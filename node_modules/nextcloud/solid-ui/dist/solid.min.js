require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var asn1=exports;asn1.bignum=require("bn.js"),asn1.define=require("./asn1/api").define,asn1.base=require("./asn1/base"),asn1.constants=require("./asn1/constants"),asn1.decoders=require("./asn1/decoders"),asn1.encoders=require("./asn1/encoders");
},{"./asn1/api":2,"./asn1/base":4,"./asn1/constants":8,"./asn1/decoders":10,"./asn1/encoders":13,"bn.js":17}],2:[function(require,module,exports){
function Entity(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}var asn1=require("../asn1"),inherits=require("inherits"),api=exports;api.define=function(e,t){return new Entity(e,t)},Entity.prototype._createNamed=function(e){var t;try{t=require("vm").runInThisContext("(function "+this.name+"(entity) {\n  this._initNamed(entity);\n})")}catch(e){t=function(e){this._initNamed(e)}}return inherits(t,e),t.prototype._initNamed=function(t){e.call(this,t)},new t(this)},Entity.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(asn1.decoders[e])),this.decoders[e]},Entity.prototype.decode=function(e,t,n){return this._getDecoder(t).decode(e,n)},Entity.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(asn1.encoders[e])),this.encoders[e]},Entity.prototype.encode=function(e,t,n){return this._getEncoder(t).encode(e,n)};
},{"../asn1":1,"inherits":97,"vm":242}],3:[function(require,module,exports){
function DecoderBuffer(e,t){return Reporter.call(this,t),Buffer.isBuffer(e)?(this.base=e,this.offset=0,void(this.length=e.length)):void this.error("Input not Buffer")}function EncoderBuffer(e,t){if(Array.isArray(e))this.length=0,this.value=e.map(function(e){return e instanceof EncoderBuffer||(e=new EncoderBuffer(e,t)),this.length+=e.length,e},this);else if("number"==typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=Buffer.byteLength(e);else{if(!Buffer.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}var inherits=require("inherits"),Reporter=require("../base").Reporter,Buffer=require("buffer").Buffer;inherits(DecoderBuffer,Reporter),exports.DecoderBuffer=DecoderBuffer,DecoderBuffer.prototype.save=function(){return{offset:this.offset,reporter:Reporter.prototype.save.call(this)}},DecoderBuffer.prototype.restore=function(e){var t=new DecoderBuffer(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,Reporter.prototype.restore.call(this,e.reporter),t},DecoderBuffer.prototype.isEmpty=function(){return this.offset===this.length},DecoderBuffer.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},DecoderBuffer.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");var r=new DecoderBuffer(this.base);return r._reporterState=this._reporterState,r.offset=this.offset,r.length=this.offset+e,this.offset+=e,r},DecoderBuffer.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},exports.EncoderBuffer=EncoderBuffer,EncoderBuffer.prototype.join=function(e,t){return e||(e=new Buffer(this.length)),t||(t=0),0===this.length?e:(Array.isArray(this.value)?this.value.forEach(function(r){r.join(e,t),t+=r.length}):("number"==typeof this.value?e[t]=this.value:"string"==typeof this.value?e.write(this.value,t):Buffer.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length),e)};
},{"../base":4,"buffer":47,"inherits":97}],4:[function(require,module,exports){
var base=exports;base.Reporter=require("./reporter").Reporter,base.DecoderBuffer=require("./buffer").DecoderBuffer,base.EncoderBuffer=require("./buffer").EncoderBuffer,base.Node=require("./node");
},{"./buffer":3,"./node":5,"./reporter":6}],5:[function(require,module,exports){
function Node(e,t){var r={};this._baseState=r,r.enc=e,r.parent=t||null,r.children=null,r.tag=null,r.args=null,r.reverseArgs=null,r.choice=null,r.optional=!1,r.any=!1,r.obj=!1,r.use=null,r.useDecoder=null,r.key=null,r.default=null,r.explicit=null,r.implicit=null,r.contains=null,r.parent||(r.children=[],this._wrap())}var Reporter=require("../base").Reporter,EncoderBuffer=require("../base").EncoderBuffer,DecoderBuffer=require("../base").DecoderBuffer,assert=require("minimalistic-assert"),tags=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],methods=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(tags),overrided=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];module.exports=Node;var stateProps=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];Node.prototype.clone=function(){var e=this._baseState,t={};stateProps.forEach(function(r){t[r]=e[r]});var r=new this.constructor(t.parent);return r._baseState=t,r},Node.prototype._wrap=function(){var e=this._baseState;methods.forEach(function(t){this[t]=function(){var r=new this.constructor(this);return e.children.push(r),r[t].apply(r,arguments)}},this)},Node.prototype._init=function(e){var t=this._baseState;assert(null===t.parent),e.call(this),t.children=t.children.filter(function(e){return e._baseState.parent===this},this),assert.equal(t.children.length,1,"Root node can have only one child")},Node.prototype._useArgs=function(e){var t=this._baseState,r=e.filter(function(e){return e instanceof this.constructor},this);e=e.filter(function(e){return!(e instanceof this.constructor)},this),0!==r.length&&(assert(null===t.children),t.children=r,r.forEach(function(e){e._baseState.parent=this},this)),0!==e.length&&(assert(null===t.args),t.args=e,t.reverseArgs=e.map(function(e){if("object"!=typeof e||e.constructor!==Object)return e;var t={};return Object.keys(e).forEach(function(r){r==(0|r)&&(r|=0);var i=e[r];t[i]=r}),t}))},overrided.forEach(function(e){Node.prototype[e]=function(){var t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}}),tags.forEach(function(e){Node.prototype[e]=function(){var t=this._baseState,r=Array.prototype.slice.call(arguments);return assert(null===t.tag),t.tag=e,this._useArgs(r),this}}),Node.prototype.use=function(e){assert(e);var t=this._baseState;return assert(null===t.use),t.use=e,this},Node.prototype.optional=function(){var e=this._baseState;return e.optional=!0,this},Node.prototype.def=function(e){var t=this._baseState;return assert(null===t.default),t.default=e,t.optional=!0,this},Node.prototype.explicit=function(e){var t=this._baseState;return assert(null===t.explicit&&null===t.implicit),t.explicit=e,this},Node.prototype.implicit=function(e){var t=this._baseState;return assert(null===t.explicit&&null===t.implicit),t.implicit=e,this},Node.prototype.obj=function(){var e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},Node.prototype.key=function(e){var t=this._baseState;return assert(null===t.key),t.key=e,this},Node.prototype.any=function(){var e=this._baseState;return e.any=!0,this},Node.prototype.choice=function(e){var t=this._baseState;return assert(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map(function(t){return e[t]})),this},Node.prototype.contains=function(e){var t=this._baseState;return assert(null===t.use),t.contains=e,this},Node.prototype._decode=function(e,t){var r=this._baseState;if(null===r.parent)return e.wrapResult(r.children[0]._decode(e,t));var i=r.default,n=!0,o=null;if(null!==r.key&&(o=e.enterKey(r.key)),r.optional){var s=null;if(null!==r.explicit?s=r.explicit:null!==r.implicit?s=r.implicit:null!==r.tag&&(s=r.tag),null!==s||r.any){if(n=this._peekTag(e,s,r.any),e.isError(n))return n}else{var a=e.save();try{null===r.choice?this._decodeGeneric(r.tag,e,t):this._decodeChoice(e,t),n=!0}catch(e){n=!1}e.restore(a)}}var c;if(r.obj&&n&&(c=e.enterObject()),n){if(null!==r.explicit){var l=this._decodeTag(e,r.explicit);if(e.isError(l))return l;e=l}var u=e.offset;if(null===r.use&&null===r.choice){if(r.any)var a=e.save();var d=this._decodeTag(e,null!==r.implicit?r.implicit:r.tag,r.any);if(e.isError(d))return d;r.any?i=e.raw(a):e=d}if(t&&t.track&&null!==r.tag&&t.track(e.path(),u,e.length,"tagged"),t&&t.track&&null!==r.tag&&t.track(e.path(),e.offset,e.length,"content"),i=r.any?i:null===r.choice?this._decodeGeneric(r.tag,e,t):this._decodeChoice(e,t),e.isError(i))return i;if(r.any||null!==r.choice||null===r.children||r.children.forEach(function(r){r._decode(e,t)}),r.contains&&("octstr"===r.tag||"bitstr"===r.tag)){var h=new DecoderBuffer(i);i=this._getUse(r.contains,e._reporterState.obj)._decode(h,t)}}return r.obj&&n&&(i=e.leaveObject(c)),null===r.key||null===i&&n!==!0?null!==o&&e.exitKey(o):e.leaveKey(o,r.key,i),i},Node.prototype._decodeGeneric=function(e,t,r){var i=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,i.args[0],r):/str$/.test(e)?this._decodeStr(t,e,r):"objid"===e&&i.args?this._decodeObjid(t,i.args[0],i.args[1],r):"objid"===e?this._decodeObjid(t,null,null,r):"gentime"===e||"utctime"===e?this._decodeTime(t,e,r):"null_"===e?this._decodeNull(t,r):"bool"===e?this._decodeBool(t,r):"objDesc"===e?this._decodeStr(t,e,r):"int"===e||"enum"===e?this._decodeInt(t,i.args&&i.args[0],r):null!==i.use?this._getUse(i.use,t._reporterState.obj)._decode(t,r):t.error("unknown tag: "+e)},Node.prototype._getUse=function(e,t){var r=this._baseState;return r.useDecoder=this._use(e,t),assert(null===r.useDecoder._baseState.parent),r.useDecoder=r.useDecoder._baseState.children[0],r.implicit!==r.useDecoder._baseState.implicit&&(r.useDecoder=r.useDecoder.clone(),r.useDecoder._baseState.implicit=r.implicit),r.useDecoder},Node.prototype._decodeChoice=function(e,t){var r=this._baseState,i=null,n=!1;return Object.keys(r.choice).some(function(o){var s=e.save(),a=r.choice[o];try{var c=a._decode(e,t);if(e.isError(c))return!1;i={type:o,value:c},n=!0}catch(t){return e.restore(s),!1}return!0},this),n?i:e.error("Choice not matched")},Node.prototype._createEncoderBuffer=function(e){return new EncoderBuffer(e,this.reporter)},Node.prototype._encode=function(e,t,r){var i=this._baseState;if(null===i.default||i.default!==e){var n=this._encodeValue(e,t,r);if(void 0!==n&&!this._skipDefault(n,t,r))return n}},Node.prototype._encodeValue=function(e,t,r){var i=this._baseState;if(null===i.parent)return i.children[0]._encode(e,t||new Reporter);var n=null;if(this.reporter=t,i.optional&&void 0===e){if(null===i.default)return;e=i.default}var o=null,s=!1;if(i.any)n=this._createEncoderBuffer(e);else if(i.choice)n=this._encodeChoice(e,t);else if(i.contains)o=this._getUse(i.contains,r)._encode(e,t),s=!0;else if(i.children)o=i.children.map(function(r){if("null_"===r._baseState.tag)return r._encode(null,t,e);if(null===r._baseState.key)return t.error("Child should have a key");var i=t.enterKey(r._baseState.key);if("object"!=typeof e)return t.error("Child expected, but input is not object");var n=r._encode(e[r._baseState.key],t,e);return t.leaveKey(i),n},this).filter(function(e){return e}),o=this._createEncoderBuffer(o);else if("seqof"===i.tag||"setof"===i.tag){if(!i.args||1!==i.args.length)return t.error("Too many args for : "+i.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");var a=this.clone();a._baseState.implicit=null,o=this._createEncoderBuffer(e.map(function(r){var i=this._baseState;return this._getUse(i.args[0],e)._encode(r,t)},a))}else null!==i.use?n=this._getUse(i.use,r)._encode(e,t):(o=this._encodePrimitive(i.tag,e),s=!0);var n;if(!i.any&&null===i.choice){var c=null!==i.implicit?i.implicit:i.tag,l=null===i.implicit?"universal":"context";null===c?null===i.use&&t.error("Tag could be ommited only for .use()"):null===i.use&&(n=this._encodeComposite(c,s,l,o))}return null!==i.explicit&&(n=this._encodeComposite(i.explicit,!1,"context",n)),n},Node.prototype._encodeChoice=function(e,t){var r=this._baseState,i=r.choice[e.type];return i||assert(!1,e.type+" not found in "+JSON.stringify(Object.keys(r.choice))),i._encode(e.value,t)},Node.prototype._encodePrimitive=function(e,t){var r=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&r.args)return this._encodeObjid(t,r.reverseArgs[0],r.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,r.args&&r.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error("Unsupported tag: "+e)},Node.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},Node.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(e)};
},{"../base":4,"minimalistic-assert":103}],6:[function(require,module,exports){
function Reporter(r){this._reporterState={obj:null,path:[],options:r||{},errors:[]}}function ReporterError(r,t){this.path=r,this.rethrow(t)}var inherits=require("inherits");exports.Reporter=Reporter,Reporter.prototype.isError=function(r){return r instanceof ReporterError},Reporter.prototype.save=function(){var r=this._reporterState;return{obj:r.obj,pathLen:r.path.length}},Reporter.prototype.restore=function(r){var t=this._reporterState;t.obj=r.obj,t.path=t.path.slice(0,r.pathLen)},Reporter.prototype.enterKey=function(r){return this._reporterState.path.push(r)},Reporter.prototype.exitKey=function(r){var t=this._reporterState;t.path=t.path.slice(0,r-1)},Reporter.prototype.leaveKey=function(r,t,e){var o=this._reporterState;this.exitKey(r),null!==o.obj&&(o.obj[t]=e)},Reporter.prototype.path=function(){return this._reporterState.path.join("/")},Reporter.prototype.enterObject=function(){var r=this._reporterState,t=r.obj;return r.obj={},t},Reporter.prototype.leaveObject=function(r){var t=this._reporterState,e=t.obj;return t.obj=r,e},Reporter.prototype.error=function(r){var t,e=this._reporterState,o=r instanceof ReporterError;if(t=o?r:new ReporterError(e.path.map(function(r){return"["+JSON.stringify(r)+"]"}).join(""),r.message||r,r.stack),!e.options.partial)throw t;return o||e.errors.push(t),t},Reporter.prototype.wrapResult=function(r){var t=this._reporterState;return t.options.partial?{result:this.isError(r)?null:r,errors:t.errors}:r},inherits(ReporterError,Error),ReporterError.prototype.rethrow=function(r){if(this.message=r+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,ReporterError),!this.stack)try{throw new Error(this.message)}catch(r){this.stack=r.stack}return this};
},{"inherits":97}],7:[function(require,module,exports){
var constants=require("../constants");exports.tagClass={0:"universal",1:"application",2:"context",3:"private"},exports.tagClassByName=constants._reverse(exports.tagClass),exports.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},exports.tagByName=constants._reverse(exports.tag);
},{"../constants":8}],8:[function(require,module,exports){
var constants=exports;constants._reverse=function(r){var e={};return Object.keys(r).forEach(function(n){(0|n)==n&&(n|=0);var t=r[n];e[t]=n}),e},constants.der=require("./der");
},{"./der":7}],9:[function(require,module,exports){
function DERDecoder(r){this.enc="der",this.name=r.name,this.entity=r,this.tree=new DERNode,this.tree._init(r.body)}function DERNode(r){base.Node.call(this,"der",r)}function derDecodeTag(r,e){var t=r.readUInt8(e);if(r.isError(t))return t;var i=der.tagClass[t>>6],o=0===(32&t);if(31===(31&t)){var n=t;for(t=0;128===(128&n);){if(n=r.readUInt8(e),r.isError(n))return n;t<<=7,t|=127&n}}else t&=31;var s=der.tag[t];return{cls:i,primitive:o,tag:t,tagStr:s}}function derDecodeLen(r,e,t){var i=r.readUInt8(t);if(r.isError(i))return i;if(!e&&128===i)return null;if(0===(128&i))return i;var o=127&i;if(o>=4)return r.error("length octect is too long");i=0;for(var n=0;n<o;n++){i<<=8;var s=r.readUInt8(t);if(r.isError(s))return s;i|=s}return i}var inherits=require("inherits"),asn1=require("../../asn1"),base=asn1.base,bignum=asn1.bignum,der=asn1.constants.der;module.exports=DERDecoder,DERDecoder.prototype.decode=function(r,e){return r instanceof base.DecoderBuffer||(r=new base.DecoderBuffer(r,e)),this.tree._decode(r,e)},inherits(DERNode,base.Node),DERNode.prototype._peekTag=function(r,e,t){if(r.isEmpty())return!1;var i=r.save(),o=derDecodeTag(r,'Failed to peek tag: "'+e+'"');return r.isError(o)?o:(r.restore(i),o.tag===e||o.tagStr===e||o.tagStr+"of"===e||t)},DERNode.prototype._decodeTag=function(r,e,t){var i=derDecodeTag(r,'Failed to decode tag of "'+e+'"');if(r.isError(i))return i;var o=derDecodeLen(r,i.primitive,'Failed to get length of "'+e+'"');if(r.isError(o))return o;if(!t&&i.tag!==e&&i.tagStr!==e&&i.tagStr+"of"!==e)return r.error('Failed to match tag: "'+e+'"');if(i.primitive||null!==o)return r.skip(o,'Failed to match body of: "'+e+'"');var n=r.save(),s=this._skipUntilEnd(r,'Failed to skip indefinite length body: "'+this.tag+'"');return r.isError(s)?s:(o=r.offset-n.offset,r.restore(n),r.skip(o,'Failed to match body of: "'+e+'"'))},DERNode.prototype._skipUntilEnd=function(r,e){for(;;){var t=derDecodeTag(r,e);if(r.isError(t))return t;var i=derDecodeLen(r,t.primitive,e);if(r.isError(i))return i;var o;if(o=t.primitive||null!==i?r.skip(i):this._skipUntilEnd(r,e),r.isError(o))return o;if("end"===t.tagStr)break}},DERNode.prototype._decodeList=function(r,e,t,i){for(var o=[];!r.isEmpty();){var n=this._peekTag(r,"end");if(r.isError(n))return n;var s=t.decode(r,"der",i);if(r.isError(s)&&n)break;o.push(s)}return o},DERNode.prototype._decodeStr=function(r,e){if("bitstr"===e){var t=r.readUInt8();return r.isError(t)?t:{unused:t,data:r.raw()}}if("bmpstr"===e){var i=r.raw();if(i.length%2===1)return r.error("Decoding of string type: bmpstr length mismatch");for(var o="",n=0;n<i.length/2;n++)o+=String.fromCharCode(i.readUInt16BE(2*n));return o}if("numstr"===e){var s=r.raw().toString("ascii");return this._isNumstr(s)?s:r.error("Decoding of string type: numstr unsupported characters")}if("octstr"===e)return r.raw();if("objDesc"===e)return r.raw();if("printstr"===e){var a=r.raw().toString("ascii");return this._isPrintstr(a)?a:r.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(e)?r.raw().toString():r.error("Decoding of string type: "+e+" unsupported")},DERNode.prototype._decodeObjid=function(r,e,t){for(var i,o=[],n=0;!r.isEmpty();){var s=r.readUInt8();n<<=7,n|=127&s,0===(128&s)&&(o.push(n),n=0)}128&s&&o.push(n);var a=o[0]/40|0,d=o[0]%40;if(i=t?o:[a,d].concat(o.slice(1)),e){var u=e[i.join(" ")];void 0===u&&(u=e[i.join(".")]),void 0!==u&&(i=u)}return i},DERNode.prototype._decodeTime=function(r,e){var t=r.raw().toString();if("gentime"===e)var i=0|t.slice(0,4),o=0|t.slice(4,6),n=0|t.slice(6,8),s=0|t.slice(8,10),a=0|t.slice(10,12),d=0|t.slice(12,14);else{if("utctime"!==e)return r.error("Decoding "+e+" time is not supported yet");var i=0|t.slice(0,2),o=0|t.slice(2,4),n=0|t.slice(4,6),s=0|t.slice(6,8),a=0|t.slice(8,10),d=0|t.slice(10,12);i=i<70?2e3+i:1900+i}return Date.UTC(i,o-1,n,s,a,d,0)},DERNode.prototype._decodeNull=function(r){return null},DERNode.prototype._decodeBool=function(r){var e=r.readUInt8();return r.isError(e)?e:0!==e},DERNode.prototype._decodeInt=function(r,e){var t=r.raw(),i=new bignum(t);return e&&(i=e[i.toString(10)]||i),i},DERNode.prototype._use=function(r,e){return"function"==typeof r&&(r=r(e)),r._getDecoder("der").tree};
},{"../../asn1":1,"inherits":97}],10:[function(require,module,exports){
var decoders=exports;decoders.der=require("./der"),decoders.pem=require("./pem");
},{"./der":9,"./pem":11}],11:[function(require,module,exports){
function PEMDecoder(e){DERDecoder.call(this,e),this.enc="pem"}var inherits=require("inherits"),Buffer=require("buffer").Buffer,DERDecoder=require("./der");inherits(PEMDecoder,DERDecoder),module.exports=PEMDecoder,PEMDecoder.prototype.decode=function(e,r){for(var o=e.toString().split(/[\r\n]+/g),i=r.label.toUpperCase(),t=/^-----(BEGIN|END) ([^-]+)-----$/,c=-1,n=-1,f=0;f<o.length;f++){var a=o[f].match(t);if(null!==a&&a[2]===i){if(c!==-1){if("END"!==a[1])break;n=f;break}if("BEGIN"!==a[1])break;c=f}}if(c===-1||n===-1)throw new Error("PEM section not found for: "+i);var d=o.slice(c+1,n).join("");d.replace(/[^a-z0-9\+\/=]+/gi,"");var D=new Buffer(d,"base64");return DERDecoder.prototype.decode.call(this,D,r)};
},{"./der":9,"buffer":47,"inherits":97}],12:[function(require,module,exports){
function DEREncoder(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new DERNode,this.tree._init(e.body)}function DERNode(e){base.Node.call(this,"der",e)}function two(e){return e<10?"0"+e:e}function encodeTag(e,r,t,n){var o;if("seqof"===e?e="seq":"setof"===e&&(e="set"),der.tagByName.hasOwnProperty(e))o=der.tagByName[e];else{if("number"!=typeof e||(0|e)!==e)return n.error("Unknown tag: "+e);o=e}return o>=31?n.error("Multi-octet tag encoding unsupported"):(r||(o|=32),o|=der.tagClassByName[t||"universal"]<<6)}var inherits=require("inherits"),Buffer=require("buffer").Buffer,asn1=require("../../asn1"),base=asn1.base,der=asn1.constants.der;module.exports=DEREncoder,DEREncoder.prototype.encode=function(e,r){return this.tree._encode(e,r).join()},inherits(DERNode,base.Node),DERNode.prototype._encodeComposite=function(e,r,t,n){var o=encodeTag(e,r,t,this.reporter);if(n.length<128){var i=new Buffer(2);return i[0]=o,i[1]=n.length,this._createEncoderBuffer([i,n])}for(var f=1,s=n.length;s>=256;s>>=8)f++;var i=new Buffer(2+f);i[0]=o,i[1]=128|f;for(var s=1+f,u=n.length;u>0;s--,u>>=8)i[s]=255&u;return this._createEncoderBuffer([i,n])},DERNode.prototype._encodeStr=function(e,r){if("bitstr"===r)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===r){for(var t=new Buffer(2*e.length),n=0;n<e.length;n++)t.writeUInt16BE(e.charCodeAt(n),2*n);return this._createEncoderBuffer(t)}return"numstr"===r?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===r?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(r)?this._createEncoderBuffer(e):"objDesc"===r?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+r+" unsupported")},DERNode.prototype._encodeObjid=function(e,r,t){if("string"==typeof e){if(!r)return this.reporter.error("string objid given, but no values map found");if(!r.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=r[e].split(/[\s\.]+/g);for(var n=0;n<e.length;n++)e[n]|=0}else if(Array.isArray(e)){e=e.slice();for(var n=0;n<e.length;n++)e[n]|=0}if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!t){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}for(var o=0,n=0;n<e.length;n++){var i=e[n];for(o++;i>=128;i>>=7)o++}for(var f=new Buffer(o),s=f.length-1,n=e.length-1;n>=0;n--){var i=e[n];for(f[s--]=127&i;(i>>=7)>0;)f[s--]=128|127&i}return this._createEncoderBuffer(f)},DERNode.prototype._encodeTime=function(e,r){var t,n=new Date(e);return"gentime"===r?t=[two(n.getFullYear()),two(n.getUTCMonth()+1),two(n.getUTCDate()),two(n.getUTCHours()),two(n.getUTCMinutes()),two(n.getUTCSeconds()),"Z"].join(""):"utctime"===r?t=[two(n.getFullYear()%100),two(n.getUTCMonth()+1),two(n.getUTCDate()),two(n.getUTCHours()),two(n.getUTCMinutes()),two(n.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+r+" time is not supported yet"),this._encodeStr(t,"octstr")},DERNode.prototype._encodeNull=function(){return this._createEncoderBuffer("")},DERNode.prototype._encodeInt=function(e,r){if("string"==typeof e){if(!r)return this.reporter.error("String int or enum given, but no values map");if(!r.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=r[e]}if("number"!=typeof e&&!Buffer.isBuffer(e)){var t=e.toArray();!e.sign&&128&t[0]&&t.unshift(0),e=new Buffer(t)}if(Buffer.isBuffer(e)){var n=e.length;0===e.length&&n++;var o=new Buffer(n);return e.copy(o),0===e.length&&(o[0]=0),this._createEncoderBuffer(o)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);for(var n=1,i=e;i>=256;i>>=8)n++;for(var o=new Array(n),i=o.length-1;i>=0;i--)o[i]=255&e,e>>=8;return 128&o[0]&&o.unshift(0),this._createEncoderBuffer(new Buffer(o))},DERNode.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},DERNode.prototype._use=function(e,r){return"function"==typeof e&&(e=e(r)),e._getEncoder("der").tree},DERNode.prototype._skipDefault=function(e,r,t){var n,o=this._baseState;if(null===o.default)return!1;var i=e.join();if(void 0===o.defaultBuffer&&(o.defaultBuffer=this._encodeValue(o.default,r,t).join()),i.length!==o.defaultBuffer.length)return!1;for(n=0;n<i.length;n++)if(i[n]!==o.defaultBuffer[n])return!1;return!0};
},{"../../asn1":1,"buffer":47,"inherits":97}],13:[function(require,module,exports){
var encoders=exports;encoders.der=require("./der"),encoders.pem=require("./pem");
},{"./der":12,"./pem":14}],14:[function(require,module,exports){
function PEMEncoder(e){DEREncoder.call(this,e),this.enc="pem"}var inherits=require("inherits"),DEREncoder=require("./der");inherits(PEMEncoder,DEREncoder),module.exports=PEMEncoder,PEMEncoder.prototype.encode=function(e,r){for(var n=DEREncoder.prototype.encode.call(this,e),o=n.toString("base64"),E=["-----BEGIN "+r.label+"-----"],t=0;t<o.length;t+=64)E.push(o.slice(t,t+64));return E.push("-----END "+r.label+"-----"),E.join("\n")};
},{"./der":12,"inherits":97}],15:[function(require,module,exports){
(function (process){
!function(){function n(n){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,n.apply(t,arguments)}}var t,e,r={};t=this,null!=t&&(e=t.async),r.noConflict=function(){return t.async=e,r};var i=Object.prototype.toString,u=Array.isArray||function(n){return"[object Array]"===i.call(n)},c=function(n,t){for(var e=0;e<n.length;e+=1)t(n[e],e,n)},o=function(n,t){if(n.map)return n.map(t);var e=[];return c(n,function(n,r,i){e.push(t(n,r,i))}),e},a=function(n,t,e){return n.reduce?n.reduce(t,e):(c(n,function(n,r,i){e=t(e,n,r,i)}),e)},l=function(n){if(Object.keys)return Object.keys(n);var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t};"undefined"!=typeof process&&process.nextTick?(r.nextTick=process.nextTick,"undefined"!=typeof setImmediate?r.setImmediate=function(n){setImmediate(n)}:r.setImmediate=r.nextTick):"function"==typeof setImmediate?(r.nextTick=function(n){setImmediate(n)},r.setImmediate=r.nextTick):(r.nextTick=function(n){setTimeout(n,0)},r.setImmediate=r.nextTick),r.each=function(t,e,r){function i(n){n?(r(n),r=function(){}):(u+=1,u>=t.length&&r())}if(r=r||function(){},!t.length)return r();var u=0;c(t,function(t){e(t,n(i))})},r.forEach=r.each,r.eachSeries=function(n,t,e){if(e=e||function(){},!n.length)return e();var r=0,i=function(){t(n[r],function(t){t?(e(t),e=function(){}):(r+=1,r>=n.length?e():i())})};i()},r.forEachSeries=r.eachSeries,r.eachLimit=function(n,t,e,r){var i=f(t);i.apply(null,[n,e,r])},r.forEachLimit=r.eachLimit;var f=function(n){return function(t,e,r){if(r=r||function(){},!t.length||n<=0)return r();var i=0,u=0,c=0;!function o(){if(i>=t.length)return r();for(;c<n&&u<t.length;)u+=1,c+=1,e(t[u-1],function(n){n?(r(n),r=function(){}):(i+=1,c-=1,i>=t.length?r():o())})}()}},s=function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[r.each].concat(t))}},p=function(n,t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[f(n)].concat(e))}},d=function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[r.eachSeries].concat(t))}},y=function(n,t,e,r){if(t=o(t,function(n,t){return{index:t,value:n}}),r){var i=[];n(t,function(n,t){e(n.value,function(e,r){i[n.index]=r,t(e)})},function(n){r(n,i)})}else n(t,function(n,t){e(n.value,function(n){t(n)})})};r.map=s(y),r.mapSeries=d(y),r.mapLimit=function(n,t,e,r){return v(t)(n,e,r)};var v=function(n){return p(n,y)};r.reduce=function(n,t,e,i){r.eachSeries(n,function(n,r){e(t,n,function(n,e){t=e,r(n)})},function(n){i(n,t)})},r.inject=r.reduce,r.foldl=r.reduce,r.reduceRight=function(n,t,e,i){var u=o(n,function(n){return n}).reverse();r.reduce(u,t,e,i)},r.foldr=r.reduceRight;var h=function(n,t,e,r){var i=[];t=o(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e&&i.push(n),t()})},function(n){r(o(i.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.filter=s(h),r.filterSeries=d(h),r.select=r.filter,r.selectSeries=r.filterSeries;var m=function(n,t,e,r){var i=[];t=o(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e||i.push(n),t()})},function(n){r(o(i.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.reject=s(m),r.rejectSeries=d(m);var g=function(n,t,e,r){n(t,function(n,t){e(n,function(e){e?(r(n),r=function(){}):t()})},function(n){r()})};r.detect=s(g),r.detectSeries=d(g),r.some=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n&&(e(!0),e=function(){}),r()})},function(n){e(!1)})},r.any=r.some,r.every=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n||(e(!1),e=function(){}),r()})},function(n){e(!0)})},r.all=r.every,r.sortBy=function(n,t,e){r.map(n,function(n,e){t(n,function(t,r){t?e(t):e(null,{value:n,criteria:r})})},function(n,t){if(n)return e(n);var r=function(n,t){var e=n.criteria,r=t.criteria;return e<r?-1:e>r?1:0};e(null,o(t.sort(r),function(n){return n.value}))})},r.auto=function(n,t){t=t||function(){};var e=l(n),i=e.length;if(!i)return t();var o={},f=[],s=function(n){f.unshift(n)},p=function(n){for(var t=0;t<f.length;t+=1)if(f[t]===n)return void f.splice(t,1)},d=function(){i--,c(f.slice(0),function(n){n()})};s(function(){if(!i){var n=t;t=function(){},n(null,o)}}),c(e,function(e){var i=u(n[e])?n[e]:[n[e]],f=function(n){var i=Array.prototype.slice.call(arguments,1);if(i.length<=1&&(i=i[0]),n){var u={};c(l(o),function(n){u[n]=o[n]}),u[e]=i,t(n,u),t=function(){}}else o[e]=i,r.setImmediate(d)},y=i.slice(0,Math.abs(i.length-1))||[],v=function(){return a(y,function(n,t){return n&&o.hasOwnProperty(t)},!0)&&!o.hasOwnProperty(e)};if(v())i[i.length-1](f,o);else{var h=function(){v()&&(p(h),i[i.length-1](f,o))};s(h)}})},r.retry=function(n,t,e){var i=5,u=[];"function"==typeof n&&(e=t,t=n,n=i),n=parseInt(n,10)||i;var c=function(i,c){for(var o=function(n,t){return function(e){n(function(n,r){e(!n||t,{err:n,result:r})},c)}};n;)u.push(o(t,!(n-=1)));r.series(u,function(n,t){t=t[t.length-1],(i||e)(t.err,t.result)})};return e?c():c},r.waterfall=function(n,t){if(t=t||function(){},!u(n)){var e=new Error("First argument to waterfall must be an array of functions");return t(e)}if(!n.length)return t();var i=function(n){return function(e){if(e)t.apply(null,arguments),t=function(){};else{var u=Array.prototype.slice.call(arguments,1),c=n.next();c?u.push(i(c)):u.push(t),r.setImmediate(function(){n.apply(null,u)})}}};i(r.iterator(n))()};var k=function(n,t,e){if(e=e||function(){},u(t))n.map(t,function(n,t){n&&n(function(n){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),t.call(null,n,e)})},e);else{var r={};n.each(l(t),function(n,e){t[n](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[n]=i,e(t)})},function(n){e(n,r)})}};r.parallel=function(n,t){k({map:r.map,each:r.each},n,t)},r.parallelLimit=function(n,t,e){k({map:v(t),each:f(t)},n,e)},r.series=function(n,t){if(t=t||function(){},u(n))r.mapSeries(n,function(n,t){n&&n(function(n){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),t.call(null,n,e)})},t);else{var e={};r.eachSeries(l(n),function(t,r){n[t](function(n){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),e[t]=i,r(n)})},function(n){t(n,e)})}},r.iterator=function(n){var t=function(e){var r=function(){return n.length&&n[e].apply(null,arguments),r.next()};return r.next=function(){return e<n.length-1?t(e+1):null},r};return t(0)},r.apply=function(n){var t=Array.prototype.slice.call(arguments,1);return function(){return n.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var A=function(n,t,e,r){var i=[];n(t,function(n,t){e(n,function(n,e){i=i.concat(e||[]),t(n)})},function(n){r(n,i)})};r.concat=s(A),r.concatSeries=d(A),r.whilst=function(n,t,e){n()?t(function(i){return i?e(i):void r.whilst(n,t,e)}):e()},r.doWhilst=function(n,t,e){n(function(i){if(i)return e(i);var u=Array.prototype.slice.call(arguments,1);t.apply(null,u)?r.doWhilst(n,t,e):e()})},r.until=function(n,t,e){n()?e():t(function(i){return i?e(i):void r.until(n,t,e)})},r.doUntil=function(n,t,e){n(function(i){if(i)return e(i);var u=Array.prototype.slice.call(arguments,1);t.apply(null,u)?e():r.doUntil(n,t,e)})},r.queue=function(t,e){function i(n,t,e,i){return n.started||(n.started=!0),u(t)||(t=[t]),0==t.length?r.setImmediate(function(){n.drain&&n.drain()}):void c(t,function(t){var u={data:t,callback:"function"==typeof i?i:null};e?n.tasks.unshift(u):n.tasks.push(u),n.saturated&&n.tasks.length===n.concurrency&&n.saturated(),r.setImmediate(n.process)})}void 0===e&&(e=1);var o=0,a={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(n,t){i(a,n,!1,t)},kill:function(){a.drain=null,a.tasks=[]},unshift:function(n,t){i(a,n,!0,t)},process:function(){if(!a.paused&&o<a.concurrency&&a.tasks.length){var e=a.tasks.shift();a.empty&&0===a.tasks.length&&a.empty(),o+=1;var r=function(){o-=1,e.callback&&e.callback.apply(e,arguments),a.drain&&a.tasks.length+o===0&&a.drain(),a.process()},i=n(r);t(e.data,i)}},length:function(){return a.tasks.length},running:function(){return o},idle:function(){return a.tasks.length+o===0},pause:function(){a.paused!==!0&&(a.paused=!0)},resume:function(){if(a.paused!==!1){a.paused=!1;for(var n=1;n<=a.concurrency;n++)r.setImmediate(a.process)}}};return a},r.priorityQueue=function(n,t){function e(n,t){return n.priority-t.priority}function i(n,t,e){for(var r=-1,i=n.length-1;r<i;){var u=r+(i-r+1>>>1);e(t,n[u])>=0?r=u:i=u-1}return r}function o(n,t,o,a){return n.started||(n.started=!0),u(t)||(t=[t]),0==t.length?r.setImmediate(function(){n.drain&&n.drain()}):void c(t,function(t){var u={data:t,priority:o,callback:"function"==typeof a?a:null};n.tasks.splice(i(n.tasks,u,e)+1,0,u),n.saturated&&n.tasks.length===n.concurrency&&n.saturated(),r.setImmediate(n.process)})}var a=r.queue(n,t);return a.push=function(n,t,e){o(a,n,t,e)},delete a.unshift,a},r.cargo=function(n,t){var e=!1,i=[],a={tasks:i,payload:t,saturated:null,empty:null,drain:null,drained:!0,push:function(n,e){u(n)||(n=[n]),c(n,function(n){i.push({data:n,callback:"function"==typeof e?e:null}),a.drained=!1,a.saturated&&i.length===t&&a.saturated()}),r.setImmediate(a.process)},process:function r(){if(!e){if(0===i.length)return a.drain&&!a.drained&&a.drain(),void(a.drained=!0);var u="number"==typeof t?i.splice(0,t):i.splice(0,i.length),l=o(u,function(n){return n.data});a.empty&&a.empty(),e=!0,n(l,function(){e=!1;var n=arguments;c(u,function(t){t.callback&&t.callback.apply(null,n)}),r()})}},length:function(){return i.length},running:function(){return e}};return a};var x=function(n){return function(t){var e=Array.prototype.slice.call(arguments,1);t.apply(null,e.concat([function(t){var e=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[n]&&c(e,function(t){console[n](t)}))}]))}};r.log=x("log"),r.dir=x("dir"),r.memoize=function(n,t){var e={},i={};t=t||function(n){return n};var u=function(){var u=Array.prototype.slice.call(arguments),c=u.pop(),o=t.apply(null,u);o in e?r.nextTick(function(){c.apply(null,e[o])}):o in i?i[o].push(c):(i[o]=[c],n.apply(null,u.concat([function(){e[o]=arguments;var n=i[o];delete i[o];for(var t=0,r=n.length;t<r;t++)n[t].apply(null,arguments)}])))};return u.memo=e,u.unmemoized=n,u},r.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},r.times=function(n,t,e){for(var i=[],u=0;u<n;u++)i.push(u);return r.map(i,t,e)},r.timesSeries=function(n,t,e){for(var i=[],u=0;u<n;u++)i.push(u);return r.mapSeries(i,t,e)},r.seq=function(){var n=arguments;return function(){var t=this,e=Array.prototype.slice.call(arguments),i=e.pop();r.reduce(n,e,function(n,e,r){e.apply(t,n.concat([function(){var n=arguments[0],t=Array.prototype.slice.call(arguments,1);r(n,t)}]))},function(n,e){i.apply(t,[n].concat(e))})}},r.compose=function(){return r.seq.apply(null,Array.prototype.reverse.call(arguments))};var S=function(n,t){var e=function(){var e=this,r=Array.prototype.slice.call(arguments),i=r.pop();return n(t,function(n,t){n.apply(e,r.concat([t]))},i)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return e.apply(this,r)}return e};r.applyEach=s(S),r.applyEachSeries=d(S),r.forever=function(n,t){function e(r){if(r){if(t)return t(r);throw r}n(e)}e()},"undefined"!=typeof module&&module.exports?module.exports=r:"undefined"!=typeof define&&define.amd?define([],function(){return r}):t.async=r}();
}).call(this,require('_process'))

},{"_process":120}],16:[function(require,module,exports){
"use strict";function placeHoldersCount(o){var r=o.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===o[r-2]?2:"="===o[r-1]?1:0}function byteLength(o){return 3*o.length/4-placeHoldersCount(o)}function toByteArray(o){var r,e,t,u,n,p,a=o.length;n=placeHoldersCount(o),p=new Arr(3*a/4-n),t=n>0?a-4:a;var l=0;for(r=0,e=0;r<t;r+=4,e+=3)u=revLookup[o.charCodeAt(r)]<<18|revLookup[o.charCodeAt(r+1)]<<12|revLookup[o.charCodeAt(r+2)]<<6|revLookup[o.charCodeAt(r+3)],p[l++]=u>>16&255,p[l++]=u>>8&255,p[l++]=255&u;return 2===n?(u=revLookup[o.charCodeAt(r)]<<2|revLookup[o.charCodeAt(r+1)]>>4,p[l++]=255&u):1===n&&(u=revLookup[o.charCodeAt(r)]<<10|revLookup[o.charCodeAt(r+1)]<<4|revLookup[o.charCodeAt(r+2)]>>2,p[l++]=u>>8&255,p[l++]=255&u),p}function tripletToBase64(o){return lookup[o>>18&63]+lookup[o>>12&63]+lookup[o>>6&63]+lookup[63&o]}function encodeChunk(o,r,e){for(var t,u=[],n=r;n<e;n+=3)t=(o[n]<<16)+(o[n+1]<<8)+o[n+2],u.push(tripletToBase64(t));return u.join("")}function fromByteArray(o){for(var r,e=o.length,t=e%3,u="",n=[],p=16383,a=0,l=e-t;a<l;a+=p)n.push(encodeChunk(o,a,a+p>l?l:a+p));return 1===t?(r=o[e-1],u+=lookup[r>>2],u+=lookup[r<<4&63],u+="=="):2===t&&(r=(o[e-2]<<8)+o[e-1],u+=lookup[r>>10],u+=lookup[r>>4&63],u+=lookup[r<<2&63],u+="="),n.push(u),n.join("")}exports.byteLength=byteLength,exports.toByteArray=toByteArray,exports.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;
},{}],17:[function(require,module,exports){
!function(t,i){"use strict";function r(t,i){if(!t)throw new Error(i||"Assertion failed")}function h(t,i){t.super_=i;var r=function(){};r.prototype=i.prototype,t.prototype=new r,t.prototype.constructor=t}function n(t,i,r){return n.isBN(t)?t:(this.negative=0,this.words=null,this.length=0,this.red=null,void(null!==t&&("le"!==i&&"be"!==i||(r=i,i=10),this._init(t||0,i||10,r||"be"))))}function e(t,i,r){for(var h=0,n=Math.min(t.length,r),e=i;e<n;e++){var o=t.charCodeAt(e)-48;h<<=4,h|=o>=49&&o<=54?o-49+10:o>=17&&o<=22?o-17+10:15&o}return h}function o(t,i,r,h){for(var n=0,e=Math.min(t.length,r),o=i;o<e;o++){var s=t.charCodeAt(o)-48;n*=h,n+=s>=49?s-49+10:s>=17?s-17+10:s}return n}function s(t){for(var i=new Array(t.bitLength()),r=0;r<i.length;r++){var h=r/26|0,n=r%26;i[r]=(t.words[h]&1<<n)>>>n}return i}function u(t,i,r){r.negative=i.negative^t.negative;var h=t.length+i.length|0;r.length=h,h=h-1|0;var n=0|t.words[0],e=0|i.words[0],o=n*e,s=67108863&o,u=o/67108864|0;r.words[0]=s;for(var a=1;a<h;a++){for(var l=u>>>26,m=67108863&u,f=Math.min(a,i.length-1),d=Math.max(0,a-t.length+1);d<=f;d++){var p=a-d|0;n=0|t.words[p],e=0|i.words[d],o=n*e+m,l+=o/67108864|0,m=67108863&o}r.words[a]=0|m,u=0|l}return 0!==u?r.words[a]=0|u:r.length--,r.strip()}function a(t,i,r){r.negative=i.negative^t.negative,r.length=t.length+i.length;for(var h=0,n=0,e=0;e<r.length-1;e++){var o=n;n=0;for(var s=67108863&h,u=Math.min(e,i.length-1),a=Math.max(0,e-t.length+1);a<=u;a++){var l=e-a,m=0|t.words[l],f=0|i.words[a],d=m*f,p=67108863&d;o=o+(d/67108864|0)|0,p=p+s|0,s=67108863&p,o=o+(p>>>26)|0,n+=o>>>26,o&=67108863}r.words[e]=s,h=o,o=n}return 0!==h?r.words[e]=h:r.length--,r.strip()}function l(t,i,r){var h=new m;return h.mulp(t,i,r)}function m(t,i){this.x=t,this.y=i}function f(t,i){this.name=t,this.p=new n(i,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function d(){f.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function p(){f.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function M(){f.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function v(){f.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function g(t){if("string"==typeof t){var i=n._prime(t);this.m=i.p,this.prime=i}else r(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function c(t){g.call(this,t),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}"object"==typeof t?t.exports=n:i.BN=n,n.BN=n,n.wordSize=26;var w;try{w=require("buffer").Buffer}catch(t){}n.isBN=function(t){return t instanceof n||null!==t&&"object"==typeof t&&t.constructor.wordSize===n.wordSize&&Array.isArray(t.words)},n.max=function(t,i){return t.cmp(i)>0?t:i},n.min=function(t,i){return t.cmp(i)<0?t:i},n.prototype._init=function(t,i,h){if("number"==typeof t)return this._initNumber(t,i,h);if("object"==typeof t)return this._initArray(t,i,h);"hex"===i&&(i=16),r(i===(0|i)&&i>=2&&i<=36),t=t.toString().replace(/\s+/g,"");var n=0;"-"===t[0]&&n++,16===i?this._parseHex(t,n):this._parseBase(t,i,n),"-"===t[0]&&(this.negative=1),this.strip(),"le"===h&&this._initArray(this.toArray(),i,h)},n.prototype._initNumber=function(t,i,h){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(r(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===h&&this._initArray(this.toArray(),i,h)},n.prototype._initArray=function(t,i,h){if(r("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var e,o,s=0;if("be"===h)for(n=t.length-1,e=0;n>=0;n-=3)o=t[n]|t[n-1]<<8|t[n-2]<<16,this.words[e]|=o<<s&67108863,this.words[e+1]=o>>>26-s&67108863,s+=24,s>=26&&(s-=26,e++);else if("le"===h)for(n=0,e=0;n<t.length;n+=3)o=t[n]|t[n+1]<<8|t[n+2]<<16,this.words[e]|=o<<s&67108863,this.words[e+1]=o>>>26-s&67108863,s+=24,s>=26&&(s-=26,e++);return this.strip()},n.prototype._parseHex=function(t,i){this.length=Math.ceil((t.length-i)/6),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var h,n,o=0;for(r=t.length-6,h=0;r>=i;r-=6)n=e(t,r,r+6),this.words[h]|=n<<o&67108863,this.words[h+1]|=n>>>26-o&4194303,o+=24,o>=26&&(o-=26,h++);r+6!==i&&(n=e(t,i,r+6),this.words[h]|=n<<o&67108863,this.words[h+1]|=n>>>26-o&4194303),this.strip()},n.prototype._parseBase=function(t,i,r){this.words=[0],this.length=1;for(var h=0,n=1;n<=67108863;n*=i)h++;h--,n=n/i|0;for(var e=t.length-r,s=e%h,u=Math.min(e,e-s)+r,a=0,l=r;l<u;l+=h)a=o(t,l,l+h,i),this.imuln(n),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a);if(0!==s){var m=1;for(a=o(t,l,t.length,i),l=0;l<s;l++)m*=i;this.imuln(m),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a)}},n.prototype.copy=function(t){t.words=new Array(this.length);for(var i=0;i<this.length;i++)t.words[i]=this.words[i];t.length=this.length,t.negative=this.negative,t.red=this.red},n.prototype.clone=function(){var t=new n(null);return this.copy(t),t},n.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var y=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],b=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],_=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(t,i){t=t||10,i=0|i||1;var h;if(16===t||"hex"===t){h="";for(var n=0,e=0,o=0;o<this.length;o++){var s=this.words[o],u=(16777215&(s<<n|e)).toString(16);e=s>>>24-n&16777215,h=0!==e||o!==this.length-1?y[6-u.length]+u+h:u+h,n+=2,n>=26&&(n-=26,o--)}for(0!==e&&(h=e.toString(16)+h);h.length%i!==0;)h="0"+h;return 0!==this.negative&&(h="-"+h),h}if(t===(0|t)&&t>=2&&t<=36){var a=b[t],l=_[t];h="";var m=this.clone();for(m.negative=0;!m.isZero();){var f=m.modn(l).toString(t);m=m.idivn(l),h=m.isZero()?f+h:y[a-f.length]+f+h}for(this.isZero()&&(h="0"+h);h.length%i!==0;)h="0"+h;return 0!==this.negative&&(h="-"+h),h}r(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(t,i){return r("undefined"!=typeof w),this.toArrayLike(w,t,i)},n.prototype.toArray=function(t,i){return this.toArrayLike(Array,t,i)},n.prototype.toArrayLike=function(t,i,h){var n=this.byteLength(),e=h||Math.max(1,n);r(n<=e,"byte array longer than desired length"),r(e>0,"Requested array length <= 0"),this.strip();var o,s,u="le"===i,a=new t(e),l=this.clone();if(u){for(s=0;!l.isZero();s++)o=l.andln(255),l.iushrn(8),a[s]=o;for(;s<e;s++)a[s]=0}else{for(s=0;s<e-n;s++)a[s]=0;for(s=0;!l.isZero();s++)o=l.andln(255),l.iushrn(8),a[e-s-1]=o}return a},Math.clz32?n.prototype._countBits=function(t){return 32-Math.clz32(t)}:n.prototype._countBits=function(t){var i=t,r=0;return i>=4096&&(r+=13,i>>>=13),i>=64&&(r+=7,i>>>=7),i>=8&&(r+=4,i>>>=4),i>=2&&(r+=2,i>>>=2),r+i},n.prototype._zeroBits=function(t){if(0===t)return 26;var i=t,r=0;return 0===(8191&i)&&(r+=13,i>>>=13),0===(127&i)&&(r+=7,i>>>=7),0===(15&i)&&(r+=4,i>>>=4),0===(3&i)&&(r+=2,i>>>=2),0===(1&i)&&r++,r},n.prototype.bitLength=function(){var t=this.words[this.length-1],i=this._countBits(t);return 26*(this.length-1)+i},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,i=0;i<this.length;i++){var r=this._zeroBits(this.words[i]);if(t+=r,26!==r)break}return t},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},n.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]|t.words[i];return this.strip()},n.prototype.ior=function(t){return r(0===(this.negative|t.negative)),this.iuor(t)},n.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},n.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},n.prototype.iuand=function(t){var i;i=this.length>t.length?t:this;for(var r=0;r<i.length;r++)this.words[r]=this.words[r]&t.words[r];return this.length=i.length,this.strip()},n.prototype.iand=function(t){return r(0===(this.negative|t.negative)),this.iuand(t)},n.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},n.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},n.prototype.iuxor=function(t){var i,r;this.length>t.length?(i=this,r=t):(i=t,r=this);for(var h=0;h<r.length;h++)this.words[h]=i.words[h]^r.words[h];if(this!==i)for(;h<i.length;h++)this.words[h]=i.words[h];return this.length=i.length,this.strip()},n.prototype.ixor=function(t){return r(0===(this.negative|t.negative)),this.iuxor(t)},n.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},n.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},n.prototype.inotn=function(t){r("number"==typeof t&&t>=0);var i=0|Math.ceil(t/26),h=t%26;this._expand(i),h>0&&i--;for(var n=0;n<i;n++)this.words[n]=67108863&~this.words[n];return h>0&&(this.words[n]=~this.words[n]&67108863>>26-h),this.strip()},n.prototype.notn=function(t){return this.clone().inotn(t)},n.prototype.setn=function(t,i){r("number"==typeof t&&t>=0);var h=t/26|0,n=t%26;return this._expand(h+1),i?this.words[h]=this.words[h]|1<<n:this.words[h]=this.words[h]&~(1<<n),this.strip()},n.prototype.iadd=function(t){var i;if(0!==this.negative&&0===t.negative)return this.negative=0,i=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,i=this.isub(t),t.negative=1,i._normSign();var r,h;this.length>t.length?(r=this,h=t):(r=t,h=this);for(var n=0,e=0;e<h.length;e++)i=(0|r.words[e])+(0|h.words[e])+n,this.words[e]=67108863&i,n=i>>>26;for(;0!==n&&e<r.length;e++)i=(0|r.words[e])+n,this.words[e]=67108863&i,n=i>>>26;if(this.length=r.length,0!==n)this.words[this.length]=n,this.length++;else if(r!==this)for(;e<r.length;e++)this.words[e]=r.words[e];return this},n.prototype.add=function(t){var i;return 0!==t.negative&&0===this.negative?(t.negative=0,i=this.sub(t),t.negative^=1,i):0===t.negative&&0!==this.negative?(this.negative=0,i=t.sub(this),this.negative=1,i):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},n.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var i=this.iadd(t);return t.negative=1,i._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var r=this.cmp(t);if(0===r)return this.negative=0,this.length=1,this.words[0]=0,this;var h,n;r>0?(h=this,n=t):(h=t,n=this);for(var e=0,o=0;o<n.length;o++)i=(0|h.words[o])-(0|n.words[o])+e,e=i>>26,this.words[o]=67108863&i;for(;0!==e&&o<h.length;o++)i=(0|h.words[o])+e,e=i>>26,this.words[o]=67108863&i;if(0===e&&o<h.length&&h!==this)for(;o<h.length;o++)this.words[o]=h.words[o];return this.length=Math.max(this.length,o),h!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(t){return this.clone().isub(t)};var k=function(t,i,r){var h,n,e,o=t.words,s=i.words,u=r.words,a=0,l=0|o[0],m=8191&l,f=l>>>13,d=0|o[1],p=8191&d,M=d>>>13,v=0|o[2],g=8191&v,c=v>>>13,w=0|o[3],y=8191&w,b=w>>>13,_=0|o[4],k=8191&_,A=_>>>13,x=0|o[5],S=8191&x,Z=x>>>13,q=0|o[6],R=8191&q,B=q>>>13,N=0|o[7],L=8191&N,I=N>>>13,z=0|o[8],T=8191&z,E=z>>>13,O=0|o[9],j=8191&O,K=O>>>13,P=0|s[0],F=8191&P,C=P>>>13,D=0|s[1],H=8191&D,J=D>>>13,U=0|s[2],G=8191&U,Q=U>>>13,V=0|s[3],W=8191&V,X=V>>>13,Y=0|s[4],$=8191&Y,tt=Y>>>13,it=0|s[5],rt=8191&it,ht=it>>>13,nt=0|s[6],et=8191&nt,ot=nt>>>13,st=0|s[7],ut=8191&st,at=st>>>13,lt=0|s[8],mt=8191&lt,ft=lt>>>13,dt=0|s[9],pt=8191&dt,Mt=dt>>>13;r.negative=t.negative^i.negative,r.length=19,h=Math.imul(m,F),n=Math.imul(m,C),n=n+Math.imul(f,F)|0,e=Math.imul(f,C);var vt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(vt>>>26)|0,vt&=67108863,h=Math.imul(p,F),n=Math.imul(p,C),n=n+Math.imul(M,F)|0,e=Math.imul(M,C),h=h+Math.imul(m,H)|0,n=n+Math.imul(m,J)|0,n=n+Math.imul(f,H)|0,e=e+Math.imul(f,J)|0;var gt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(gt>>>26)|0,gt&=67108863,h=Math.imul(g,F),n=Math.imul(g,C),n=n+Math.imul(c,F)|0,e=Math.imul(c,C),h=h+Math.imul(p,H)|0,n=n+Math.imul(p,J)|0,n=n+Math.imul(M,H)|0,e=e+Math.imul(M,J)|0,h=h+Math.imul(m,G)|0,n=n+Math.imul(m,Q)|0,n=n+Math.imul(f,G)|0,e=e+Math.imul(f,Q)|0;var ct=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(ct>>>26)|0,ct&=67108863,h=Math.imul(y,F),n=Math.imul(y,C),n=n+Math.imul(b,F)|0,e=Math.imul(b,C),h=h+Math.imul(g,H)|0,n=n+Math.imul(g,J)|0,n=n+Math.imul(c,H)|0,e=e+Math.imul(c,J)|0,h=h+Math.imul(p,G)|0,n=n+Math.imul(p,Q)|0,n=n+Math.imul(M,G)|0,e=e+Math.imul(M,Q)|0,h=h+Math.imul(m,W)|0,n=n+Math.imul(m,X)|0,n=n+Math.imul(f,W)|0,e=e+Math.imul(f,X)|0;var wt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(wt>>>26)|0,wt&=67108863,h=Math.imul(k,F),n=Math.imul(k,C),n=n+Math.imul(A,F)|0,e=Math.imul(A,C),h=h+Math.imul(y,H)|0,n=n+Math.imul(y,J)|0,n=n+Math.imul(b,H)|0,e=e+Math.imul(b,J)|0,h=h+Math.imul(g,G)|0,n=n+Math.imul(g,Q)|0,n=n+Math.imul(c,G)|0,e=e+Math.imul(c,Q)|0,h=h+Math.imul(p,W)|0,n=n+Math.imul(p,X)|0,n=n+Math.imul(M,W)|0,e=e+Math.imul(M,X)|0,h=h+Math.imul(m,$)|0,n=n+Math.imul(m,tt)|0,n=n+Math.imul(f,$)|0,e=e+Math.imul(f,tt)|0;var yt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(yt>>>26)|0,yt&=67108863,h=Math.imul(S,F),n=Math.imul(S,C),n=n+Math.imul(Z,F)|0,e=Math.imul(Z,C),h=h+Math.imul(k,H)|0,n=n+Math.imul(k,J)|0,n=n+Math.imul(A,H)|0,e=e+Math.imul(A,J)|0,h=h+Math.imul(y,G)|0,n=n+Math.imul(y,Q)|0,n=n+Math.imul(b,G)|0,e=e+Math.imul(b,Q)|0,h=h+Math.imul(g,W)|0,n=n+Math.imul(g,X)|0,n=n+Math.imul(c,W)|0,e=e+Math.imul(c,X)|0,h=h+Math.imul(p,$)|0,n=n+Math.imul(p,tt)|0,n=n+Math.imul(M,$)|0,e=e+Math.imul(M,tt)|0,h=h+Math.imul(m,rt)|0,n=n+Math.imul(m,ht)|0,n=n+Math.imul(f,rt)|0,e=e+Math.imul(f,ht)|0;var bt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(bt>>>26)|0,bt&=67108863,h=Math.imul(R,F),n=Math.imul(R,C),n=n+Math.imul(B,F)|0,e=Math.imul(B,C),h=h+Math.imul(S,H)|0,n=n+Math.imul(S,J)|0,n=n+Math.imul(Z,H)|0,e=e+Math.imul(Z,J)|0,h=h+Math.imul(k,G)|0,n=n+Math.imul(k,Q)|0,n=n+Math.imul(A,G)|0,e=e+Math.imul(A,Q)|0,h=h+Math.imul(y,W)|0,n=n+Math.imul(y,X)|0,n=n+Math.imul(b,W)|0,e=e+Math.imul(b,X)|0,h=h+Math.imul(g,$)|0,n=n+Math.imul(g,tt)|0,n=n+Math.imul(c,$)|0,e=e+Math.imul(c,tt)|0,h=h+Math.imul(p,rt)|0,n=n+Math.imul(p,ht)|0,n=n+Math.imul(M,rt)|0,e=e+Math.imul(M,ht)|0,h=h+Math.imul(m,et)|0,n=n+Math.imul(m,ot)|0,n=n+Math.imul(f,et)|0,e=e+Math.imul(f,ot)|0;var _t=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(_t>>>26)|0,_t&=67108863,h=Math.imul(L,F),n=Math.imul(L,C),n=n+Math.imul(I,F)|0,e=Math.imul(I,C),h=h+Math.imul(R,H)|0,n=n+Math.imul(R,J)|0,n=n+Math.imul(B,H)|0,e=e+Math.imul(B,J)|0,h=h+Math.imul(S,G)|0,n=n+Math.imul(S,Q)|0,n=n+Math.imul(Z,G)|0,e=e+Math.imul(Z,Q)|0,h=h+Math.imul(k,W)|0,n=n+Math.imul(k,X)|0,n=n+Math.imul(A,W)|0,e=e+Math.imul(A,X)|0,h=h+Math.imul(y,$)|0,n=n+Math.imul(y,tt)|0,n=n+Math.imul(b,$)|0,e=e+Math.imul(b,tt)|0,h=h+Math.imul(g,rt)|0,n=n+Math.imul(g,ht)|0,n=n+Math.imul(c,rt)|0,e=e+Math.imul(c,ht)|0,h=h+Math.imul(p,et)|0,n=n+Math.imul(p,ot)|0,n=n+Math.imul(M,et)|0,e=e+Math.imul(M,ot)|0,h=h+Math.imul(m,ut)|0,n=n+Math.imul(m,at)|0,n=n+Math.imul(f,ut)|0,e=e+Math.imul(f,at)|0;var kt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(kt>>>26)|0,kt&=67108863,h=Math.imul(T,F),n=Math.imul(T,C),n=n+Math.imul(E,F)|0,e=Math.imul(E,C),h=h+Math.imul(L,H)|0,n=n+Math.imul(L,J)|0,n=n+Math.imul(I,H)|0,e=e+Math.imul(I,J)|0,h=h+Math.imul(R,G)|0,n=n+Math.imul(R,Q)|0,n=n+Math.imul(B,G)|0,e=e+Math.imul(B,Q)|0,h=h+Math.imul(S,W)|0,n=n+Math.imul(S,X)|0,n=n+Math.imul(Z,W)|0,e=e+Math.imul(Z,X)|0,h=h+Math.imul(k,$)|0,n=n+Math.imul(k,tt)|0,n=n+Math.imul(A,$)|0,e=e+Math.imul(A,tt)|0,h=h+Math.imul(y,rt)|0,n=n+Math.imul(y,ht)|0,n=n+Math.imul(b,rt)|0,e=e+Math.imul(b,ht)|0,h=h+Math.imul(g,et)|0,n=n+Math.imul(g,ot)|0,n=n+Math.imul(c,et)|0,e=e+Math.imul(c,ot)|0,h=h+Math.imul(p,ut)|0,n=n+Math.imul(p,at)|0,n=n+Math.imul(M,ut)|0,e=e+Math.imul(M,at)|0,h=h+Math.imul(m,mt)|0,n=n+Math.imul(m,ft)|0,n=n+Math.imul(f,mt)|0,e=e+Math.imul(f,ft)|0;var At=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(At>>>26)|0,At&=67108863,h=Math.imul(j,F),n=Math.imul(j,C),n=n+Math.imul(K,F)|0,e=Math.imul(K,C),h=h+Math.imul(T,H)|0,n=n+Math.imul(T,J)|0,n=n+Math.imul(E,H)|0,e=e+Math.imul(E,J)|0,h=h+Math.imul(L,G)|0,n=n+Math.imul(L,Q)|0,n=n+Math.imul(I,G)|0,e=e+Math.imul(I,Q)|0,h=h+Math.imul(R,W)|0,n=n+Math.imul(R,X)|0,n=n+Math.imul(B,W)|0,e=e+Math.imul(B,X)|0,h=h+Math.imul(S,$)|0,n=n+Math.imul(S,tt)|0,n=n+Math.imul(Z,$)|0,e=e+Math.imul(Z,tt)|0,h=h+Math.imul(k,rt)|0,n=n+Math.imul(k,ht)|0,n=n+Math.imul(A,rt)|0,e=e+Math.imul(A,ht)|0,h=h+Math.imul(y,et)|0,n=n+Math.imul(y,ot)|0,n=n+Math.imul(b,et)|0,e=e+Math.imul(b,ot)|0,h=h+Math.imul(g,ut)|0,n=n+Math.imul(g,at)|0,n=n+Math.imul(c,ut)|0,e=e+Math.imul(c,at)|0,h=h+Math.imul(p,mt)|0,n=n+Math.imul(p,ft)|0,n=n+Math.imul(M,mt)|0,e=e+Math.imul(M,ft)|0,h=h+Math.imul(m,pt)|0,n=n+Math.imul(m,Mt)|0,n=n+Math.imul(f,pt)|0,e=e+Math.imul(f,Mt)|0;var xt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(xt>>>26)|0,xt&=67108863,h=Math.imul(j,H),n=Math.imul(j,J),n=n+Math.imul(K,H)|0,e=Math.imul(K,J),h=h+Math.imul(T,G)|0,n=n+Math.imul(T,Q)|0,n=n+Math.imul(E,G)|0,e=e+Math.imul(E,Q)|0,h=h+Math.imul(L,W)|0,n=n+Math.imul(L,X)|0,n=n+Math.imul(I,W)|0,e=e+Math.imul(I,X)|0,h=h+Math.imul(R,$)|0,n=n+Math.imul(R,tt)|0,n=n+Math.imul(B,$)|0,e=e+Math.imul(B,tt)|0,h=h+Math.imul(S,rt)|0,n=n+Math.imul(S,ht)|0,n=n+Math.imul(Z,rt)|0,e=e+Math.imul(Z,ht)|0,h=h+Math.imul(k,et)|0,n=n+Math.imul(k,ot)|0,n=n+Math.imul(A,et)|0,e=e+Math.imul(A,ot)|0,h=h+Math.imul(y,ut)|0,n=n+Math.imul(y,at)|0,n=n+Math.imul(b,ut)|0,e=e+Math.imul(b,at)|0,h=h+Math.imul(g,mt)|0,n=n+Math.imul(g,ft)|0,n=n+Math.imul(c,mt)|0,e=e+Math.imul(c,ft)|0,h=h+Math.imul(p,pt)|0,n=n+Math.imul(p,Mt)|0,n=n+Math.imul(M,pt)|0,e=e+Math.imul(M,Mt)|0;var St=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(St>>>26)|0,St&=67108863,h=Math.imul(j,G),n=Math.imul(j,Q),n=n+Math.imul(K,G)|0,e=Math.imul(K,Q),h=h+Math.imul(T,W)|0,n=n+Math.imul(T,X)|0,n=n+Math.imul(E,W)|0,e=e+Math.imul(E,X)|0,h=h+Math.imul(L,$)|0,n=n+Math.imul(L,tt)|0,n=n+Math.imul(I,$)|0,e=e+Math.imul(I,tt)|0,h=h+Math.imul(R,rt)|0,n=n+Math.imul(R,ht)|0,n=n+Math.imul(B,rt)|0,e=e+Math.imul(B,ht)|0,h=h+Math.imul(S,et)|0,n=n+Math.imul(S,ot)|0,n=n+Math.imul(Z,et)|0,e=e+Math.imul(Z,ot)|0,h=h+Math.imul(k,ut)|0,n=n+Math.imul(k,at)|0,n=n+Math.imul(A,ut)|0,e=e+Math.imul(A,at)|0,h=h+Math.imul(y,mt)|0,n=n+Math.imul(y,ft)|0,n=n+Math.imul(b,mt)|0,e=e+Math.imul(b,ft)|0,h=h+Math.imul(g,pt)|0,n=n+Math.imul(g,Mt)|0,n=n+Math.imul(c,pt)|0,e=e+Math.imul(c,Mt)|0;var Zt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,h=Math.imul(j,W),n=Math.imul(j,X),n=n+Math.imul(K,W)|0,e=Math.imul(K,X),h=h+Math.imul(T,$)|0,n=n+Math.imul(T,tt)|0,n=n+Math.imul(E,$)|0,e=e+Math.imul(E,tt)|0,h=h+Math.imul(L,rt)|0,n=n+Math.imul(L,ht)|0,n=n+Math.imul(I,rt)|0,e=e+Math.imul(I,ht)|0,h=h+Math.imul(R,et)|0,n=n+Math.imul(R,ot)|0,n=n+Math.imul(B,et)|0,e=e+Math.imul(B,ot)|0,h=h+Math.imul(S,ut)|0,n=n+Math.imul(S,at)|0,n=n+Math.imul(Z,ut)|0,e=e+Math.imul(Z,at)|0,h=h+Math.imul(k,mt)|0,n=n+Math.imul(k,ft)|0,n=n+Math.imul(A,mt)|0,e=e+Math.imul(A,ft)|0,h=h+Math.imul(y,pt)|0,n=n+Math.imul(y,Mt)|0,n=n+Math.imul(b,pt)|0,e=e+Math.imul(b,Mt)|0;var qt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(qt>>>26)|0,qt&=67108863,h=Math.imul(j,$),n=Math.imul(j,tt),n=n+Math.imul(K,$)|0,e=Math.imul(K,tt),h=h+Math.imul(T,rt)|0,n=n+Math.imul(T,ht)|0,n=n+Math.imul(E,rt)|0,e=e+Math.imul(E,ht)|0,h=h+Math.imul(L,et)|0,n=n+Math.imul(L,ot)|0,n=n+Math.imul(I,et)|0,e=e+Math.imul(I,ot)|0,h=h+Math.imul(R,ut)|0,n=n+Math.imul(R,at)|0,n=n+Math.imul(B,ut)|0,e=e+Math.imul(B,at)|0,h=h+Math.imul(S,mt)|0,n=n+Math.imul(S,ft)|0,n=n+Math.imul(Z,mt)|0,e=e+Math.imul(Z,ft)|0,h=h+Math.imul(k,pt)|0,n=n+Math.imul(k,Mt)|0,n=n+Math.imul(A,pt)|0,e=e+Math.imul(A,Mt)|0;var Rt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,h=Math.imul(j,rt),n=Math.imul(j,ht),n=n+Math.imul(K,rt)|0,e=Math.imul(K,ht),h=h+Math.imul(T,et)|0,n=n+Math.imul(T,ot)|0,n=n+Math.imul(E,et)|0,e=e+Math.imul(E,ot)|0,h=h+Math.imul(L,ut)|0,n=n+Math.imul(L,at)|0,n=n+Math.imul(I,ut)|0,e=e+Math.imul(I,at)|0,h=h+Math.imul(R,mt)|0,n=n+Math.imul(R,ft)|0,n=n+Math.imul(B,mt)|0,e=e+Math.imul(B,ft)|0,h=h+Math.imul(S,pt)|0,n=n+Math.imul(S,Mt)|0,n=n+Math.imul(Z,pt)|0,e=e+Math.imul(Z,Mt)|0;var Bt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,h=Math.imul(j,et),n=Math.imul(j,ot),n=n+Math.imul(K,et)|0,e=Math.imul(K,ot),h=h+Math.imul(T,ut)|0,n=n+Math.imul(T,at)|0,n=n+Math.imul(E,ut)|0,e=e+Math.imul(E,at)|0,h=h+Math.imul(L,mt)|0,n=n+Math.imul(L,ft)|0,n=n+Math.imul(I,mt)|0,e=e+Math.imul(I,ft)|0,h=h+Math.imul(R,pt)|0,n=n+Math.imul(R,Mt)|0,n=n+Math.imul(B,pt)|0,e=e+Math.imul(B,Mt)|0;var Nt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,h=Math.imul(j,ut),n=Math.imul(j,at),n=n+Math.imul(K,ut)|0,e=Math.imul(K,at),h=h+Math.imul(T,mt)|0,n=n+Math.imul(T,ft)|0,n=n+Math.imul(E,mt)|0,e=e+Math.imul(E,ft)|0,h=h+Math.imul(L,pt)|0,n=n+Math.imul(L,Mt)|0,n=n+Math.imul(I,pt)|0,e=e+Math.imul(I,Mt)|0;var Lt=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,h=Math.imul(j,mt),n=Math.imul(j,ft),n=n+Math.imul(K,mt)|0,e=Math.imul(K,ft),h=h+Math.imul(T,pt)|0,n=n+Math.imul(T,Mt)|0,n=n+Math.imul(E,pt)|0,e=e+Math.imul(E,Mt)|0;var It=(a+h|0)+((8191&n)<<13)|0;a=(e+(n>>>13)|0)+(It>>>26)|0,It&=67108863,h=Math.imul(j,pt),n=Math.imul(j,Mt),n=n+Math.imul(K,pt)|0,e=Math.imul(K,Mt);var zt=(a+h|0)+((8191&n)<<13)|0;return a=(e+(n>>>13)|0)+(zt>>>26)|0,zt&=67108863,u[0]=vt,u[1]=gt,u[2]=ct,u[3]=wt,u[4]=yt,u[5]=bt,u[6]=_t,u[7]=kt,u[8]=At,u[9]=xt,u[10]=St,u[11]=Zt,u[12]=qt,u[13]=Rt,u[14]=Bt,u[15]=Nt,u[16]=Lt,u[17]=It,u[18]=zt,0!==a&&(u[19]=a,r.length++),r};Math.imul||(k=u),n.prototype.mulTo=function(t,i){var r,h=this.length+t.length;return r=10===this.length&&10===t.length?k(this,t,i):h<63?u(this,t,i):h<1024?a(this,t,i):l(this,t,i)},m.prototype.makeRBT=function(t){for(var i=new Array(t),r=n.prototype._countBits(t)-1,h=0;h<t;h++)i[h]=this.revBin(h,r,t);return i},m.prototype.revBin=function(t,i,r){if(0===t||t===r-1)return t;for(var h=0,n=0;n<i;n++)h|=(1&t)<<i-n-1,t>>=1;return h},m.prototype.permute=function(t,i,r,h,n,e){for(var o=0;o<e;o++)h[o]=i[t[o]],n[o]=r[t[o]]},m.prototype.transform=function(t,i,r,h,n,e){this.permute(e,t,i,r,h,n);for(var o=1;o<n;o<<=1)for(var s=o<<1,u=Math.cos(2*Math.PI/s),a=Math.sin(2*Math.PI/s),l=0;l<n;l+=s)for(var m=u,f=a,d=0;d<o;d++){var p=r[l+d],M=h[l+d],v=r[l+d+o],g=h[l+d+o],c=m*v-f*g;g=m*g+f*v,v=c,r[l+d]=p+v,h[l+d]=M+g,r[l+d+o]=p-v,h[l+d+o]=M-g,d!==s&&(c=u*m-a*f,f=u*f+a*m,m=c)}},m.prototype.guessLen13b=function(t,i){var r=1|Math.max(i,t),h=1&r,n=0;for(r=r/2|0;r;r>>>=1)n++;return 1<<n+1+h},m.prototype.conjugate=function(t,i,r){if(!(r<=1))for(var h=0;h<r/2;h++){var n=t[h];t[h]=t[r-h-1],t[r-h-1]=n,n=i[h],i[h]=-i[r-h-1],i[r-h-1]=-n}},m.prototype.normalize13b=function(t,i){for(var r=0,h=0;h<i/2;h++){var n=8192*Math.round(t[2*h+1]/i)+Math.round(t[2*h]/i)+r;t[h]=67108863&n,r=n<67108864?0:n/67108864|0}return t},m.prototype.convert13b=function(t,i,h,n){for(var e=0,o=0;o<i;o++)e+=0|t[o],h[2*o]=8191&e,e>>>=13,h[2*o+1]=8191&e,e>>>=13;for(o=2*i;o<n;++o)h[o]=0;r(0===e),r(0===(e&-8192))},m.prototype.stub=function(t){for(var i=new Array(t),r=0;r<t;r++)i[r]=0;return i},m.prototype.mulp=function(t,i,r){var h=2*this.guessLen13b(t.length,i.length),n=this.makeRBT(h),e=this.stub(h),o=new Array(h),s=new Array(h),u=new Array(h),a=new Array(h),l=new Array(h),m=new Array(h),f=r.words;f.length=h,this.convert13b(t.words,t.length,o,h),this.convert13b(i.words,i.length,a,h),this.transform(o,e,s,u,h,n),this.transform(a,e,l,m,h,n);for(var d=0;d<h;d++){var p=s[d]*l[d]-u[d]*m[d];u[d]=s[d]*m[d]+u[d]*l[d],s[d]=p}return this.conjugate(s,u,h),this.transform(s,u,f,e,h,n),this.conjugate(f,e,h),this.normalize13b(f,h),r.negative=t.negative^i.negative,r.length=t.length+i.length,r.strip()},n.prototype.mul=function(t){var i=new n(null);return i.words=new Array(this.length+t.length),this.mulTo(t,i)},n.prototype.mulf=function(t){var i=new n(null);return i.words=new Array(this.length+t.length),l(this,t,i)},n.prototype.imul=function(t){return this.clone().mulTo(t,this)},n.prototype.imuln=function(t){r("number"==typeof t),r(t<67108864);for(var i=0,h=0;h<this.length;h++){var n=(0|this.words[h])*t,e=(67108863&n)+(67108863&i);i>>=26,i+=n/67108864|0,i+=e>>>26,this.words[h]=67108863&e}return 0!==i&&(this.words[h]=i,this.length++),this},n.prototype.muln=function(t){return this.clone().imuln(t)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(t){var i=s(t);if(0===i.length)return new n(1);for(var r=this,h=0;h<i.length&&0===i[h];h++,r=r.sqr());if(++h<i.length)for(var e=r.sqr();h<i.length;h++,e=e.sqr())0!==i[h]&&(r=r.mul(e));return r},n.prototype.iushln=function(t){r("number"==typeof t&&t>=0);var i,h=t%26,n=(t-h)/26,e=67108863>>>26-h<<26-h;if(0!==h){var o=0;for(i=0;i<this.length;i++){var s=this.words[i]&e,u=(0|this.words[i])-s<<h;this.words[i]=u|o,o=s>>>26-h}o&&(this.words[i]=o,this.length++)}if(0!==n){for(i=this.length-1;i>=0;i--)this.words[i+n]=this.words[i];for(i=0;i<n;i++)this.words[i]=0;this.length+=n}return this.strip()},n.prototype.ishln=function(t){return r(0===this.negative),this.iushln(t)},n.prototype.iushrn=function(t,i,h){r("number"==typeof t&&t>=0);var n;n=i?(i-i%26)/26:0;var e=t%26,o=Math.min((t-e)/26,this.length),s=67108863^67108863>>>e<<e,u=h;if(n-=o,n=Math.max(0,n),u){for(var a=0;a<o;a++)u.words[a]=this.words[a];u.length=o}if(0===o);else if(this.length>o)for(this.length-=o,a=0;a<this.length;a++)this.words[a]=this.words[a+o];else this.words[0]=0,this.length=1;var l=0;for(a=this.length-1;a>=0&&(0!==l||a>=n);a--){var m=0|this.words[a];this.words[a]=l<<26-e|m>>>e,l=m&s}return u&&0!==l&&(u.words[u.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(t,i,h){return r(0===this.negative),this.iushrn(t,i,h)},n.prototype.shln=function(t){return this.clone().ishln(t)},n.prototype.ushln=function(t){return this.clone().iushln(t)},n.prototype.shrn=function(t){return this.clone().ishrn(t)},n.prototype.ushrn=function(t){return this.clone().iushrn(t)},n.prototype.testn=function(t){r("number"==typeof t&&t>=0);var i=t%26,h=(t-i)/26,n=1<<i;if(this.length<=h)return!1;var e=this.words[h];return!!(e&n)},n.prototype.imaskn=function(t){r("number"==typeof t&&t>=0);var i=t%26,h=(t-i)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=h)return this;if(0!==i&&h++,this.length=Math.min(h,this.length),0!==i){var n=67108863^67108863>>>i<<i;this.words[this.length-1]&=n}return this.strip()},n.prototype.maskn=function(t){return this.clone().imaskn(t)},n.prototype.iaddn=function(t){return r("number"==typeof t),r(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},n.prototype._iaddn=function(t){this.words[0]+=t;for(var i=0;i<this.length&&this.words[i]>=67108864;i++)this.words[i]-=67108864,i===this.length-1?this.words[i+1]=1:this.words[i+1]++;return this.length=Math.max(this.length,i+1),this},n.prototype.isubn=function(t){if(r("number"==typeof t),r(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var i=0;i<this.length&&this.words[i]<0;i++)this.words[i]+=67108864,this.words[i+1]-=1;return this.strip()},n.prototype.addn=function(t){return this.clone().iaddn(t)},n.prototype.subn=function(t){return this.clone().isubn(t)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(t,i,h){var n,e=t.length+h;this._expand(e);var o,s=0;for(n=0;n<t.length;n++){o=(0|this.words[n+h])+s;var u=(0|t.words[n])*i;o-=67108863&u,s=(o>>26)-(u/67108864|0),this.words[n+h]=67108863&o}for(;n<this.length-h;n++)o=(0|this.words[n+h])+s,s=o>>26,this.words[n+h]=67108863&o;if(0===s)return this.strip();for(r(s===-1),s=0,n=0;n<this.length;n++)o=-(0|this.words[n])+s,s=o>>26,this.words[n]=67108863&o;return this.negative=1,this.strip()},n.prototype._wordDiv=function(t,i){var r=this.length-t.length,h=this.clone(),e=t,o=0|e.words[e.length-1],s=this._countBits(o);r=26-s,0!==r&&(e=e.ushln(r),h.iushln(r),o=0|e.words[e.length-1]);var u,a=h.length-e.length;if("mod"!==i){u=new n(null),u.length=a+1,u.words=new Array(u.length);for(var l=0;l<u.length;l++)u.words[l]=0}var m=h.clone()._ishlnsubmul(e,1,a);0===m.negative&&(h=m,u&&(u.words[a]=1));for(var f=a-1;f>=0;f--){var d=67108864*(0|h.words[e.length+f])+(0|h.words[e.length+f-1]);for(d=Math.min(d/o|0,67108863),h._ishlnsubmul(e,d,f);0!==h.negative;)d--,h.negative=0,h._ishlnsubmul(e,1,f),h.isZero()||(h.negative^=1);u&&(u.words[f]=d)}return u&&u.strip(),h.strip(),"div"!==i&&0!==r&&h.iushrn(r),{div:u||null,mod:h}},n.prototype.divmod=function(t,i,h){if(r(!t.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var e,o,s;return 0!==this.negative&&0===t.negative?(s=this.neg().divmod(t,i),"mod"!==i&&(e=s.div.neg()),"div"!==i&&(o=s.mod.neg(),h&&0!==o.negative&&o.iadd(t)),{div:e,mod:o}):0===this.negative&&0!==t.negative?(s=this.divmod(t.neg(),i),"mod"!==i&&(e=s.div.neg()),{div:e,mod:s.mod}):0!==(this.negative&t.negative)?(s=this.neg().divmod(t.neg(),i),"div"!==i&&(o=s.mod.neg(),h&&0!==o.negative&&o.isub(t)),{div:s.div,mod:o}):t.length>this.length||this.cmp(t)<0?{div:new n(0),mod:this}:1===t.length?"div"===i?{div:this.divn(t.words[0]),mod:null}:"mod"===i?{div:null,mod:new n(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new n(this.modn(t.words[0]))}:this._wordDiv(t,i)},n.prototype.div=function(t){return this.divmod(t,"div",!1).div},n.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},n.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},n.prototype.divRound=function(t){var i=this.divmod(t);if(i.mod.isZero())return i.div;var r=0!==i.div.negative?i.mod.isub(t):i.mod,h=t.ushrn(1),n=t.andln(1),e=r.cmp(h);
return e<0||1===n&&0===e?i.div:0!==i.div.negative?i.div.isubn(1):i.div.iaddn(1)},n.prototype.modn=function(t){r(t<=67108863);for(var i=(1<<26)%t,h=0,n=this.length-1;n>=0;n--)h=(i*h+(0|this.words[n]))%t;return h},n.prototype.idivn=function(t){r(t<=67108863);for(var i=0,h=this.length-1;h>=0;h--){var n=(0|this.words[h])+67108864*i;this.words[h]=n/t|0,i=n%t}return this.strip()},n.prototype.divn=function(t){return this.clone().idivn(t)},n.prototype.egcd=function(t){r(0===t.negative),r(!t.isZero());var i=this,h=t.clone();i=0!==i.negative?i.umod(t):i.clone();for(var e=new n(1),o=new n(0),s=new n(0),u=new n(1),a=0;i.isEven()&&h.isEven();)i.iushrn(1),h.iushrn(1),++a;for(var l=h.clone(),m=i.clone();!i.isZero();){for(var f=0,d=1;0===(i.words[0]&d)&&f<26;++f,d<<=1);if(f>0)for(i.iushrn(f);f-- >0;)(e.isOdd()||o.isOdd())&&(e.iadd(l),o.isub(m)),e.iushrn(1),o.iushrn(1);for(var p=0,M=1;0===(h.words[0]&M)&&p<26;++p,M<<=1);if(p>0)for(h.iushrn(p);p-- >0;)(s.isOdd()||u.isOdd())&&(s.iadd(l),u.isub(m)),s.iushrn(1),u.iushrn(1);i.cmp(h)>=0?(i.isub(h),e.isub(s),o.isub(u)):(h.isub(i),s.isub(e),u.isub(o))}return{a:s,b:u,gcd:h.iushln(a)}},n.prototype._invmp=function(t){r(0===t.negative),r(!t.isZero());var i=this,h=t.clone();i=0!==i.negative?i.umod(t):i.clone();for(var e=new n(1),o=new n(0),s=h.clone();i.cmpn(1)>0&&h.cmpn(1)>0;){for(var u=0,a=1;0===(i.words[0]&a)&&u<26;++u,a<<=1);if(u>0)for(i.iushrn(u);u-- >0;)e.isOdd()&&e.iadd(s),e.iushrn(1);for(var l=0,m=1;0===(h.words[0]&m)&&l<26;++l,m<<=1);if(l>0)for(h.iushrn(l);l-- >0;)o.isOdd()&&o.iadd(s),o.iushrn(1);i.cmp(h)>=0?(i.isub(h),e.isub(o)):(h.isub(i),o.isub(e))}var f;return f=0===i.cmpn(1)?e:o,f.cmpn(0)<0&&f.iadd(t),f},n.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var i=this.clone(),r=t.clone();i.negative=0,r.negative=0;for(var h=0;i.isEven()&&r.isEven();h++)i.iushrn(1),r.iushrn(1);for(;;){for(;i.isEven();)i.iushrn(1);for(;r.isEven();)r.iushrn(1);var n=i.cmp(r);if(n<0){var e=i;i=r,r=e}else if(0===n||0===r.cmpn(1))break;i.isub(r)}return r.iushln(h)},n.prototype.invm=function(t){return this.egcd(t).a.umod(t)},n.prototype.isEven=function(){return 0===(1&this.words[0])},n.prototype.isOdd=function(){return 1===(1&this.words[0])},n.prototype.andln=function(t){return this.words[0]&t},n.prototype.bincn=function(t){r("number"==typeof t);var i=t%26,h=(t-i)/26,n=1<<i;if(this.length<=h)return this._expand(h+1),this.words[h]|=n,this;for(var e=n,o=h;0!==e&&o<this.length;o++){var s=0|this.words[o];s+=e,e=s>>>26,s&=67108863,this.words[o]=s}return 0!==e&&(this.words[o]=e,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(t){var i=t<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;this.strip();var h;if(this.length>1)h=1;else{i&&(t=-t),r(t<=67108863,"Number is too big");var n=0|this.words[0];h=n===t?0:n<t?-1:1}return 0!==this.negative?0|-h:h},n.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var i=this.ucmp(t);return 0!==this.negative?0|-i:i},n.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var i=0,r=this.length-1;r>=0;r--){var h=0|this.words[r],n=0|t.words[r];if(h!==n){h<n?i=-1:h>n&&(i=1);break}}return i},n.prototype.gtn=function(t){return 1===this.cmpn(t)},n.prototype.gt=function(t){return 1===this.cmp(t)},n.prototype.gten=function(t){return this.cmpn(t)>=0},n.prototype.gte=function(t){return this.cmp(t)>=0},n.prototype.ltn=function(t){return this.cmpn(t)===-1},n.prototype.lt=function(t){return this.cmp(t)===-1},n.prototype.lten=function(t){return this.cmpn(t)<=0},n.prototype.lte=function(t){return this.cmp(t)<=0},n.prototype.eqn=function(t){return 0===this.cmpn(t)},n.prototype.eq=function(t){return 0===this.cmp(t)},n.red=function(t){return new g(t)},n.prototype.toRed=function(t){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},n.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(t){return this.red=t,this},n.prototype.forceRed=function(t){return r(!this.red,"Already a number in reduction context"),this._forceRed(t)},n.prototype.redAdd=function(t){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},n.prototype.redIAdd=function(t){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},n.prototype.redSub=function(t){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},n.prototype.redISub=function(t){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},n.prototype.redShl=function(t){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},n.prototype.redMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},n.prototype.redIMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},n.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(t){return r(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var A={k256:null,p224:null,p192:null,p25519:null};f.prototype._tmp=function(){var t=new n(null);return t.words=new Array(Math.ceil(this.n/13)),t},f.prototype.ireduce=function(t){var i,r=t;do this.split(r,this.tmp),r=this.imulK(r),r=r.iadd(this.tmp),i=r.bitLength();while(i>this.n);var h=i<this.n?-1:r.ucmp(this.p);return 0===h?(r.words[0]=0,r.length=1):h>0?r.isub(this.p):r.strip(),r},f.prototype.split=function(t,i){t.iushrn(this.n,0,i)},f.prototype.imulK=function(t){return t.imul(this.k)},h(d,f),d.prototype.split=function(t,i){for(var r=4194303,h=Math.min(t.length,9),n=0;n<h;n++)i.words[n]=t.words[n];if(i.length=h,t.length<=9)return t.words[0]=0,void(t.length=1);var e=t.words[9];for(i.words[i.length++]=e&r,n=10;n<t.length;n++){var o=0|t.words[n];t.words[n-10]=(o&r)<<4|e>>>22,e=o}e>>>=22,t.words[n-10]=e,0===e&&t.length>10?t.length-=10:t.length-=9},d.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var i=0,r=0;r<t.length;r++){var h=0|t.words[r];i+=977*h,t.words[r]=67108863&i,i=64*h+(i/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},h(p,f),h(M,f),h(v,f),v.prototype.imulK=function(t){for(var i=0,r=0;r<t.length;r++){var h=19*(0|t.words[r])+i,n=67108863&h;h>>>=26,t.words[r]=n,i=h}return 0!==i&&(t.words[t.length++]=i),t},n._prime=function t(i){if(A[i])return A[i];var t;if("k256"===i)t=new d;else if("p224"===i)t=new p;else if("p192"===i)t=new M;else{if("p25519"!==i)throw new Error("Unknown prime "+i);t=new v}return A[i]=t,t},g.prototype._verify1=function(t){r(0===t.negative,"red works only with positives"),r(t.red,"red works only with red numbers")},g.prototype._verify2=function(t,i){r(0===(t.negative|i.negative),"red works only with positives"),r(t.red&&t.red===i.red,"red works only with red numbers")},g.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},g.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},g.prototype.add=function(t,i){this._verify2(t,i);var r=t.add(i);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},g.prototype.iadd=function(t,i){this._verify2(t,i);var r=t.iadd(i);return r.cmp(this.m)>=0&&r.isub(this.m),r},g.prototype.sub=function(t,i){this._verify2(t,i);var r=t.sub(i);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},g.prototype.isub=function(t,i){this._verify2(t,i);var r=t.isub(i);return r.cmpn(0)<0&&r.iadd(this.m),r},g.prototype.shl=function(t,i){return this._verify1(t),this.imod(t.ushln(i))},g.prototype.imul=function(t,i){return this._verify2(t,i),this.imod(t.imul(i))},g.prototype.mul=function(t,i){return this._verify2(t,i),this.imod(t.mul(i))},g.prototype.isqr=function(t){return this.imul(t,t.clone())},g.prototype.sqr=function(t){return this.mul(t,t)},g.prototype.sqrt=function(t){if(t.isZero())return t.clone();var i=this.m.andln(3);if(r(i%2===1),3===i){var h=this.m.add(new n(1)).iushrn(2);return this.pow(t,h)}for(var e=this.m.subn(1),o=0;!e.isZero()&&0===e.andln(1);)o++,e.iushrn(1);r(!e.isZero());var s=new n(1).toRed(this),u=s.redNeg(),a=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new n(2*l*l).toRed(this);0!==this.pow(l,a).cmp(u);)l.redIAdd(u);for(var m=this.pow(l,e),f=this.pow(t,e.addn(1).iushrn(1)),d=this.pow(t,e),p=o;0!==d.cmp(s);){for(var M=d,v=0;0!==M.cmp(s);v++)M=M.redSqr();r(v<p);var g=this.pow(m,new n(1).iushln(p-v-1));f=f.redMul(g),m=g.redSqr(),d=d.redMul(m),p=v}return f},g.prototype.invm=function(t){var i=t._invmp(this.m);return 0!==i.negative?(i.negative=0,this.imod(i).redNeg()):this.imod(i)},g.prototype.pow=function(t,i){if(i.isZero())return new n(1);if(0===i.cmpn(1))return t.clone();var r=4,h=new Array(1<<r);h[0]=new n(1).toRed(this),h[1]=t;for(var e=2;e<h.length;e++)h[e]=this.mul(h[e-1],t);var o=h[0],s=0,u=0,a=i.bitLength()%26;for(0===a&&(a=26),e=i.length-1;e>=0;e--){for(var l=i.words[e],m=a-1;m>=0;m--){var f=l>>m&1;o!==h[0]&&(o=this.sqr(o)),0!==f||0!==s?(s<<=1,s|=f,u++,(u===r||0===e&&0===m)&&(o=this.mul(o,h[s]),u=0,s=0)):u=0}a=26}return o},g.prototype.convertTo=function(t){var i=t.umod(this.m);return i===t?i.clone():i},g.prototype.convertFrom=function(t){var i=t.clone();return i.red=null,i},n.mont=function(t){return new c(t)},h(c,g),c.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},c.prototype.convertFrom=function(t){var i=this.imod(t.mul(this.rinv));return i.red=null,i},c.prototype.imul=function(t,i){if(t.isZero()||i.isZero())return t.words[0]=0,t.length=1,t;var r=t.imul(i),h=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(h).iushrn(this.shift),e=n;return n.cmp(this.m)>=0?e=n.isub(this.m):n.cmpn(0)<0&&(e=n.iadd(this.m)),e._forceRed(this)},c.prototype.mul=function(t,i){if(t.isZero()||i.isZero())return new n(0)._forceRed(this);var r=t.mul(i),h=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=r.isub(h).iushrn(this.shift),o=e;return e.cmp(this.m)>=0?o=e.isub(this.m):e.cmpn(0)<0&&(o=e.iadd(this.m)),o._forceRed(this)},c.prototype.invm=function(t){var i=this.imod(t._invmp(this.m).mul(this.r2));return i._forceRed(this)}}("undefined"==typeof module||module,this);
},{"buffer":47}],18:[function(require,module,exports){
function Rand(n){this.rand=n}var r;if(module.exports=function(n){return r||(r=new Rand(null)),r.generate(n)},module.exports.Rand=Rand,Rand.prototype.generate=function(n){return this._rand(n)},"object"==typeof window)window.crypto&&window.crypto.getRandomValues?Rand.prototype._rand=function(n){var r=new Uint8Array(n);return window.crypto.getRandomValues(r),r}:window.msCrypto&&window.msCrypto.getRandomValues?Rand.prototype._rand=function(n){var r=new Uint8Array(n);return window.msCrypto.getRandomValues(r),r}:Rand.prototype._rand=function(){throw new Error("Not implemented yet")};else try{var crypto=require("crypto");Rand.prototype._rand=function(n){return crypto.randomBytes(n)}}catch(n){Rand.prototype._rand=function(n){for(var r=new Uint8Array(n),t=0;t<r.length;t++)r[t]=this.rand.getByte();return r}}
},{"crypto":19}],19:[function(require,module,exports){

},{}],20:[function(require,module,exports){
(function (Buffer){
function fixup_uint32(t){var e,i;return e=t>uint_max||t<0?(i=Math.abs(t)%uint_max,t<0?uint_max-i:i):t}function scrub_vec(t){for(var e=0;e<t.length;t++)t[e]=0;return!1}function Global(){this.SBOX=[],this.INV_SBOX=[],this.SUB_MIX=[[],[],[],[]],this.INV_SUB_MIX=[[],[],[],[]],this.init(),this.RCON=[0,1,2,4,8,16,32,64,128,27,54]}function bufferToArray(t){for(var e=t.length/4,i=new Array(e),r=-1;++r<e;)i[r]=t.readUInt32BE(4*r);return i}function AES(t){this._key=bufferToArray(t),this._doReset()}var uint_max=Math.pow(2,32);Global.prototype.init=function(){var t,e,i,r,n,S,u,_,o,h;for(t=function(){var t,i;for(i=[],e=t=0;t<256;e=++t)e<128?i.push(e<<1):i.push(e<<1^283);return i}(),n=0,o=0,e=h=0;h<256;e=++h)i=o^o<<1^o<<2^o<<3^o<<4,i=i>>>8^255&i^99,this.SBOX[n]=i,this.INV_SBOX[i]=n,S=t[n],u=t[S],_=t[u],r=257*t[i]^16843008*i,this.SUB_MIX[0][n]=r<<24|r>>>8,this.SUB_MIX[1][n]=r<<16|r>>>16,this.SUB_MIX[2][n]=r<<8|r>>>24,this.SUB_MIX[3][n]=r,r=16843009*_^65537*u^257*S^16843008*n,this.INV_SUB_MIX[0][i]=r<<24|r>>>8,this.INV_SUB_MIX[1][i]=r<<16|r>>>16,this.INV_SUB_MIX[2][i]=r<<8|r>>>24,this.INV_SUB_MIX[3][i]=r,0===n?n=o=1:(n=S^t[t[t[_^S]]],o^=t[t[o]]);return!0};var G=new Global;AES.blockSize=16,AES.prototype.blockSize=AES.blockSize,AES.keySize=32,AES.prototype.keySize=AES.keySize,AES.prototype._doReset=function(){var t,e,i,r,n,S;for(i=this._key,e=i.length,this._nRounds=e+6,n=4*(this._nRounds+1),this._keySchedule=[],r=0;r<n;r++)this._keySchedule[r]=r<e?i[r]:(S=this._keySchedule[r-1],r%e===0?(S=S<<8|S>>>24,S=G.SBOX[S>>>24]<<24|G.SBOX[S>>>16&255]<<16|G.SBOX[S>>>8&255]<<8|G.SBOX[255&S],S^=G.RCON[r/e|0]<<24):e>6&&r%e===4?S=G.SBOX[S>>>24]<<24|G.SBOX[S>>>16&255]<<16|G.SBOX[S>>>8&255]<<8|G.SBOX[255&S]:void 0,this._keySchedule[r-e]^S);for(this._invKeySchedule=[],t=0;t<n;t++)r=n-t,S=this._keySchedule[r-(t%4?0:4)],this._invKeySchedule[t]=t<4||r<=4?S:G.INV_SUB_MIX[0][G.SBOX[S>>>24]]^G.INV_SUB_MIX[1][G.SBOX[S>>>16&255]]^G.INV_SUB_MIX[2][G.SBOX[S>>>8&255]]^G.INV_SUB_MIX[3][G.SBOX[255&S]];return!0},AES.prototype.encryptBlock=function(t){t=bufferToArray(new Buffer(t));var e=this._doCryptBlock(t,this._keySchedule,G.SUB_MIX,G.SBOX),i=new Buffer(16);return i.writeUInt32BE(e[0],0),i.writeUInt32BE(e[1],4),i.writeUInt32BE(e[2],8),i.writeUInt32BE(e[3],12),i},AES.prototype.decryptBlock=function(t){t=bufferToArray(new Buffer(t));var e=[t[3],t[1]];t[1]=e[0],t[3]=e[1];var i=this._doCryptBlock(t,this._invKeySchedule,G.INV_SUB_MIX,G.INV_SBOX),r=new Buffer(16);return r.writeUInt32BE(i[0],0),r.writeUInt32BE(i[3],4),r.writeUInt32BE(i[2],8),r.writeUInt32BE(i[1],12),r},AES.prototype.scrub=function(){scrub_vec(this._keySchedule),scrub_vec(this._invKeySchedule),scrub_vec(this._key)},AES.prototype._doCryptBlock=function(t,e,i,r){var n,S,u,_,o,h,B,s,c;S=t[0]^e[0],u=t[1]^e[1],_=t[2]^e[2],o=t[3]^e[3],n=4;for(var f=1;f<this._nRounds;f++)h=i[0][S>>>24]^i[1][u>>>16&255]^i[2][_>>>8&255]^i[3][255&o]^e[n++],B=i[0][u>>>24]^i[1][_>>>16&255]^i[2][o>>>8&255]^i[3][255&S]^e[n++],s=i[0][_>>>24]^i[1][o>>>16&255]^i[2][S>>>8&255]^i[3][255&u]^e[n++],c=i[0][o>>>24]^i[1][S>>>16&255]^i[2][u>>>8&255]^i[3][255&_]^e[n++],S=h,u=B,_=s,o=c;return h=(r[S>>>24]<<24|r[u>>>16&255]<<16|r[_>>>8&255]<<8|r[255&o])^e[n++],B=(r[u>>>24]<<24|r[_>>>16&255]<<16|r[o>>>8&255]<<8|r[255&S])^e[n++],s=(r[_>>>24]<<24|r[o>>>16&255]<<16|r[S>>>8&255]<<8|r[255&u])^e[n++],c=(r[o>>>24]<<24|r[S>>>16&255]<<16|r[u>>>8&255]<<8|r[255&_])^e[n++],[fixup_uint32(h),fixup_uint32(B),fixup_uint32(s),fixup_uint32(c)]},exports.AES=AES;
}).call(this,require("buffer").Buffer)

},{"buffer":47}],21:[function(require,module,exports){
(function (Buffer){
function StreamCipher(t,e,r,h){if(!(this instanceof StreamCipher))return new StreamCipher(t,e,r);Transform.call(this),this._finID=Buffer.concat([r,new Buffer([0,0,0,1])]),r=Buffer.concat([r,new Buffer([0,0,0,2])]),this._cipher=new aes.AES(e),this._prev=new Buffer(r.length),this._cache=new Buffer(""),this._secCache=new Buffer(""),this._decrypt=h,this._alen=0,this._len=0,r.copy(this._prev),this._mode=t;var i=new Buffer(4);i.fill(0),this._ghash=new GHASH(this._cipher.encryptBlock(i)),this._authTag=null,this._called=!1}function xorTest(t,e){var r=0;t.length!==e.length&&r++;for(var h=Math.min(t.length,e.length),i=-1;++i<h;)r+=t[i]^e[i];return r}var aes=require("./aes"),Transform=require("cipher-base"),inherits=require("inherits"),GHASH=require("./ghash"),xor=require("buffer-xor");inherits(StreamCipher,Transform),module.exports=StreamCipher,StreamCipher.prototype._update=function(t){if(!this._called&&this._alen){var e=16-this._alen%16;e<16&&(e=new Buffer(e),e.fill(0),this._ghash.update(e))}this._called=!0;var r=this._mode.encrypt(this,t);return this._decrypt?this._ghash.update(t):this._ghash.update(r),this._len+=t.length,r},StreamCipher.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var t=xor(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt){if(xorTest(t,this._authTag))throw new Error("Unsupported state or unable to authenticate data")}else this._authTag=t;this._cipher.scrub()},StreamCipher.prototype.getAuthTag=function(){if(!this._decrypt&&Buffer.isBuffer(this._authTag))return this._authTag;throw new Error("Attempting to get auth tag in unsupported state")},StreamCipher.prototype.setAuthTag=function(t){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=t},StreamCipher.prototype.setAAD=function(t){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(t),this._alen+=t.length};
}).call(this,require("buffer").Buffer)

},{"./aes":20,"./ghash":25,"buffer":47,"buffer-xor":46,"cipher-base":49,"inherits":97}],22:[function(require,module,exports){
function getCiphers(){return Object.keys(modes)}var ciphers=require("./encrypter");exports.createCipher=exports.Cipher=ciphers.createCipher,exports.createCipheriv=exports.Cipheriv=ciphers.createCipheriv;var deciphers=require("./decrypter");exports.createDecipher=exports.Decipher=deciphers.createDecipher,exports.createDecipheriv=exports.Decipheriv=deciphers.createDecipheriv;var modes=require("./modes");exports.listCiphers=exports.getCiphers=getCiphers;
},{"./decrypter":23,"./encrypter":24,"./modes":26}],23:[function(require,module,exports){
(function (Buffer){
function Decipher(e,r,t){return this instanceof Decipher?(Transform.call(this),this._cache=new Splitter,this._last=void 0,this._cipher=new aes.AES(r),this._prev=new Buffer(t.length),t.copy(this._prev),this._mode=e,void(this._autopadding=!0)):new Decipher(e,r,t)}function Splitter(){return this instanceof Splitter?void(this.cache=new Buffer("")):new Splitter}function unpad(e){for(var r=e[15],t=-1;++t<r;)if(e[t+(16-r)]!==r)throw new Error("unable to decrypt data");if(16!==r)return e.slice(0,16-r)}function createDecipheriv(e,r,t){var i=modes[e.toLowerCase()];if(!i)throw new TypeError("invalid suite type");if("string"==typeof t&&(t=new Buffer(t)),"string"==typeof r&&(r=new Buffer(r)),r.length!==i.key/8)throw new TypeError("invalid key length "+r.length);if(t.length!==i.iv)throw new TypeError("invalid iv length "+t.length);return"stream"===i.type?new StreamCipher(modelist[i.mode],r,t,!0):"auth"===i.type?new AuthCipher(modelist[i.mode],r,t,!0):new Decipher(modelist[i.mode],r,t)}function createDecipher(e,r){var t=modes[e.toLowerCase()];if(!t)throw new TypeError("invalid suite type");var i=ebtk(r,!1,t.key,t.iv);return createDecipheriv(e,i.key,i.iv)}var aes=require("./aes"),Transform=require("cipher-base"),inherits=require("inherits"),modes=require("./modes"),StreamCipher=require("./streamCipher"),AuthCipher=require("./authCipher"),ebtk=require("evp_bytestokey");inherits(Decipher,Transform),Decipher.prototype._update=function(e){this._cache.add(e);for(var r,t,i=[];r=this._cache.get(this._autopadding);)t=this._mode.decrypt(this,r),i.push(t);return Buffer.concat(i)},Decipher.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return unpad(this._mode.decrypt(this,e));if(e)throw new Error("data not multiple of block length")},Decipher.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},Splitter.prototype.add=function(e){this.cache=Buffer.concat([this.cache,e])},Splitter.prototype.get=function(e){var r;if(e){if(this.cache.length>16)return r=this.cache.slice(0,16),this.cache=this.cache.slice(16),r}else if(this.cache.length>=16)return r=this.cache.slice(0,16),this.cache=this.cache.slice(16),r;return null},Splitter.prototype.flush=function(){if(this.cache.length)return this.cache};var modelist={ECB:require("./modes/ecb"),CBC:require("./modes/cbc"),CFB:require("./modes/cfb"),CFB8:require("./modes/cfb8"),CFB1:require("./modes/cfb1"),OFB:require("./modes/ofb"),CTR:require("./modes/ctr"),GCM:require("./modes/ctr")};exports.createDecipher=createDecipher,exports.createDecipheriv=createDecipheriv;
}).call(this,require("buffer").Buffer)

},{"./aes":20,"./authCipher":21,"./modes":26,"./modes/cbc":27,"./modes/cfb":28,"./modes/cfb1":29,"./modes/cfb8":30,"./modes/ctr":31,"./modes/ecb":32,"./modes/ofb":33,"./streamCipher":34,"buffer":47,"cipher-base":49,"evp_bytestokey":87,"inherits":97}],24:[function(require,module,exports){
(function (Buffer){
function Cipher(e,r,t){return this instanceof Cipher?(Transform.call(this),this._cache=new Splitter,this._cipher=new aes.AES(r),this._prev=new Buffer(t.length),t.copy(this._prev),this._mode=e,void(this._autopadding=!0)):new Cipher(e,r,t)}function Splitter(){return this instanceof Splitter?void(this.cache=new Buffer("")):new Splitter}function createCipheriv(e,r,t){var i=modes[e.toLowerCase()];if(!i)throw new TypeError("invalid suite type");if("string"==typeof t&&(t=new Buffer(t)),"string"==typeof r&&(r=new Buffer(r)),r.length!==i.key/8)throw new TypeError("invalid key length "+r.length);if(t.length!==i.iv)throw new TypeError("invalid iv length "+t.length);return"stream"===i.type?new StreamCipher(modelist[i.mode],r,t):"auth"===i.type?new AuthCipher(modelist[i.mode],r,t):new Cipher(modelist[i.mode],r,t)}function createCipher(e,r){var t=modes[e.toLowerCase()];if(!t)throw new TypeError("invalid suite type");var i=ebtk(r,!1,t.key,t.iv);return createCipheriv(e,i.key,i.iv)}var aes=require("./aes"),Transform=require("cipher-base"),inherits=require("inherits"),modes=require("./modes"),ebtk=require("evp_bytestokey"),StreamCipher=require("./streamCipher"),AuthCipher=require("./authCipher");inherits(Cipher,Transform),Cipher.prototype._update=function(e){this._cache.add(e);for(var r,t,i=[];r=this._cache.get();)t=this._mode.encrypt(this,r),i.push(t);return Buffer.concat(i)},Cipher.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return e=this._mode.encrypt(this,e),this._cipher.scrub(),e;if("10101010101010101010101010101010"!==e.toString("hex"))throw this._cipher.scrub(),new Error("data not multiple of block length")},Cipher.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},Splitter.prototype.add=function(e){this.cache=Buffer.concat([this.cache,e])},Splitter.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);return this.cache=this.cache.slice(16),e}return null},Splitter.prototype.flush=function(){for(var e=16-this.cache.length,r=new Buffer(e),t=-1;++t<e;)r.writeUInt8(e,t);var i=Buffer.concat([this.cache,r]);return i};var modelist={ECB:require("./modes/ecb"),CBC:require("./modes/cbc"),CFB:require("./modes/cfb"),CFB8:require("./modes/cfb8"),CFB1:require("./modes/cfb1"),OFB:require("./modes/ofb"),CTR:require("./modes/ctr"),GCM:require("./modes/ctr")};exports.createCipheriv=createCipheriv,exports.createCipher=createCipher;
}).call(this,require("buffer").Buffer)

},{"./aes":20,"./authCipher":21,"./modes":26,"./modes/cbc":27,"./modes/cfb":28,"./modes/cfb1":29,"./modes/cfb8":30,"./modes/ctr":31,"./modes/ecb":32,"./modes/ofb":33,"./streamCipher":34,"buffer":47,"cipher-base":49,"evp_bytestokey":87,"inherits":97}],25:[function(require,module,exports){
(function (Buffer){
function GHASH(t){this.h=t,this.state=new Buffer(16),this.state.fill(0),this.cache=new Buffer("")}function toArray(t){return[t.readUInt32BE(0),t.readUInt32BE(4),t.readUInt32BE(8),t.readUInt32BE(12)]}function fromArray(t){t=t.map(fixup_uint32);var r=new Buffer(16);return r.writeUInt32BE(t[0],0),r.writeUInt32BE(t[1],4),r.writeUInt32BE(t[2],8),r.writeUInt32BE(t[3],12),r}function fixup_uint32(t){var r,e;return r=t>uint_max||t<0?(e=Math.abs(t)%uint_max,t<0?uint_max-e:e):t}function xor(t,r){return[t[0]^r[0],t[1]^r[1],t[2]^r[2],t[3]^r[3]]}var zeros=new Buffer(16);zeros.fill(0),module.exports=GHASH,GHASH.prototype.ghash=function(t){for(var r=-1;++r<t.length;)this.state[r]^=t[r];this._multiply()},GHASH.prototype._multiply=function(){for(var t,r,e,i=toArray(this.h),a=[0,0,0,0],n=-1;++n<128;){for(r=0!==(this.state[~~(n/8)]&1<<7-n%8),r&&(a=xor(a,i)),e=0!==(1&i[3]),t=3;t>0;t--)i[t]=i[t]>>>1|(1&i[t-1])<<31;i[0]=i[0]>>>1,e&&(i[0]=i[0]^225<<24)}this.state=fromArray(a)},GHASH.prototype.update=function(t){this.cache=Buffer.concat([this.cache,t]);for(var r;this.cache.length>=16;)r=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(r)},GHASH.prototype.final=function(t,r){return this.cache.length&&this.ghash(Buffer.concat([this.cache,zeros],16)),this.ghash(fromArray([0,t,0,r])),this.state};var uint_max=Math.pow(2,32);
}).call(this,require("buffer").Buffer)

},{"buffer":47}],26:[function(require,module,exports){
exports["aes-128-ecb"]={cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},exports["aes-192-ecb"]={cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},exports["aes-256-ecb"]={cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},exports["aes-128-cbc"]={cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},exports["aes-192-cbc"]={cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},exports["aes-256-cbc"]={cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},exports.aes128=exports["aes-128-cbc"],exports.aes192=exports["aes-192-cbc"],exports.aes256=exports["aes-256-cbc"],exports["aes-128-cfb"]={cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},exports["aes-192-cfb"]={cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},exports["aes-256-cfb"]={cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},exports["aes-128-cfb8"]={cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},exports["aes-192-cfb8"]={cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},exports["aes-256-cfb8"]={cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},exports["aes-128-cfb1"]={cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},exports["aes-192-cfb1"]={cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},exports["aes-256-cfb1"]={cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},exports["aes-128-ofb"]={cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},exports["aes-192-ofb"]={cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},exports["aes-256-ofb"]={cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},exports["aes-128-ctr"]={cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},exports["aes-192-ctr"]={cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},exports["aes-256-ctr"]={cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},exports["aes-128-gcm"]={cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},exports["aes-192-gcm"]={cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},exports["aes-256-gcm"]={cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"};
},{}],27:[function(require,module,exports){
var xor=require("buffer-xor");exports.encrypt=function(r,e){var p=xor(e,r._prev);return r._prev=r._cipher.encryptBlock(p),r._prev},exports.decrypt=function(r,e){var p=r._prev;r._prev=e;var c=r._cipher.decryptBlock(e);return xor(c,p)};
},{"buffer-xor":46}],28:[function(require,module,exports){
(function (Buffer){
function encryptStart(e,r,c){var t=r.length,n=xor(r,e._cache);return e._cache=e._cache.slice(t),e._prev=Buffer.concat([e._prev,c?r:n]),n}var xor=require("buffer-xor");exports.encrypt=function(e,r,c){for(var t,n=new Buffer("");r.length;){if(0===e._cache.length&&(e._cache=e._cipher.encryptBlock(e._prev),e._prev=new Buffer("")),!(e._cache.length<=r.length)){n=Buffer.concat([n,encryptStart(e,r,c)]);break}t=e._cache.length,n=Buffer.concat([n,encryptStart(e,r.slice(0,t),c)]),r=r.slice(t)}return n};
}).call(this,require("buffer").Buffer)

},{"buffer":47,"buffer-xor":46}],29:[function(require,module,exports){
(function (Buffer){
function encryptByte(r,e,n){for(var t,f,c,u=-1,o=8,p=0;++u<o;)t=r._cipher.encryptBlock(r._prev),f=e&1<<7-u?128:0,c=t[0]^f,p+=(128&c)>>u%8,r._prev=shiftIn(r._prev,n?f:c);return p}function shiftIn(r,e){var n=r.length,t=-1,f=new Buffer(r.length);for(r=Buffer.concat([r,new Buffer([e])]);++t<n;)f[t]=r[t]<<1|r[t+1]>>7;return f}exports.encrypt=function(r,e,n){for(var t=e.length,f=new Buffer(t),c=-1;++c<t;)f[c]=encryptByte(r,e[c],n);return f};
}).call(this,require("buffer").Buffer)

},{"buffer":47}],30:[function(require,module,exports){
(function (Buffer){
function encryptByte(e,r,n){var t=e._cipher.encryptBlock(e._prev),c=t[0]^r;return e._prev=Buffer.concat([e._prev.slice(1),new Buffer([n?r:c])]),c}exports.encrypt=function(e,r,n){for(var t=r.length,c=new Buffer(t),f=-1;++f<t;)c[f]=encryptByte(e,r[f],n);return c};
}).call(this,require("buffer").Buffer)

},{"buffer":47}],31:[function(require,module,exports){
(function (Buffer){
function incr32(e){for(var r,c=e.length;c--;){if(r=e.readUInt8(c),255!==r){r++,e.writeUInt8(r,c);break}e.writeUInt8(0,c)}}function getBlock(e){var r=e._cipher.encryptBlock(e._prev);return incr32(e._prev),r}var xor=require("buffer-xor");exports.encrypt=function(e,r){for(;e._cache.length<r.length;)e._cache=Buffer.concat([e._cache,getBlock(e)]);var c=e._cache.slice(0,r.length);return e._cache=e._cache.slice(r.length),xor(r,c)};
}).call(this,require("buffer").Buffer)

},{"buffer":47,"buffer-xor":46}],32:[function(require,module,exports){
exports.encrypt=function(r,c){return r._cipher.encryptBlock(c)},exports.decrypt=function(r,c){return r._cipher.decryptBlock(c)};
},{}],33:[function(require,module,exports){
(function (Buffer){
function getBlock(e){return e._prev=e._cipher.encryptBlock(e._prev),e._prev}var xor=require("buffer-xor");exports.encrypt=function(e,c){for(;e._cache.length<c.length;)e._cache=Buffer.concat([e._cache,getBlock(e)]);var r=e._cache.slice(0,c.length);return e._cache=e._cache.slice(c.length),xor(c,r)};
}).call(this,require("buffer").Buffer)

},{"buffer":47,"buffer-xor":46}],34:[function(require,module,exports){
(function (Buffer){
function StreamCipher(e,r,t,i){return this instanceof StreamCipher?(Transform.call(this),this._cipher=new aes.AES(r),this._prev=new Buffer(t.length),this._cache=new Buffer(""),this._secCache=new Buffer(""),this._decrypt=i,t.copy(this._prev),void(this._mode=e)):new StreamCipher(e,r,t)}var aes=require("./aes"),Transform=require("cipher-base"),inherits=require("inherits");inherits(StreamCipher,Transform),module.exports=StreamCipher,StreamCipher.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)},StreamCipher.prototype._final=function(){this._cipher.scrub()};
}).call(this,require("buffer").Buffer)

},{"./aes":20,"buffer":47,"cipher-base":49,"inherits":97}],35:[function(require,module,exports){
function createCipher(e,r){var s,i;if(e=e.toLowerCase(),aesModes[e])s=aesModes[e].key,i=aesModes[e].iv;else{if(!desModes[e])throw new TypeError("invalid suite type");s=8*desModes[e].key,i=desModes[e].iv}var t=ebtk(r,!1,s,i);return createCipheriv(e,t.key,t.iv)}function createDecipher(e,r){var s,i;if(e=e.toLowerCase(),aesModes[e])s=aesModes[e].key,i=aesModes[e].iv;else{if(!desModes[e])throw new TypeError("invalid suite type");s=8*desModes[e].key,i=desModes[e].iv}var t=ebtk(r,!1,s,i);return createDecipheriv(e,t.key,t.iv)}function createCipheriv(e,r,s){if(e=e.toLowerCase(),aesModes[e])return aes.createCipheriv(e,r,s);if(desModes[e])return new DES({key:r,iv:s,mode:e});throw new TypeError("invalid suite type")}function createDecipheriv(e,r,s){if(e=e.toLowerCase(),aesModes[e])return aes.createDecipheriv(e,r,s);if(desModes[e])return new DES({key:r,iv:s,mode:e,decrypt:!0});throw new TypeError("invalid suite type")}function getCiphers(){return Object.keys(desModes).concat(aes.getCiphers())}var ebtk=require("evp_bytestokey"),aes=require("browserify-aes/browser"),DES=require("browserify-des"),desModes=require("browserify-des/modes"),aesModes=require("browserify-aes/modes");exports.createCipher=exports.Cipher=createCipher,exports.createCipheriv=exports.Cipheriv=createCipheriv,exports.createDecipher=exports.Decipher=createDecipher,exports.createDecipheriv=exports.Decipheriv=createDecipheriv,exports.listCiphers=exports.getCiphers=getCiphers;
},{"browserify-aes/browser":22,"browserify-aes/modes":26,"browserify-des":36,"browserify-des/modes":37,"evp_bytestokey":87}],36:[function(require,module,exports){
(function (Buffer){
function DES(e){CipherBase.call(this);var s,d=e.mode.toLowerCase(),t=modes[d];s=e.decrypt?"decrypt":"encrypt";var r=e.key;"des-ede"!==d&&"des-ede-cbc"!==d||(r=Buffer.concat([r,r.slice(0,8)]));var i=e.iv;this._des=t.create({key:r,iv:i,type:s})}var CipherBase=require("cipher-base"),des=require("des.js"),inherits=require("inherits"),modes={"des-ede3-cbc":des.CBC.instantiate(des.EDE),"des-ede3":des.EDE,"des-ede-cbc":des.CBC.instantiate(des.EDE),"des-ede":des.EDE,"des-cbc":des.CBC.instantiate(des.DES),"des-ecb":des.DES};modes.des=modes["des-cbc"],modes.des3=modes["des-ede3-cbc"],module.exports=DES,inherits(DES,CipherBase),DES.prototype._update=function(e){return new Buffer(this._des.update(e))},DES.prototype._final=function(){return new Buffer(this._des.final())};
}).call(this,require("buffer").Buffer)

},{"buffer":47,"cipher-base":49,"des.js":57,"inherits":97}],37:[function(require,module,exports){
exports["des-ecb"]={key:8,iv:0},exports["des-cbc"]=exports.des={key:8,iv:8},exports["des-ede3-cbc"]=exports.des3={key:24,iv:8},exports["des-ede3"]={key:24,iv:0},exports["des-ede-cbc"]={key:16,iv:8},exports["des-ede"]={key:16,iv:0};
},{}],38:[function(require,module,exports){
(function (Buffer){
function blind(e){var n=getr(e),r=n.toRed(bn.mont(e.modulus)).redPow(new bn(e.publicExponent)).fromRed();return{blinder:r,unblinder:n.invm(e.modulus)}}function crt(e,n){var r=blind(n),o=n.modulus.byteLength(),u=(bn.mont(n.modulus),new bn(e).mul(r.blinder).umod(n.modulus)),m=u.toRed(bn.mont(n.prime1)),d=u.toRed(bn.mont(n.prime2)),t=n.coefficient,i=n.prime1,b=n.prime2,l=m.redPow(n.exponent1),s=d.redPow(n.exponent2);l=l.fromRed(),s=s.fromRed();var p=l.isub(s).imul(t).umod(i);return p.imul(b),s.iadd(p),new Buffer(s.imul(r.unblinder).umod(n.modulus).toArray(!1,o))}function getr(e){for(var n=e.modulus.byteLength(),r=new bn(randomBytes(n));r.cmp(e.modulus)>=0||!r.umod(e.prime1)||!r.umod(e.prime2);)r=new bn(randomBytes(n));return r}var bn=require("bn.js"),randomBytes=require("randombytes");module.exports=crt,crt.getr=getr;
}).call(this,require("buffer").Buffer)

},{"bn.js":17,"buffer":47,"randombytes":131}],39:[function(require,module,exports){
(function (Buffer){
"use strict";exports["RSA-SHA224"]=exports.sha224WithRSAEncryption={sign:"rsa",hash:"sha224",id:new Buffer("302d300d06096086480165030402040500041c","hex")},exports["RSA-SHA256"]=exports.sha256WithRSAEncryption={sign:"rsa",hash:"sha256",id:new Buffer("3031300d060960864801650304020105000420","hex")},exports["RSA-SHA384"]=exports.sha384WithRSAEncryption={sign:"rsa",hash:"sha384",id:new Buffer("3041300d060960864801650304020205000430","hex")},exports["RSA-SHA512"]=exports.sha512WithRSAEncryption={sign:"rsa",hash:"sha512",id:new Buffer("3051300d060960864801650304020305000440","hex")},exports["RSA-SHA1"]={sign:"rsa",hash:"sha1",id:new Buffer("3021300906052b0e03021a05000414","hex")},exports["ecdsa-with-SHA1"]={sign:"ecdsa",hash:"sha1",id:new Buffer("","hex")},exports.DSA=exports["DSA-SHA1"]=exports["DSA-SHA"]={sign:"dsa",hash:"sha1",id:new Buffer("","hex")},exports["DSA-SHA224"]=exports["DSA-WITH-SHA224"]={sign:"dsa",hash:"sha224",id:new Buffer("","hex")},exports["DSA-SHA256"]=exports["DSA-WITH-SHA256"]={sign:"dsa",hash:"sha256",id:new Buffer("","hex")},exports["DSA-SHA384"]=exports["DSA-WITH-SHA384"]={sign:"dsa",hash:"sha384",id:new Buffer("","hex")},exports["DSA-SHA512"]=exports["DSA-WITH-SHA512"]={sign:"dsa",hash:"sha512",id:new Buffer("","hex")},exports["DSA-RIPEMD160"]={sign:"dsa",hash:"rmd160",id:new Buffer("","hex")},exports["RSA-RIPEMD160"]=exports.ripemd160WithRSA={sign:"rsa",hash:"rmd160",id:new Buffer("3021300906052b2403020105000414","hex")},exports["RSA-MD5"]=exports.md5WithRSAEncryption={sign:"rsa",hash:"md5",id:new Buffer("3020300c06082a864886f70d020505000410","hex")};
}).call(this,require("buffer").Buffer)

},{"buffer":47}],40:[function(require,module,exports){
(function (Buffer){
function Sign(e){stream.Writable.call(this);var t=algos[e];if(!t)throw new Error("Unknown message digest");this._hashType=t.hash,this._hash=createHash(t.hash),this._tag=t.id,this._signType=t.sign}function Verify(e){stream.Writable.call(this);var t=algos[e];if(!t)throw new Error("Unknown message digest");this._hash=createHash(t.hash),this._tag=t.id,this._signType=t.sign}function createSign(e){return new Sign(e)}function createVerify(e){return new Verify(e)}var _algos=require("./algos"),createHash=require("create-hash"),inherits=require("inherits"),sign=require("./sign"),stream=require("stream"),verify=require("./verify"),algos={};Object.keys(_algos).forEach(function(e){algos[e]=algos[e.toLowerCase()]=_algos[e]}),inherits(Sign,stream.Writable),Sign.prototype._write=function(e,t,i){this._hash.update(e),i()},Sign.prototype.update=function(e,t){return"string"==typeof e&&(e=new Buffer(e,t)),this._hash.update(e),this},Sign.prototype.sign=function(e,t){this.end();var i=this._hash.digest(),r=sign(Buffer.concat([this._tag,i]),e,this._hashType,this._signType);return t?r.toString(t):r},inherits(Verify,stream.Writable),Verify.prototype._write=function(e,t,i){this._hash.update(e),i()},Verify.prototype.update=function(e,t){return"string"==typeof e&&(e=new Buffer(e,t)),this._hash.update(e),this},Verify.prototype.verify=function(e,t,i){"string"==typeof t&&(t=new Buffer(t,i)),this.end();var r=this._hash.digest();return verify(t,Buffer.concat([this._tag,r]),e,this._signType)},module.exports={Sign:createSign,Verify:createVerify,createSign:createSign,createVerify:createVerify};
}).call(this,require("buffer").Buffer)

},{"./algos":39,"./sign":42,"./verify":43,"buffer":47,"create-hash":52,"inherits":97,"stream":229}],41:[function(require,module,exports){
"use strict";exports["1.3.132.0.10"]="secp256k1",exports["1.3.132.0.33"]="p224",exports["1.2.840.10045.3.1.1"]="p192",exports["1.2.840.10045.3.1.7"]="p256",exports["1.3.132.0.34"]="p384",exports["1.3.132.0.35"]="p521";
},{}],42:[function(require,module,exports){
(function (Buffer){
function sign(e,r,t,n){var a=parseKeys(r);if(a.curve){if("ecdsa"!==n)throw new Error("wrong private key type");return ecSign(e,a)}if("dsa"===a.type){if("dsa"!==n)throw new Error("wrong private key type");return dsaSign(e,a,t)}if("rsa"!==n)throw new Error("wrong private key type");for(var i=a.modulus.byteLength(),u=[0,1];e.length+u.length+1<i;)u.push(255);u.push(0);for(var o=-1;++o<e.length;)u.push(e[o]);var c=crt(u,a);return c}function ecSign(e,r){var t=curves[r.curve.join(".")];if(!t)throw new Error("unknown curve "+r.curve.join("."));var n=new EC(t),a=n.genKeyPair();a._importPrivate(r.privateKey);var i=a.sign(e);return new Buffer(i.toDER())}function dsaSign(e,r,t){for(var n,a=r.params.priv_key,i=r.params.p,u=r.params.q,o=r.params.g,c=new BN(0),f=bits2int(e,u).mod(u),s=!1,g=getKey(a,u,e,t);s===!1;)n=makeKey(u,g,t),c=makeR(o,n,i,u),s=n.invm(u).imul(f.add(a.mul(c))).mod(u),s.cmpn(0)||(s=!1,c=new BN(0));return toDER(c,s)}function toDER(e,r){e=e.toArray(),r=r.toArray(),128&e[0]&&(e=[0].concat(e)),128&r[0]&&(r=[0].concat(r));var t=e.length+r.length+4,n=[48,t,2,e.length];return n=n.concat(e,[2,r.length],r),new Buffer(n)}function getKey(e,r,t,n){if(e=new Buffer(e.toArray()),e.length<r.byteLength()){var a=new Buffer(r.byteLength()-e.length);a.fill(0),e=Buffer.concat([a,e])}var i=t.length,u=bits2octets(t,r),o=new Buffer(i);o.fill(1);var c=new Buffer(i);return c.fill(0),c=createHmac(n,c).update(o).update(new Buffer([0])).update(e).update(u).digest(),o=createHmac(n,c).update(o).digest(),c=createHmac(n,c).update(o).update(new Buffer([1])).update(e).update(u).digest(),o=createHmac(n,c).update(o).digest(),{k:c,v:o}}function bits2int(e,r){var t=new BN(e),n=(e.length<<3)-r.bitLength();return n>0&&t.ishrn(n),t}function bits2octets(e,r){e=bits2int(e,r),e=e.mod(r);var t=new Buffer(e.toArray());if(t.length<r.byteLength()){var n=new Buffer(r.byteLength()-t.length);n.fill(0),t=Buffer.concat([n,t])}return t}function makeKey(e,r,t){var n,a;do{for(n=new Buffer("");8*n.length<e.bitLength();)r.v=createHmac(t,r.k).update(r.v).digest(),n=Buffer.concat([n,r.v]);a=bits2int(n,e),r.k=createHmac(t,r.k).update(r.v).update(new Buffer([0])).digest(),r.v=createHmac(t,r.k).update(r.v).digest()}while(a.cmp(e)!==-1);return a}function makeR(e,r,t,n){return e.toRed(BN.mont(t)).redPow(r).fromRed().mod(n)}var createHmac=require("create-hmac"),crt=require("browserify-rsa"),curves=require("./curves"),elliptic=require("elliptic"),parseKeys=require("parse-asn1"),BN=require("bn.js"),EC=elliptic.ec;module.exports=sign,module.exports.getKey=getKey,module.exports.makeKey=makeKey;
}).call(this,require("buffer").Buffer)

},{"./curves":41,"bn.js":17,"browserify-rsa":38,"buffer":47,"create-hmac":55,"elliptic":67,"parse-asn1":116}],43:[function(require,module,exports){
(function (Buffer){
function verify(e,r,t,n){var o=parseKeys(t);if("ec"===o.type){if("ecdsa"!==n)throw new Error("wrong public key type");return ecVerify(e,r,o)}if("dsa"===o.type){if("dsa"!==n)throw new Error("wrong public key type");return dsaVerify(e,r,o)}if("rsa"!==n)throw new Error("wrong public key type");for(var a=o.modulus.byteLength(),i=[1],u=0;r.length+i.length+2<a;)i.push(255),u++;i.push(0);for(var d=-1;++d<r.length;)i.push(r[d]);i=new Buffer(i);var c=BN.mont(o.modulus);e=new BN(e).toRed(c),e=e.redPow(new BN(o.publicExponent)),e=new Buffer(e.fromRed().toArray());var l=0;for(u<8&&(l=1),a=Math.min(e.length,i.length),e.length!==i.length&&(l=1),d=-1;++d<a;)l|=e[d]^i[d];return 0===l}function ecVerify(e,r,t){var n=curves[t.data.algorithm.curve.join(".")];if(!n)throw new Error("unknown curve "+t.data.algorithm.curve.join("."));var o=new EC(n),a=t.data.subjectPrivateKey.data;return o.verify(r,e,a)}function dsaVerify(e,r,t){var n=t.data.p,o=t.data.q,a=t.data.g,i=t.data.pub_key,u=parseKeys.signature.decode(e,"der"),d=u.s,c=u.r;checkValue(d,o),checkValue(c,o);var l=BN.mont(n),f=d.invm(o),s=a.toRed(l).redPow(new BN(r).mul(f).mod(o)).fromRed().mul(i.toRed(l).redPow(c.mul(f).mod(o)).fromRed()).mod(n).mod(o);return!s.cmp(c)}function checkValue(e,r){if(e.cmpn(0)<=0)throw new Error("invalid sig");if(e.cmp(r)>=r)throw new Error("invalid sig")}var curves=require("./curves"),elliptic=require("elliptic"),parseKeys=require("parse-asn1"),BN=require("bn.js"),EC=elliptic.ec;module.exports=verify;
}).call(this,require("buffer").Buffer)

},{"./curves":41,"bn.js":17,"buffer":47,"elliptic":67,"parse-asn1":116}],44:[function(require,module,exports){
arguments[4][19][0].apply(exports,arguments)
},{"dup":19}],45:[function(require,module,exports){
(function (global){
"use strict";var buffer=require("buffer"),Buffer=buffer.Buffer,SlowBuffer=buffer.SlowBuffer,MAX_LEN=buffer.kMaxLength||2147483647;exports.alloc=function(r,e,f){if("function"==typeof Buffer.alloc)return Buffer.alloc(r,e,f);if("number"==typeof f)throw new TypeError("encoding must not be number");if("number"!=typeof r)throw new TypeError("size must be a number");if(r>MAX_LEN)throw new RangeError("size is too large");var n=f,o=e;void 0===o&&(n=void 0,o=0);var t=new Buffer(r);if("string"==typeof o)for(var u=new Buffer(o,n),i=u.length,a=-1;++a<r;)t[a]=u[a%i];else t.fill(o);return t},exports.allocUnsafe=function(r){if("function"==typeof Buffer.allocUnsafe)return Buffer.allocUnsafe(r);if("number"!=typeof r)throw new TypeError("size must be a number");if(r>MAX_LEN)throw new RangeError("size is too large");return new Buffer(r)},exports.from=function(r,e,f){if("function"==typeof Buffer.from&&(!global.Uint8Array||Uint8Array.from!==Buffer.from))return Buffer.from(r,e,f);if("number"==typeof r)throw new TypeError('"value" argument must not be a number');if("string"==typeof r)return new Buffer(r,e);if("undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer){var n=e;if(1===arguments.length)return new Buffer(r);"undefined"==typeof n&&(n=0);var o=f;if("undefined"==typeof o&&(o=r.byteLength-n),n>=r.byteLength)throw new RangeError("'offset' is out of bounds");if(o>r.byteLength-n)throw new RangeError("'length' is out of bounds");return new Buffer(r.slice(n,n+o))}if(Buffer.isBuffer(r)){var t=new Buffer(r.length);return r.copy(t,0,0,r.length),t}if(r){if(Array.isArray(r)||"undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return new Buffer(r);if("Buffer"===r.type&&Array.isArray(r.data))return new Buffer(r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},exports.allocUnsafeSlow=function(r){if("function"==typeof Buffer.allocUnsafeSlow)return Buffer.allocUnsafeSlow(r);if("number"!=typeof r)throw new TypeError("size must be a number");if(r>=MAX_LEN)throw new RangeError("size is too large");return new SlowBuffer(r)};
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"buffer":47}],46:[function(require,module,exports){
(function (Buffer){
module.exports=function(e,n){for(var r=Math.min(e.length,n.length),t=new Buffer(r),f=0;f<r;++f)t[f]=e[f]^n[f];return t};
}).call(this,require("buffer").Buffer)

},{"buffer":47}],47:[function(require,module,exports){
(function (global){
"use strict";function typedArraySupport(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(t,e){if(kMaxLength()<e)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=Buffer.prototype):(null===t&&(t=new Buffer(e)),t.length=e),t}function Buffer(t,e,r){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,t)}return from(this,t,e,r)}function from(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?fromArrayBuffer(t,e,r,n):"string"==typeof e?fromString(t,e,r):fromObject(t,e)}function assertSize(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function alloc(t,e,r,n){return assertSize(e),e<=0?createBuffer(t,e):void 0!==r?"string"==typeof n?createBuffer(t,e).fill(r,n):createBuffer(t,e).fill(r):createBuffer(t,e)}function allocUnsafe(t,e){if(assertSize(e),t=createBuffer(t,e<0?0:0|checked(e)),!Buffer.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function fromString(t,e,r){if("string"==typeof r&&""!==r||(r="utf8"),!Buffer.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|byteLength(e,r);t=createBuffer(t,n);var f=t.write(e,r);return f!==n&&(t=t.slice(0,f)),t}function fromArrayLike(t,e){var r=e.length<0?0:0|checked(e.length);t=createBuffer(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function fromArrayBuffer(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n),Buffer.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=Buffer.prototype):t=fromArrayLike(t,e),t}function fromObject(t,e){if(Buffer.isBuffer(e)){var r=0|checked(e.length);return t=createBuffer(t,r),0===t.length?t:(e.copy(t,0,0,r),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||isnan(e.length)?createBuffer(t,0):fromArrayLike(t,e);if("Buffer"===e.type&&isArray(e.data))return fromArrayLike(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(t){if(t>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|t}function SlowBuffer(t){return+t!=t&&(t=0),Buffer.alloc(+t)}function byteLength(t,e){if(Buffer.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return utf8ToBytes(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(t).length;default:if(n)return utf8ToBytes(t).length;e=(""+e).toLowerCase(),n=!0}}function slowToString(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,e>>>=0,r<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return hexSlice(this,e,r);case"utf8":case"utf-8":return utf8Slice(this,e,r);case"ascii":return asciiSlice(this,e,r);case"latin1":case"binary":return latin1Slice(this,e,r);case"base64":return base64Slice(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function swap(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function bidirectionalIndexOf(t,e,r,n,f){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=f?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(f)return-1;r=t.length-1}else if(r<0){if(!f)return-1;r=0}if("string"==typeof e&&(e=Buffer.from(e,n)),Buffer.isBuffer(e))return 0===e.length?-1:arrayIndexOf(t,e,r,n,f);if("number"==typeof e)return e&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?f?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):arrayIndexOf(t,[e],r,n,f);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(t,e,r,n,f){function i(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}var o=1,u=t.length,s=e.length;if(void 0!==n&&(n=String(n).toLowerCase(),"ucs2"===n||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,u/=2,s/=2,r/=2}var a;if(f){var h=-1;for(a=r;a<u;a++)if(i(t,a)===i(e,h===-1?0:a-h)){if(h===-1&&(h=a),a-h+1===s)return h*o}else h!==-1&&(a-=a-h),h=-1}else for(r+s>u&&(r=u-s),a=r;a>=0;a--){for(var c=!0,l=0;l<s;l++)if(i(t,a+l)!==i(e,l)){c=!1;break}if(c)return a}return-1}function hexWrite(t,e,r,n){r=Number(r)||0;var f=t.length-r;n?(n=Number(n),n>f&&(n=f)):n=f;var i=e.length;if(i%2!==0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var o=0;o<n;++o){var u=parseInt(e.substr(2*o,2),16);if(isNaN(u))return o;t[r+o]=u}return o}function utf8Write(t,e,r,n){return blitBuffer(utf8ToBytes(e,t.length-r),t,r,n)}function asciiWrite(t,e,r,n){return blitBuffer(asciiToBytes(e),t,r,n)}function latin1Write(t,e,r,n){return asciiWrite(t,e,r,n)}function base64Write(t,e,r,n){return blitBuffer(base64ToBytes(e),t,r,n)}function ucs2Write(t,e,r,n){return blitBuffer(utf16leToBytes(e,t.length-r),t,r,n)}function base64Slice(t,e,r){return 0===e&&r===t.length?base64.fromByteArray(t):base64.fromByteArray(t.slice(e,r))}function utf8Slice(t,e,r){r=Math.min(t.length,r);for(var n=[],f=e;f<r;){var i=t[f],o=null,u=i>239?4:i>223?3:i>191?2:1;if(f+u<=r){var s,a,h,c;switch(u){case 1:i<128&&(o=i);break;case 2:s=t[f+1],128===(192&s)&&(c=(31&i)<<6|63&s,c>127&&(o=c));break;case 3:s=t[f+1],a=t[f+2],128===(192&s)&&128===(192&a)&&(c=(15&i)<<12|(63&s)<<6|63&a,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:s=t[f+1],a=t[f+2],h=t[f+3],128===(192&s)&&128===(192&a)&&128===(192&h)&&(c=(15&i)<<18|(63&s)<<12|(63&a)<<6|63&h,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,u=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),f+=u}return decodeCodePointsArray(n)}function decodeCodePointsArray(t){var e=t.length;if(e<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=MAX_ARGUMENTS_LENGTH));return r}function asciiSlice(t,e,r){var n="";r=Math.min(t.length,r);for(var f=e;f<r;++f)n+=String.fromCharCode(127&t[f]);return n}function latin1Slice(t,e,r){var n="";r=Math.min(t.length,r);for(var f=e;f<r;++f)n+=String.fromCharCode(t[f]);return n}function hexSlice(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var f="",i=e;i<r;++i)f+=toHex(t[i]);return f}function utf16leSlice(t,e,r){for(var n=t.slice(e,r),f="",i=0;i<n.length;i+=2)f+=String.fromCharCode(n[i]+256*n[i+1]);return f}function checkOffset(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(t,e,r,n,f,i){if(!Buffer.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>f||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function objectWriteUInt16(t,e,r,n){e<0&&(e=65535+e+1);for(var f=0,i=Math.min(t.length-r,2);f<i;++f)t[r+f]=(e&255<<8*(n?f:1-f))>>>8*(n?f:1-f)}function objectWriteUInt32(t,e,r,n){e<0&&(e=4294967295+e+1);for(var f=0,i=Math.min(t.length-r,4);f<i;++f)t[r+f]=e>>>8*(n?f:3-f)&255}function checkIEEE754(t,e,r,n,f,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function writeFloat(t,e,r,n,f){return f||checkIEEE754(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(t,e,r,n,23,4),r+4}function writeDouble(t,e,r,n,f){return f||checkIEEE754(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(t,e,r,n,52,8),r+8}function base64clean(t){if(t=stringtrim(t).replace(INVALID_BASE64_RE,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function stringtrim(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function toHex(t){return t<16?"0"+t.toString(16):t.toString(16)}function utf8ToBytes(t,e){e=e||1/0;for(var r,n=t.length,f=null,i=[],o=0;o<n;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!f){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&i.push(239,191,189);continue}f=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),f=r;continue}r=(f-55296<<10|r-56320)+65536}else f&&(e-=3)>-1&&i.push(239,191,189);if(f=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function asciiToBytes(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function utf16leToBytes(t,e){for(var r,n,f,i=[],o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,f=r%256,i.push(f),i.push(n);return i}function base64ToBytes(t){return base64.toByteArray(base64clean(t))}function blitBuffer(t,e,r,n){for(var f=0;f<n&&!(f+r>=e.length||f>=t.length);++f)e[f+r]=t[f];return f}function isnan(t){return t!==t}var base64=require("base64-js"),ieee754=require("ieee754"),isArray=require("isarray");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:typedArraySupport(),exports.kMaxLength=kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(t){return t.__proto__=Buffer.prototype,t},Buffer.from=function(t,e,r){return from(null,t,e,r)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0})),Buffer.alloc=function(t,e,r){return alloc(null,t,e,r)},Buffer.allocUnsafe=function(t){return allocUnsafe(null,t)},Buffer.allocUnsafeSlow=function(t){return allocUnsafe(null,t)},Buffer.isBuffer=function(t){return!(null==t||!t._isBuffer)},Buffer.compare=function(t,e){if(!Buffer.isBuffer(t)||!Buffer.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,f=0,i=Math.min(r,n);f<i;++f)if(t[f]!==e[f]){r=t[f],n=e[f];break}return r<n?-1:n<r?1:0},Buffer.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(t,e){if(!isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Buffer.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=Buffer.allocUnsafe(e),f=0;for(r=0;r<t.length;++r){var i=t[r];if(!Buffer.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,f),f+=i.length}return n},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)swap(this,e,e+1);return this},Buffer.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)swap(this,e,e+3),swap(this,e+1,e+2);return this},Buffer.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)swap(this,e,e+7),swap(this,e+1,e+6),swap(this,e+2,e+5),swap(this,e+3,e+4);return this},Buffer.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?utf8Slice(this,0,t):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(t){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===Buffer.compare(this,t)},Buffer.prototype.inspect=function(){var t="",e=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},Buffer.prototype.compare=function(t,e,r,n,f){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===f&&(f=this.length),e<0||r>t.length||n<0||f>this.length)throw new RangeError("out of range index");if(n>=f&&e>=r)return 0;if(n>=f)return-1;if(e>=r)return 1;if(e>>>=0,r>>>=0,n>>>=0,f>>>=0,this===t)return 0;for(var i=f-n,o=r-e,u=Math.min(i,o),s=this.slice(n,f),a=t.slice(e,r),h=0;h<u;++h)if(s[h]!==a[h]){i=s[h],o=a[h];break}return i<o?-1:o<i?1:0},Buffer.prototype.includes=function(t,e,r){return this.indexOf(t,e,r)!==-1},Buffer.prototype.indexOf=function(t,e,r){return bidirectionalIndexOf(this,t,e,r,!0)},Buffer.prototype.lastIndexOf=function(t,e,r){return bidirectionalIndexOf(this,t,e,r,!1)},Buffer.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var f=this.length-e;if((void 0===r||r>f)&&(r=f),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return hexWrite(this,t,e,r);case"utf8":case"utf-8":return utf8Write(this,t,e,r);case"ascii":return asciiWrite(this,t,e,r);case"latin1":case"binary":return latin1Write(this,t,e,r);case"base64":return base64Write(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;Buffer.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),e<t&&(e=t);var n;if(Buffer.TYPED_ARRAY_SUPPORT)n=this.subarray(t,e),n.__proto__=Buffer.prototype;else{var f=e-t;n=new Buffer(f,void 0);for(var i=0;i<f;++i)n[i]=this[i+t]}return n},Buffer.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=this[t],f=1,i=0;++i<e&&(f*=256);)n+=this[t+i]*f;return n},Buffer.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=this[t+--e],f=1;e>0&&(f*=256);)n+=this[t+--e]*f;return n},Buffer.prototype.readUInt8=function(t,e){return e||checkOffset(t,1,this.length),this[t]},Buffer.prototype.readUInt16LE=function(t,e){return e||checkOffset(t,2,this.length),this[t]|this[t+1]<<8},Buffer.prototype.readUInt16BE=function(t,e){return e||checkOffset(t,2,this.length),this[t]<<8|this[t+1]},Buffer.prototype.readUInt32LE=function(t,e){return e||checkOffset(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Buffer.prototype.readUInt32BE=function(t,e){return e||checkOffset(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Buffer.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=this[t],f=1,i=0;++i<e&&(f*=256);)n+=this[t+i]*f;return f*=128,n>=f&&(n-=Math.pow(2,8*e)),n},Buffer.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=e,f=1,i=this[t+--n];n>0&&(f*=256);)i+=this[t+--n]*f;return f*=128,i>=f&&(i-=Math.pow(2,8*e)),i},Buffer.prototype.readInt8=function(t,e){return e||checkOffset(t,1,this.length),128&this[t]?(255-this[t]+1)*-1:this[t]},Buffer.prototype.readInt16LE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function(t,e){return e||checkOffset(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Buffer.prototype.readInt32BE=function(t,e){return e||checkOffset(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Buffer.prototype.readFloatLE=function(t,e){return e||checkOffset(t,4,this.length),ieee754.read(this,t,!0,23,4)},Buffer.prototype.readFloatBE=function(t,e){return e||checkOffset(t,4,this.length),ieee754.read(this,t,!1,23,4)},Buffer.prototype.readDoubleLE=function(t,e){return e||checkOffset(t,8,this.length),ieee754.read(this,t,!0,52,8)},Buffer.prototype.readDoubleBE=function(t,e){return e||checkOffset(t,8,this.length),ieee754.read(this,t,!1,52,8)},Buffer.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e|=0,r|=0,!n){var f=Math.pow(2,8*r)-1;checkInt(this,t,e,r,f,0)}var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},Buffer.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e|=0,r|=0,!n){var f=Math.pow(2,8*r)-1;checkInt(this,t,e,r,f,0)}var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},Buffer.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},Buffer.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var f=Math.pow(2,8*r-1);checkInt(this,t,e,r,f-1,-f)}var i=0,o=1,u=0;for(this[e]=255&t;++i<r&&(o*=256);)t<0&&0===u&&0!==this[e+i-1]&&(u=1),this[e+i]=(t/o>>0)-u&255;return e+r},Buffer.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var f=Math.pow(2,8*r-1);checkInt(this,t,e,r,f-1,-f)}var i=r-1,o=1,u=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===u&&0!==this[e+i+1]&&(u=1),this[e+i]=(t/o>>0)-u&255;return e+r},Buffer.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},Buffer.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeFloatLE=function(t,e,r){return writeFloat(this,t,e,!0,r)},Buffer.prototype.writeFloatBE=function(t,e,r){return writeFloat(this,t,e,!1,r)},Buffer.prototype.writeDoubleLE=function(t,e,r){return writeDouble(this,t,e,!0,r)},Buffer.prototype.writeDoubleBE=function(t,e,r){return writeDouble(this,t,e,!1,r)},Buffer.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var f,i=n-r;if(this===t&&r<e&&e<n)for(f=i-1;f>=0;--f)t[f+e]=this[f+r];else if(i<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(f=0;f<i;++f)t[f+e]=this[f+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+i),e);return i},Buffer.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var f=t.charCodeAt(0);f<256&&(t=f)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Buffer.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0);var i;if("number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{var o=Buffer.isBuffer(t)?t:utf8ToBytes(new Buffer(t,n).toString()),u=o.length;for(i=0;i<r-e;++i)this[i+e]=o[i%u]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"base64-js":16,"ieee754":95,"isarray":99}],48:[function(require,module,exports){
module.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"};
},{}],49:[function(require,module,exports){
(function (Buffer){
function CipherBase(t){Transform.call(this),this.hashMode="string"==typeof t,this.hashMode?this[t]=this._finalOrDigest:this.final=this._finalOrDigest,this._decoder=null,this._encoding=null}var Transform=require("stream").Transform,inherits=require("inherits"),StringDecoder=require("string_decoder").StringDecoder;module.exports=CipherBase,inherits(CipherBase,Transform),CipherBase.prototype.update=function(t,e,r){"string"==typeof t&&(t=new Buffer(t,e));var i=this._update(t);return this.hashMode?this:(r&&(i=this._toString(i,r)),i)},CipherBase.prototype.setAutoPadding=function(){},CipherBase.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},CipherBase.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},CipherBase.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},CipherBase.prototype._transform=function(t,e,r){var i;try{this.hashMode?this._update(t):this.push(this._update(t))}catch(t){i=t}finally{r(i)}},CipherBase.prototype._flush=function(t){var e;try{this.push(this._final())}catch(t){e=t}finally{t(e)}},CipherBase.prototype._finalOrDigest=function(t){var e=this._final()||new Buffer("");return t&&(e=this._toString(e,t,!0)),e},CipherBase.prototype._toString=function(t,e,r){if(this._decoder||(this._decoder=new StringDecoder(e),this._encoding=e),this._encoding!==e)throw new Error("can't switch encodings");var i=this._decoder.write(t);return r&&(i+=this._decoder.end()),i};
}).call(this,require("buffer").Buffer)

},{"buffer":47,"inherits":97,"stream":229,"string_decoder":234}],50:[function(require,module,exports){
(function (Buffer){
function isArray(r){return Array.isArray?Array.isArray(r):"[object Array]"===objectToString(r)}function isBoolean(r){return"boolean"==typeof r}function isNull(r){return null===r}function isNullOrUndefined(r){return null==r}function isNumber(r){return"number"==typeof r}function isString(r){return"string"==typeof r}function isSymbol(r){return"symbol"==typeof r}function isUndefined(r){return void 0===r}function isRegExp(r){return"[object RegExp]"===objectToString(r)}function isObject(r){return"object"==typeof r&&null!==r}function isDate(r){return"[object Date]"===objectToString(r)}function isError(r){return"[object Error]"===objectToString(r)||r instanceof Error}function isFunction(r){return"function"==typeof r}function isPrimitive(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||"undefined"==typeof r}function objectToString(r){return Object.prototype.toString.call(r)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=Buffer.isBuffer;
}).call(this,{"isBuffer":require("../../is-buffer/index.js")})

},{"../../is-buffer/index.js":98}],51:[function(require,module,exports){
(function (Buffer){
function ECDH(e){this.curveType=aliases[e],this.curveType||(this.curveType={name:e}),this.curve=new elliptic.ec(this.curveType.name),this.keys=void 0}function formatReturnValue(e,t,r){Array.isArray(e)||(e=e.toArray());var i=new Buffer(e);if(r&&i.length<r){var s=new Buffer(r-i.length);s.fill(0),i=Buffer.concat([s,i])}return t?i.toString(t):i}var elliptic=require("elliptic"),BN=require("bn.js");module.exports=function(e){return new ECDH(e)};var aliases={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};aliases.p224=aliases.secp224r1,aliases.p256=aliases.secp256r1=aliases.prime256v1,aliases.p192=aliases.secp192r1=aliases.prime192v1,aliases.p384=aliases.secp384r1,aliases.p521=aliases.secp521r1,ECDH.prototype.generateKeys=function(e,t){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,t)},ECDH.prototype.computeSecret=function(e,t,r){t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t));var i=this.curve.keyFromPublic(e).getPublic(),s=i.mul(this.keys.getPrivate()).getX();return formatReturnValue(s,r,this.curveType.byteLength)},ECDH.prototype.getPublicKey=function(e,t){var r=this.keys.getPublic("compressed"===t,!0);return"hybrid"===t&&(r[r.length-1]%2?r[0]=7:r[0]=6),formatReturnValue(r,e)},ECDH.prototype.getPrivateKey=function(e){return formatReturnValue(this.keys.getPrivate(),e)},ECDH.prototype.setPublicKey=function(e,t){return t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t)),this.keys._importPublic(e),this},ECDH.prototype.setPrivateKey=function(e,t){t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t));var r=new BN(e);return r=r.toString(16),this.keys._importPrivate(r),this};
}).call(this,require("buffer").Buffer)

},{"bn.js":17,"buffer":47,"elliptic":67}],52:[function(require,module,exports){
(function (Buffer){
"use strict";function HashNoConstructor(s){Base.call(this,"digest"),this._hash=s,this.buffers=[]}function Hash(s){Base.call(this,"digest"),this._hash=s}var inherits=require("inherits"),md5=require("./md5"),rmd160=require("ripemd160"),sha=require("sha.js"),Base=require("cipher-base");inherits(HashNoConstructor,Base),HashNoConstructor.prototype._update=function(s){this.buffers.push(s)},HashNoConstructor.prototype._final=function(){var s=Buffer.concat(this.buffers),t=this._hash(s);return this.buffers=null,t},inherits(Hash,Base),Hash.prototype._update=function(s){this._hash.update(s)},Hash.prototype._final=function(){return this._hash.digest()},module.exports=function(s){return s=s.toLowerCase(),"md5"===s?new HashNoConstructor(md5):"rmd160"===s||"ripemd160"===s?new HashNoConstructor(rmd160):new Hash(sha(s))};
}).call(this,require("buffer").Buffer)

},{"./md5":54,"buffer":47,"cipher-base":49,"inherits":97,"ripemd160":178,"sha.js":180}],53:[function(require,module,exports){
(function (Buffer){
"use strict";function toArray(r,e){if(r.length%intSize!==0){var t=r.length+(intSize-r.length%intSize);r=Buffer.concat([r,zeroBuffer],t)}for(var f=[],n=e?r.readInt32BE:r.readInt32LE,i=0;i<r.length;i+=intSize)f.push(n.call(r,i));return f}function toBuffer(r,e,t){for(var f=new Buffer(e),n=t?f.writeInt32BE:f.writeInt32LE,i=0;i<r.length;i++)n.call(f,r[i],4*i,!0);return f}function hash(r,e,t,f){Buffer.isBuffer(r)||(r=new Buffer(r));var n=e(toArray(r,f),r.length*chrsz);return toBuffer(n,t,f)}var intSize=4,zeroBuffer=new Buffer(intSize);zeroBuffer.fill(0);var chrsz=8;exports.hash=hash;
}).call(this,require("buffer").Buffer)

},{"buffer":47}],54:[function(require,module,exports){
"use strict";function core_md5(d,_){d[_>>5]|=128<<_%32,d[(_+64>>>9<<4)+14]=_;for(var m=1732584193,f=-271733879,i=-1732584194,h=271733878,r=0;r<d.length;r+=16){var g=m,n=f,e=i,a=h;m=md5_ff(m,f,i,h,d[r+0],7,-680876936),h=md5_ff(h,m,f,i,d[r+1],12,-389564586),i=md5_ff(i,h,m,f,d[r+2],17,606105819),f=md5_ff(f,i,h,m,d[r+3],22,-1044525330),m=md5_ff(m,f,i,h,d[r+4],7,-176418897),h=md5_ff(h,m,f,i,d[r+5],12,1200080426),i=md5_ff(i,h,m,f,d[r+6],17,-1473231341),f=md5_ff(f,i,h,m,d[r+7],22,-45705983),m=md5_ff(m,f,i,h,d[r+8],7,1770035416),h=md5_ff(h,m,f,i,d[r+9],12,-1958414417),i=md5_ff(i,h,m,f,d[r+10],17,-42063),f=md5_ff(f,i,h,m,d[r+11],22,-1990404162),m=md5_ff(m,f,i,h,d[r+12],7,1804603682),h=md5_ff(h,m,f,i,d[r+13],12,-40341101),i=md5_ff(i,h,m,f,d[r+14],17,-1502002290),f=md5_ff(f,i,h,m,d[r+15],22,1236535329),m=md5_gg(m,f,i,h,d[r+1],5,-165796510),h=md5_gg(h,m,f,i,d[r+6],9,-1069501632),i=md5_gg(i,h,m,f,d[r+11],14,643717713),f=md5_gg(f,i,h,m,d[r+0],20,-373897302),m=md5_gg(m,f,i,h,d[r+5],5,-701558691),h=md5_gg(h,m,f,i,d[r+10],9,38016083),i=md5_gg(i,h,m,f,d[r+15],14,-660478335),f=md5_gg(f,i,h,m,d[r+4],20,-405537848),m=md5_gg(m,f,i,h,d[r+9],5,568446438),h=md5_gg(h,m,f,i,d[r+14],9,-1019803690),i=md5_gg(i,h,m,f,d[r+3],14,-187363961),f=md5_gg(f,i,h,m,d[r+8],20,1163531501),m=md5_gg(m,f,i,h,d[r+13],5,-1444681467),h=md5_gg(h,m,f,i,d[r+2],9,-51403784),i=md5_gg(i,h,m,f,d[r+7],14,1735328473),f=md5_gg(f,i,h,m,d[r+12],20,-1926607734),m=md5_hh(m,f,i,h,d[r+5],4,-378558),h=md5_hh(h,m,f,i,d[r+8],11,-2022574463),i=md5_hh(i,h,m,f,d[r+11],16,1839030562),f=md5_hh(f,i,h,m,d[r+14],23,-35309556),m=md5_hh(m,f,i,h,d[r+1],4,-1530992060),h=md5_hh(h,m,f,i,d[r+4],11,1272893353),i=md5_hh(i,h,m,f,d[r+7],16,-155497632),f=md5_hh(f,i,h,m,d[r+10],23,-1094730640),m=md5_hh(m,f,i,h,d[r+13],4,681279174),h=md5_hh(h,m,f,i,d[r+0],11,-358537222),i=md5_hh(i,h,m,f,d[r+3],16,-722521979),f=md5_hh(f,i,h,m,d[r+6],23,76029189),m=md5_hh(m,f,i,h,d[r+9],4,-640364487),h=md5_hh(h,m,f,i,d[r+12],11,-421815835),i=md5_hh(i,h,m,f,d[r+15],16,530742520),f=md5_hh(f,i,h,m,d[r+2],23,-995338651),m=md5_ii(m,f,i,h,d[r+0],6,-198630844),h=md5_ii(h,m,f,i,d[r+7],10,1126891415),i=md5_ii(i,h,m,f,d[r+14],15,-1416354905),f=md5_ii(f,i,h,m,d[r+5],21,-57434055),m=md5_ii(m,f,i,h,d[r+12],6,1700485571),h=md5_ii(h,m,f,i,d[r+3],10,-1894986606),i=md5_ii(i,h,m,f,d[r+10],15,-1051523),f=md5_ii(f,i,h,m,d[r+1],21,-2054922799),m=md5_ii(m,f,i,h,d[r+8],6,1873313359),h=md5_ii(h,m,f,i,d[r+15],10,-30611744),i=md5_ii(i,h,m,f,d[r+6],15,-1560198380),f=md5_ii(f,i,h,m,d[r+13],21,1309151649),m=md5_ii(m,f,i,h,d[r+4],6,-145523070),h=md5_ii(h,m,f,i,d[r+11],10,-1120210379),i=md5_ii(i,h,m,f,d[r+2],15,718787259),f=md5_ii(f,i,h,m,d[r+9],21,-343485551),m=safe_add(m,g),f=safe_add(f,n),i=safe_add(i,e),h=safe_add(h,a)}return Array(m,f,i,h)}function md5_cmn(d,_,m,f,i,h){return safe_add(bit_rol(safe_add(safe_add(_,d),safe_add(f,h)),i),m)}function md5_ff(d,_,m,f,i,h,r){return md5_cmn(_&m|~_&f,d,_,i,h,r)}function md5_gg(d,_,m,f,i,h,r){return md5_cmn(_&f|m&~f,d,_,i,h,r)}function md5_hh(d,_,m,f,i,h,r){return md5_cmn(_^m^f,d,_,i,h,r)}function md5_ii(d,_,m,f,i,h,r){return md5_cmn(m^(_|~f),d,_,i,h,r)}function safe_add(d,_){var m=(65535&d)+(65535&_),f=(d>>16)+(_>>16)+(m>>16);return f<<16|65535&m}function bit_rol(d,_){return d<<_|d>>>32-_}var helpers=require("./helpers");module.exports=function(d){return helpers.hash(d,core_md5,16)};
},{"./helpers":53}],55:[function(require,module,exports){
(function (Buffer){
"use strict";function Hmac(t,e){Transform.call(this),t=t.toLowerCase(),"string"==typeof e&&(e=new Buffer(e));var r="sha512"===t||"sha384"===t?128:64;this._alg=t,this._key=e,e.length>r?e=createHash(t).update(e).digest():e.length<r&&(e=Buffer.concat([e,ZEROS],r));for(var a=this._ipad=new Buffer(r),s=this._opad=new Buffer(r),i=0;i<r;i++)a[i]=54^e[i],s[i]=92^e[i];this._hash=createHash(t).update(a)}var createHash=require("create-hash/browser"),inherits=require("inherits"),Transform=require("stream").Transform,ZEROS=new Buffer(128);ZEROS.fill(0),inherits(Hmac,Transform),Hmac.prototype.update=function(t,e){return this._hash.update(t,e),this},Hmac.prototype._transform=function(t,e,r){this._hash.update(t),r()},Hmac.prototype._flush=function(t){this.push(this.digest()),t()},Hmac.prototype.digest=function(t){var e=this._hash.digest();return createHash(this._alg).update(this._opad).update(e).digest(t)},module.exports=function(t,e){return new Hmac(t,e)};
}).call(this,require("buffer").Buffer)

},{"buffer":47,"create-hash/browser":52,"inherits":97,"stream":229}],56:[function(require,module,exports){
"use strict";exports.randomBytes=exports.rng=exports.pseudoRandomBytes=exports.prng=require("randombytes"),exports.createHash=exports.Hash=require("create-hash"),exports.createHmac=exports.Hmac=require("create-hmac");var hashes=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(Object.keys(require("browserify-sign/algos")));exports.getHashes=function(){return hashes};var p=require("pbkdf2");exports.pbkdf2=p.pbkdf2,exports.pbkdf2Sync=p.pbkdf2Sync;var aes=require("browserify-cipher");["Cipher","createCipher","Cipheriv","createCipheriv","Decipher","createDecipher","Decipheriv","createDecipheriv","getCiphers","listCiphers"].forEach(function(e){exports[e]=aes[e]});var dh=require("diffie-hellman");["DiffieHellmanGroup","createDiffieHellmanGroup","getDiffieHellman","createDiffieHellman","DiffieHellman"].forEach(function(e){exports[e]=dh[e]});var sign=require("browserify-sign");["createSign","Sign","createVerify","Verify"].forEach(function(e){exports[e]=sign[e]}),exports.createECDH=require("create-ecdh");var publicEncrypt=require("public-encrypt");["publicEncrypt","privateEncrypt","publicDecrypt","privateDecrypt"].forEach(function(e){exports[e]=publicEncrypt[e]}),["createCredentials"].forEach(function(e){exports[e]=function(){throw new Error(["sorry, "+e+" is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))}});
},{"browserify-cipher":35,"browserify-sign":40,"browserify-sign/algos":39,"create-ecdh":51,"create-hash":52,"create-hmac":55,"diffie-hellman":63,"pbkdf2":117,"public-encrypt":121,"randombytes":131}],57:[function(require,module,exports){
"use strict";exports.utils=require("./des/utils"),exports.Cipher=require("./des/cipher"),exports.DES=require("./des/des"),exports.CBC=require("./des/cbc"),exports.EDE=require("./des/ede");
},{"./des/cbc":58,"./des/cipher":59,"./des/des":60,"./des/ede":61,"./des/utils":62}],58:[function(require,module,exports){
"use strict";function CBCState(t){assert.equal(t.length,8,"Invalid IV length"),this.iv=new Array(8);for(var i=0;i<this.iv.length;i++)this.iv[i]=t[i]}function instantiate(t){function i(i){t.call(this,i),this._cbcInit()}inherits(i,t);for(var e=Object.keys(proto),r=0;r<e.length;r++){var n=e[r];i.prototype[n]=proto[n]}return i.create=function(t){return new i(t)},i}var assert=require("minimalistic-assert"),inherits=require("inherits"),proto={};exports.instantiate=instantiate,proto._cbcInit=function(){var t=new CBCState(this.options.iv);this._cbcState=t},proto._update=function(t,i,e,r){var n=this._cbcState,s=this.constructor.super_.prototype,o=n.iv;if("encrypt"===this.type){for(var a=0;a<this.blockSize;a++)o[a]^=t[i+a];s._update.call(this,o,0,e,r);for(var a=0;a<this.blockSize;a++)o[a]=e[r+a]}else{s._update.call(this,t,i,e,r);for(var a=0;a<this.blockSize;a++)e[r+a]^=o[a];for(var a=0;a<this.blockSize;a++)o[a]=t[i+a]}};
},{"inherits":97,"minimalistic-assert":103}],59:[function(require,module,exports){
"use strict";function Cipher(t){this.options=t,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}var assert=require("minimalistic-assert");module.exports=Cipher,Cipher.prototype._init=function(){},Cipher.prototype.update=function(t){return 0===t.length?[]:"decrypt"===this.type?this._updateDecrypt(t):this._updateEncrypt(t)},Cipher.prototype._buffer=function(t,e){for(var r=Math.min(this.buffer.length-this.bufferOff,t.length-e),i=0;i<r;i++)this.buffer[this.bufferOff+i]=t[e+i];return this.bufferOff+=r,r},Cipher.prototype._flushBuffer=function(t,e){return this._update(this.buffer,0,t,e),this.bufferOff=0,this.blockSize},Cipher.prototype._updateEncrypt=function(t){var e=0,r=0,i=(this.bufferOff+t.length)/this.blockSize|0,f=new Array(i*this.blockSize);0!==this.bufferOff&&(e+=this._buffer(t,e),this.bufferOff===this.buffer.length&&(r+=this._flushBuffer(f,r)));for(var h=t.length-(t.length-e)%this.blockSize;e<h;e+=this.blockSize)this._update(t,e,f,r),r+=this.blockSize;for(;e<t.length;e++,this.bufferOff++)this.buffer[this.bufferOff]=t[e];return f},Cipher.prototype._updateDecrypt=function(t){for(var e=0,r=0,i=Math.ceil((this.bufferOff+t.length)/this.blockSize)-1,f=new Array(i*this.blockSize);i>0;i--)e+=this._buffer(t,e),r+=this._flushBuffer(f,r);return e+=this._buffer(t,e),f},Cipher.prototype.final=function(t){var e;t&&(e=this.update(t));var r;return r="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),e?e.concat(r):r},Cipher.prototype._pad=function(t,e){if(0===e)return!1;for(;e<t.length;)t[e++]=0;return!0},Cipher.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var t=new Array(this.blockSize);return this._update(this.buffer,0,t,0),t},Cipher.prototype._unpad=function(t){return t},Cipher.prototype._finalDecrypt=function(){assert.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var t=new Array(this.blockSize);return this._flushBuffer(t,0),this._unpad(t)};
},{"minimalistic-assert":103}],60:[function(require,module,exports){
"use strict";function DESState(){this.tmp=new Array(2),this.keys=null}function DES(t){Cipher.call(this,t);var e=new DESState;this._desState=e,this.deriveKeys(e,t.key)}var assert=require("minimalistic-assert"),inherits=require("inherits"),des=require("../des"),utils=des.utils,Cipher=des.Cipher;inherits(DES,Cipher),module.exports=DES,DES.create=function(t){return new DES(t)};var shiftTable=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];DES.prototype.deriveKeys=function(t,e){t.keys=new Array(32),assert.equal(e.length,this.blockSize,"Invalid key length");var r=utils.readUInt32BE(e,0),s=utils.readUInt32BE(e,4);utils.pc1(r,s,t.tmp,0),r=t.tmp[0],s=t.tmp[1];for(var i=0;i<t.keys.length;i+=2){var n=shiftTable[i>>>1];r=utils.r28shl(r,n),s=utils.r28shl(s,n),utils.pc2(r,s,t.keys,i)}},DES.prototype._update=function(t,e,r,s){var i=this._desState,n=utils.readUInt32BE(t,e),p=utils.readUInt32BE(t,e+4);utils.ip(n,p,i.tmp,0),n=i.tmp[0],p=i.tmp[1],"encrypt"===this.type?this._encrypt(i,n,p,i.tmp,0):this._decrypt(i,n,p,i.tmp,0),n=i.tmp[0],p=i.tmp[1],utils.writeUInt32BE(r,n,s),utils.writeUInt32BE(r,p,s+4)},DES.prototype._pad=function(t,e){for(var r=t.length-e,s=e;s<t.length;s++)t[s]=r;return!0},DES.prototype._unpad=function(t){for(var e=t[t.length-1],r=t.length-e;r<t.length;r++)assert.equal(t[r],e);return t.slice(0,t.length-e)},DES.prototype._encrypt=function(t,e,r,s,i){for(var n=e,p=r,u=0;u<t.keys.length;u+=2){var l=t.keys[u],a=t.keys[u+1];utils.expand(p,t.tmp,0),l^=t.tmp[0],a^=t.tmp[1];var h=utils.substitute(l,a),o=utils.permute(h),y=p;p=(n^o)>>>0,n=y}utils.rip(p,n,s,i)},DES.prototype._decrypt=function(t,e,r,s,i){for(var n=r,p=e,u=t.keys.length-2;u>=0;u-=2){var l=t.keys[u],a=t.keys[u+1];utils.expand(n,t.tmp,0),l^=t.tmp[0],a^=t.tmp[1];var h=utils.substitute(l,a),o=utils.permute(h),y=n;n=(p^o)>>>0,p=y}utils.rip(n,p,s,i)};
},{"../des":57,"inherits":97,"minimalistic-assert":103}],61:[function(require,module,exports){
"use strict";function EDEState(e,t){assert.equal(t.length,24,"Invalid key length");var r=t.slice(0,8),p=t.slice(8,16),i=t.slice(16,24);"encrypt"===e?this.ciphers=[DES.create({type:"encrypt",key:r}),DES.create({type:"decrypt",key:p}),DES.create({type:"encrypt",key:i})]:this.ciphers=[DES.create({type:"decrypt",key:i}),DES.create({type:"encrypt",key:p}),DES.create({type:"decrypt",key:r})]}function EDE(e){Cipher.call(this,e);var t=new EDEState(this.type,this.options.key);this._edeState=t}var assert=require("minimalistic-assert"),inherits=require("inherits"),des=require("../des"),Cipher=des.Cipher,DES=des.DES;inherits(EDE,Cipher),module.exports=EDE,EDE.create=function(e){return new EDE(e)},EDE.prototype._update=function(e,t,r,p){var i=this._edeState;i.ciphers[0]._update(e,t,r,p),i.ciphers[1]._update(r,p,r,p),i.ciphers[2]._update(r,p,r,p)},EDE.prototype._pad=DES.prototype._pad,EDE.prototype._unpad=DES.prototype._unpad;
},{"../des":57,"inherits":97,"minimalistic-assert":103}],62:[function(require,module,exports){
"use strict";exports.readUInt32BE=function(r,o){var t=r[0+o]<<24|r[1+o]<<16|r[2+o]<<8|r[3+o];return t>>>0},exports.writeUInt32BE=function(r,o,t){r[0+t]=o>>>24,r[1+t]=o>>>16&255,r[2+t]=o>>>8&255,r[3+t]=255&o},exports.ip=function(r,o,t,a){for(var e=0,f=0,n=6;n>=0;n-=2){for(var v=0;v<=24;v+=8)e<<=1,e|=o>>>v+n&1;for(var v=0;v<=24;v+=8)e<<=1,e|=r>>>v+n&1}for(var n=6;n>=0;n-=2){for(var v=1;v<=25;v+=8)f<<=1,f|=o>>>v+n&1;for(var v=1;v<=25;v+=8)f<<=1,f|=r>>>v+n&1}t[a+0]=e>>>0,t[a+1]=f>>>0},exports.rip=function(r,o,t,a){for(var e=0,f=0,n=0;n<4;n++)for(var v=24;v>=0;v-=8)e<<=1,e|=o>>>v+n&1,e<<=1,e|=r>>>v+n&1;for(var n=4;n<8;n++)for(var v=24;v>=0;v-=8)f<<=1,f|=o>>>v+n&1,f<<=1,f|=r>>>v+n&1;t[a+0]=e>>>0,t[a+1]=f>>>0},exports.pc1=function(r,o,t,a){for(var e=0,f=0,n=7;n>=5;n--){for(var v=0;v<=24;v+=8)e<<=1,e|=o>>v+n&1;for(var v=0;v<=24;v+=8)e<<=1,e|=r>>v+n&1}for(var v=0;v<=24;v+=8)e<<=1,e|=o>>v+n&1;for(var n=1;n<=3;n++){for(var v=0;v<=24;v+=8)f<<=1,f|=o>>v+n&1;for(var v=0;v<=24;v+=8)f<<=1,f|=r>>v+n&1}for(var v=0;v<=24;v+=8)f<<=1,f|=r>>v+n&1;t[a+0]=e>>>0,t[a+1]=f>>>0},exports.r28shl=function(r,o){return r<<o&268435455|r>>>28-o};var pc2table=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];exports.pc2=function(r,o,t,a){for(var e=0,f=0,n=pc2table.length>>>1,v=0;v<n;v++)e<<=1,e|=r>>>pc2table[v]&1;for(var v=n;v<pc2table.length;v++)f<<=1,f|=o>>>pc2table[v]&1;t[a+0]=e>>>0,t[a+1]=f>>>0},exports.expand=function(r,o,t){var a=0,e=0;a=(1&r)<<5|r>>>27;for(var f=23;f>=15;f-=4)a<<=6,a|=r>>>f&63;for(var f=11;f>=3;f-=4)e|=r>>>f&63,e<<=6;e|=(31&r)<<1|r>>>31,o[t+0]=a>>>0,o[t+1]=e>>>0};var sTable=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];exports.substitute=function(r,o){for(var t=0,a=0;a<4;a++){var e=r>>>18-6*a&63,f=sTable[64*a+e];t<<=4,t|=f}for(var a=0;a<4;a++){var e=o>>>18-6*a&63,f=sTable[256+64*a+e];t<<=4,t|=f}return t>>>0};var permuteTable=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];exports.permute=function(r){for(var o=0,t=0;t<permuteTable.length;t++)o<<=1,o|=r>>>permuteTable[t]&1;return o>>>0},exports.padSplit=function(r,o,t){for(var a=r.toString(2);a.length<o;)a="0"+a;for(var e=[],f=0;f<o;f+=t)e.push(a.slice(f,f+t));return e.join(" ")};
},{}],63:[function(require,module,exports){
(function (Buffer){
function getDiffieHellman(e){var r=new Buffer(primes[e].prime,"hex"),f=new Buffer(primes[e].gen,"hex");return new DH(r,f)}function createDiffieHellman(e,r,f,i){return Buffer.isBuffer(r)||void 0===ENCODINGS[r]?createDiffieHellman(e,"binary",r,f):(r=r||"binary",i=i||"binary",f=f||new Buffer([2]),Buffer.isBuffer(f)||(f=new Buffer(f,i)),"number"==typeof e?new DH(generatePrime(e,f),f,!0):(Buffer.isBuffer(e)||(e=new Buffer(e,r)),new DH(e,f,!0)))}var generatePrime=require("./lib/generatePrime"),primes=require("./lib/primes.json"),DH=require("./lib/dh"),ENCODINGS={binary:!0,hex:!0,base64:!0};exports.DiffieHellmanGroup=exports.createDiffieHellmanGroup=exports.getDiffieHellman=getDiffieHellman,exports.createDiffieHellman=exports.DiffieHellman=createDiffieHellman;
}).call(this,require("buffer").Buffer)

},{"./lib/dh":64,"./lib/generatePrime":65,"./lib/primes.json":66,"buffer":47}],64:[function(require,module,exports){
(function (Buffer){
function setPublicKey(e,r){return r=r||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,r)),this._pub=new BN(e),this}function setPrivateKey(e,r){return r=r||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,r)),this._priv=new BN(e),this}function checkPrime(e,r){var t=r.toString("hex"),i=[t,e.toString(16)].join("_");if(i in primeCache)return primeCache[i];var n=0;if(e.isEven()||!primes.simpleSieve||!primes.fermatTest(e)||!millerRabin.test(e))return n+=1,n+="02"===t||"05"===t?8:4,primeCache[i]=n,n;millerRabin.test(e.shrn(1))||(n+=2);var u;switch(t){case"02":e.mod(TWENTYFOUR).cmp(ELEVEN)&&(n+=8);break;case"05":u=e.mod(TEN),u.cmp(THREE)&&u.cmp(SEVEN)&&(n+=8);break;default:n+=4}return primeCache[i]=n,n}function DH(e,r,t){this.setGenerator(r),this.__prime=new BN(e),this._prime=BN.mont(this.__prime),this._primeLen=e.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,t?(this.setPublicKey=setPublicKey,this.setPrivateKey=setPrivateKey):this._primeCode=8}function formatReturnValue(e,r){var t=new Buffer(e.toArray());return r?t.toString(r):t}var BN=require("bn.js"),MillerRabin=require("miller-rabin"),millerRabin=new MillerRabin,TWENTYFOUR=new BN(24),ELEVEN=new BN(11),TEN=new BN(10),THREE=new BN(3),SEVEN=new BN(7),primes=require("./generatePrime"),randomBytes=require("randombytes");module.exports=DH;var primeCache={};Object.defineProperty(DH.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=checkPrime(this.__prime,this.__gen)),this._primeCode}}),DH.prototype.generateKeys=function(){return this._priv||(this._priv=new BN(randomBytes(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},DH.prototype.computeSecret=function(e){e=new BN(e),e=e.toRed(this._prime);var r=e.redPow(this._priv).fromRed(),t=new Buffer(r.toArray()),i=this.getPrime();if(t.length<i.length){var n=new Buffer(i.length-t.length);n.fill(0),t=Buffer.concat([n,t])}return t},DH.prototype.getPublicKey=function(e){return formatReturnValue(this._pub,e)},DH.prototype.getPrivateKey=function(e){return formatReturnValue(this._priv,e)},DH.prototype.getPrime=function(e){return formatReturnValue(this.__prime,e)},DH.prototype.getGenerator=function(e){return formatReturnValue(this._gen,e)},DH.prototype.setGenerator=function(e,r){return r=r||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,r)),this.__gen=e,this._gen=new BN(e),this};
}).call(this,require("buffer").Buffer)

},{"./generatePrime":65,"bn.js":17,"buffer":47,"miller-rabin":102,"randombytes":131}],65:[function(require,module,exports){
function _getPrimes(){if(null!==primes)return primes;var e=1048576,r=[];r[0]=2;for(var i=1,n=3;n<e;n+=2){for(var t=Math.ceil(Math.sqrt(n)),m=0;m<i&&r[m]<=t&&n%r[m]!==0;m++);i!==m&&r[m]<=t||(r[i++]=n)}return primes=r,r}function simpleSieve(e){for(var r=_getPrimes(),i=0;i<r.length;i++)if(0===e.modn(r[i]))return 0===e.cmpn(r[i]);return!0}function fermatTest(e){var r=BN.mont(e);return 0===TWO.toRed(r).redPow(e.subn(1)).fromRed().cmpn(1)}function findPrime(e,r){if(e<16)return new BN(2===r||5===r?[140,123]:[140,39]);r=new BN(r);for(var i,n;;){for(i=new BN(randomBytes(Math.ceil(e/8)));i.bitLength()>e;)i.ishrn(1);if(i.isEven()&&i.iadd(ONE),i.testn(1)||i.iadd(TWO),r.cmp(TWO)){if(!r.cmp(FIVE))for(;i.mod(TEN).cmp(THREE);)i.iadd(FOUR)}else for(;i.mod(TWENTYFOUR).cmp(ELEVEN);)i.iadd(FOUR);if(n=i.shrn(1),simpleSieve(n)&&simpleSieve(i)&&fermatTest(n)&&fermatTest(i)&&millerRabin.test(n)&&millerRabin.test(i))return i}}var randomBytes=require("randombytes");module.exports=findPrime,findPrime.simpleSieve=simpleSieve,findPrime.fermatTest=fermatTest;var BN=require("bn.js"),TWENTYFOUR=new BN(24),MillerRabin=require("miller-rabin"),millerRabin=new MillerRabin,ONE=new BN(1),TWO=new BN(2),FIVE=new BN(5),SIXTEEN=new BN(16),EIGHT=new BN(8),TEN=new BN(10),THREE=new BN(3),SEVEN=new BN(7),ELEVEN=new BN(11),FOUR=new BN(4),TWELVE=new BN(12),primes=null;
},{"bn.js":17,"miller-rabin":102,"randombytes":131}],66:[function(require,module,exports){
module.exports={"modp1":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},"modp2":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},"modp5":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},"modp14":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},"modp15":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},"modp16":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},"modp17":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},"modp18":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}
},{}],67:[function(require,module,exports){
"use strict";var elliptic=exports;elliptic.version=require("../package.json").version,elliptic.utils=require("./elliptic/utils"),elliptic.rand=require("brorand"),elliptic.hmacDRBG=require("./elliptic/hmac-drbg"),elliptic.curve=require("./elliptic/curve"),elliptic.curves=require("./elliptic/curves"),elliptic.ec=require("./elliptic/ec"),elliptic.eddsa=require("./elliptic/eddsa");
},{"../package.json":83,"./elliptic/curve":70,"./elliptic/curves":73,"./elliptic/ec":74,"./elliptic/eddsa":77,"./elliptic/hmac-drbg":80,"./elliptic/utils":82,"brorand":18}],68:[function(require,module,exports){
"use strict";function BaseCurve(t,e){this.type=t,this.p=new BN(e.p,16),this.red=e.prime?BN.red(e.prime):BN.mont(this.p),this.zero=new BN(0).toRed(this.red),this.one=new BN(1).toRed(this.red),this.two=new BN(2).toRed(this.red),this.n=e.n&&new BN(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4);var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function BasePoint(t,e){this.curve=t,this.type=e,this.precomputed=null}var BN=require("bn.js"),elliptic=require("../../elliptic"),utils=elliptic.utils,getNAF=utils.getNAF,getJSF=utils.getJSF,assert=utils.assert;module.exports=BaseCurve,BaseCurve.prototype.point=function(){throw new Error("Not implemented")},BaseCurve.prototype.validate=function(){throw new Error("Not implemented")},BaseCurve.prototype._fixedNafMul=function(t,e){assert(t.precomputed);var r=t._getDoubles(),n=getNAF(e,1),i=(1<<r.step+1)-(r.step%2===0?2:1);i/=3;for(var o=[],s=0;s<n.length;s+=r.step){for(var a=0,e=s+r.step-1;e>=s;e--)a=(a<<1)+n[e];o.push(a)}for(var p=this.jpoint(null,null,null),u=this.jpoint(null,null,null),d=i;d>0;d--){for(var s=0;s<o.length;s++){var a=o[s];a===d?u=u.mixedAdd(r.points[s]):a===-d&&(u=u.mixedAdd(r.points[s].neg()))}p=p.add(u)}return p.toP()},BaseCurve.prototype._wnafMul=function(t,e){var r=4,n=t._getNAFPoints(r);r=n.wnd;for(var i=n.points,o=getNAF(e,r),s=this.jpoint(null,null,null),a=o.length-1;a>=0;a--){for(var e=0;a>=0&&0===o[a];a--)e++;if(a>=0&&e++,s=s.dblp(e),a<0)break;var p=o[a];assert(0!==p),s="affine"===t.type?p>0?s.mixedAdd(i[p-1>>1]):s.mixedAdd(i[-p-1>>1].neg()):p>0?s.add(i[p-1>>1]):s.add(i[-p-1>>1].neg())}return"affine"===t.type?s.toP():s},BaseCurve.prototype._wnafMulAdd=function(t,e,r,n,i){for(var o=this._wnafT1,s=this._wnafT2,a=this._wnafT3,p=0,u=0;u<n;u++){var d=e[u],l=d._getNAFPoints(t);o[u]=l.wnd,s[u]=l.points}for(var u=n-1;u>=1;u-=2){var h=u-1,f=u;if(1===o[h]&&1===o[f]){var c=[e[h],null,null,e[f]];0===e[h].y.cmp(e[f].y)?(c[1]=e[h].add(e[f]),c[2]=e[h].toJ().mixedAdd(e[f].neg())):0===e[h].y.cmp(e[f].y.redNeg())?(c[1]=e[h].toJ().mixedAdd(e[f]),c[2]=e[h].add(e[f].neg())):(c[1]=e[h].toJ().mixedAdd(e[f]),c[2]=e[h].toJ().mixedAdd(e[f].neg()));var v=[-3,-1,-5,-7,0,7,5,1,3],g=getJSF(r[h],r[f]);p=Math.max(g[0].length,p),a[h]=new Array(p),a[f]=new Array(p);for(var m=0;m<p;m++){var y=0|g[0][m],w=0|g[1][m];a[h][m]=v[3*(y+1)+(w+1)],a[f][m]=0,s[h]=c}}else a[h]=getNAF(r[h],o[h]),a[f]=getNAF(r[f],o[f]),p=Math.max(a[h].length,p),p=Math.max(a[f].length,p)}for(var B=this.jpoint(null,null,null),A=this._wnafT4,u=p;u>=0;u--){for(var b=0;u>=0;){for(var N=!0,m=0;m<n;m++)A[m]=0|a[m][u],0!==A[m]&&(N=!1);if(!N)break;b++,u--}if(u>=0&&b++,B=B.dblp(b),u<0)break;for(var m=0;m<n;m++){var d,_=A[m];0!==_&&(_>0?d=s[m][_-1>>1]:_<0&&(d=s[m][-_-1>>1].neg()),B="affine"===d.type?B.mixedAdd(d):B.add(d))}}for(var u=0;u<n;u++)s[u]=null;return i?B:B.toP()},BaseCurve.BasePoint=BasePoint,BasePoint.prototype.eq=function(){throw new Error("Not implemented")},BasePoint.prototype.validate=function(){return this.curve.validate(this)},BaseCurve.prototype.decodePoint=function(t,e){t=utils.toArray(t,e);var r=this.p.byteLength();if((4===t[0]||6===t[0]||7===t[0])&&t.length-1===2*r){6===t[0]?assert(t[t.length-1]%2===0):7===t[0]&&assert(t[t.length-1]%2===1);var n=this.point(t.slice(1,1+r),t.slice(1+r,1+2*r));return n}if((2===t[0]||3===t[0])&&t.length-1===r)return this.pointFromX(t.slice(1,1+r),3===t[0]);throw new Error("Unknown point format")},BasePoint.prototype.encodeCompressed=function(t){return this.encode(t,!0)},BasePoint.prototype._encode=function(t){var e=this.curve.p.byteLength(),r=this.getX().toArray("be",e);return t?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",e))},BasePoint.prototype.encode=function(t,e){return utils.encode(this._encode(e),t)},BasePoint.prototype.precompute=function(t){if(this.precomputed)return this;var e={doubles:null,naf:null,beta:null};return e.naf=this._getNAFPoints(8),e.doubles=this._getDoubles(4,t),e.beta=this._getBeta(),this.precomputed=e,this},BasePoint.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var e=this.precomputed.doubles;return!!e&&e.points.length>=Math.ceil((t.bitLength()+1)/e.step)},BasePoint.prototype._getDoubles=function(t,e){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],n=this,i=0;i<e;i+=t){for(var o=0;o<t;o++)n=n.dbl();r.push(n)}return{step:t,points:r}},BasePoint.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var e=[this],r=(1<<t)-1,n=1===r?null:this.dbl(),i=1;i<r;i++)e[i]=e[i-1].add(n);return{wnd:t,points:e}},BasePoint.prototype._getBeta=function(){return null},BasePoint.prototype.dblp=function(t){for(var e=this,r=0;r<t;r++)e=e.dbl();return e};
},{"../../elliptic":67,"bn.js":17}],69:[function(require,module,exports){
"use strict";function EdwardsCurve(t){this.twisted=1!==(0|t.a),this.mOneA=this.twisted&&(0|t.a)===-1,this.extended=this.mOneA,Base.call(this,"edwards",t),this.a=new BN(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new BN(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new BN(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),assert(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1===(0|t.c)}function Point(t,r,e,i,d){Base.BasePoint.call(this,t,"projective"),null===r&&null===e&&null===i?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new BN(r,16),this.y=new BN(e,16),this.z=i?new BN(i,16):this.curve.one,this.t=d&&new BN(d,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}var curve=require("../curve"),elliptic=require("../../elliptic"),BN=require("bn.js"),inherits=require("inherits"),Base=curve.base,assert=elliptic.utils.assert;inherits(EdwardsCurve,Base),module.exports=EdwardsCurve,EdwardsCurve.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)},EdwardsCurve.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)},EdwardsCurve.prototype.jpoint=function(t,r,e,i){return this.point(t,r,e,i)},EdwardsCurve.prototype.pointFromX=function(t,r){t=new BN(t,16),t.red||(t=t.toRed(this.red));var e=t.redSqr(),i=this.c2.redSub(this.a.redMul(e)),d=this.one.redSub(this.c2.redMul(this.d).redMul(e)),s=i.redMul(d.redInvm()),u=s.redSqrt();if(0!==u.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");var n=u.fromRed().isOdd();return(r&&!n||!r&&n)&&(u=u.redNeg()),this.point(t,u)},EdwardsCurve.prototype.pointFromY=function(t,r){t=new BN(t,16),t.red||(t=t.toRed(this.red));var e=t.redSqr(),i=e.redSub(this.one),d=e.redMul(this.d).redAdd(this.one),s=i.redMul(d.redInvm());if(0===s.cmp(this.zero)){if(r)throw new Error("invalid point");return this.point(this.zero,t)}var u=s.redSqrt();if(0!==u.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");return u.isOdd()!==r&&(u=u.redNeg()),this.point(u,t)},EdwardsCurve.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var r=t.x.redSqr(),e=t.y.redSqr(),i=r.redMul(this.a).redAdd(e),d=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(e)));return 0===i.cmp(d)},inherits(Point,Base.BasePoint),EdwardsCurve.prototype.pointFromJSON=function(t){return Point.fromJSON(this,t)},EdwardsCurve.prototype.point=function(t,r,e,i){return new Point(this,t,r,e,i)},Point.fromJSON=function(t,r){return new Point(t,r[0],r[1],r[2])},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&0===this.y.cmp(this.z)},Point.prototype._extDbl=function(){var t=this.x.redSqr(),r=this.y.redSqr(),e=this.z.redSqr();e=e.redIAdd(e);var i=this.curve._mulA(t),d=this.x.redAdd(this.y).redSqr().redISub(t).redISub(r),s=i.redAdd(r),u=s.redSub(e),n=i.redSub(r),h=d.redMul(u),o=s.redMul(n),l=d.redMul(n),c=u.redMul(s);return this.curve.point(h,o,c,l)},Point.prototype._projDbl=function(){var t,r,e,i=this.x.redAdd(this.y).redSqr(),d=this.x.redSqr(),s=this.y.redSqr();if(this.curve.twisted){var u=this.curve._mulA(d),n=u.redAdd(s);if(this.zOne)t=i.redSub(d).redSub(s).redMul(n.redSub(this.curve.two)),r=n.redMul(u.redSub(s)),e=n.redSqr().redSub(n).redSub(n);else{var h=this.z.redSqr(),o=n.redSub(h).redISub(h);t=i.redSub(d).redISub(s).redMul(o),r=n.redMul(u.redSub(s)),e=n.redMul(o)}}else{var u=d.redAdd(s),h=this.curve._mulC(this.c.redMul(this.z)).redSqr(),o=u.redSub(h).redSub(h);t=this.curve._mulC(i.redISub(u)).redMul(o),r=this.curve._mulC(u).redMul(d.redISub(s)),e=u.redMul(o)}return this.curve.point(t,r,e)},Point.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},Point.prototype._extAdd=function(t){var r=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),e=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),i=this.t.redMul(this.curve.dd).redMul(t.t),d=this.z.redMul(t.z.redAdd(t.z)),s=e.redSub(r),u=d.redSub(i),n=d.redAdd(i),h=e.redAdd(r),o=s.redMul(u),l=n.redMul(h),c=s.redMul(h),p=u.redMul(n);return this.curve.point(o,l,p,c)},Point.prototype._projAdd=function(t){var r,e,i=this.z.redMul(t.z),d=i.redSqr(),s=this.x.redMul(t.x),u=this.y.redMul(t.y),n=this.curve.d.redMul(s).redMul(u),h=d.redSub(n),o=d.redAdd(n),l=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(s).redISub(u),c=i.redMul(h).redMul(l);return this.curve.twisted?(r=i.redMul(o).redMul(u.redSub(this.curve._mulA(s))),e=h.redMul(o)):(r=i.redMul(o).redMul(u.redSub(s)),e=this.curve._mulC(h).redMul(o)),this.curve.point(c,r,e)},Point.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)},Point.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)},Point.prototype.mulAdd=function(t,r,e){return this.curve._wnafMulAdd(1,[this,r],[t,e],2,!1)},Point.prototype.jmulAdd=function(t,r,e){return this.curve._wnafMulAdd(1,[this,r],[t,e],2,!0)},Point.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this},Point.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},Point.prototype.getX=function(){return this.normalize(),this.x.fromRed()},Point.prototype.getY=function(){return this.normalize(),this.y.fromRed()},Point.prototype.eq=function(t){return this===t||0===this.getX().cmp(t.getX())&&0===this.getY().cmp(t.getY())},Point.prototype.eqXToP=function(t){var r=t.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(r))return!0;for(var e=t.clone(),i=this.curve.redN.redMul(this.z);;){if(e.iadd(this.curve.n),e.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),0===this.x.cmp(r))return!0}return!1},Point.prototype.toP=Point.prototype.normalize,Point.prototype.mixedAdd=Point.prototype.add;
},{"../../elliptic":67,"../curve":70,"bn.js":17,"inherits":97}],70:[function(require,module,exports){
"use strict";var curve=exports;curve.base=require("./base"),curve.short=require("./short"),curve.mont=require("./mont"),curve.edwards=require("./edwards");
},{"./base":68,"./edwards":69,"./mont":71,"./short":72}],71:[function(require,module,exports){
"use strict";function MontCurve(t){Base.call(this,"mont",t),this.a=new BN(t.a,16).toRed(this.red),this.b=new BN(t.b,16).toRed(this.red),this.i4=new BN(4).toRed(this.red).redInvm(),this.two=new BN(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function Point(t,r,e){Base.BasePoint.call(this,t,"projective"),null===r&&null===e?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new BN(r,16),this.z=new BN(e,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}var curve=require("../curve"),BN=require("bn.js"),inherits=require("inherits"),Base=curve.base,elliptic=require("../../elliptic"),utils=elliptic.utils;inherits(MontCurve,Base),module.exports=MontCurve,MontCurve.prototype.validate=function(t){var r=t.normalize().x,e=r.redSqr(),i=e.redMul(r).redAdd(e.redMul(this.a)).redAdd(r),o=i.redSqrt();return 0===o.redSqr().cmp(i)},inherits(Point,Base.BasePoint),MontCurve.prototype.decodePoint=function(t,r){return this.point(utils.toArray(t,r),1)},MontCurve.prototype.point=function(t,r){return new Point(this,t,r)},MontCurve.prototype.pointFromJSON=function(t){return Point.fromJSON(this,t)},Point.prototype.precompute=function(){},Point.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},Point.fromJSON=function(t,r){return new Point(t,r[0],r[1]||t.one)},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},Point.prototype.dbl=function(){var t=this.x.redAdd(this.z),r=t.redSqr(),e=this.x.redSub(this.z),i=e.redSqr(),o=r.redSub(i),n=r.redMul(i),u=o.redMul(i.redAdd(this.curve.a24.redMul(o)));return this.curve.point(n,u)},Point.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},Point.prototype.diffAdd=function(t,r){var e=this.x.redAdd(this.z),i=this.x.redSub(this.z),o=t.x.redAdd(t.z),n=t.x.redSub(t.z),u=n.redMul(e),d=o.redMul(i),s=r.z.redMul(u.redAdd(d).redSqr()),h=r.x.redMul(u.redISub(d).redSqr());return this.curve.point(s,h)},Point.prototype.mul=function(t){for(var r=t.clone(),e=this,i=this.curve.point(null,null),o=this,n=[];0!==r.cmpn(0);r.iushrn(1))n.push(r.andln(1));for(var u=n.length-1;u>=0;u--)0===n[u]?(e=e.diffAdd(i,o),i=i.dbl()):(i=e.diffAdd(i,o),e=e.dbl());return i},Point.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},Point.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},Point.prototype.eq=function(t){return 0===this.getX().cmp(t.getX())},Point.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},Point.prototype.getX=function(){return this.normalize(),this.x.fromRed()};
},{"../../elliptic":67,"../curve":70,"bn.js":17,"inherits":97}],72:[function(require,module,exports){
"use strict";function ShortCurve(r){Base.call(this,"short",r),this.a=new BN(r.a,16).toRed(this.red),this.b=new BN(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function Point(r,e,t,d){Base.BasePoint.call(this,r,"affine"),null===e&&null===t?(this.x=null,this.y=null,this.inf=!0):(this.x=new BN(e,16),this.y=new BN(t,16),d&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function JPoint(r,e,t,d){Base.BasePoint.call(this,r,"jacobian"),null===e&&null===t&&null===d?(this.x=this.curve.one,this.y=this.curve.one,this.z=new BN(0)):(this.x=new BN(e,16),this.y=new BN(t,16),this.z=new BN(d,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}var curve=require("../curve"),elliptic=require("../../elliptic"),BN=require("bn.js"),inherits=require("inherits"),Base=curve.base,assert=elliptic.utils.assert;inherits(ShortCurve,Base),module.exports=ShortCurve,ShortCurve.prototype._getEndomorphism=function(r){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var e,t;if(r.beta)e=new BN(r.beta,16).toRed(this.red);else{var d=this._getEndoRoots(this.p);e=d[0].cmp(d[1])<0?d[0]:d[1],e=e.toRed(this.red)}if(r.lambda)t=new BN(r.lambda,16);else{var i=this._getEndoRoots(this.n);0===this.g.mul(i[0]).x.cmp(this.g.x.redMul(e))?t=i[0]:(t=i[1],assert(0===this.g.mul(t).x.cmp(this.g.x.redMul(e))))}var n;return n=r.basis?r.basis.map(function(r){return{a:new BN(r.a,16),b:new BN(r.b,16)}}):this._getEndoBasis(t),{beta:e,lambda:t,basis:n}}},ShortCurve.prototype._getEndoRoots=function(r){var e=r===this.p?this.red:BN.mont(r),t=new BN(2).toRed(e).redInvm(),d=t.redNeg(),i=new BN(3).toRed(e).redNeg().redSqrt().redMul(t),n=d.redAdd(i).fromRed(),u=d.redSub(i).fromRed();return[n,u]},ShortCurve.prototype._getEndoBasis=function(r){for(var e,t,d,i,n,u,s,o,h,l=this.n.ushrn(Math.floor(this.n.bitLength()/2)),p=r,a=this.n.clone(),c=new BN(1),f=new BN(0),v=new BN(0),S=new BN(1),b=0;0!==p.cmpn(0);){var I=a.div(p);o=a.sub(I.mul(p)),h=v.sub(I.mul(c));var y=S.sub(I.mul(f));if(!d&&o.cmp(l)<0)e=s.neg(),t=c,d=o.neg(),i=h;else if(d&&2===++b)break;s=o,a=p,p=o,v=c,c=h,S=f,f=y}n=o.neg(),u=h;var A=d.sqr().add(i.sqr()),m=n.sqr().add(u.sqr());return m.cmp(A)>=0&&(n=e,u=t),d.negative&&(d=d.neg(),i=i.neg()),n.negative&&(n=n.neg(),u=u.neg()),[{a:d,b:i},{a:n,b:u}]},ShortCurve.prototype._endoSplit=function(r){var e=this.endo.basis,t=e[0],d=e[1],i=d.b.mul(r).divRound(this.n),n=t.b.neg().mul(r).divRound(this.n),u=i.mul(t.a),s=n.mul(d.a),o=i.mul(t.b),h=n.mul(d.b),l=r.sub(u).sub(s),p=o.add(h).neg();return{k1:l,k2:p}},ShortCurve.prototype.pointFromX=function(r,e){r=new BN(r,16),r.red||(r=r.toRed(this.red));var t=r.redSqr().redMul(r).redIAdd(r.redMul(this.a)).redIAdd(this.b),d=t.redSqrt();if(0!==d.redSqr().redSub(t).cmp(this.zero))throw new Error("invalid point");var i=d.fromRed().isOdd();return(e&&!i||!e&&i)&&(d=d.redNeg()),this.point(r,d)},ShortCurve.prototype.validate=function(r){if(r.inf)return!0;var e=r.x,t=r.y,d=this.a.redMul(e),i=e.redSqr().redMul(e).redIAdd(d).redIAdd(this.b);return 0===t.redSqr().redISub(i).cmpn(0)},ShortCurve.prototype._endoWnafMulAdd=function(r,e,t){for(var d=this._endoWnafT1,i=this._endoWnafT2,n=0;n<r.length;n++){var u=this._endoSplit(e[n]),s=r[n],o=s._getBeta();u.k1.negative&&(u.k1.ineg(),s=s.neg(!0)),u.k2.negative&&(u.k2.ineg(),o=o.neg(!0)),d[2*n]=s,d[2*n+1]=o,i[2*n]=u.k1,i[2*n+1]=u.k2}for(var h=this._wnafMulAdd(1,d,i,2*n,t),l=0;l<2*n;l++)d[l]=null,i[l]=null;return h},inherits(Point,Base.BasePoint),ShortCurve.prototype.point=function(r,e,t){return new Point(this,r,e,t)},ShortCurve.prototype.pointFromJSON=function(r,e){return Point.fromJSON(this,r,e)},Point.prototype._getBeta=function(){if(this.curve.endo){var r=this.precomputed;if(r&&r.beta)return r.beta;var e=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(r){var t=this.curve,d=function(r){return t.point(r.x.redMul(t.endo.beta),r.y)};r.beta=e,e.precomputed={beta:null,naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(d)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(d)}}}return e}},Point.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},Point.fromJSON=function(r,e,t){function d(e){return r.point(e[0],e[1],t)}"string"==typeof e&&(e=JSON.parse(e));var i=r.point(e[0],e[1],t);if(!e[2])return i;var n=e[2];return i.precomputed={beta:null,doubles:n.doubles&&{step:n.doubles.step,points:[i].concat(n.doubles.points.map(d))},naf:n.naf&&{wnd:n.naf.wnd,points:[i].concat(n.naf.points.map(d))}},i},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return this.inf},Point.prototype.add=function(r){if(this.inf)return r;if(r.inf)return this;if(this.eq(r))return this.dbl();if(this.neg().eq(r))return this.curve.point(null,null);if(0===this.x.cmp(r.x))return this.curve.point(null,null);var e=this.y.redSub(r.y);0!==e.cmpn(0)&&(e=e.redMul(this.x.redSub(r.x).redInvm()));var t=e.redSqr().redISub(this.x).redISub(r.x),d=e.redMul(this.x.redSub(t)).redISub(this.y);return this.curve.point(t,d)},Point.prototype.dbl=function(){if(this.inf)return this;var r=this.y.redAdd(this.y);if(0===r.cmpn(0))return this.curve.point(null,null);var e=this.curve.a,t=this.x.redSqr(),d=r.redInvm(),i=t.redAdd(t).redIAdd(t).redIAdd(e).redMul(d),n=i.redSqr().redISub(this.x.redAdd(this.x)),u=i.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,u)},Point.prototype.getX=function(){return this.x.fromRed()},Point.prototype.getY=function(){return this.y.fromRed()},Point.prototype.mul=function(r){return r=new BN(r,16),this._hasDoubles(r)?this.curve._fixedNafMul(this,r):this.curve.endo?this.curve._endoWnafMulAdd([this],[r]):this.curve._wnafMul(this,r)},Point.prototype.mulAdd=function(r,e,t){var d=[this,e],i=[r,t];return this.curve.endo?this.curve._endoWnafMulAdd(d,i):this.curve._wnafMulAdd(1,d,i,2)},Point.prototype.jmulAdd=function(r,e,t){var d=[this,e],i=[r,t];return this.curve.endo?this.curve._endoWnafMulAdd(d,i,!0):this.curve._wnafMulAdd(1,d,i,2,!0)},Point.prototype.eq=function(r){return this===r||this.inf===r.inf&&(this.inf||0===this.x.cmp(r.x)&&0===this.y.cmp(r.y))},Point.prototype.neg=function(r){if(this.inf)return this;var e=this.curve.point(this.x,this.y.redNeg());if(r&&this.precomputed){var t=this.precomputed,d=function(r){return r.neg()};e.precomputed={naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(d)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(d)}}}return e},Point.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var r=this.curve.jpoint(this.x,this.y,this.curve.one);return r},inherits(JPoint,Base.BasePoint),ShortCurve.prototype.jpoint=function(r,e,t){return new JPoint(this,r,e,t)},JPoint.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var r=this.z.redInvm(),e=r.redSqr(),t=this.x.redMul(e),d=this.y.redMul(e).redMul(r);return this.curve.point(t,d)},JPoint.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},JPoint.prototype.add=function(r){if(this.isInfinity())return r;if(r.isInfinity())return this;var e=r.z.redSqr(),t=this.z.redSqr(),d=this.x.redMul(e),i=r.x.redMul(t),n=this.y.redMul(e.redMul(r.z)),u=r.y.redMul(t.redMul(this.z)),s=d.redSub(i),o=n.redSub(u);if(0===s.cmpn(0))return 0!==o.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var h=s.redSqr(),l=h.redMul(s),p=d.redMul(h),a=o.redSqr().redIAdd(l).redISub(p).redISub(p),c=o.redMul(p.redISub(a)).redISub(n.redMul(l)),f=this.z.redMul(r.z).redMul(s);return this.curve.jpoint(a,c,f)},JPoint.prototype.mixedAdd=function(r){if(this.isInfinity())return r.toJ();if(r.isInfinity())return this;var e=this.z.redSqr(),t=this.x,d=r.x.redMul(e),i=this.y,n=r.y.redMul(e).redMul(this.z),u=t.redSub(d),s=i.redSub(n);if(0===u.cmpn(0))return 0!==s.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var o=u.redSqr(),h=o.redMul(u),l=t.redMul(o),p=s.redSqr().redIAdd(h).redISub(l).redISub(l),a=s.redMul(l.redISub(p)).redISub(i.redMul(h)),c=this.z.redMul(u);return this.curve.jpoint(p,a,c)},JPoint.prototype.dblp=function(r){if(0===r)return this;if(this.isInfinity())return this;if(!r)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var e=this,t=0;t<r;t++)e=e.dbl();return e}for(var d=this.curve.a,i=this.curve.tinv,n=this.x,u=this.y,s=this.z,o=s.redSqr().redSqr(),h=u.redAdd(u),t=0;t<r;t++){var l=n.redSqr(),p=h.redSqr(),a=p.redSqr(),c=l.redAdd(l).redIAdd(l).redIAdd(d.redMul(o)),f=n.redMul(p),v=c.redSqr().redISub(f.redAdd(f)),S=f.redISub(v),b=c.redMul(S);b=b.redIAdd(b).redISub(a);var I=h.redMul(s);t+1<r&&(o=o.redMul(a)),n=v,s=I,h=b}return this.curve.jpoint(n,h.redMul(i),s)},JPoint.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},JPoint.prototype._zeroDbl=function(){var r,e,t;if(this.zOne){var d=this.x.redSqr(),i=this.y.redSqr(),n=i.redSqr(),u=this.x.redAdd(i).redSqr().redISub(d).redISub(n);u=u.redIAdd(u);var s=d.redAdd(d).redIAdd(d),o=s.redSqr().redISub(u).redISub(u),h=n.redIAdd(n);h=h.redIAdd(h),h=h.redIAdd(h),r=o,e=s.redMul(u.redISub(o)).redISub(h),t=this.y.redAdd(this.y)}else{var l=this.x.redSqr(),p=this.y.redSqr(),a=p.redSqr(),c=this.x.redAdd(p).redSqr().redISub(l).redISub(a);c=c.redIAdd(c);var f=l.redAdd(l).redIAdd(l),v=f.redSqr(),S=a.redIAdd(a);S=S.redIAdd(S),S=S.redIAdd(S),r=v.redISub(c).redISub(c),e=f.redMul(c.redISub(r)).redISub(S),t=this.y.redMul(this.z),t=t.redIAdd(t)}return this.curve.jpoint(r,e,t)},JPoint.prototype._threeDbl=function(){var r,e,t;if(this.zOne){var d=this.x.redSqr(),i=this.y.redSqr(),n=i.redSqr(),u=this.x.redAdd(i).redSqr().redISub(d).redISub(n);u=u.redIAdd(u);var s=d.redAdd(d).redIAdd(d).redIAdd(this.curve.a),o=s.redSqr().redISub(u).redISub(u);r=o;var h=n.redIAdd(n);h=h.redIAdd(h),h=h.redIAdd(h),e=s.redMul(u.redISub(o)).redISub(h),t=this.y.redAdd(this.y)}else{var l=this.z.redSqr(),p=this.y.redSqr(),a=this.x.redMul(p),c=this.x.redSub(l).redMul(this.x.redAdd(l));c=c.redAdd(c).redIAdd(c);var f=a.redIAdd(a);f=f.redIAdd(f);var v=f.redAdd(f);r=c.redSqr().redISub(v),t=this.y.redAdd(this.z).redSqr().redISub(p).redISub(l);var S=p.redSqr();S=S.redIAdd(S),S=S.redIAdd(S),S=S.redIAdd(S),e=c.redMul(f.redISub(r)).redISub(S)}return this.curve.jpoint(r,e,t)},JPoint.prototype._dbl=function(){var r=this.curve.a,e=this.x,t=this.y,d=this.z,i=d.redSqr().redSqr(),n=e.redSqr(),u=t.redSqr(),s=n.redAdd(n).redIAdd(n).redIAdd(r.redMul(i)),o=e.redAdd(e);o=o.redIAdd(o);var h=o.redMul(u),l=s.redSqr().redISub(h.redAdd(h)),p=h.redISub(l),a=u.redSqr();a=a.redIAdd(a),a=a.redIAdd(a),a=a.redIAdd(a);var c=s.redMul(p).redISub(a),f=t.redAdd(t).redMul(d);return this.curve.jpoint(l,c,f)},JPoint.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var r=this.x.redSqr(),e=this.y.redSqr(),t=this.z.redSqr(),d=e.redSqr(),i=r.redAdd(r).redIAdd(r),n=i.redSqr(),u=this.x.redAdd(e).redSqr().redISub(r).redISub(d);u=u.redIAdd(u),u=u.redAdd(u).redIAdd(u),u=u.redISub(n);var s=u.redSqr(),o=d.redIAdd(d);o=o.redIAdd(o),o=o.redIAdd(o),o=o.redIAdd(o);var h=i.redIAdd(u).redSqr().redISub(n).redISub(s).redISub(o),l=e.redMul(h);l=l.redIAdd(l),l=l.redIAdd(l);var p=this.x.redMul(s).redISub(l);p=p.redIAdd(p),p=p.redIAdd(p);var a=this.y.redMul(h.redMul(o.redISub(h)).redISub(u.redMul(s)));a=a.redIAdd(a),a=a.redIAdd(a),a=a.redIAdd(a);var c=this.z.redAdd(u).redSqr().redISub(t).redISub(s);return this.curve.jpoint(p,a,c)},JPoint.prototype.mul=function(r,e){return r=new BN(r,e),this.curve._wnafMul(this,r)},JPoint.prototype.eq=function(r){if("affine"===r.type)return this.eq(r.toJ());if(this===r)return!0;var e=this.z.redSqr(),t=r.z.redSqr();if(0!==this.x.redMul(t).redISub(r.x.redMul(e)).cmpn(0))return!1;var d=e.redMul(this.z),i=t.redMul(r.z);return 0===this.y.redMul(i).redISub(r.y.redMul(d)).cmpn(0)},JPoint.prototype.eqXToP=function(r){var e=this.z.redSqr(),t=r.toRed(this.curve.red).redMul(e);if(0===this.x.cmp(t))return!0;for(var d=r.clone(),i=this.curve.redN.redMul(e);;){if(d.iadd(this.curve.n),d.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(i),0===this.x.cmp(t))return!0}return!1},JPoint.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},JPoint.prototype.isInfinity=function(){return 0===this.z.cmpn(0)};
},{"../../elliptic":67,"../curve":70,"bn.js":17,"inherits":97}],73:[function(require,module,exports){
"use strict";function PresetCurve(f){"short"===f.type?this.curve=new elliptic.curve.short(f):"edwards"===f.type?this.curve=new elliptic.curve.edwards(f):this.curve=new elliptic.curve.mont(f),this.g=this.curve.g,this.n=this.curve.n,this.hash=f.hash,assert(this.g.validate(),"Invalid curve"),assert(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function defineCurve(f,e){Object.defineProperty(curves,f,{configurable:!0,enumerable:!0,get:function(){var a=new PresetCurve(e);return Object.defineProperty(curves,f,{configurable:!0,enumerable:!0,value:a}),a}})}var curves=exports,hash=require("hash.js"),elliptic=require("../elliptic"),assert=elliptic.utils.assert;curves.PresetCurve=PresetCurve,defineCurve("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:hash.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),defineCurve("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:hash.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),defineCurve("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:hash.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),defineCurve("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:hash.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),defineCurve("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:hash.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),defineCurve("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"0",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:hash.sha256,gRed:!1,g:["9"]}),defineCurve("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:hash.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var pre;try{pre=require("./precomputed/secp256k1")}catch(f){pre=void 0}defineCurve("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:hash.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",pre]});
},{"../elliptic":67,"./precomputed/secp256k1":81,"hash.js":88}],74:[function(require,module,exports){
"use strict";function EC(e){return this instanceof EC?("string"==typeof e&&(assert(elliptic.curves.hasOwnProperty(e),"Unknown curve "+e),e=elliptic.curves[e]),e instanceof elliptic.curves.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),void(this.hash=e.hash||e.curve.hash)):new EC(e)}var BN=require("bn.js"),elliptic=require("../../elliptic"),utils=elliptic.utils,assert=utils.assert,KeyPair=require("./key"),Signature=require("./signature");module.exports=EC,EC.prototype.keyPair=function(e){return new KeyPair(this,e)},EC.prototype.keyFromPrivate=function(e,t){return KeyPair.fromPrivate(this,e,t)},EC.prototype.keyFromPublic=function(e,t){return KeyPair.fromPublic(this,e,t)},EC.prototype.genKeyPair=function(e){e||(e={});for(var t=new elliptic.hmacDRBG({hash:this.hash,pers:e.pers,entropy:e.entropy||elliptic.rand(this.hash.hmacStrength),nonce:this.n.toArray()}),r=this.n.byteLength(),i=this.n.sub(new BN(2));;){var n=new BN(t.generate(r));if(!(n.cmp(i)>0))return n.iaddn(1),this.keyFromPrivate(n)}},EC.prototype._truncateToN=function(e,t){var r=8*e.byteLength()-this.n.bitLength();return r>0&&(e=e.ushrn(r)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},EC.prototype.sign=function(e,t,r,i){"object"==typeof r&&(i=r,r=null),i||(i={}),t=this.keyFromPrivate(t,r),e=this._truncateToN(new BN(e,16));for(var n=this.n.byteLength(),s=t.getPrivate().toArray("be",n),u=e.toArray("be",n),o=new elliptic.hmacDRBG({hash:this.hash,entropy:s,nonce:u,pers:i.pers,persEnc:i.persEnc}),h=this.n.sub(new BN(1)),c=0;!0;c++){var a=i.k?i.k(c):new BN(o.generate(this.n.byteLength()));if(a=this._truncateToN(a,!0),!(a.cmpn(1)<=0||a.cmp(h)>=0)){var p=this.g.mul(a);if(!p.isInfinity()){var v=p.getX(),m=v.umod(this.n);if(0!==m.cmpn(0)){var y=a.invm(this.n).mul(m.mul(t.getPrivate()).iadd(e));if(y=y.umod(this.n),0!==y.cmpn(0)){var l=(p.getY().isOdd()?1:0)|(0!==v.cmp(m)?2:0);return i.canonical&&y.cmp(this.nh)>0&&(y=this.n.sub(y),l^=1),new Signature({r:m,s:y,recoveryParam:l})}}}}}},EC.prototype.verify=function(e,t,r,i){e=this._truncateToN(new BN(e,16)),r=this.keyFromPublic(r,i),t=new Signature(t,"hex");var n=t.r,s=t.s;if(n.cmpn(1)<0||n.cmp(this.n)>=0)return!1;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;var u=s.invm(this.n),o=u.mul(e).umod(this.n),h=u.mul(n).umod(this.n);if(!this.curve._maxwellTrick){var c=this.g.mulAdd(o,r.getPublic(),h);return!c.isInfinity()&&0===c.getX().umod(this.n).cmp(n)}var c=this.g.jmulAdd(o,r.getPublic(),h);return!c.isInfinity()&&c.eqXToP(n)},EC.prototype.recoverPubKey=function(e,t,r,i){assert((3&r)===r,"The recovery param is more than two bits"),t=new Signature(t,i);var n=this.n,s=new BN(e),u=t.r,o=t.s,h=1&r,c=r>>1;if(u.cmp(this.curve.p.umod(this.curve.n))>=0&&c)throw new Error("Unable to find sencond key candinate");u=c?this.curve.pointFromX(u.add(this.curve.n),h):this.curve.pointFromX(u,h);var a=t.r.invm(n),p=n.sub(s).mul(a).umod(n),v=o.mul(a).umod(n);return this.g.mulAdd(p,u,v)},EC.prototype.getKeyRecoveryParam=function(e,t,r,i){if(t=new Signature(t,i),null!==t.recoveryParam)return t.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(e,t,n)}catch(e){continue}if(s.eq(r))return n}throw new Error("Unable to find valid recovery factor")};
},{"../../elliptic":67,"./key":75,"./signature":76,"bn.js":17}],75:[function(require,module,exports){
"use strict";function KeyPair(i,t){this.ec=i,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}var BN=require("bn.js");module.exports=KeyPair,KeyPair.fromPublic=function(i,t,r){return t instanceof KeyPair?t:new KeyPair(i,{pub:t,pubEnc:r})},KeyPair.fromPrivate=function(i,t,r){return t instanceof KeyPair?t:new KeyPair(i,{priv:t,privEnc:r})},KeyPair.prototype.validate=function(){var i=this.getPublic();return i.isInfinity()?{result:!1,reason:"Invalid public key"}:i.validate()?i.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},KeyPair.prototype.getPublic=function(i,t){return"string"==typeof i&&(t=i,i=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,i):this.pub},KeyPair.prototype.getPrivate=function(i){return"hex"===i?this.priv.toString(16,2):this.priv},KeyPair.prototype._importPrivate=function(i,t){this.priv=new BN(i,t||16),this.priv=this.priv.umod(this.ec.curve.n)},KeyPair.prototype._importPublic=function(i,t){return i.x||i.y?void(this.pub=this.ec.curve.point(i.x,i.y)):void(this.pub=this.ec.curve.decodePoint(i,t))},KeyPair.prototype.derive=function(i){return i.mul(this.priv).getX()},KeyPair.prototype.sign=function(i,t,r){return this.ec.sign(i,this,t,r)},KeyPair.prototype.verify=function(i,t){return this.ec.verify(i,t,this)},KeyPair.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};
},{"bn.js":17}],76:[function(require,module,exports){
"use strict";function Signature(t,r){return t instanceof Signature?t:void(this._importDER(t,r)||(assert(t.r&&t.s,"Signature without r or s"),this.r=new BN(t.r,16),this.s=new BN(t.s,16),void 0===t.recoveryParam?this.recoveryParam=null:this.recoveryParam=t.recoveryParam))}function Position(){this.place=0}function getLength(t,r){var e=t[r.place++];if(!(128&e))return e;for(var n=15&e,i=0,a=0,c=r.place;a<n;a++,c++)i<<=8,i|=t[c];return r.place=c,i}function rmPadding(t){for(var r=0,e=t.length-1;!t[r]&&!(128&t[r+1])&&r<e;)r++;return 0===r?t:t.slice(r)}function constructLength(t,r){if(r<128)return void t.push(r);var e=1+(Math.log(r)/Math.LN2>>>3);for(t.push(128|e);--e;)t.push(r>>>(e<<3)&255);t.push(r)}var BN=require("bn.js"),elliptic=require("../../elliptic"),utils=elliptic.utils,assert=utils.assert;module.exports=Signature,Signature.prototype._importDER=function(t,r){t=utils.toArray(t,r);var e=new Position;if(48!==t[e.place++])return!1;var n=getLength(t,e);if(n+e.place!==t.length)return!1;if(2!==t[e.place++])return!1;var i=getLength(t,e),a=t.slice(e.place,i+e.place);if(e.place+=i,2!==t[e.place++])return!1;var c=getLength(t,e);if(t.length!==c+e.place)return!1;var s=t.slice(e.place,c+e.place);return 0===a[0]&&128&a[1]&&(a=a.slice(1)),0===s[0]&&128&s[1]&&(s=s.slice(1)),this.r=new BN(a),this.s=new BN(s),this.recoveryParam=null,!0},Signature.prototype.toDER=function(t){var r=this.r.toArray(),e=this.s.toArray();for(128&r[0]&&(r=[0].concat(r)),128&e[0]&&(e=[0].concat(e)),r=rmPadding(r),e=rmPadding(e);!(e[0]||128&e[1]);)e=e.slice(1);var n=[2];constructLength(n,r.length),n=n.concat(r),n.push(2),constructLength(n,e.length);var i=n.concat(e),a=[48];return constructLength(a,i.length),a=a.concat(i),utils.encode(a,t)};
},{"../../elliptic":67,"bn.js":17}],77:[function(require,module,exports){
"use strict";function EDDSA(t){if(assert("ed25519"===t,"only tested with ed25519 so far"),!(this instanceof EDDSA))return new EDDSA(t);var t=elliptic.curves[t].curve;this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=hash.sha512}var hash=require("hash.js"),elliptic=require("../../elliptic"),utils=elliptic.utils,assert=utils.assert,parseBytes=utils.parseBytes,KeyPair=require("./key"),Signature=require("./signature");module.exports=EDDSA,EDDSA.prototype.sign=function(t,e){t=parseBytes(t);var i=this.keyFromSecret(e),r=this.hashInt(i.messagePrefix(),t),n=this.g.mul(r),s=this.encodePoint(n),o=this.hashInt(s,i.pubBytes(),t).mul(i.priv()),u=r.add(o).umod(this.curve.n);return this.makeSignature({R:n,S:u,Rencoded:s})},EDDSA.prototype.verify=function(t,e,i){t=parseBytes(t),e=this.makeSignature(e);var r=this.keyFromPublic(i),n=this.hashInt(e.Rencoded(),r.pubBytes(),t),s=this.g.mul(e.S()),o=e.R().add(r.pub().mul(n));return o.eq(s)},EDDSA.prototype.hashInt=function(){for(var t=this.hash(),e=0;e<arguments.length;e++)t.update(arguments[e]);return utils.intFromLE(t.digest()).umod(this.curve.n)},EDDSA.prototype.keyFromPublic=function(t){return KeyPair.fromPublic(this,t)},EDDSA.prototype.keyFromSecret=function(t){return KeyPair.fromSecret(this,t)},EDDSA.prototype.makeSignature=function(t){return t instanceof Signature?t:new Signature(this,t)},EDDSA.prototype.encodePoint=function(t){var e=t.getY().toArray("le",this.encodingLength);return e[this.encodingLength-1]|=t.getX().isOdd()?128:0,e},EDDSA.prototype.decodePoint=function(t){t=utils.parseBytes(t);var e=t.length-1,i=t.slice(0,e).concat(t[e]&-129),r=0!==(128&t[e]),n=utils.intFromLE(i);return this.curve.pointFromY(n,r)},EDDSA.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)},EDDSA.prototype.decodeInt=function(t){return utils.intFromLE(t)},EDDSA.prototype.isPoint=function(t){return t instanceof this.pointClass};
},{"../../elliptic":67,"./key":78,"./signature":79,"hash.js":88}],78:[function(require,module,exports){
"use strict";function KeyPair(e,t){this.eddsa=e,this._secret=parseBytes(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=parseBytes(t.pub)}var elliptic=require("../../elliptic"),utils=elliptic.utils,assert=utils.assert,parseBytes=utils.parseBytes,cachedProperty=utils.cachedProperty;KeyPair.fromPublic=function(e,t){return t instanceof KeyPair?t:new KeyPair(e,{pub:t})},KeyPair.fromSecret=function(e,t){return t instanceof KeyPair?t:new KeyPair(e,{secret:t})},KeyPair.prototype.secret=function(){return this._secret},cachedProperty(KeyPair,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),cachedProperty(KeyPair,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),cachedProperty(KeyPair,"privBytes",function(){var e=this.eddsa,t=this.hash(),i=e.encodingLength-1,r=t.slice(0,e.encodingLength);return r[0]&=248,r[i]&=127,r[i]|=64,r}),cachedProperty(KeyPair,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),cachedProperty(KeyPair,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),cachedProperty(KeyPair,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),KeyPair.prototype.sign=function(e){return assert(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},KeyPair.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},KeyPair.prototype.getSecret=function(e){return assert(this._secret,"KeyPair is public only"),utils.encode(this.secret(),e)},KeyPair.prototype.getPublic=function(e){return utils.encode(this.pubBytes(),e)},module.exports=KeyPair;
},{"../../elliptic":67}],79:[function(require,module,exports){
"use strict";function Signature(e,t){this.eddsa=e,"object"!=typeof t&&(t=parseBytes(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),assert(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof BN&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}var BN=require("bn.js"),elliptic=require("../../elliptic"),utils=elliptic.utils,assert=utils.assert,cachedProperty=utils.cachedProperty,parseBytes=utils.parseBytes;cachedProperty(Signature,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),cachedProperty(Signature,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),cachedProperty(Signature,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),cachedProperty(Signature,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),Signature.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},Signature.prototype.toHex=function(){return utils.encode(this.toBytes(),"hex").toUpperCase()},module.exports=Signature;
},{"../../elliptic":67,"bn.js":17}],80:[function(require,module,exports){
"use strict";function HmacDRBG(t){if(!(this instanceof HmacDRBG))return new HmacDRBG(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this.reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=utils.toArray(t.entropy,t.entropyEnc),s=utils.toArray(t.nonce,t.nonceEnc),i=utils.toArray(t.pers,t.persEnc);assert(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,s,i)}var hash=require("hash.js"),elliptic=require("../elliptic"),utils=elliptic.utils,assert=utils.assert;module.exports=HmacDRBG,HmacDRBG.prototype._init=function(t,e,s){var i=t.concat(e).concat(s);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var h=0;h<this.V.length;h++)this.K[h]=0,this.V[h]=1;this._update(i),this.reseed=1,this.reseedInterval=281474976710656},HmacDRBG.prototype._hmac=function(){return new hash.hmac(this.hash,this.K)},HmacDRBG.prototype._update=function(t){var e=this._hmac().update(this.V).update([0]);t&&(e=e.update(t)),this.K=e.digest(),this.V=this._hmac().update(this.V).digest(),t&&(this.K=this._hmac().update(this.V).update([1]).update(t).digest(),this.V=this._hmac().update(this.V).digest())},HmacDRBG.prototype.reseed=function(t,e,s,i){"string"!=typeof e&&(i=s,s=e,e=null),t=utils.toBuffer(t,e),s=utils.toBuffer(s,i),assert(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(t.concat(s||[])),this.reseed=1},HmacDRBG.prototype.generate=function(t,e,s,i){if(this.reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof e&&(i=s,s=e,e=null),s&&(s=utils.toArray(s,i),this._update(s));for(var h=[];h.length<t;)this.V=this._hmac().update(this.V).digest(),h=h.concat(this.V);var r=h.slice(0,t);return this._update(s),this.reseed++,utils.encode(r,e)};
},{"../elliptic":67,"hash.js":88}],81:[function(require,module,exports){
module.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}};
},{}],82:[function(require,module,exports){
"use strict";function toArray(r,t){if(Array.isArray(r))return r.slice();if(!r)return[];var e=[];if("string"!=typeof r){for(var n=0;n<r.length;n++)e[n]=0|r[n];return e}if(t){if("hex"===t){r=r.replace(/[^a-z0-9]+/gi,""),r.length%2!==0&&(r="0"+r);for(var n=0;n<r.length;n+=2)e.push(parseInt(r[n]+r[n+1],16))}}else for(var n=0;n<r.length;n++){var i=r.charCodeAt(n),o=i>>8,s=255&i;o?e.push(o,s):e.push(s)}return e}function zero2(r){return 1===r.length?"0"+r:r}function toHex(r){for(var t="",e=0;e<r.length;e++)t+=zero2(r[e].toString(16));return t}function getNAF(r,t){for(var e=[],n=1<<t+1,i=r.clone();i.cmpn(1)>=0;){var o;if(i.isOdd()){var s=i.andln(n-1);o=s>(n>>1)-1?(n>>1)-s:s,i.isubn(o)}else o=0;e.push(o);for(var u=0!==i.cmpn(0)&&0===i.andln(n-1)?t+1:1,a=1;a<u;a++)e.push(0);i.iushrn(u)}return e}function getJSF(r,t){var e=[[],[]];r=r.clone(),t=t.clone();for(var n=0,i=0;r.cmpn(-n)>0||t.cmpn(-i)>0;){var o=r.andln(3)+n&3,s=t.andln(3)+i&3;3===o&&(o=-1),3===s&&(s=-1);var u;if(0===(1&o))u=0;else{var a=r.andln(7)+n&7;u=3!==a&&5!==a||2!==s?o:-o}e[0].push(u);var l;if(0===(1&s))l=0;else{var a=t.andln(7)+i&7;l=3!==a&&5!==a||2!==o?s:-s}e[1].push(l),2*n===u+1&&(n=1-n),2*i===l+1&&(i=1-i),r.iushrn(1),t.iushrn(1)}return e}function cachedProperty(r,t,e){var n="_"+t;r.prototype[t]=function(){return void 0!==this[n]?this[n]:this[n]=e.call(this)}}function parseBytes(r){return"string"==typeof r?utils.toArray(r,"hex"):r}function intFromLE(r){return new BN(r,"hex","le")}var utils=exports,BN=require("bn.js");utils.assert=function(r,t){if(!r)throw new Error(t||"Assertion failed")},utils.toArray=toArray,utils.zero2=zero2,utils.toHex=toHex,utils.encode=function(r,t){return"hex"===t?toHex(r):r},utils.getNAF=getNAF,utils.getJSF=getJSF,utils.cachedProperty=cachedProperty,utils.parseBytes=parseBytes,utils.intFromLE=intFromLE;
},{"bn.js":17}],83:[function(require,module,exports){
module.exports={"_args":[[{"raw":"elliptic@^6.0.0","scope":null,"escapedName":"elliptic","name":"elliptic","rawSpec":"^6.0.0","spec":">=6.0.0 <7.0.0","type":"range"},"/var/www/ld/melvincarvalho/solid-ui/node_modules/browserify-sign"]],"_from":"elliptic@>=6.0.0 <7.0.0","_id":"elliptic@6.3.2","_inCache":true,"_location":"/elliptic","_nodeVersion":"6.3.0","_npmOperationalInternal":{"host":"packages-16-east.internal.npmjs.com","tmp":"tmp/elliptic-6.3.2.tgz_1473938837205_0.3108903462998569"},"_npmUser":{"name":"indutny","email":"fedor@indutny.com"},"_npmVersion":"3.10.3","_phantomChildren":{},"_requested":{"raw":"elliptic@^6.0.0","scope":null,"escapedName":"elliptic","name":"elliptic","rawSpec":"^6.0.0","spec":">=6.0.0 <7.0.0","type":"range"},"_requiredBy":["/browserify-sign","/create-ecdh"],"_resolved":"https://registry.npmjs.org/elliptic/-/elliptic-6.3.2.tgz","_shasum":"e4c81e0829cf0a65ab70e998b8232723b5c1bc48","_shrinkwrap":null,"_spec":"elliptic@^6.0.0","_where":"/var/www/ld/melvincarvalho/solid-ui/node_modules/browserify-sign","author":{"name":"Fedor Indutny","email":"fedor@indutny.com"},"bugs":{"url":"https://github.com/indutny/elliptic/issues"},"dependencies":{"bn.js":"^4.4.0","brorand":"^1.0.1","hash.js":"^1.0.0","inherits":"^2.0.1"},"description":"EC cryptography","devDependencies":{"brfs":"^1.4.3","coveralls":"^2.11.3","grunt":"^0.4.5","grunt-browserify":"^5.0.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^8.6.2","istanbul":"^0.4.2","jscs":"^2.9.0","jshint":"^2.6.0","mocha":"^2.1.0"},"directories":{},"dist":{"shasum":"e4c81e0829cf0a65ab70e998b8232723b5c1bc48","tarball":"https://registry.npmjs.org/elliptic/-/elliptic-6.3.2.tgz"},"files":["lib"],"gitHead":"cbace4683a4a548dc0306ef36756151a20299cd5","homepage":"https://github.com/indutny/elliptic","keywords":["EC","Elliptic","curve","Cryptography"],"license":"MIT","main":"lib/elliptic.js","maintainers":[{"name":"indutny","email":"fedor@indutny.com"}],"name":"elliptic","optionalDependencies":{},"readme":"ERROR: No README data found!","repository":{"type":"git","url":"git+ssh://git@github.com/indutny/elliptic.git"},"scripts":{"jscs":"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js","jshint":"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js","lint":"npm run jscs && npm run jshint","test":"npm run lint && npm run unit","unit":"istanbul test _mocha --reporter=spec test/index.js","version":"grunt dist && git add dist/"},"version":"6.3.2"}
},{}],84:[function(require,module,exports){
(function (process,global){
(function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function e(t){return"function"==typeof t}function n(t){return"object"==typeof t&&null!==t}function r(t){U=t}function o(t){B=t}function i(){var t=process.nextTick,e=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(e)&&"0"===e[1]&&"10"===e[2]&&(t=setImmediate),function(){t(f)}}function u(){return function(){N(f)}}function s(){var t=0,e=new J(f),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function c(){var t=new MessageChannel;return t.port1.onmessage=f,function(){t.port2.postMessage(0)}}function a(){return function(){setTimeout(f,1)}}function f(){for(var t=0;t<z;t+=2){var e=V[t],n=V[t+1];e(n),V[t]=void 0,V[t+1]=void 0}z=0}function l(){try{var t=require,e=t("vertx");return N=e.runOnLoop||e.runOnContext,u()}catch(t){return a()}}function p(){}function _(){return new TypeError("You cannot resolve a promise with itself")}function h(){return new TypeError("A promises callback cannot return that same promise.")}function d(t){try{return t.then}catch(t){return et.error=t,et}}function v(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function y(t,e,n){B(function(t){var r=!1,o=v(n,e,function(n){r||(r=!0,e!==n?g(t,n):A(t,n))},function(e){r||(r=!0,E(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,E(t,o))},t)}function m(t,e){e._state===Z?A(t,e._result):e._state===tt?E(t,e._result):j(e,void 0,function(e){g(t,e)},function(e){E(t,e)})}function b(t,n){if(n.constructor===t.constructor)m(t,n);else{var r=d(n);r===et?E(t,et.error):void 0===r?A(t,n):e(r)?y(t,n,r):A(t,n)}}function g(e,n){e===n?E(e,_()):t(n)?b(e,n):A(e,n)}function w(t){t._onerror&&t._onerror(t._result),S(t)}function A(t,e){t._state===X&&(t._result=e,t._state=Z,0!==t._subscribers.length&&B(S,t))}function E(t,e){t._state===X&&(t._state=tt,t._result=e,B(w,t))}function j(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+Z]=n,o[i+tt]=r,0===i&&t._state&&B(S,t)}function S(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,i=t._result,u=0;u<e.length;u+=3)r=e[u],o=e[u+n],r?x(n,r,o,i):o(i);t._subscribers.length=0}}function T(){this.error=null}function P(t,e){try{return t(e)}catch(t){return nt.error=t,nt}}function x(t,n,r,o){var i,u,s,c,a=e(r);if(a){if(i=P(r,o),i===nt?(c=!0,u=i.error,i=null):s=!0,n===i)return void E(n,h())}else i=o,s=!0;n._state!==X||(a&&s?g(n,i):c?E(n,u):t===Z?A(n,i):t===tt&&E(n,i))}function C(t,e){try{e(function(e){g(t,e)},function(e){E(t,e)})}catch(e){E(t,e)}}function M(t,e){var n=this;n._instanceConstructor=t,n.promise=new t(p),n._validateInput(e)?(n._input=e,n.length=e.length,n._remaining=e.length,n._init(),0===n.length?A(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&A(n.promise,n._result))):E(n.promise,n._validationError())}function O(t){return new rt(this,t).promise}function k(t){function e(t){g(o,t)}function n(t){E(o,t)}var r=this,o=new r(p);if(!$(t))return E(o,new TypeError("You must pass an array to race.")),o;for(var i=t.length,u=0;o._state===X&&u<i;u++)j(r.resolve(t[u]),void 0,e,n);return o}function I(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(p);return g(n,t),n}function Y(t){var e=this,n=new e(p);return E(n,t),n}function q(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function F(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function D(t){this._id=ct++,this._state=void 0,this._result=void 0,this._subscribers=[],p!==t&&(e(t)||q(),this instanceof D||F(),C(this,t))}function K(){var t;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;e&&"[object Promise]"===Object.prototype.toString.call(e.resolve())&&!e.cast||(t.Promise=at)}var L;L=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var N,U,W,$=L,z=0,B=({}.toString,function(t,e){V[z]=t,V[z+1]=e,z+=2,2===z&&(U?U(f):W())}),G="undefined"!=typeof window?window:void 0,H=G||{},J=H.MutationObserver||H.WebKitMutationObserver,Q="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),R="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,V=new Array(1e3);W=Q?i():J?s():R?c():void 0===G&&"function"==typeof require?l():a();var X=void 0,Z=1,tt=2,et=new T,nt=new T;M.prototype._validateInput=function(t){return $(t)},M.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},M.prototype._init=function(){this._result=new Array(this.length)};var rt=M;M.prototype._enumerate=function(){for(var t=this,e=t.length,n=t.promise,r=t._input,o=0;n._state===X&&o<e;o++)t._eachEntry(r[o],o)},M.prototype._eachEntry=function(t,e){var r=this,o=r._instanceConstructor;n(t)?t.constructor===o&&t._state!==X?(t._onerror=null,r._settledAt(t._state,e,t._result)):r._willSettleAt(o.resolve(t),e):(r._remaining--,r._result[e]=t)},M.prototype._settledAt=function(t,e,n){var r=this,o=r.promise;o._state===X&&(r._remaining--,t===tt?E(o,n):r._result[e]=n),0===r._remaining&&A(o,r._result)},M.prototype._willSettleAt=function(t,e){var n=this;j(t,void 0,function(t){n._settledAt(Z,e,t)},function(t){n._settledAt(tt,e,t)})};var ot=O,it=k,ut=I,st=Y,ct=0,at=D;D.all=ot,D.race=it,D.resolve=ut,D.reject=st,D._setScheduler=r,D._setAsap=o,D._asap=B,D.prototype={constructor:D,then:function(t,e){var n=this,r=n._state;if(r===Z&&!t||r===tt&&!e)return this;var o=new this.constructor(p),i=n._result;if(r){var u=arguments[r-1];B(function(){x(r,o,u,i)})}else j(n,o,t,e);return o},catch:function(t){return this.then(null,t)}};var ft=K,lt={Promise:at,polyfill:ft};"function"==typeof define&&define.amd?define(function(){return lt}):"undefined"!=typeof module&&module.exports?module.exports=lt:"undefined"!=typeof this&&(this.ES6Promise=lt),ft()}).call(this);
}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"_process":120}],85:[function(require,module,exports){
"use strict";function escapeHtml(e){var t=""+e,a=matchHtmlRegExp.exec(t);if(!a)return t;var r,c="",s=0,n=0;for(s=a.index;s<t.length;s++){switch(t.charCodeAt(s)){case 34:r="&quot;";break;case 38:r="&amp;";break;case 39:r="&#39;";break;case 60:r="&lt;";break;case 62:r="&gt;";break;default:continue}n!==s&&(c+=t.substring(n,s)),n=s+1,c+=r}return n!==s?c+t.substring(n,s):c}var matchHtmlRegExp=/["'&<>]/;module.exports=escapeHtml;
},{}],86:[function(require,module,exports){
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,i,n,s,r,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");throw h.context=t,h}if(i=this._events[e],isUndefined(i))return!1;if(isFunction(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),i.apply(this,s)}else if(isObject(i))for(s=Array.prototype.slice.call(arguments,1),o=i.slice(),n=o.length,r=0;r<n;r++)o[r].apply(this,s);return!0},EventEmitter.prototype.addListener=function(e,t){var i;if(!isFunction(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned&&(i=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}if(!isFunction(t))throw TypeError("listener must be a function");var n=!1;return i.listener=t,this.on(e,i),this},EventEmitter.prototype.removeListener=function(e,t){var i,n,s,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],s=i.length,n=-1,i===t||isFunction(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(i)){for(r=s;r-- >0;)if(i[r]===t||i[r].listener&&i[r].listener===t){n=r;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],isFunction(i))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(isFunction(t))return 1;if(t)return t.length}return 0},EventEmitter.listenerCount=function(e,t){return e.listenerCount(t)};
},{}],87:[function(require,module,exports){
(function (Buffer){
function EVP_BytesToKey(e,f,r,u){Buffer.isBuffer(e)||(e=new Buffer(e,"binary")),f&&!Buffer.isBuffer(f)&&(f=new Buffer(f,"binary")),r/=8,u=u||0;for(var i,n,a=0,t=0,B=new Buffer(r),o=new Buffer(u),h=0,s=[];;){if(h++>0&&s.push(i),s.push(e),f&&s.push(f),i=md5(Buffer.concat(s)),s=[],n=0,r>0)for(;;){if(0===r)break;if(n===i.length)break;B[a++]=i[n],r--,n++}if(u>0&&n!==i.length)for(;;){if(0===u)break;if(n===i.length)break;o[t++]=i[n],u--,n++}if(0===r&&0===u)break}for(n=0;n<i.length;n++)i[n]=0;return{key:B,iv:o}}var md5=require("create-hash/md5");module.exports=EVP_BytesToKey;
}).call(this,require("buffer").Buffer)

},{"buffer":47,"create-hash/md5":54}],88:[function(require,module,exports){
var hash=exports;hash.utils=require("./hash/utils"),hash.common=require("./hash/common"),hash.sha=require("./hash/sha"),hash.ripemd=require("./hash/ripemd"),hash.hmac=require("./hash/hmac"),hash.sha1=hash.sha.sha1,hash.sha256=hash.sha.sha256,hash.sha224=hash.sha.sha224,hash.sha384=hash.sha.sha384,hash.sha512=hash.sha.sha512,hash.ripemd160=hash.ripemd.ripemd160;
},{"./hash/common":89,"./hash/hmac":90,"./hash/ripemd":91,"./hash/sha":92,"./hash/utils":93}],89:[function(require,module,exports){
function BlockHash(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var hash=require("../hash"),utils=hash.utils,assert=utils.assert;exports.BlockHash=BlockHash,BlockHash.prototype.update=function(t,i){if(t=utils.toArray(t,i),this.pending?this.pending=this.pending.concat(t):this.pending=t,this.pendingTotal+=t.length,this.pending.length>=this._delta8){t=this.pending;var h=t.length%this._delta8;this.pending=t.slice(t.length-h,t.length),0===this.pending.length&&(this.pending=null),t=utils.join32(t,0,t.length-h,this.endian);for(var s=0;s<t.length;s+=this._delta32)this._update(t,s,s+this._delta32)}return this},BlockHash.prototype.digest=function(t){return this.update(this._pad()),assert(null===this.pending),this._digest(t)},BlockHash.prototype._pad=function(){var t=this.pendingTotal,i=this._delta8,h=i-(t+this.padLength)%i,s=new Array(h+this.padLength);s[0]=128;for(var n=1;n<h;n++)s[n]=0;if(t<<=3,"big"===this.endian){for(var e=8;e<this.padLength;e++)s[n++]=0;s[n++]=0,s[n++]=0,s[n++]=0,s[n++]=0,s[n++]=t>>>24&255,s[n++]=t>>>16&255,s[n++]=t>>>8&255,s[n++]=255&t}else{s[n++]=255&t,s[n++]=t>>>8&255,s[n++]=t>>>16&255,s[n++]=t>>>24&255,s[n++]=0,s[n++]=0,s[n++]=0,s[n++]=0;for(var e=8;e<this.padLength;e++)s[n++]=0}return s};
},{"../hash":88}],90:[function(require,module,exports){
function Hmac(t,i,e){return this instanceof Hmac?(this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,void this._init(utils.toArray(i,e))):new Hmac(t,i,e)}var hmac=exports,hash=require("../hash"),utils=hash.utils,assert=utils.assert;module.exports=Hmac,Hmac.prototype._init=function(t){t.length>this.blockSize&&(t=(new this.Hash).update(t).digest()),assert(t.length<=this.blockSize);for(var i=t.length;i<this.blockSize;i++)t.push(0);for(var i=0;i<t.length;i++)t[i]^=54;this.inner=(new this.Hash).update(t);for(var i=0;i<t.length;i++)t[i]^=106;this.outer=(new this.Hash).update(t)},Hmac.prototype.update=function(t,i){return this.inner.update(t,i),this},Hmac.prototype.digest=function(t){return this.outer.update(this.inner.digest()),this.outer.digest(t)};
},{"../hash":88}],91:[function(require,module,exports){
function RIPEMD160(){return this instanceof RIPEMD160?(BlockHash.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],void(this.endian="little")):new RIPEMD160}function f(t,h,s,i){return t<=15?h^s^i:t<=31?h&s|~h&i:t<=47?(h|~s)^i:t<=63?h&i|s&~i:h^(s|~i)}function K(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function Kh(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}var hash=require("../hash"),utils=hash.utils,rotl32=utils.rotl32,sum32=utils.sum32,sum32_3=utils.sum32_3,sum32_4=utils.sum32_4,BlockHash=hash.common.BlockHash;utils.inherits(RIPEMD160,BlockHash),exports.ripemd160=RIPEMD160,RIPEMD160.blockSize=512,RIPEMD160.outSize=160,RIPEMD160.hmacStrength=192,RIPEMD160.padLength=64,RIPEMD160.prototype._update=function(t,h){for(var i=this.h[0],u=this.h[1],l=this.h[2],o=this.h[3],e=this.h[4],n=i,m=u,a=l,c=o,_=e,D=0;D<80;D++){var E=sum32(rotl32(sum32_4(i,f(D,u,l,o),t[r[D]+h],K(D)),s[D]),e);i=e,e=o,o=rotl32(l,10),l=u,u=E,E=sum32(rotl32(sum32_4(n,f(79-D,m,a,c),t[rh[D]+h],Kh(D)),sh[D]),_),n=_,_=c,c=rotl32(a,10),a=m,m=E}E=sum32_3(this.h[1],l,c),this.h[1]=sum32_3(this.h[2],o,_),this.h[2]=sum32_3(this.h[3],e,n),this.h[3]=sum32_3(this.h[4],i,m),this.h[4]=sum32_3(this.h[0],u,a),this.h[0]=E},RIPEMD160.prototype._digest=function(t){return"hex"===t?utils.toHex32(this.h,"little"):utils.split32(this.h,"little")};var r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],rh=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],s=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],sh=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];
},{"../hash":88}],92:[function(require,module,exports){
function SHA256(){return this instanceof SHA256?(BlockHash.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=sha256_K,void(this.W=new Array(64))):new SHA256}function SHA224(){return this instanceof SHA224?(SHA256.call(this),void(this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])):new SHA224}function SHA512(){return this instanceof SHA512?(BlockHash.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=sha512_K,void(this.W=new Array(160))):new SHA512}function SHA384(){return this instanceof SHA384?(SHA512.call(this),void(this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428])):new SHA384}function SHA1(){return this instanceof SHA1?(BlockHash.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],void(this.W=new Array(80))):new SHA1}function ch32(t,h,s){return t&h^~t&s}function maj32(t,h,s){return t&h^t&s^h&s}function p32(t,h,s){return t^h^s}function s0_256(t){return rotr32(t,2)^rotr32(t,13)^rotr32(t,22)}function s1_256(t){return rotr32(t,6)^rotr32(t,11)^rotr32(t,25)}function g0_256(t){return rotr32(t,7)^rotr32(t,18)^t>>>3}function g1_256(t){return rotr32(t,17)^rotr32(t,19)^t>>>10}function ft_1(t,h,s,i){return 0===t?ch32(h,s,i):1===t||3===t?p32(h,s,i):2===t?maj32(h,s,i):void 0}function ch64_hi(t,h,s,i,r,o){var u=t&s^~t&r;return u<0&&(u+=4294967296),u}function ch64_lo(t,h,s,i,r,o){var u=h&i^~h&o;return u<0&&(u+=4294967296),u}function maj64_hi(t,h,s,i,r,o){var u=t&s^t&r^s&r;return u<0&&(u+=4294967296),u}function maj64_lo(t,h,s,i,r,o){var u=h&i^h&o^i&o;return u<0&&(u+=4294967296),u}function s0_512_hi(t,h){var s=rotr64_hi(t,h,28),i=rotr64_hi(h,t,2),r=rotr64_hi(h,t,7),o=s^i^r;return o<0&&(o+=4294967296),o}function s0_512_lo(t,h){var s=rotr64_lo(t,h,28),i=rotr64_lo(h,t,2),r=rotr64_lo(h,t,7),o=s^i^r;return o<0&&(o+=4294967296),o}function s1_512_hi(t,h){var s=rotr64_hi(t,h,14),i=rotr64_hi(t,h,18),r=rotr64_hi(h,t,9),o=s^i^r;return o<0&&(o+=4294967296),o}function s1_512_lo(t,h){var s=rotr64_lo(t,h,14),i=rotr64_lo(t,h,18),r=rotr64_lo(h,t,9),o=s^i^r;return o<0&&(o+=4294967296),o}function g0_512_hi(t,h){var s=rotr64_hi(t,h,1),i=rotr64_hi(t,h,8),r=shr64_hi(t,h,7),o=s^i^r;return o<0&&(o+=4294967296),o}function g0_512_lo(t,h){var s=rotr64_lo(t,h,1),i=rotr64_lo(t,h,8),r=shr64_lo(t,h,7),o=s^i^r;return o<0&&(o+=4294967296),o}function g1_512_hi(t,h){var s=rotr64_hi(t,h,19),i=rotr64_hi(h,t,29),r=shr64_hi(t,h,6),o=s^i^r;return o<0&&(o+=4294967296),o}function g1_512_lo(t,h){var s=rotr64_lo(t,h,19),i=rotr64_lo(h,t,29),r=shr64_lo(t,h,6),o=s^i^r;return o<0&&(o+=4294967296),o}var hash=require("../hash"),utils=hash.utils,assert=utils.assert,rotr32=utils.rotr32,rotl32=utils.rotl32,sum32=utils.sum32,sum32_4=utils.sum32_4,sum32_5=utils.sum32_5,rotr64_hi=utils.rotr64_hi,rotr64_lo=utils.rotr64_lo,shr64_hi=utils.shr64_hi,shr64_lo=utils.shr64_lo,sum64=utils.sum64,sum64_hi=utils.sum64_hi,sum64_lo=utils.sum64_lo,sum64_4_hi=utils.sum64_4_hi,sum64_4_lo=utils.sum64_4_lo,sum64_5_hi=utils.sum64_5_hi,sum64_5_lo=utils.sum64_5_lo,BlockHash=hash.common.BlockHash,sha256_K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],sha512_K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],sha1_K=[1518500249,1859775393,2400959708,3395469782];utils.inherits(SHA256,BlockHash),exports.sha256=SHA256,SHA256.blockSize=512,SHA256.outSize=256,SHA256.hmacStrength=192,SHA256.padLength=64,SHA256.prototype._update=function(t,h){for(var s=this.W,i=0;i<16;i++)s[i]=t[h+i];for(;i<s.length;i++)s[i]=sum32_4(g1_256(s[i-2]),s[i-7],g0_256(s[i-15]),s[i-16]);var r=this.h[0],o=this.h[1],u=this.h[2],n=this.h[3],_=this.h[4],e=this.h[5],l=this.h[6],a=this.h[7];assert(this.k.length===s.length);for(var i=0;i<s.length;i++){var c=sum32_5(a,s1_256(_),ch32(_,e,l),this.k[i],s[i]),S=sum32(s0_256(r),maj32(r,o,u));a=l,l=e,e=_,_=sum32(n,c),n=u,u=o,o=r,r=sum32(c,S)}this.h[0]=sum32(this.h[0],r),this.h[1]=sum32(this.h[1],o),this.h[2]=sum32(this.h[2],u),this.h[3]=sum32(this.h[3],n),this.h[4]=sum32(this.h[4],_),this.h[5]=sum32(this.h[5],e),this.h[6]=sum32(this.h[6],l),this.h[7]=sum32(this.h[7],a)},SHA256.prototype._digest=function(t){return"hex"===t?utils.toHex32(this.h,"big"):utils.split32(this.h,"big")},utils.inherits(SHA224,SHA256),exports.sha224=SHA224,SHA224.blockSize=512,SHA224.outSize=224,SHA224.hmacStrength=192,SHA224.padLength=64,SHA224.prototype._digest=function(t){return"hex"===t?utils.toHex32(this.h.slice(0,7),"big"):utils.split32(this.h.slice(0,7),"big")},utils.inherits(SHA512,BlockHash),exports.sha512=SHA512,SHA512.blockSize=1024,SHA512.outSize=512,SHA512.hmacStrength=192,SHA512.padLength=128,SHA512.prototype._prepareBlock=function(t,h){for(var s=this.W,i=0;i<32;i++)s[i]=t[h+i];for(;i<s.length;i+=2){var r=g1_512_hi(s[i-4],s[i-3]),o=g1_512_lo(s[i-4],s[i-3]),u=s[i-14],n=s[i-13],_=g0_512_hi(s[i-30],s[i-29]),e=g0_512_lo(s[i-30],s[i-29]),l=s[i-32],a=s[i-31];s[i]=sum64_4_hi(r,o,u,n,_,e,l,a),s[i+1]=sum64_4_lo(r,o,u,n,_,e,l,a)}},SHA512.prototype._update=function(t,h){this._prepareBlock(t,h);var s=this.W,i=this.h[0],r=this.h[1],o=this.h[2],u=this.h[3],n=this.h[4],_=this.h[5],e=this.h[6],l=this.h[7],a=this.h[8],c=this.h[9],S=this.h[10],m=this.h[11],H=this.h[12],A=this.h[13],f=this.h[14],g=this.h[15];assert(this.k.length===s.length);for(var p=0;p<s.length;p+=2){var v=f,k=g,d=s1_512_hi(a,c),b=s1_512_lo(a,c),x=ch64_hi(a,c,S,m,H,A),y=ch64_lo(a,c,S,m,H,A),z=this.k[p],B=this.k[p+1],w=s[p],j=s[p+1],W=sum64_5_hi(v,k,d,b,x,y,z,B,w,j),K=sum64_5_lo(v,k,d,b,x,y,z,B,w,j),v=s0_512_hi(i,r),k=s0_512_lo(i,r),d=maj64_hi(i,r,o,u,n,_),b=maj64_lo(i,r,o,u,n,_),L=sum64_hi(v,k,d,b),q=sum64_lo(v,k,d,b);f=H,g=A,H=S,A=m,S=a,m=c,a=sum64_hi(e,l,W,K),c=sum64_lo(l,l,W,K),e=n,l=_,n=o,_=u,o=i,u=r,i=sum64_hi(W,K,L,q),r=sum64_lo(W,K,L,q)}sum64(this.h,0,i,r),sum64(this.h,2,o,u),sum64(this.h,4,n,_),sum64(this.h,6,e,l),sum64(this.h,8,a,c),sum64(this.h,10,S,m),sum64(this.h,12,H,A),sum64(this.h,14,f,g)},SHA512.prototype._digest=function(t){return"hex"===t?utils.toHex32(this.h,"big"):utils.split32(this.h,"big")},utils.inherits(SHA384,SHA512),exports.sha384=SHA384,SHA384.blockSize=1024,SHA384.outSize=384,SHA384.hmacStrength=192,SHA384.padLength=128,SHA384.prototype._digest=function(t){return"hex"===t?utils.toHex32(this.h.slice(0,12),"big"):utils.split32(this.h.slice(0,12),"big")},utils.inherits(SHA1,BlockHash),exports.sha1=SHA1,SHA1.blockSize=512,SHA1.outSize=160,SHA1.hmacStrength=80,SHA1.padLength=64,SHA1.prototype._update=function(t,h){for(var s=this.W,i=0;i<16;i++)s[i]=t[h+i];for(;i<s.length;i++)s[i]=rotl32(s[i-3]^s[i-8]^s[i-14]^s[i-16],1);for(var r=this.h[0],o=this.h[1],u=this.h[2],n=this.h[3],_=this.h[4],i=0;i<s.length;i++){var e=~~(i/20),l=sum32_5(rotl32(r,5),ft_1(e,o,u,n),_,s[i],sha1_K[e]);_=n,n=u,u=rotl32(o,30),o=r,r=l}this.h[0]=sum32(this.h[0],r),this.h[1]=sum32(this.h[1],o),this.h[2]=sum32(this.h[2],u),this.h[3]=sum32(this.h[3],n),this.h[4]=sum32(this.h[4],_)},SHA1.prototype._digest=function(t){return"hex"===t?utils.toHex32(this.h,"big"):utils.split32(this.h,"big")};
},{"../hash":88}],93:[function(require,module,exports){
function toArray(r,t){if(Array.isArray(r))return r.slice();if(!r)return[];var n=[];if("string"==typeof r)if(t){if("hex"===t){r=r.replace(/[^a-z0-9]+/gi,""),r.length%2!==0&&(r="0"+r);for(var u=0;u<r.length;u+=2)n.push(parseInt(r[u]+r[u+1],16))}}else for(var u=0;u<r.length;u++){var o=r.charCodeAt(u),e=o>>8,s=255&o;e?n.push(e,s):n.push(s)}else for(var u=0;u<r.length;u++)n[u]=0|r[u];return n}function toHex(r){for(var t="",n=0;n<r.length;n++)t+=zero2(r[n].toString(16));return t}function htonl(r){var t=r>>>24|r>>>8&65280|r<<8&16711680|(255&r)<<24;return t>>>0}function toHex32(r,t){for(var n="",u=0;u<r.length;u++){var o=r[u];"little"===t&&(o=htonl(o)),n+=zero8(o.toString(16))}return n}function zero2(r){return 1===r.length?"0"+r:r}function zero8(r){return 7===r.length?"0"+r:6===r.length?"00"+r:5===r.length?"000"+r:4===r.length?"0000"+r:3===r.length?"00000"+r:2===r.length?"000000"+r:1===r.length?"0000000"+r:r}function join32(r,t,n,u){var o=n-t;assert(o%4===0);for(var e=new Array(o/4),s=0,i=t;s<e.length;s++,i+=4){var l;l="big"===u?r[i]<<24|r[i+1]<<16|r[i+2]<<8|r[i+3]:r[i+3]<<24|r[i+2]<<16|r[i+1]<<8|r[i],e[s]=l>>>0}return e}function split32(r,t){for(var n=new Array(4*r.length),u=0,o=0;u<r.length;u++,o+=4){var e=r[u];"big"===t?(n[o]=e>>>24,n[o+1]=e>>>16&255,n[o+2]=e>>>8&255,n[o+3]=255&e):(n[o+3]=e>>>24,n[o+2]=e>>>16&255,n[o+1]=e>>>8&255,n[o]=255&e)}return n}function rotr32(r,t){return r>>>t|r<<32-t}function rotl32(r,t){return r<<t|r>>>32-t}function sum32(r,t){return r+t>>>0}function sum32_3(r,t,n){return r+t+n>>>0}function sum32_4(r,t,n,u){return r+t+n+u>>>0}function sum32_5(r,t,n,u,o){return r+t+n+u+o>>>0}function assert(r,t){if(!r)throw new Error(t||"Assertion failed")}function sum64(r,t,n,u){var o=r[t],e=r[t+1],s=u+e>>>0,i=(s<u?1:0)+n+o;r[t]=i>>>0,r[t+1]=s}function sum64_hi(r,t,n,u){var o=t+u>>>0,e=(o<t?1:0)+r+n;return e>>>0}function sum64_lo(r,t,n,u){var o=t+u;return o>>>0}function sum64_4_hi(r,t,n,u,o,e,s,i){var l=0,h=t;h=h+u>>>0,l+=h<t?1:0,h=h+e>>>0,l+=h<e?1:0,h=h+i>>>0,l+=h<i?1:0;var _=r+n+o+s+l;return _>>>0}function sum64_4_lo(r,t,n,u,o,e,s,i){var l=t+u+e+i;return l>>>0}function sum64_5_hi(r,t,n,u,o,e,s,i,l,h){var _=0,a=t;a=a+u>>>0,_+=a<t?1:0,a=a+e>>>0,_+=a<e?1:0,a=a+i>>>0,_+=a<i?1:0,a=a+h>>>0,_+=a<h?1:0;var f=r+n+o+s+l+_;return f>>>0}function sum64_5_lo(r,t,n,u,o,e,s,i,l,h){var _=t+u+e+i+h;return _>>>0}function rotr64_hi(r,t,n){var u=t<<32-n|r>>>n;return u>>>0}function rotr64_lo(r,t,n){var u=r<<32-n|t>>>n;return u>>>0}function shr64_hi(r,t,n){return r>>>n}function shr64_lo(r,t,n){var u=r<<32-n|t>>>n;return u>>>0}var utils=exports,inherits=require("inherits");utils.toArray=toArray,utils.toHex=toHex,utils.htonl=htonl,utils.toHex32=toHex32,utils.zero2=zero2,utils.zero8=zero8,utils.join32=join32,utils.split32=split32,utils.rotr32=rotr32,utils.rotl32=rotl32,utils.sum32=sum32,utils.sum32_3=sum32_3,utils.sum32_4=sum32_4,utils.sum32_5=sum32_5,utils.assert=assert,utils.inherits=inherits,exports.sum64=sum64,exports.sum64_hi=sum64_hi,exports.sum64_lo=sum64_lo,exports.sum64_4_hi=sum64_4_hi,exports.sum64_4_lo=sum64_4_lo,exports.sum64_5_hi=sum64_5_hi,exports.sum64_5_lo=sum64_5_lo,exports.rotr64_hi=rotr64_hi,exports.rotr64_lo=rotr64_lo,exports.shr64_hi=shr64_hi,exports.shr64_lo=shr64_lo;
},{"inherits":97}],94:[function(require,module,exports){
var http=require("http"),https=module.exports;for(var key in http)http.hasOwnProperty(key)&&(https[key]=http[key]);https.request=function(t,e){return t||(t={}),t.scheme="https",t.protocol="https:",http.request.call(this,t,e)};
},{"http":230}],95:[function(require,module,exports){
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:(s?-1:1)*(1/0);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),o+=p+N>=1?n/f:n*Math.pow(2,1-N),o*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};
},{}],96:[function(require,module,exports){
var indexOf=[].indexOf;module.exports=function(e,n){if(indexOf)return e.indexOf(n);for(var r=0;r<e.length;++r)if(e[r]===n)return r;return-1};
},{}],97:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};
},{}],98:[function(require,module,exports){
function isBuffer(f){return!!f.constructor&&"function"==typeof f.constructor.isBuffer&&f.constructor.isBuffer(f)}function isSlowBuffer(f){return"function"==typeof f.readFloatLE&&"function"==typeof f.slice&&isBuffer(f.slice(0,0))}module.exports=function(f){return null!=f&&(isBuffer(f)||isSlowBuffer(f)||!!f._isBuffer)};
},{}],99:[function(require,module,exports){
var toString={}.toString;module.exports=Array.isArray||function(r){return"[object Array]"==toString.call(r)};
},{}],100:[function(require,module,exports){
arguments[4][19][0].apply(exports,arguments)
},{"dup":19}],101:[function(require,module,exports){
(function (process,global,__dirname){
!function(){var e="undefined"!=typeof process&&process.versions&&process.versions.node,t=!e&&("undefined"!=typeof window||"undefined"!=typeof self);t&&"undefined"==typeof global&&("undefined"!=typeof window?global=window:"undefined"!=typeof self?global=self:"undefined"!=typeof $&&(global=$));var n=function(n){function r(){}function a(e){for(var t=[],n=Object.keys(e).sort(),r=0;r<n.length;++r){var a=n[r],o=e[a];A(o)||(o=[o]);for(var i=0;i<o.length;++i){var l=o[i];if(null!==l){if(!J(l))throw new Ee("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:e});t.push({"@value":l,"@language":a.toLowerCase()})}}}return t}function o(e,t){if(A(t))for(var n=0;n<t.length;++n)t[n]=o(e,t[n]);else if(Q(t))t["@list"]=o(e,t["@list"]);else if(T(t)){G(t)&&(t["@id"]=e.getId(t["@id"]));for(var r=Object.keys(t).sort(),a=0;a<r.length;++a){var i=r[a];"@id"!==i&&(t[i]=o(e,t[i]))}}return t}function i(e,t,r){if(null===r||void 0===r)return null;var a=D(e,t,{vocab:!0});if("@id"===a)return D(e,r,{base:!0});if("@type"===a)return D(e,r,{vocab:!0,base:!0});var o=n.getContextValue(e,t,"@type");if("@id"===o||"@graph"===a&&J(r))return{"@id":D(e,r,{base:!0})};if("@vocab"===o)return{"@id":D(e,r,{vocab:!0,base:!0})};if(_(a))return r;var i={};if(null!==o)i["@type"]=o;else if(J(r)){var l=n.getContextValue(e,t,"@language");null!==l&&(i["@language"]=l)}return["boolean","number","string"].indexOf(typeof r)===-1&&(r=r.toString()),i["@value"]=r,i}function l(e,t,n){for(var r=[],a=Object.keys(e).sort(),o=0;o<a.length;++o)for(var i=a[o],l=e[i],c=Object.keys(l).sort(),d=0;d<c.length;++d){var f=c[d],p=l[f];if("@type"===f)f=be;else if(_(f))continue;for(var h=0;h<p.length;++h){var v=p[h],g={};if(g.type=0===i.indexOf("_:")?"blank node":"IRI",g.value=i,$(i)){var y={};if(y.type=0===f.indexOf("_:")?"blank node":"IRI",y.value=f,$(f)&&("blank node"!==y.type||n.produceGeneralizedRdf))if(Q(v))u(v["@list"],t,g,y,r);else{var m=s(v);m&&r.push({subject:g,predicate:y,object:m})}}}}return r}function u(e,t,n,r,a){for(var o={type:"IRI",value:ye},i={type:"IRI",value:me},l={type:"IRI",value:xe},u=0;u<e.length;++u){var c=e[u],d={type:"blank node",value:t.getId()};a.push({subject:n,predicate:r,object:d}),n=d,r=o;var f=s(c);f&&a.push({subject:n,predicate:r,object:f}),r=i}a.push({subject:n,predicate:r,object:l})}function s(e){var t={};if(X(e)){t.type="literal";var n=e["@value"],r=e["@type"]||null;V(n)?(t.value=n.toString(),t.datatype=r||de):F(n)||r===fe?(F(n)||(n=parseFloat(n)),t.value=n.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),t.datatype=r||fe):P(n)?(t.value=n.toFixed(0),t.datatype=r||pe):"@language"in e?(t.value=n,t.datatype=r||Ie,t.language=e["@language"]):(t.value=n,t.datatype=r||he)}else{var a=T(e)?e["@id"]:e;t.type=0===a.indexOf("_:")?"blank node":"IRI",t.value=a}return"IRI"!==t.type||$(t.value)?t:null}function c(e,t){if("IRI"===e.type||"blank node"===e.type)return{"@id":e.value};var n={"@value":e.value};if(e.language)n["@language"]=e.language;else{var r=e.datatype;if(r||(r=he),t){if(r===de)"true"===n["@value"]?n["@value"]=!0:"false"===n["@value"]&&(n["@value"]=!1);else if(B(n["@value"]))if(r===pe){var a=parseInt(n["@value"],10);a.toFixed(0)===n["@value"]&&(n["@value"]=a)}else r===fe&&(n["@value"]=parseFloat(n["@value"]));[de,pe,fe,he].indexOf(r)===-1&&(n["@type"]=r)}else r!==he&&(n["@type"]=r)}return n}function d(e,t){for(var n=["subject","predicate","object"],r=0;r<n.length;++r){var a=n[r];if(e[a].type!==t[a].type||e[a].value!==t[a].value)return!1}return e.object.language===t.object.language&&e.object.datatype===t.object.datatype}function f(e,t,r,a,o,i){if(A(e))for(var l=0;l<e.length;++l)f(e[l],t,r,a,void 0,i);else{if(!T(e))return void(i&&i.push(e));if(X(e)){if("@type"in e){var u=e["@type"];0===u.indexOf("_:")&&(e["@type"]=u=a.getId(u))}return void(i&&i.push(e))}if("@type"in e)for(var s=e["@type"],l=0;l<s.length;++l){var u=s[l];0===u.indexOf("_:")&&a.getId(u)}M(o)&&(o=G(e)?a.getId(e["@id"]):e["@id"]),i&&i.push({"@id":o});var c=t[r],d=c[o]=c[o]||{};d["@id"]=o;for(var p=Object.keys(e).sort(),h=0;h<p.length;++h){var v=p[h];if("@id"!==v)if("@reverse"!==v)if("@graph"!==v)if("@type"!==v&&_(v)){if("@index"===v&&v in d&&(e[v]!==d[v]||e[v]["@id"]!==d[v]["@id"]))throw new Ee("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:d});d[v]=e[v]}else{var g=e[v];if(0===v.indexOf("_:")&&(v=a.getId(v)),0!==g.length)for(var y=0;y<g.length;++y){var m=g[y];if("@type"===v&&(m=0===m.indexOf("_:")?a.getId(m):m),z(m)||H(m)){var x=G(m)?a.getId(m["@id"]):m["@id"];n.addValue(d,v,{"@id":x},{propertyIsArray:!0,allowDuplicate:!1}),f(m,t,r,a,x)}else if(Q(m)){var b=[];f(m["@list"],t,r,a,o,b),m={"@list":b},n.addValue(d,v,m,{propertyIsArray:!0,allowDuplicate:!1})}else f(m,t,r,a,o),n.addValue(d,v,m,{propertyIsArray:!0,allowDuplicate:!1})}else n.addValue(d,v,[],{propertyIsArray:!0})}else{o in t||(t[o]={});var w="@merged"===r?r:o;f(e[v],t,w,a)}else{var j={"@id":o},k=e["@reverse"];for(var I in k)for(var L=k[I],O=0;O<L.length;++O){var E=L[O],S=E["@id"];G(E)&&(S=a.getId(S)),f(E,t,r,a,S),n.addValue(c[S],I,j,{propertyIsArray:!0,allowDuplicate:!1})}}}}}function p(e){for(var t=e["@default"],n=Object.keys(e).sort(),r=0;r<n.length;++r){var a=n[r];if("@default"!==a){var o=e[a],i=t[a];i?"@graph"in i||(i["@graph"]=[]):t[a]=i={"@id":a,"@graph":[]};for(var l=i["@graph"],u=Object.keys(o).sort(),s=0;s<u.length;++s){var c=o[u[s]];H(c)||l.push(c)}}}return t}function h(e,t,n,r,a){m(n),n=n[0];for(var o=e.options,i={embed:y(n,o,"embed"),explicit:y(n,o,"explicit"),requireAll:y(n,o,"requireAll")},l=x(e,t,n,i),u=Object.keys(l).sort(),s=0;s<u.length;++s){var c=u[s],d=l[c];if("@link"===i.embed&&c in e.link)j(r,a,e.link[c]);else{null===a&&(e.uniqueEmbeds={});var f={};if(f["@id"]=c,e.link[c]=f,"@never"===i.embed||g(d,e.subjectStack))j(r,a,f);else{"@last"===i.embed&&(c in e.uniqueEmbeds&&w(e,c),e.uniqueEmbeds[c]={parent:r,property:a}),e.subjectStack.push(d);for(var p=Object.keys(d).sort(),b=0;b<p.length;b++){var k=p[b];if(_(k))f[k]=W(d[k]);else if(!i.explicit||k in n)for(var I=d[k],L=0;L<I.length;++L){var O=I[L];if(Q(O)){var E={"@list":[]};j(f,k,E);var S=O["@list"];for(var D in S)if(O=S[D],H(O)){var N=k in n?n[k][0]["@list"]:v(i);h(e,[O["@id"]],N,E,"@list")}else j(E,"@list",W(O))}else if(H(O)){var N=k in n?n[k]:v(i);h(e,[O["@id"]],N,f,k)}else j(f,k,W(O))}}for(var p=Object.keys(n).sort(),b=0;b<p.length;++b){var k=p[b];if(!_(k)){var C=n[k][0],R=y(C,o,"omitDefault");if(!(R||k in f)){var T="@null";"@default"in C&&(T=W(C["@default"])),A(T)||(T=[T]),f[k]=[{"@preserve":T}]}}}j(r,a,f),e.subjectStack.pop()}}}}function v(e){var t={};for(var n in e)void 0!==e[n]&&(t["@"+n]=[e[n]]);return[t]}function g(e,t){for(var n=t.length-1;n>=0;--n)if(t[n]["@id"]===e["@id"])return!0;return!1}function y(e,t,n){var r="@"+n,a=r in e?e[r][0]:t[n];return"embed"===n&&(a===!0?a="@last":a===!1?a="@never":"@always"!==a&&"@never"!==a&&"@link"!==a&&(a="@last")),a}function m(e){if(!A(e)||1!==e.length||!T(e[0]))throw new Ee("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e})}function x(e,t,n,r){for(var a={},o=0;o<t.length;++o){var i=t[o],l=e.subjects[i];b(l,n,r)&&(a[i]=l)}return a}function b(e,t,r){if("@type"in t&&(1!==t["@type"].length||!T(t["@type"][0]))){for(var a=t["@type"],o=0;o<a.length;++o)if(n.hasValue(e,"@type",a[o]))return!0;return!1}var i=!0,l=!1;for(var u in t){if(_(u)){if("@id"!==u&&"@type"!==u)continue;if(i=!1,"@id"===u&&J(t[u])){if(e[u]!==t[u])return!1;l=!0;continue}}if(i=!1,u in e){if(A(t[u])&&0===t[u].length&&void 0!==e[u])return!1;l=!0}else{var s=A(t[u])&&T(t[u][0])&&"@default"in t[u][0];if(r.requireAll&&!s)return!1}}return i||l}function w(e,t){var r=e.uniqueEmbeds,a=r[t],o=a.parent,i=a.property,l={"@id":t};if(A(o)){for(var u=0;u<o.length;++u)if(n.compareValues(o[u],l)){o[u]=l;break}}else{var s=A(o[i]);n.removeValue(o,i,l,{propertyIsArray:s}),n.addValue(o,i,l,{propertyIsArray:s})}var c=function(e){for(var t=Object.keys(r),n=0;n<t.length;++n){var a=t[n];a in r&&T(r[a].parent)&&r[a].parent["@id"]===e&&(delete r[a],c(a))}};c(t)}function j(e,t,r){T(e)?n.addValue(e,t,r,{propertyIsArray:!0}):e.push(r)}function k(e,t,r){if(A(t)){for(var a=[],o=0;o<t.length;++o){var i=k(e,t[o],r);null!==i&&a.push(i)}t=a}else if(T(t)){if("@preserve"in t)return"@null"===t["@preserve"]?null:t["@preserve"];if(X(t))return t;if(Q(t))return t["@list"]=k(e,t["@list"],r),t;var l=O(e,"@id");if(l in t){var u=t[l];if(u in r.link){var s=r.link[u].indexOf(t);if(s!==-1)return r.link[u][s];r.link[u].push(t)}else r.link[u]=[t]}for(var c in t){var i=k(e,t[c],r),d=n.getContextValue(e,c,"@container");r.compactArrays&&A(i)&&1===i.length&&null===d&&(i=i[0]),t[c]=i}}return t}function I(e,t){return e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1}function L(e,t,n,r,a,o){null===o&&(o="@null");var i=[];if("@id"!==o&&"@reverse"!==o||!H(n))i.push(o);else{"@reverse"===o&&i.push("@reverse");var l=O(e,n["@id"],null,{vocab:!0});l in e.mappings&&e.mappings[l]&&e.mappings[l]["@id"]===n["@id"]?i.push.apply(i,["@vocab","@id"]):i.push.apply(i,["@id","@vocab"])}i.push("@none");for(var u=e.inverse[t],s=0;s<r.length;++s){var c=r[s];if(c in u)for(var d=u[c][a],f=0;f<i.length;++f){var p=i[f];if(p in d)return d[p]}}return null}function O(e,t,n,r,a){if(null===t)return t;M(n)&&(n=null),M(a)&&(a=!1),r=r||{};var o=e.getInverse();if(_(t))return t in o?o[t]["@none"]["@type"]["@none"]:t;if(r.vocab&&t in o){var i=e["@language"]||"@none",l=[];T(n)&&"@index"in n&&l.push("@index");var u="@language",s="@null";if(a)u="@type",s="@reverse",l.push("@set");else if(Q(n)){"@index"in n||l.push("@list");for(var c=n["@list"],d=0===c.length?i:null,f=null,p=0;p<c.length;++p){var h=c[p],v="@none",g="@none";if(X(h)?"@language"in h?v=h["@language"]:"@type"in h?g=h["@type"]:v="@null":g="@id",null===d?d=v:v!==d&&X(h)&&(d="@none"),null===f?f=g:g!==f&&(f="@none"),"@none"===d&&"@none"===f)break}d=d||"@none",f=f||"@none","@none"!==f?(u="@type",s=f):s=d}else X(n)?"@language"in n&&!("@index"in n)?(l.push("@language"),s=n["@language"]):"@type"in n&&(u="@type",s=n["@type"]):(u="@type",s="@id"),l.push("@set");l.push("@none");var y=L(e,t,n,l,u,s);if(null!==y)return y}if(r.vocab&&"@vocab"in e){var m=e["@vocab"];if(0===t.indexOf(m)&&t!==m){var x=t.substr(m.length);if(!(x in e.mappings))return x}}for(var b=null,w=0,j=[],k=e.fastCurieMap,O=t.length-1;w<O&&t[w]in k;++w)k=k[t[w]],""in k&&j.push(k[""][0]);for(var p=j.length-1;p>=0;--p)for(var E=j[p],S=E.terms,D=0;D<S.length;++D){var N=S[D]+":"+t.substr(E.iri.length),R=!(N in e.mappings)||null===n&&e.mappings[N]["@id"]===t;R&&(null===b||I(N,b)<0)&&(b=N)}return null!==b?b:r.vocab?t:C(e["@base"],t)}function E(e,t,r){if(X(r)){var a=n.getContextValue(e,t,"@type"),o=n.getContextValue(e,t,"@language"),i=n.getContextValue(e,t,"@container"),l="@index"in r&&"@index"!==i;if(!l&&(r["@type"]===a||r["@language"]===o))return r["@value"];var u=Object.keys(r).length,s=1===u||2===u&&"@index"in r&&!l,c="@language"in e,d=J(r["@value"]),f=e.mappings[t]&&null===e.mappings[t]["@language"];if(s&&(!c||!d||f))return r["@value"];var p={};return l&&(p[O(e,"@index")]=r["@index"]),"@type"in r?p[O(e,"@type")]=O(e,r["@type"],null,{vocab:!0}):"@language"in r&&(p[O(e,"@language")]=r["@language"]),p[O(e,"@value")]=r["@value"],p}var h=D(e,t,{vocab:!0}),a=n.getContextValue(e,t,"@type"),v=O(e,r["@id"],null,{vocab:"@vocab"===a});if("@id"===a||"@vocab"===a||"@graph"===h)return v;var p={};return p[O(e,"@id")]=v,p}function S(e,t,n,r){if(n in r){if(r[n])return;throw new Ee("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:n})}if(r[n]=!1,_(n))throw new Ee("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:n});if(""===n)throw new Ee("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t});e.mappings[n]&&delete e.mappings[n];var a=t[n];if(null===a||T(a)&&null===a["@id"])return e.mappings[n]=null,void(r[n]=!0);if(J(a)&&(a={"@id":a}),!T(a))throw new Ee("Invalid JSON-LD syntax; @context property values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});var o=e.mappings[n]={};if(o.reverse=!1,"@reverse"in a){if("@id"in a)throw new Ee("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});var i=a["@reverse"];if(!J(i))throw new Ee("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});var l=D(e,i,{vocab:!0,base:!1},t,r);if(!$(l))throw new Ee("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});o["@id"]=l,o.reverse=!0}else if("@id"in a){var l=a["@id"];if(!J(l))throw new Ee("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(l!==n){if(l=D(e,l,{vocab:!0,base:!1},t,r),!$(l)&&!_(l))throw new Ee("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});o["@id"]=l}}var u=n.indexOf(":");if(o._termHasColon=u!==-1,!("@id"in o))if(o._termHasColon){var s=n.substr(0,u);if(s in t&&S(e,t,s,r),e.mappings[s]){var c=n.substr(u+1);o["@id"]=e.mappings[s]["@id"]+c}else o["@id"]=n}else{if(!("@vocab"in e))throw new Ee("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:n});o["@id"]=e["@vocab"]+n}if(r[n]=!0,"@type"in a){var d=a["@type"];if(!J(d))throw new Ee("Invalid JSON-LD syntax; an @context @type values must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if("@id"!==d&&"@vocab"!==d){if(d=D(e,d,{vocab:!0,base:!1},t,r),!$(d))throw new Ee("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(0===d.indexOf("_:"))throw new Ee("Invalid JSON-LD syntax; an @context @type values must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}o["@type"]=d}if("@container"in a){var f=a["@container"];if("@list"!==f&&"@set"!==f&&"@index"!==f&&"@language"!==f)throw new Ee("Invalid JSON-LD syntax; @context @container value must be one of the following: @list, @set, @index, or @language.","jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(o.reverse&&"@index"!==f&&"@set"!==f&&null!==f)throw new Ee("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});o["@container"]=f}if("@language"in a&&!("@type"in a)){var p=a["@language"];if(null!==p&&!J(p))throw new Ee("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});null!==p&&(p=p.toLowerCase()),o["@language"]=p}var l=o["@id"];if("@context"===l||"@preserve"===l)throw new Ee("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t})}function D(e,t,r,a,o){if(null===t||_(t))return t;if(t=String(t),a&&t in a&&o[t]!==!0&&S(e,a,t,o),r=r||{},r.vocab){var i=e.mappings[t];if(null===i)return null;if(i)return i["@id"]}var l=t.indexOf(":");if(l!==-1){var u=t.substr(0,l),s=t.substr(l+1);if("_"===u||0===s.indexOf("//"))return t;a&&u in a&&S(e,a,u,o);var i=e.mappings[u];return i?i["@id"]+s:t}if(r.vocab&&"@vocab"in e)return e["@vocab"]+t;var c=t;return r.base&&(c=n.prependBase(e["@base"],c)),c}function N(e,t){if(null===e)return t;if(t.indexOf(":")!==-1)return t;J(e)&&(e=n.url.parse(e||""));var r=n.url.parse(t),a={protocol:e.protocol||""};if(null!==r.authority)a.authority=r.authority,a.path=r.path,a.query=r.query;else if(a.authority=e.authority,""===r.path)a.path=e.path,null!==r.query?a.query=r.query:a.query=e.query;else{if(0===r.path.indexOf("/"))a.path=r.path;else{var o=e.path;""!==r.path&&(o=o.substr(0,o.lastIndexOf("/")+1),o.length>0&&"/"!==o.substr(-1)&&(o+="/"),o+=r.path),a.path=o}a.query=r.query}a.path=ae(a.path,!!a.authority);var i=a.protocol;return null!==a.authority&&(i+="//"+a.authority),i+=a.path,null!==a.query&&(i+="?"+a.query),null!==r.fragment&&(i+="#"+r.fragment),""===i&&(i="./"),i}function C(e,t){if(null===e)return t;J(e)&&(e=n.url.parse(e||""));var r="";if(""!==e.href?r+=(e.protocol||"")+"//"+(e.authority||""):t.indexOf("//")&&(r+="//"),0!==t.indexOf(r))return t;for(var a=n.url.parse(t.substr(r.length)),o=e.normalizedPath.split("/"),i=a.normalizedPath.split("/"),l=a.fragment||a.query?0:1;o.length>0&&i.length>l&&o[0]===i[0];)o.shift(),i.shift();var u="";if(o.length>0){o.pop();for(var s=0;s<o.length;++s)u+="../"}return u+=i.join("/"),null!==a.query&&(u+="?"+a.query),null!==a.fragment&&(u+="#"+a.fragment),""===u&&(u="./"),u}function R(e){function t(){var e=this;if(e.inverse)return e.inverse;for(var t=e.inverse={},n=e.fastCurieMap={},o={},i=e["@language"]||"@none",l=e.mappings,u=Object.keys(l).sort(I),s=0;s<u.length;++s){var c=u[s],d=l[c];if(null!==d){var f=d["@container"]||"@none",p=d["@id"];A(p)||(p=[p]);for(var h=0;h<p.length;++h){var v=p[h],g=t[v],y=_(v);if(g)y||d._termHasColon||o[v].push(c);else if(t[v]=g={},!y&&!d._termHasColon){o[v]=[c];var m={iri:v,terms:o[v]};v[0]in n?n[v[0]].push(m):n[v[0]]=[m]}if(g[f]||(g[f]={"@language":{},"@type":{}}),g=g[f],d.reverse)a(d,c,g["@type"],"@reverse");else if("@type"in d)a(d,c,g["@type"],d["@type"]);else if("@language"in d){var x=d["@language"]||"@null";a(d,c,g["@language"],x)}else a(d,c,g["@language"],i),a(d,c,g["@type"],"@none"),a(d,c,g["@language"],"@none")}}}for(var b in n)r(n,b,1);return t}function r(e,t,n){for(var a,o,i=e[t],l=e[t]={},u=0;u<i.length;++u)a=i[u].iri,o=n>=a.length?"":a[n],o in l?l[o].push(i[u]):l[o]=[i[u]];for(var t in l)""!==t&&r(l,t,n+1)}function a(e,t,n,r){r in n||(n[r]=t)}function o(){var e={};return e["@base"]=this["@base"],e.mappings=W(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,"@language"in this&&(e["@language"]=this["@language"]),"@vocab"in this&&(e["@vocab"]=this["@vocab"]),e}var i=n.url.parse(e.base||"");return{"@base":i,mappings:{},inverse:null,getInverse:t,clone:o}}function _(e){if(!J(e))return!1;switch(e){case"@base":case"@context":case"@container":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@omitDefault":case"@preserve":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@vocab":return!0}return!1}function T(e){return"[object Object]"===Object.prototype.toString.call(e)}function U(e){return T(e)&&0===Object.keys(e).length}function A(e){return Array.isArray(e)}function q(e){if(!J(e)&&!U(e)){var t=!1;if(A(e)){t=!0;for(var n=0;n<e.length;++n)if(!J(e[n])){t=!1;break}}if(!t)throw new Ee('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})}}function J(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)}function P(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function F(e){return P(e)&&String(e).indexOf(".")!==-1}function B(e){return!isNaN(parseFloat(e))&&isFinite(e)}function V(e){return"boolean"==typeof e||"[object Boolean]"===Object.prototype.toString.call(e)}function M(e){return"undefined"==typeof e}function z(e){var t=!1;if(T(e)&&!("@value"in e||"@set"in e||"@list"in e)){var n=Object.keys(e).length;t=n>1||!("@id"in e)}return t}function H(e){return T(e)&&1===Object.keys(e).length&&"@id"in e}function X(e){return T(e)&&"@value"in e}function Q(e){return T(e)&&"@list"in e}function G(e){var t=!1;return T(e)&&(t="@id"in e?0===e["@id"].indexOf("_:"):0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e)),t}function $(e){return J(e)&&e.indexOf(":")!==-1}function W(e){if(e&&"object"==typeof e){var t;if(A(e)){t=[];for(var n=0;n<e.length;++n)t[n]=W(e[n])}else if(T(e)){t={};for(var r in e)t[r]=W(e[r])}else t=e.toString();return t}return e}function Y(e,t,r,a){var o=Object.keys(t).length;if(A(e)){for(var i=0;i<e.length;++i)Y(e[i],t,r,a);return o<Object.keys(t).length}if(T(e)){for(var l in e)if("@context"===l){var u=e[l];if(A(u))for(var s=u.length,i=0;i<s;++i){var c=u[i];J(c)&&(c=n.prependBase(a,c),r?(c=t[c],A(c)?(Array.prototype.splice.apply(u,[i,1].concat(c)),i+=c.length-1,s=u.length):u[i]=c):c in t||(t[c]=!1))}else J(u)&&(u=n.prependBase(a,u),r?e[l]=t[u]:u in t||(t[u]=!1))}else Y(e[l],t,r,a);return o<Object.keys(t).length}return!1}function Z(e,t,n){var r=null,a=t.documentLoader,o=function(e,t,n,a,i){if(Object.keys(t).length>Oe)return r=new Ee("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:Oe}),i(r);var l={},u=function(){Y(e,l,!0,a),i(null,e)};Y(e,l,!1,a)||u();var s=[];for(var c in l)l[c]===!1&&s.push(c);for(var d=s.length,f=0;f<s.length;++f)!function(e){if(e in t)return r=new Ee("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"recursive context inclusion",url:e}),i(r);var a=W(t);a[e]=!0;var s=function(t,s){if(!r){var c=s?s.document:null;if(!t&&J(c))try{c=JSON.parse(c)}catch(e){t=e}if(t?t=new Ee("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:e,cause:t}):T(c)||(t=new Ee("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:e,cause:t})),t)return r=t,i(r);c="@context"in c?{"@context":c["@context"]}:{"@context":{}},s.contextUrl&&(A(c["@context"])||(c["@context"]=[c["@context"]]),c["@context"].push(s.contextUrl)),o(c,a,n,e,function(t,n){return t?i(t):(l[e]=n["@context"],d-=1,void(0===d&&u()))})}},c=n(e,s);c&&"then"in c&&c.then(s.bind(null,null),s)}(s[f])};o(e,{},a,t.base,n)}function K(e){for(var t="(?:<([^:]+:[^>]*)>)",n="(_:(?:[A-Za-z0-9]+))",r='"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"',a="(?:\\^\\^"+t+")",o="(?:@([a-z]+(?:-[a-z0-9]+)*))",i="(?:"+r+"(?:"+a+"|"+o+")?)",l="(?:#.*)?",u="[ \\t]+",s="[ \\t]*",c=/(?:\r\n)|(?:\n)|(?:\r)/g,f=new RegExp("^"+s+l+"$"),p="(?:"+t+"|"+n+")"+u,h=t+u,v="(?:"+t+"|"+n+"|"+i+")"+s,g="(?:\\.|(?:(?:"+t+"|"+n+")"+s+"\\.))",y=new RegExp("^"+s+p+h+v+g+s+l+"$"),m={},x=e.split(c),b=0,w=0;w<x.length;++w){var j=x[w];if(b++,!f.test(j)){var k=j.match(y);if(null===k)throw new Ee("Error while parsing N-Quads; invalid quad.","jsonld.ParseError",{line:b});var I={};if(M(k[1])?I.subject={type:"blank node",value:k[2]}:I.subject={type:"IRI",value:k[1]},I.predicate={type:"IRI",value:k[3]},M(k[4]))if(M(k[5])){I.object={type:"literal"},M(k[7])?M(k[8])?I.object.datatype=he:(I.object.datatype=Ie,I.object.language=k[8]):I.object.datatype=k[7];var L=k[6].replace(/\\"/g,'"').replace(/\\t/g,"\t").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");I.object.value=L}else I.object={type:"blank node",value:k[5]};else I.object={type:"IRI",value:k[4]};var O="@default";if(M(k[9])?M(k[10])||(O=k[10]):O=k[9],O in m){for(var E=!0,S=m[O],D=0;E&&D<S.length;++D)d(S[D],I)&&(E=!1);E&&S.push(I)}else m[O]=[I]}}return m}function ee(e){var t=[];for(var n in e)for(var r=e[n],a=0;a<r.length;++a){var o=r[a];"@default"===n&&(n=null),t.push(te(o,n))}return t.sort().join("")}function te(e,t){var n=e.subject,r=e.predicate,a=e.object,o=t||null;"name"in e&&e.name&&(o=e.name.value);var i="";if(i+="IRI"===n.type?"<"+n.value+">":n.value,i+=" ",i+="IRI"===r.type?"<"+r.value+">":r.value,i+=" ","IRI"===a.type)i+="<"+a.value+">";else if("blank node"===a.type)i+=a.value;else{var l=a.value.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\"/g,'\\"');i+='"'+l+'"',a.datatype===Ie?a.language&&(i+="@"+a.language):a.datatype!==he&&(i+="^^<"+a.datatype+">")}return null!==o&&void 0!==o&&(i+=0!==o.indexOf("_:")?" <"+o+">":" "+o),i+=" .\n"}function ne(e){var t={};t["@default"]=[];for(var n=e.getSubjects(),r=0;r<n.length;++r){var a=n[r];if(null!==a){var o=e.getSubjectTriples(a);if(null!==o){var i=o.predicates;for(var l in i)for(var u=i[l].objects,s=0;s<u.length;++s){var c=u[s],d={};0===a.indexOf("_:")?d.subject={type:"blank node",value:a}:d.subject={type:"IRI",value:a},0===l.indexOf("_:")?d.predicate={type:"blank node",value:l}:d.predicate={type:"IRI",value:l};var f=c.value;if(c.type===je){se||_e();var p=new se;f="";for(var h=0;h<c.value.length;h++)c.value[h].nodeType===ce.ELEMENT_NODE?f+=p.serializeToString(c.value[h]):c.value[h].nodeType===ce.TEXT_NODE&&(f+=c.value[h].nodeValue)}d.object={},c.type===ke?0===c.value.indexOf("_:")?d.object.type="blank node":d.object.type="IRI":(d.object.type="literal",c.type===we?c.language?(d.object.datatype=Ie,d.object.language=c.language):d.object.datatype=he:d.object.datatype=c.type),d.object.value=f,t["@default"].push(d)}}}}return t}function re(e){this.prefix=e,this.counter=0,this.existing={}}function ae(e,t){var n="";0===e.indexOf("/")&&(n="/");for(var r=e.split("/"),a=[];r.length>0;)"."===r[0]||""===r[0]&&r.length>1?r.shift():".."!==r[0]?a.push(r.shift()):(r.shift(),t||a.length>0&&".."!==a[a.length-1]?a.pop():a.push(".."));return n+a.join("/")}n.compact=function(e,t,r,a){function o(e,n,r,o){if(e)return a(e);o.compactArrays&&!o.graph&&A(n)?1===n.length?n=n[0]:0===n.length&&(n={}):o.graph&&T(n)&&(n=[n]),T(t)&&"@context"in t&&(t=t["@context"]),t=W(t),A(t)||(t=[t]);var i=t;t=[];for(var l=0;l<i.length;++l)(!T(i[l])||Object.keys(i[l]).length>0)&&t.push(i[l]);var u=t.length>0;if(1===t.length&&(t=t[0]),A(n)){var s=O(r,"@graph"),c=n;n={},u&&(n["@context"]=t),n[s]=c}else if(T(n)&&u){var c=n;n={"@context":t};for(var d in c)n[d]=c[d]}a(null,n,r)}if(arguments.length<2)return n.nextTick(function(){a(new TypeError("Could not compact, too few arguments."))});if("function"==typeof r&&(a=r,r={}),r=r||{},null===t)return n.nextTick(function(){a(new Ee("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"}))});if(null===e)return n.nextTick(function(){a(null,null)});"base"in r||(r.base="string"==typeof e?e:""),"compactArrays"in r||(r.compactArrays=!0),"graph"in r||(r.graph=!1),"skipExpansion"in r||(r.skipExpansion=!1),"documentLoader"in r||(r.documentLoader=n.loadDocument),"link"in r||(r.link=!1),r.link&&(r.skipExpansion=!0);var i=function(e,t,r){return t.skipExpansion?n.nextTick(function(){r(null,e)}):void n.expand(e,t,r)};i(e,r,function(e,i){if(e)return a(new Ee("Could not expand input before compaction.","jsonld.CompactError",{cause:e}));var l=R(r);n.processContext(l,t,r,function(e,t){if(e)return a(new Ee("Could not process context before compaction.","jsonld.CompactError",{cause:e}));var n;try{n=(new Se).compact(t,null,i,r)}catch(e){return a(e)}o(null,n,t,r)})})},n.expand=function(e,t,r){function a(e){"base"in t||(t.base=e.documentUrl||"");var n={document:W(e.document),remoteContext:{"@context":e.contextUrl}};if("expandContext"in t){var a=W(t.expandContext);"object"==typeof a&&"@context"in a?n.expandContext=a:n.expandContext={"@context":a}}Z(n,t,function(e,n){if(e)return r(e);var a;try{var o=new Se,i=R(t),l=n.document,u=n.remoteContext["@context"];n.expandContext&&(i=o.processContext(i,n.expandContext["@context"],t)),u&&(i=o.processContext(i,u,t)),a=o.expand(i,null,l,t,!1),T(a)&&"@graph"in a&&1===Object.keys(a).length?a=a["@graph"]:null===a&&(a=[]),A(a)||(a=[a])}catch(e){return r(e)}r(null,a)})}return arguments.length<1?n.nextTick(function(){r(new TypeError("Could not expand, too few arguments."))}):("function"==typeof t&&(r=t,t={}),t=t||{},"documentLoader"in t||(t.documentLoader=n.loadDocument),"keepFreeFloatingNodes"in t||(t.keepFreeFloatingNodes=!1),void n.nextTick(function(){if("string"==typeof e){var n=function(e,t){if(e)return r(e);try{if(!t.document)throw new Ee("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof t.document&&(t.document=JSON.parse(t.document))}catch(e){return r(new Ee("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:t}))}a(t)},o=t.documentLoader(e,n);return void(o&&"then"in o&&o.then(n.bind(null,null),n))}a({contextUrl:null,documentUrl:null,document:e})}))},n.flatten=function(e,t,r,a){return arguments.length<1?n.nextTick(function(){a(new TypeError("Could not flatten, too few arguments."))}):("function"==typeof r?(a=r,r={}):"function"==typeof t&&(a=t,t=null,r={}),r=r||{},"base"in r||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=n.loadDocument),void n.expand(e,r,function(e,o){if(e)return a(new Ee("Could not expand input before flattening.","jsonld.FlattenError",{cause:e}));var i;try{i=(new Se).flatten(o)}catch(e){return a(e)}return null===t?a(null,i):(r.graph=!0,r.skipExpansion=!0,void n.compact(i,t,r,function(e,t){return e?a(new Ee("Could not compact flattened output.","jsonld.FlattenError",{cause:e})):void a(null,t)}))}))},n.frame=function(e,t,r,a){function o(t){var o,i=t.document;i?(o=i["@context"],t.contextUrl?(o?A(o)?o.push(t.contextUrl):o=[o,t.contextUrl]:o=t.contextUrl,i["@context"]=o):o=o||{}):o={},n.expand(e,r,function(e,t){if(e)return a(new Ee("Could not expand input before framing.","jsonld.FrameError",{cause:e}));var l=W(r);l.isFrame=!0,l.keepFreeFloatingNodes=!0,n.expand(i,l,function(e,r){if(e)return a(new Ee("Could not expand frame before framing.","jsonld.FrameError",{cause:e}));var i;try{i=(new Se).frame(t,r,l)}catch(e){return a(e)}l.graph=!0,l.skipExpansion=!0,l.link={},n.compact(i,o,l,function(e,t,n){if(e)return a(new Ee("Could not compact framed output.","jsonld.FrameError",{cause:e}));var r=O(n,"@graph");l.link={},t[r]=k(n,t[r],l),a(null,t)})})})}return arguments.length<2?n.nextTick(function(){a(new TypeError("Could not frame, too few arguments."))}):("function"==typeof r&&(a=r,r={}),r=r||{},"base"in r||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=n.loadDocument),"embed"in r||(r.embed="@last"),r.explicit=r.explicit||!1,"requireAll"in r||(r.requireAll=!0),r.omitDefault=r.omitDefault||!1,void n.nextTick(function(){if("string"==typeof t){var e=function(e,t){if(e)return a(e);try{if(!t.document)throw new Ee("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof t.document&&(t.document=JSON.parse(t.document))}catch(e){return a(new Ee("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:t}))}o(t)},n=r.documentLoader(t,e);return void(n&&"then"in n&&n.then(e.bind(null,null),e))}o({contextUrl:null,documentUrl:null,document:t})}))},n.link=function(e,t,r,a){var o={};t&&(o["@context"]=t),o["@embed"]="@link",n.frame(e,o,r,a)},n.objectify=function(e,t,r,a){"function"==typeof r&&(a=r,r={}),r=r||{},"base"in r||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=n.loadDocument),n.expand(e,r,function(e,o){if(e)return a(new Ee("Could not expand input before linking.","jsonld.LinkError",{cause:e}));var i;try{i=(new Se).flatten(o)}catch(e){return a(e)}r.graph=!0,r.skipExpansion=!0,n.compact(i,t,r,function(e,t,r){if(e)return a(new Ee("Could not compact flattened output before linking.","jsonld.LinkError",{cause:e}));var o=O(r,"@graph"),i=t[o][0],l=function(e){if(T(e)||A(e)){if(T(e)){if(l.visited[e["@id"]])return;l.visited[e["@id"]]=!0}for(var t in e){var a=e[t],o="@id"===n.getContextValue(r,t,"@type");
if(A(a)||T(a)||o)if(J(a)&&o)e[t]=a=i[a],l(a);else if(A(a))for(var u=0;u<a.length;++u)J(a[u])&&o?a[u]=i[a[u]]:T(a[u])&&"@id"in a[u]&&(a[u]=i[a[u]["@id"]]),l(a[u]);else if(T(a)){var s=a["@id"];e[t]=a=i[s],l(a)}}}};l.visited={},l(i),t.of_type={};for(var u in i)if("@type"in i[u]){var s=i[u]["@type"];A(s)||(s=[s]);for(var c=0;c<s.length;++c)s[c]in t.of_type||(t.of_type[s[c]]=[]),t.of_type[s[c]].push(i[u])}a(null,t)})})},n.normalize=function(e,t,r){if(arguments.length<1)return n.nextTick(function(){r(new TypeError("Could not normalize, too few arguments."))});if("function"==typeof t&&(r=t,t={}),t=t||{},"algorithm"in t||(t.algorithm="URGNA2012"),"base"in t||(t.base="string"==typeof e?e:""),"documentLoader"in t||(t.documentLoader=n.loadDocument),"inputFormat"in t){if("application/nquads"!==t.inputFormat)return r(new Ee("Unknown normalization input format.","jsonld.NormalizeError"));var a=K(e);(new Se).normalize(a,t,r)}else{var o=W(t);delete o.format,o.produceGeneralizedRdf=!1,n.toRDF(e,o,function(e,n){return e?r(new Ee("Could not convert input to RDF dataset before normalization.","jsonld.NormalizeError",{cause:e})):void(new Se).normalize(n,t,r)})}},n.fromRDF=function(e,t,r){return arguments.length<1?n.nextTick(function(){r(new TypeError("Could not convert from RDF, too few arguments."))}):("function"==typeof t&&(r=t,t={}),t=t||{},"useRdfType"in t||(t.useRdfType=!1),"useNativeTypes"in t||(t.useNativeTypes=!1),"format"in t||!J(e)||"format"in t||(t.format="application/nquads"),void n.nextTick(function(){function n(e,t,n){(new Se).fromRDF(e,t,n)}var a;if(t.format){if(a=t.rdfParser||ue[t.format],!a)return r(new Ee("Unknown input format.","jsonld.UnknownFormat",{format:t.format}))}else a=function(){return e};var o=!1;try{e=a(e,function(e,a){return o=!0,e?r(e):void n(a,t,r)})}catch(e){if(!o)return r(e);throw e}if(e){if("then"in e)return e.then(function(e){n(e,t,r)},r);n(e,t,r)}}))},n.toRDF=function(e,t,r){return arguments.length<1?n.nextTick(function(){r(new TypeError("Could not convert to RDF, too few arguments."))}):("function"==typeof t&&(r=t,t={}),t=t||{},"base"in t||(t.base="string"==typeof e?e:""),"documentLoader"in t||(t.documentLoader=n.loadDocument),void n.expand(e,t,function(e,n){if(e)return r(new Ee("Could not expand input before serialization to RDF.","jsonld.RdfError",{cause:e}));var a;try{if(a=Se.prototype.toRDF(n,t),t.format){if("application/nquads"===t.format)return r(null,ee(a));throw new Ee("Unknown output format.","jsonld.UnknownFormat",{format:t.format})}}catch(e){return r(e)}r(null,a)}))},n.createNodeMap=function(e,t,r){return arguments.length<1?n.nextTick(function(){r(new TypeError("Could not create node map, too few arguments."))}):("function"==typeof t&&(r=t,t={}),t=t||{},"base"in t||(t.base="string"==typeof e?e:""),"documentLoader"in t||(t.documentLoader=n.loadDocument),void n.expand(e,t,function(e,n){if(e)return r(new Ee("Could not expand input before creating node map.","jsonld.CreateNodeMapError",{cause:e}));var a;try{a=(new Se).createNodeMap(n,t)}catch(e){return r(e)}r(null,a)}))},n.merge=function(e,t,r,a){function o(e,t){if(!u){if(e)return u=e,a(new Ee("Could not expand input before flattening.","jsonld.FlattenError",{cause:e}));l.push(t),0===--s&&i(l)}}function i(e){var o=!0;"mergeNodes"in r&&(o=r.mergeNodes);var i,l=r.namer||r.issuer||new re("_:b"),u={"@default":{}};try{for(var s=0;s<e.length;++s){var c=e[s];c=n.relabelBlankNodes(c,{issuer:new re("_:b"+s+"-")});var d=o||0===s?u:{"@default":{}};if(f(c,d,"@default",l),d!==u)for(var h in d){var v=d[h];if(h in u){var g=u[h];for(var y in v)y in g||(g[y]=v[y])}else u[h]=v}}i=p(u)}catch(e){return a(e)}for(var m=[],x=Object.keys(i).sort(),b=0;b<x.length;++b){var w=i[x[b]];H(w)||m.push(w)}return null===t?a(null,m):(r.graph=!0,r.skipExpansion=!0,void n.compact(m,t,r,function(e,t){return e?a(new Ee("Could not compact merged output.","jsonld.MergeError",{cause:e})):void a(null,t)}))}if(arguments.length<1)return n.nextTick(function(){a(new TypeError("Could not merge, too few arguments."))});if(!A(e))return n.nextTick(function(){a(new TypeError('Could not merge, "docs" must be an array.'))});"function"==typeof r?(a=r,r={}):"function"==typeof t&&(a=t,t=null,r={}),r=r||{};for(var l=[],u=null,s=e.length,c=0;c<e.length;++c){var d={};for(var h in r)d[h]=r[h];n.expand(e[c],d,o)}},n.relabelBlankNodes=function(e,t){t=t||{};var n=t.namer||t.issuer||new re("_:b");return o(n,e)},n.prependBase=function(e,t){return N(e,t)},n.documentLoader=function(t,r){var a=new Ee("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed"});return e?r(a,{contextUrl:null,documentUrl:t,document:null}):n.promisify(function(e){e(a)})},n.loadDocument=function(e,t){var r=n.documentLoader(e,t);r&&"then"in r&&r.then(t.bind(null,null),t)},n.promises=function(e){e=e||{};var t=Array.prototype.slice,r=n.promisify,a=e.api||{},o=e.version||"jsonld.js";"string"==typeof e.api&&(e.version||(o=e.api),a={}),a.expand=function(e){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");return r.apply(null,[n.expand].concat(t.call(arguments)))},a.compact=function(e,a){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");var o=function(e,t,r,a){n.compact(e,t,r,function(e,t){a(e,t)})};return r.apply(null,[o].concat(t.call(arguments)))},a.flatten=function(e){if(arguments.length<1)throw new TypeError("Could not flatten, too few arguments.");return r.apply(null,[n.flatten].concat(t.call(arguments)))},a.frame=function(e,a){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");return r.apply(null,[n.frame].concat(t.call(arguments)))},a.fromRDF=function(e){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");return r.apply(null,[n.fromRDF].concat(t.call(arguments)))},a.toRDF=function(e){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");return r.apply(null,[n.toRDF].concat(t.call(arguments)))},a.normalize=function(e){if(arguments.length<1)throw new TypeError("Could not normalize, too few arguments.");return r.apply(null,[n.normalize].concat(t.call(arguments)))},"jsonld.js"===o&&(a.link=function(e,a){if(arguments.length<2)throw new TypeError("Could not link, too few arguments.");return r.apply(null,[n.link].concat(t.call(arguments)))},a.objectify=function(e){return r.apply(null,[n.objectify].concat(t.call(arguments)))},a.createNodeMap=function(e){return r.apply(null,[n.createNodeMap].concat(t.call(arguments)))},a.merge=function(e){return r.apply(null,[n.merge].concat(t.call(arguments)))});try{n.Promise=global.Promise||require("es6-promise").Promise}catch(e){var i=function(){throw new Error("Unable to find a Promise implementation.")};for(var l in a)a[l]=i}return a},n.promisify=function(e){if(!n.Promise)try{n.Promise=global.Promise||require("es6-promise").Promise}catch(e){throw new Error("Unable to find a Promise implementation.")}var t=Array.prototype.slice.call(arguments,1);return new n.Promise(function(n,r){e.apply(null,t.concat(function(e,t){e?r(e):n(t)}))})},n.promises({api:n.promises}),r.prototype=n.promises({version:"json-ld-1.0"}),r.prototype.toString=function(){return this instanceof r?"[object JsonLdProcessor]":"[object JsonLdProcessorPrototype]"},n.JsonLdProcessor=r;var oe=!!Object.defineProperty;if(oe)try{Object.defineProperty({},"x",{})}catch(e){oe=!1}oe&&(Object.defineProperty(r,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(r.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:r})),t&&"undefined"==typeof global.JsonLdProcessor&&(oe?Object.defineProperty(global,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:r}):global.JsonLdProcessor=r);var ie="function"==typeof setImmediate&&setImmediate,le=ie?function(e){ie(e)}:function(e){setTimeout(e,0)};"object"==typeof process&&"function"==typeof process.nextTick?n.nextTick=process.nextTick:n.nextTick=le,n.setImmediate=ie?le:n.nextTick,n.parseLinkHeader=function(e){for(var t={},n=e.match(/(?:<[^>]*?>|"[^"]*?"|[^,])+/g),r=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,a=0;a<n.length;++a){var o=n[a].match(r);if(o){for(var i={target:o[1]},l=o[2],u=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g;o=u.exec(l);)i[o[1]]=void 0===o[2]?o[3]:o[2];var s=i.rel||"";A(t[s])?t[s].push(i):s in t?t[s]=[t[s],i]:t[s]=i}}return t},n.RequestQueue=function(){this._requests={}},n.RequestQueue.prototype.wrapLoader=function(e){return this._loader=e,this._usePromise=1===e.length,this.add.bind(this)},n.RequestQueue.prototype.add=function(e,t){var r=this;if(!t&&!r._usePromise)throw new Error("callback must be specified.");return r._usePromise?new n.Promise(function(t,n){var a=r._requests[e];a||(a=r._requests[e]=r._loader(e).then(function(t){return delete r._requests[e],t}).catch(function(t){throw delete r._requests[e],t})),a.then(function(e){t(e)}).catch(function(e){n(e)})}):void(e in r._requests?r._requests[e].push(t):(r._requests[e]=[t],r._loader(e,function(t,n){var a=r._requests[e];delete r._requests[e];for(var o=0;o<a.length;++o)a[o](t,n)})))},n.DocumentCache=function(e){this.order=[],this.cache={},this.size=e||50,this.expires=3e4},n.DocumentCache.prototype.get=function(e){if(e in this.cache){var t=this.cache[e];if(t.expires>=+new Date)return t.ctx;delete this.cache[e],this.order.splice(this.order.indexOf(e),1)}return null},n.DocumentCache.prototype.set=function(e,t){this.order.length===this.size&&delete this.cache[this.order.shift()],this.order.push(e),this.cache[e]={ctx:t,expires:+new Date+this.expires}},n.ActiveContextCache=function(e){this.order=[],this.cache={},this.size=e||100},n.ActiveContextCache.prototype.get=function(e,t){var n=JSON.stringify(e),r=JSON.stringify(t),a=this.cache[n];return a&&r in a?a[r]:null},n.ActiveContextCache.prototype.set=function(e,t,n){if(this.order.length===this.size){var r=this.order.shift();delete this.cache[r.activeCtx][r.localCtx]}var a=JSON.stringify(e),o=JSON.stringify(t);this.order.push({activeCtx:a,localCtx:o}),a in this.cache||(this.cache[a]={}),this.cache[a][o]=W(n)},n.cache={activeCtx:new n.ActiveContextCache},n.documentLoaders={},n.documentLoaders.jquery=function(e,t){function r(r,a){return 0!==r.indexOf("http:")&&0!==r.indexOf("https:")?a(new Ee('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null}):t.secure&&0!==r.indexOf("https")?a(new Ee('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null}):void e.ajax({url:r,accepts:{json:"application/ld+json, application/json"},headers:{Accept:"application/ld+json, application/json"},dataType:"json",crossDomain:!0,success:function(e,t,o){var i={contextUrl:null,documentUrl:r,document:e},l=o.getResponseHeader("Content-Type"),u=o.getResponseHeader("Link");if(u&&"application/ld+json"!==l){if(u=n.parseLinkHeader(u)[Le],A(u))return a(new Ee("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:r}),i);u&&(i.contextUrl=u.target)}a(null,i)},error:function(e,t,n){a(new Ee("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:r,cause:n}),{contextUrl:null,documentUrl:r,document:null})}})}t=t||{};var a=new n.RequestQueue,o="usePromise"in t?t.usePromise:"undefined"!=typeof Promise;return o?a.wrapLoader(function(e){return n.promisify(r,e)}):a.wrapLoader(r)},n.documentLoaders.node=function(e){function t(u,s,c){function d(e,r,o){if(f={contextUrl:null,documentUrl:u,document:o||null},e)return c(new Ee("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:u,cause:e}),f);var i=l.STATUS_CODES[r.statusCode];if(r.statusCode>=400)return c(new Ee("URL could not be dereferenced: "+i,"jsonld.InvalidUrl",{code:"loading document failed",url:u,httpStatusCode:r.statusCode}),f);if(r.headers.link&&"application/ld+json"!==r.headers["content-type"]){var d=n.parseLinkHeader(r.headers.link)[Le];if(A(d))return c(new Ee("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:u}),f);d&&(f.contextUrl=d.target)}return r.statusCode>=300&&r.statusCode<400&&r.headers.location?s.length===a?c(new Ee("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:u,httpStatusCode:r.statusCode,redirects:s}),f):s.indexOf(u)!==-1?c(new Ee("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:u,httpStatusCode:r.statusCode,redirects:s}),f):(s.push(u),t(r.headers.location,s,c)):(s.push(u),void c(e,f))}if(0!==u.indexOf("http:")&&0!==u.indexOf("https:"))return c(new Ee('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:u}),{contextUrl:null,documentUrl:u,document:null});if(e.secure&&0!==u.indexOf("https"))return c(new Ee('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:u}),{contextUrl:null,documentUrl:u,document:null});var f=null;if(null!==f)return c(null,f);var p={Accept:i};for(var h in e.headers)p[h]=e.headers[h];o({url:u,headers:p,strictSSL:r,followRedirect:!1},d)}e=e||{};var r=!("strictSSL"in e)||e.strictSSL,a="maxRedirects"in e?e.maxRedirects:-1,o="request"in e?e.request:require("request"),i="application/ld+json, application/json",l=require("http"),u=new n.RequestQueue;if(e.usePromise)return u.wrapLoader(function(e){return n.promisify(t,e,[])});var s=e.headers||{};if("Accept"in s||"accept"in s)throw new RangeError('Accept header may not be specified as an option; only "'+i+'" is supported.');return u.wrapLoader(function(e,n){t(e,[],n)})},n.documentLoaders.xhr=function(e){function t(t,a){if(0!==t.indexOf("http:")&&0!==t.indexOf("https:"))return a(new Ee('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:t}),{contextUrl:null,documentUrl:t,document:null});if(e.secure&&0!==t.indexOf("https"))return a(new Ee('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:t}),{contextUrl:null,documentUrl:t,document:null});var o=e.xhr||XMLHttpRequest,i=new o;i.onload=function(){if(i.status>=400)return a(new Ee("URL could not be dereferenced: "+i.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:t,httpStatusCode:i.status}),{contextUrl:null,documentUrl:t,document:null});var e,o={contextUrl:null,documentUrl:t,document:i.response},l=i.getResponseHeader("Content-Type");if(r.test(i.getAllResponseHeaders())&&(e=i.getResponseHeader("Link")),e&&"application/ld+json"!==l){if(e=n.parseLinkHeader(e)[Le],A(e))return a(new Ee("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:t}),o);e&&(o.contextUrl=e.target)}a(null,o)},i.onerror=function(){a(new Ee("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:t}),{contextUrl:null,documentUrl:t,document:null})},i.open("GET",t,!0),i.setRequestHeader("Accept","application/ld+json, application/json"),i.send()}e=e||{};var r=/(^|(\r\n))link:/i,a=new n.RequestQueue,o="usePromise"in e?e.usePromise:"undefined"!=typeof Promise;return o?a.wrapLoader(function(e){return n.promisify(t,e)}):a.wrapLoader(t)},n.useDocumentLoader=function(e){if(!(e in n.documentLoaders))throw new Ee('Unknown document loader type: "'+e+'"',"jsonld.UnknownDocumentLoader",{type:e});n.documentLoader=n.documentLoaders[e].apply(n,Array.prototype.slice.call(arguments,1))},n.processContext=function(e,t){var r={},a=2;arguments.length>3&&(r=arguments[2]||{},a+=1);var o=arguments[a];return"base"in r||(r.base=""),"documentLoader"in r||(r.documentLoader=n.loadDocument),null===t?o(null,R(r)):(t=W(t),T(t)&&"@context"in t||(t={"@context":t}),void Z(t,r,function(t,n){if(t)return o(t);try{n=(new Se).processContext(e,n,r)}catch(e){return o(e)}o(null,n)}))},n.hasProperty=function(e,t){var n=!1;if(t in e){var r=e[t];n=!A(r)||r.length>0}return n},n.hasValue=function(e,t,r){var a=!1;if(n.hasProperty(e,t)){var o=e[t],i=Q(o);if(A(o)||i){i&&(o=o["@list"]);for(var l=0;l<o.length;++l)if(n.compareValues(r,o[l])){a=!0;break}}else A(r)||(a=n.compareValues(r,o))}return a},n.addValue=function(e,t,r,a){if(a=a||{},"propertyIsArray"in a||(a.propertyIsArray=!1),"allowDuplicate"in a||(a.allowDuplicate=!0),A(r)){0!==r.length||!a.propertyIsArray||t in e||(e[t]=[]);for(var o=0;o<r.length;++o)n.addValue(e,t,r[o],a)}else if(t in e){var i=!a.allowDuplicate&&n.hasValue(e,t,r);A(e[t])||i&&!a.propertyIsArray||(e[t]=[e[t]]),i||e[t].push(r)}else e[t]=a.propertyIsArray?[r]:r},n.getValues=function(e,t){var n=e[t]||[];return A(n)||(n=[n]),n},n.removeProperty=function(e,t){delete e[t]},n.removeValue=function(e,t,r,a){a=a||{},"propertyIsArray"in a||(a.propertyIsArray=!1);var o=n.getValues(e,t).filter(function(e){return!n.compareValues(e,r)});0===o.length?n.removeProperty(e,t):1!==o.length||a.propertyIsArray?e[t]=o:e[t]=o[0]},n.compareValues=function(e,t){return e===t||(!(!X(e)||!X(t)||e["@value"]!==t["@value"]||e["@type"]!==t["@type"]||e["@language"]!==t["@language"]||e["@index"]!==t["@index"])||!!(T(e)&&"@id"in e&&T(t)&&"@id"in t)&&e["@id"]===t["@id"])},n.getContextValue=function(e,t,n){var r=null;if(null===t)return r;if("@language"===n&&n in e&&(r=e[n]),e.mappings[t]){var a=e.mappings[t];M(n)?r=a:n in a&&(r=a[n])}return r};var ue={};if(n.registerRDFParser=function(e,t){ue[e]=t},n.unregisterRDFParser=function(e){delete ue[e]},e){if("undefined"==typeof se)var se=null;if("undefined"==typeof ce)var ce={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}var de="http://www.w3.org/2001/XMLSchema#boolean",fe="http://www.w3.org/2001/XMLSchema#double",pe="http://www.w3.org/2001/XMLSchema#integer",he="http://www.w3.org/2001/XMLSchema#string",ve="http://www.w3.org/1999/02/22-rdf-syntax-ns#",ge=ve+"List",ye=ve+"first",me=ve+"rest",xe=ve+"nil",be=ve+"type",we=ve+"PlainLiteral",je=ve+"XMLLiteral",ke=ve+"object",Ie=ve+"langString",Le="http://www.w3.org/ns/json-ld#context",Oe=10,Ee=function(t,n,r){e?(Error.call(this),Error.captureStackTrace(this,this.constructor)):"undefined"!=typeof Error&&(this.stack=(new Error).stack),this.name=n||"jsonld.Error",this.message=t||"An unspecified JSON-LD error occurred.",this.details=r||{}};e?require("util").inherits(Ee,Error):"undefined"!=typeof Error&&(Ee.prototype=new Error);var Se=function(){};Se.prototype.compact=function(e,t,r,a){if(A(r)){for(var o=[],i=0;i<r.length;++i){var l=this.compact(e,t,r[i],a);null!==l&&o.push(l)}if(a.compactArrays&&1===o.length){var u=n.getContextValue(e,t,"@container");null===u&&(o=o[0])}return o}if(T(r)){if(a.link&&"@id"in r&&r["@id"]in a.link)for(var s=a.link[r["@id"]],i=0;i<s.length;++i)if(s[i].expanded===r)return s[i].compacted;if(X(r)||H(r)){var o=E(e,t,r);return a.link&&H(r)&&(r["@id"]in a.link||(a.link[r["@id"]]=[]),a.link[r["@id"]].push({expanded:r,compacted:o})),o}var c="@reverse"===t,o={};a.link&&"@id"in r&&(r["@id"]in a.link||(a.link[r["@id"]]=[]),a.link[r["@id"]].push({expanded:r,compacted:o}));for(var d=Object.keys(r).sort(),f=0;f<d.length;++f){var p=d[f],h=r[p];if("@id"!==p&&"@type"!==p)if("@reverse"!==p)if("@index"!==p)if("@graph"!==p&&"@list"!==p&&_(p)){var v=O(e,p);n.addValue(o,v,h)}else{if(0===h.length){var g=O(e,p,h,{vocab:!0},c);n.addValue(o,g,h,{propertyIsArray:!0})}for(var y=0;y<h.length;++y){var m=h[y],g=O(e,p,m,{vocab:!0},c),u=n.getContextValue(e,g,"@container"),x=Q(m),b=null;x&&(b=m["@list"]);var w=this.compact(e,g,x?b:m,a);if(x)if(A(w)||(w=[w]),"@list"!==u){var j={};j[O(e,"@list")]=w,w=j,"@index"in m&&(w[O(e,"@index")]=m["@index"])}else if(g in o)throw new Ee('JSON-LD compact error; property has a "@list" @container rule but there is more than a single @list that matches the compacted term in the document. Compaction might mix unwanted items into the list.',"jsonld.SyntaxError",{code:"compaction to list of lists"});if("@language"===u||"@index"===u){var k;g in o?k=o[g]:o[g]=k={},"@language"===u&&X(w)&&(w=w["@value"]),n.addValue(k,m[u],w)}else{var I=!a.compactArrays||"@set"===u||"@list"===u||A(w)&&0===w.length||"@list"===p||"@graph"===p;n.addValue(o,g,w,{propertyIsArray:I})}}}else{var u=n.getContextValue(e,t,"@container");if("@index"===u)continue;var v=O(e,p);n.addValue(o,v,h)}else{var L=this.compact(e,"@reverse",h,a);for(var S in L)if(e.mappings[S]&&e.mappings[S].reverse){var D=L[S],u=n.getContextValue(e,S,"@container"),N="@set"===u||!a.compactArrays;n.addValue(o,S,D,{propertyIsArray:N}),delete L[S]}if(Object.keys(L).length>0){var v=O(e,p);n.addValue(o,v,L)}}else{var L;if(J(h))L=O(e,h,null,{vocab:"@type"===p});else{L=[];for(var y=0;y<h.length;++y)L.push(O(e,h[y],null,{vocab:!0}))}var v=O(e,p),I=A(L)&&0===h.length;n.addValue(o,v,L,{propertyIsArray:I})}}return o}return r},Se.prototype.expand=function(e,t,r,o,l){var u=this;if(null===r||void 0===r)return null;if(!A(r)&&!T(r))return l||null!==t&&"@graph"!==D(e,t,{vocab:!0})?i(e,t,r):null;if(A(r)){var s=[],c=n.getContextValue(e,t,"@container");l=l||"@list"===c;for(var d=0;d<r.length;++d){var f=u.expand(e,t,r[d],o);if(l&&(A(f)||Q(f)))throw new Ee("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"});null!==f&&(A(f)?s=s.concat(f):s.push(f))}return s}"@context"in r&&(e=u.processContext(e,r["@context"],o));for(var p=D(e,t,{vocab:!0}),s={},h=Object.keys(r).sort(),v=0;v<h.length;++v){var g,y=h[v],m=r[y];if("@context"!==y){var x=D(e,y,{vocab:!0});if(null!==x&&($(x)||_(x))){if(_(x)){if("@reverse"===p)throw new Ee("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:m});if(x in s)throw new Ee("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:x})}if("@id"===x&&!J(m)){if(!o.isFrame)throw new Ee('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:m});if(!T(m))throw new Ee('Invalid JSON-LD syntax; "@id" value must be a string or an object.',"jsonld.SyntaxError",{code:"invalid @id value",value:m})}if("@type"===x&&q(m),"@graph"===x&&!T(m)&&!A(m))throw new Ee('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:m});if("@value"===x&&(T(m)||A(m)))throw new Ee('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:m});if("@language"===x){if(null===m)continue;if(!J(m))throw new Ee('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:m});m=m.toLowerCase()}if("@index"===x&&!J(m))throw new Ee('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:m});if("@reverse"!==x){var c=n.getContextValue(e,y,"@container");if("@language"===c&&T(m))g=a(m);else if("@index"===c&&T(m))g=function(t){for(var n=[],r=Object.keys(m).sort(),a=0;a<r.length;++a){var i=r[a],l=m[i];A(l)||(l=[l]),l=u.expand(e,t,l,o,!1);for(var s=0;s<l.length;++s){var c=l[s];"@index"in c||(c["@index"]=i),n.push(c)}}return n}(y);else{var b="@list"===x;if(b||"@set"===x){var w=t;if(b&&"@graph"===p&&(w=null),g=u.expand(e,w,m,o,b),b&&Q(g))throw new Ee("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"})}else g=u.expand(e,y,m,o,!1)}if(null!==g||"@value"===x)if("@list"===x||Q(g)||"@list"!==c||(g=A(g)?g:[g],g={"@list":g}),e.mappings[y]&&e.mappings[y].reverse){var j=s["@reverse"]=s["@reverse"]||{};A(g)||(g=[g]);for(var k=0;k<g.length;++k){var I=g[k];if(X(I)||Q(I))throw new Ee('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:g});n.addValue(j,x,I,{propertyIsArray:!0})}}else{var L=["@index","@id","@type","@value","@language"].indexOf(x)===-1;n.addValue(s,x,g,{propertyIsArray:L})}}else{if(!T(m))throw new Ee('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:m});if(g=u.expand(e,"@reverse",m,o),"@reverse"in g)for(var O in g["@reverse"])n.addValue(s,O,g["@reverse"][O],{propertyIsArray:!0});var j=s["@reverse"]||null;for(var O in g)if("@reverse"!==O){null===j&&(j=s["@reverse"]={}),n.addValue(j,O,[],{propertyIsArray:!0});for(var E=g[O],k=0;k<E.length;++k){var I=E[k];if(X(I)||Q(I))throw new Ee('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:g});n.addValue(j,O,I,{propertyIsArray:!0})}}}}}}h=Object.keys(s);var S=h.length;if("@value"in s){if("@type"in s&&"@language"in s)throw new Ee('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:s});var N=S-1;if("@type"in s&&(N-=1),"@index"in s&&(N-=1),"@language"in s&&(N-=1),0!==N)throw new Ee('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:s});if(null===s["@value"])s=null;else{if("@language"in s&&!J(s["@value"]))throw new Ee("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:s});if("@type"in s&&(!$(s["@type"])||0===s["@type"].indexOf("_:")))throw new Ee('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:s})}}else if("@type"in s&&!A(s["@type"]))s["@type"]=[s["@type"]];else if("@set"in s||"@list"in s){if(S>1&&!(2===S&&"@index"in s))throw new Ee('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:s});"@set"in s&&(s=s["@set"],h=Object.keys(s),S=h.length)}else 1===S&&"@language"in s&&(s=null);return!T(s)||o.keepFreeFloatingNodes||l||null!==t&&"@graph"!==p||(0===S||"@value"in s||"@list"in s||1===S&&"@id"in s)&&(s=null),s},Se.prototype.createNodeMap=function(e,t){t=t||{};var n=t.namer||t.issuer||new re("_:b"),r={"@default":{}};return f(e,r,"@default",n),p(r)},Se.prototype.flatten=function(e){for(var t=this.createNodeMap(e),n=[],r=Object.keys(t).sort(),a=0;a<r.length;++a){var o=t[r[a]];H(o)||n.push(o)}return n},Se.prototype.frame=function(e,t,n){var r={options:n,graphs:{"@default":{},"@merged":{}},subjectStack:[],link:{}},a=new re("_:b");f(e,r.graphs,"@merged",a),r.subjects=r.graphs["@merged"];var o=[];return h(r,Object.keys(r.subjects).sort(),t,o,null),o},Se.prototype.normalize=function(e,t,n){return"URDNA2015"===t.algorithm?new De(t).main(e,n):"URGNA2012"===t.algorithm?new Ne(t).main(e,n):void n(new Error("Invalid RDF Dataset Normalization algorithm: "+t.algorithm))},Se.prototype.fromRDF=function(e,t,r){var a={},o={"@default":a},i={};for(var l in e){var u=e[l];l in o||(o[l]={}),"@default"===l||l in a||(a[l]={"@id":l});for(var s=o[l],d=0;d<u.length;++d){var f=u[d],p=f.subject.value,h=f.predicate.value,v=f.object;p in s||(s[p]={"@id":p});var g=s[p],y="IRI"===v.type||"blank node"===v.type;if(!y||v.value in s||(s[v.value]={"@id":v.value}),h!==be||t.useRdfType||!y){var m=c(v,t.useNativeTypes);if(n.addValue(g,h,m,{propertyIsArray:!0}),y)if(v.value===xe){var x=s[v.value];"usages"in x||(x.usages=[]),x.usages.push({node:g,property:h,value:m})}else v.value in i?i[v.value]=!1:i[v.value]={node:g,property:h,value:m}}else n.addValue(g,"@type",v.value,{propertyIsArray:!0})}}for(var l in o){var b=o[l];if(xe in b){for(var w=b[xe],j=0;j<w.usages.length;++j){for(var k=w.usages[j],g=k.node,I=k.property,L=k.value,O=[],E=[],S=Object.keys(g).length;I===me&&T(i[g["@id"]])&&A(g[ye])&&1===g[ye].length&&A(g[me])&&1===g[me].length&&(3===S||4===S&&A(g["@type"])&&1===g["@type"].length&&g["@type"][0]===ge)&&(O.push(g[ye][0]),E.push(g["@id"]),k=i[g["@id"]],g=k.node,I=k.property,L=k.value,S=Object.keys(g).length,0===g["@id"].indexOf("_:")););if(I===ye){if(g["@id"]===xe)continue;L=b[L["@id"]][me][0],O.pop(),E.pop()}delete L["@id"],L["@list"]=O.reverse();for(var D=0;D<E.length;++D)delete b[E[D]]}delete w.usages}}for(var N=[],C=Object.keys(a).sort(),j=0;j<C.length;++j){var R=C[j],g=a[R];if(R in o)for(var u=g["@graph"]=[],b=o[R],_=Object.keys(b).sort(),U=0;U<_.length;++U){var q=b[_[U]];H(q)||u.push(q)}H(g)||N.push(g)}r(null,N)},Se.prototype.toRDF=function(e,t){var n=new re("_:b"),r={"@default":{}};f(e,r,"@default",n);for(var a={},o=Object.keys(r).sort(),i=0;i<o.length;++i){var u=o[i];("@default"===u||$(u))&&(a[u]=l(r[u],n,t))}return a},Se.prototype.processContext=function(e,t,r){T(t)&&"@context"in t&&A(t["@context"])&&(t=t["@context"]);var a=A(t)?t:[t];if(0===a.length)return e.clone();for(var o=e,i=0;i<a.length;++i){var l=a[i];if(null!==l){if(T(l)&&"@context"in l&&(l=l["@context"]),!T(l))throw new Ee("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:l});if(n.cache.activeCtx){var u=n.cache.activeCtx.get(e,l);if(u){o=e=u;continue}}e=o,o=o.clone();var s={};if("@base"in l){var c=l["@base"];if(null===c)c=null;else{if(!J(c))throw new Ee('Invalid JSON-LD syntax; the value of "@base" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:l});if(""!==c&&!$(c))throw new Ee('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI or the empty string.',"jsonld.SyntaxError",{code:"invalid base IRI",context:l})}null!==c&&(c=n.url.parse(c||"")),o["@base"]=c,s["@base"]=!0}if("@vocab"in l){var d=l["@vocab"];if(null===d)delete o["@vocab"];else{if(!J(d))throw new Ee('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:l});if(!$(d))throw new Ee('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:l});o["@vocab"]=d}s["@vocab"]=!0}if("@language"in l){var d=l["@language"];if(null===d)delete o["@language"];else{if(!J(d))throw new Ee('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:l});o["@language"]=d.toLowerCase()}s["@language"]=!0}for(var f in l)S(o,l,f,s);n.cache.activeCtx&&n.cache.activeCtx.set(e,l,o)}else o=e=R(r)}return o};var De=function(){var e={subject:"s",object:"o",name:"g"},t=function(e){e=e||{},this.name="URDNA2015",this.options=e,this.blankNodeInfo={},this.hashToBlankNodes={},this.canonicalIssuer=new re("_:c14n"),this.quads=[],this.schedule={},"maxCallStackDepth"in e?this.schedule.MAX_DEPTH=e.maxCallStackDepth:this.schedule.MAX_DEPTH=500,"maxTotalCallStackDepth"in e?this.schedule.MAX_TOTAL_DEPTH=e.maxCallStackDepth:this.schedule.MAX_TOTAL_DEPTH=4294967295,this.schedule.depth=0,this.schedule.totalDepth=0,"timeSlice"in e?this.schedule.timeSlice=e.timeSlice:this.schedule.timeSlice=10};return t.prototype.doWork=function(e,t){
var r=this.schedule;return r.totalDepth>=r.MAX_TOTAL_DEPTH?t(new Error("Maximum total call stack depth exceeded; normalization aborting.")):void function a(){if(r.depth===r.MAX_DEPTH)return r.depth=0,r.running=!1,n.nextTick(a);var o=(new Date).getTime();return r.running||(r.start=(new Date).getTime(),r.deadline=r.start+r.timeSlice),o<r.deadline?(r.running=!0,r.depth++,r.totalDepth++,e(function(e,n){r.depth--,r.totalDepth--,t(e,n)})):(r.depth=0,r.running=!1,void n.setImmediate(a))}()},t.prototype.forEach=function(e,t,n){var r,a,o=this,i=0;if(A(e))a=e.length,r=function(){return i!==a&&(r.value=e[i++],r.key=i,!0)};else{var l=Object.keys(e);a=l.length,r=function(){return i!==a&&(r.key=l[i++],r.value=e[r.key],!0)}}!function e(a,i){return a?n(a):r()?o.doWork(function(){t(r.value,r.key,e)}):void n()}()},t.prototype.waterfall=function(e,t){var n=this;n.forEach(e,function(e,t,r){n.doWork(e,r)},t)},t.prototype.whilst=function(e,t,n){var r=this;!function a(o){return o?n(o):e()?void r.doWork(t,a):n()}()},t.prototype.main=function(e,t){var n=this;n.schedule.start=(new Date).getTime();var r;if(n.options.format&&"application/nquads"!==n.options.format)return t(new Ee("Unknown output format.","jsonld.UnknownFormat",{format:n.options.format}));var a={};n.waterfall([function(t){n.forEach(e,function(e,t,r){"@default"===t&&(t=null),n.forEach(e,function(e,r,o){null!==t&&(0===t.indexOf("_:")?e.name={type:"blank node",value:t}:e.name={type:"IRI",value:t}),n.quads.push(e),n.forEachComponent(e,function(t){if("blank node"===t.type){var r=t.value;r in n.blankNodeInfo?n.blankNodeInfo[r].quads.push(e):(a[r]=!0,n.blankNodeInfo[r]={quads:[e]})}}),o()},r)},t)},function(e){var t=!0;n.whilst(function(){return t},function(e){t=!1,n.hashToBlankNodes={},n.waterfall([function(e){n.forEach(a,function(e,t,r){n.hashFirstDegreeQuads(t,function(e,a){return e?r(e):(a in n.hashToBlankNodes?n.hashToBlankNodes[a].push(t):n.hashToBlankNodes[a]=[t],void r())})},e)},function(e){var r=Object.keys(n.hashToBlankNodes).sort();n.forEach(r,function(e,r,o){var i=n.hashToBlankNodes[e];if(i.length>1)return o();var l=i[0];n.canonicalIssuer.getId(l),delete a[l],delete n.hashToBlankNodes[e],t=!0,o()},e)}],e)},e)},function(e){var t=Object.keys(n.hashToBlankNodes).sort();n.forEach(t,function(e,t,r){var a=[],o=n.hashToBlankNodes[e];n.waterfall([function(e){n.forEach(o,function(e,t,r){if(n.canonicalIssuer.hasId(e))return r();var o=new re("_:b");o.getId(e),n.hashNDegreeQuads(e,o,function(e,t){return e?r(e):(a.push(t),void r())})},e)},function(e){a.sort(function(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}),n.forEach(a,function(e,t,r){for(var a in e.issuer.existing)n.canonicalIssuer.getId(a);r()},e)}],r)},e)},function(e){var t=[];n.waterfall([function(e){n.forEach(n.quads,function(e,r,a){n.forEachComponent(e,function(e){"blank node"===e.type&&0!==e.value.indexOf(n.canonicalIssuer.prefix)&&(e.value=n.canonicalIssuer.getId(e.value))}),t.push(te(e)),a()},e)},function(e){return t.sort(),"application/nquads"===n.options.format?(r=t.join(""),e()):(r=K(t.join("")),void e())}],e)}],function(e){t(e,r)})},t.prototype.hashFirstDegreeQuads=function(e,t){var n=this,r=n.blankNodeInfo[e];if("hash"in r)return t(null,r.hash);var a=[],o=r.quads;n.forEach(o,function(t,r,o){var i={predicate:t.predicate};n.forEachComponent(t,function(t,r){i[r]=n.modifyFirstDegreeComponent(e,t,r)}),a.push(te(i)),o()},function(e){return e?t(e):(a.sort(),r.hash=Re.hashNQuads(n.name,a),void t(null,r.hash))})},t.prototype.modifyFirstDegreeComponent=function(e,t){return"blank node"!==t.type?t:(t=W(t),t.value=t.value===e?"_:a":"_:z",t)},t.prototype.hashRelatedBlankNode=function(e,t,n,r,a){var o,i=this;i.waterfall([function(t){return i.canonicalIssuer.hasId(e)?(o=i.canonicalIssuer.getId(e),t()):n.hasId(e)?(o=n.getId(e),t()):void i.hashFirstDegreeQuads(e,function(e,n){return e?t(e):(o=n,void t())})}],function(e){if(e)return a(e);var n=new Re(i.name);return n.update(r),"g"!==r&&n.update(i.getRelatedPredicate(t)),n.update(o),a(null,n.digest())})},t.prototype.getRelatedPredicate=function(e){return"<"+e.predicate.value+">"},t.prototype.hashNDegreeQuads=function(e,t,n){var r,a=this,o=new Re(a.name);a.waterfall([function(n){a.createHashToRelated(e,t,function(e,t){return e?n(e):(r=t,void n())})},function(e){var n=Object.keys(r).sort();a.forEach(n,function(e,n,i){o.update(e);var l,u="",s=new Ce(r[e]);a.whilst(function(){return s.hasNext()},function(e){var n=s.next(),r=t.clone(),o="",i=[];a.waterfall([function(t){a.forEach(n,function(t,n,l){return a.canonicalIssuer.hasId(t)?o+=a.canonicalIssuer.getId(t):(r.hasId(t)||i.push(t),o+=r.getId(t)),0!==u.length&&o.length>=u.length&&o>u?e():void l()},t)},function(t){a.forEach(i,function(t,n,i){a.hashNDegreeQuads(t,r,function(n,a){return n?i(n):(o+=r.getId(t),o+="<"+a.hash+">",r=a.issuer,0!==u.length&&o.length>=u.length&&o>u?e():void i())})},t)},function(e){(0===u.length||o<u)&&(u=o,l=r),e()}],e)},function(e){return e?i(e):(o.update(u),t=l,void i())})},e)}],function(e){n(e,{hash:o.digest(),issuer:t})})},t.prototype.createHashToRelated=function(t,n,r){var a=this,o={},i=a.blankNodeInfo[t].quads;a.forEach(i,function(r,i,l){a.forEach(r,function(i,l,u){if("predicate"===l||"blank node"!==i.type||i.value===t)return u();var s=i.value,c=e[l];a.hashRelatedBlankNode(s,r,n,c,function(e,t){return e?u(e):(t in o?o[t].push(s):o[t]=[s],void u())})},l)},function(e){r(e,o)})},t.prototype.forEachComponent=function(e,t){for(var n in e)"predicate"!==n&&t(e[n],n,e)},t}(),Ne=function(){var e=function(e){De.call(this,e),this.name="URGNA2012"};return e.prototype=new De,e.prototype.modifyFirstDegreeComponent=function(e,t,n){return"blank node"!==t.type?t:(t=W(t),"name"===n?t.value="_:g":t.value=t.value===e?"_:a":"_:z",t)},e.prototype.getRelatedPredicate=function(e){return e.predicate.value},e.prototype.createHashToRelated=function(e,t,n){var r=this,a={},o=r.blankNodeInfo[e].quads;r.forEach(o,function(n,o,i){var l,u;if("blank node"===n.subject.type&&n.subject.value!==e)u=n.subject.value,l="p";else{if("blank node"!==n.object.type||n.object.value===e)return i();u=n.object.value,l="r"}r.hashRelatedBlankNode(u,n,t,l,function(e,t){t in a?a[t].push(u):a[t]=[u],i()})},function(e){n(e,a)})},e}();Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on non-object");var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}),n.registerRDFParser("application/nquads",K),n.registerRDFParser("rdfa-api",ne),n.IdentifierIssuer=re,n.UniqueNamer=re,re.prototype.clone=function(){var e=new re(this.prefix);return e.counter=this.counter,e.existing=W(this.existing),e},re.prototype.getId=function(e){if(e&&e in this.existing)return this.existing[e];var t=this.prefix+this.counter;return this.counter+=1,e&&(this.existing[e]=t),t},re.prototype.getName=re.prototype.getName,re.prototype.hasId=function(e){return e in this.existing},re.prototype.isNamed=re.prototype.hasId;var Ce=function(e){this.list=e.sort(),this.done=!1,this.left={};for(var t=0;t<e.length;++t)this.left[e[t]]=!0};Ce.prototype.hasNext=function(){return!this.done},Ce.prototype.next=function(){for(var e=this.list.slice(),t=null,n=0,r=this.list.length,a=0;a<r;++a){var o=this.list[a],i=this.left[o];(null===t||o>t)&&(i&&a>0&&o>this.list[a-1]||!i&&a<r-1&&o>this.list[a+1])&&(t=o,n=a)}if(null===t)this.done=!0;else{var l=this.left[t]?n-1:n+1;this.list[n]=this.list[l],this.list[l]=t;for(var a=0;a<r;++a)this.list[a]>t&&(this.left[this.list[a]]=!this.left[this.list[a]])}return e};var Re=function(e){if(!(this instanceof Re))return new Re(e);if(["URDNA2015","URGNA2012"].indexOf(e)===-1)throw new Error("Invalid RDF Dataset Normalization algorithm: "+e);Re._init.call(this,e)};if(Re.hashNQuads=function(e,t){for(var n=new Re(e),r=0;r<t.length;++r)n.update(t[r]);return n.digest()},function(e){if(e){var t=require("crypto");return Re._init=function(e){e="URDNA2015"===e?"sha256":"sha1",this.md=t.createHash(e)},Re.prototype.update=function(e){return this.md.update(e,"utf8")},void(Re.prototype.digest=function(){return this.md.digest("hex")})}Re._init=function(e){e="URDNA2015"===e?new a.Algorithm:new r.Algorithm,this.md=new n(e)},Re.prototype.update=function(e){return this.md.update(e)},Re.prototype.digest=function(){return this.md.digest().toHex()};var n=function(e){if(!(this instanceof n))return new n(e);if(this._algorithm=e,!n._padding||n._padding.length<this._algorithm.blockSize){n._padding=String.fromCharCode(128);for(var t=String.fromCharCode(0),r=64;r>0;)1&r&&(n._padding+=t),r>>>=1,r>0&&(t+=t)}this.start()};n.prototype.start=function(){this.messageLength=0,this.fullMessageLength=[];for(var e=this._algorithm.messageLengthSize/4,t=0;t<e;++t)this.fullMessageLength.push(0);return this._input=new n.ByteBuffer,this.state=this._algorithm.start(),this},n.prototype.update=function(e){e=new n.ByteBuffer(unescape(encodeURIComponent(e))),this.messageLength+=e.length();var t=e.length();t=[t/4294967296>>>0,t>>>0];for(var r=this.fullMessageLength.length-1;r>=0;--r)this.fullMessageLength[r]+=t[1],t[1]=t[0]+(this.fullMessageLength[r]/4294967296>>>0),this.fullMessageLength[r]=this.fullMessageLength[r]>>>0,t[0]=t[1]/4294967296>>>0;for(this._input.putBytes(e.bytes());this._input.length()>=this._algorithm.blockSize;)this.state=this._algorithm.digest(this.state,this._input);return(this._input.read>2048||0===this._input.length())&&this._input.compact(),this},n.prototype.digest=function(){var e=new n.ByteBuffer;e.putBytes(this._input.bytes());var t=this.fullMessageLength[this.fullMessageLength.length-1]+this._algorithm.messageLengthSize,r=t&this._algorithm.blockSize-1;e.putBytes(n._padding.substr(0,this._algorithm.blockSize-r));for(var a=new n.ByteBuffer,o=0;o<this.fullMessageLength.length;++o)a.putInt32(this.fullMessageLength[o]<<3|this.fullMessageLength[o+1]>>>28);this._algorithm.writeMessageLength(e,a);var i=this._algorithm.digest(this.state.copy(),e),l=new n.ByteBuffer;return i.write(l),l},n.ByteBuffer=function(e){"string"==typeof e?this.data=e:this.data="",this.read=0},n.ByteBuffer.prototype.putInt32=function(e){this.data+=String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)},n.ByteBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},n.ByteBuffer.prototype.putBytes=function(e){this.data+=e},n.ByteBuffer.prototype.bytes=function(){return this.data.slice(this.read)},n.ByteBuffer.prototype.length=function(){return this.data.length-this.read},n.ByteBuffer.prototype.compact=function(){this.data=this.data.slice(this.read),this.read=0},n.ByteBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var n=this.data.charCodeAt(t);n<16&&(e+="0"),e+=n.toString(16)}return e};var r={_w:null};r.Algorithm=function(){this.name="sha1",this.blockSize=64,this.digestLength=20,this.messageLengthSize=8},r.Algorithm.prototype.start=function(){return r._w||(r._w=new Array(80)),r._createState()},r.Algorithm.prototype.writeMessageLength=function(e,t){e.putBytes(t.bytes())},r.Algorithm.prototype.digest=function(e,t){for(var n,a,o,i,l,u,s,c,d=t.length(),f=r._w;d>=64;){for(a=e.h0,o=e.h1,i=e.h2,l=e.h3,u=e.h4,c=0;c<16;++c)n=t.getInt32(),f[c]=n,s=l^o&(i^l),n=(a<<5|a>>>27)+s+u+1518500249+n,u=l,l=i,i=o<<30|o>>>2,o=a,a=n;for(;c<20;++c)n=f[c-3]^f[c-8]^f[c-14]^f[c-16],n=n<<1|n>>>31,f[c]=n,s=l^o&(i^l),n=(a<<5|a>>>27)+s+u+1518500249+n,u=l,l=i,i=o<<30|o>>>2,o=a,a=n;for(;c<32;++c)n=f[c-3]^f[c-8]^f[c-14]^f[c-16],n=n<<1|n>>>31,f[c]=n,s=o^i^l,n=(a<<5|a>>>27)+s+u+1859775393+n,u=l,l=i,i=o<<30|o>>>2,o=a,a=n;for(;c<40;++c)n=f[c-6]^f[c-16]^f[c-28]^f[c-32],n=n<<2|n>>>30,f[c]=n,s=o^i^l,n=(a<<5|a>>>27)+s+u+1859775393+n,u=l,l=i,i=o<<30|o>>>2,o=a,a=n;for(;c<60;++c)n=f[c-6]^f[c-16]^f[c-28]^f[c-32],n=n<<2|n>>>30,f[c]=n,s=o&i|l&(o^i),n=(a<<5|a>>>27)+s+u+2400959708+n,u=l,l=i,i=o<<30|o>>>2,o=a,a=n;for(;c<80;++c)n=f[c-6]^f[c-16]^f[c-28]^f[c-32],n=n<<2|n>>>30,f[c]=n,s=o^i^l,n=(a<<5|a>>>27)+s+u+3395469782+n,u=l,l=i,i=o<<30|o>>>2,o=a,a=n;e.h0=e.h0+a|0,e.h1=e.h1+o|0,e.h2=e.h2+i|0,e.h3=e.h3+l|0,e.h4=e.h4+u|0,d-=64}return e},r._createState=function(){var e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520};return e.copy=function(){var t=r._createState();return t.h0=e.h0,t.h1=e.h1,t.h2=e.h2,t.h3=e.h3,t.h4=e.h4,t},e.write=function(t){t.putInt32(e.h0),t.putInt32(e.h1),t.putInt32(e.h2),t.putInt32(e.h3),t.putInt32(e.h4)},e};var a={_k:null,_w:null};a.Algorithm=function(){this.name="sha256",this.blockSize=64,this.digestLength=32,this.messageLengthSize=8},a.Algorithm.prototype.start=function(){return a._k||a._init(),a._createState()},a.Algorithm.prototype.writeMessageLength=function(e,t){e.putBytes(t.bytes())},a.Algorithm.prototype.digest=function(e,t){for(var n,r,o,i,l,u,s,c,d,f,p,h,v,g,y,m=t.length(),x=a._k,b=a._w;m>=64;){for(s=0;s<16;++s)b[s]=t.getInt32();for(;s<64;++s)n=b[s-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,r=b[s-15],r=(r>>>7|r<<25)^(r>>>18|r<<14)^r>>>3,b[s]=n+b[s-7]+r+b[s-16]|0;for(c=e.h0,d=e.h1,f=e.h2,p=e.h3,h=e.h4,v=e.h5,g=e.h6,y=e.h7,s=0;s<64;++s)i=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7),l=g^h&(v^g),o=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),u=c&d|f&(c^d),n=y+i+l+x[s]+b[s],r=o+u,y=g,g=v,v=h,h=p+n|0,p=f,f=d,d=c,c=n+r|0;e.h0=e.h0+c|0,e.h1=e.h1+d|0,e.h2=e.h2+f|0,e.h3=e.h3+p|0,e.h4=e.h4+h|0,e.h5=e.h5+v|0,e.h6=e.h6+g|0,e.h7=e.h7+y|0,m-=64}return e},a._createState=function(){var e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225};return e.copy=function(){var t=a._createState();return t.h0=e.h0,t.h1=e.h1,t.h2=e.h2,t.h3=e.h3,t.h4=e.h4,t.h5=e.h5,t.h6=e.h6,t.h7=e.h7,t},e.write=function(t){t.putInt32(e.h0),t.putInt32(e.h1),t.putInt32(e.h2),t.putInt32(e.h3),t.putInt32(e.h4),t.putInt32(e.h5),t.putInt32(e.h6),t.putInt32(e.h7)},e},a._init=function(){a._k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a._w=new Array(64)}}(e),!se)var _e=function(){se=require("xmldom").XMLSerializer};if(n.url={},n.url.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},n.url.parse=function(e,t){for(var r={},a=n.url.parsers[t||"full"],o=a.regex.exec(e),i=a.keys.length;i--;)r[a.keys[i]]=void 0===o[i]?null:o[i];return r.normalizedPath=ae(r.path,!!r.authority),r},e?n.useDocumentLoader("node"):"undefined"!=typeof XMLHttpRequest&&n.useDocumentLoader("xhr"),e){n.use=function(e){switch(e){case"request":n.request=require("jsonld-request");break;default:throw new Ee("Unknown extension.","jsonld.UnknownExtension",{extension:e})}};var Te={exports:{},filename:__dirname};require("pkginfo")(Te,"version"),n.version=Te.exports.version}return n},r=function(){return n(function(){return r()})};return!e&&"function"==typeof define&&define.amd?define([],function(){return n(r),r}):(n(r),"function"==typeof require&&"undefined"!=typeof module&&module.exports&&(module.exports=r),t&&("undefined"==typeof jsonld?jsonld=jsonldjs=r:jsonldjs=r)),r}();
}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},"/node_modules/jsonld/js")

},{"_process":120,"crypto":100,"es6-promise":84,"http":100,"jsonld-request":100,"pkginfo":100,"request":100,"util":100,"xmldom":100}],102:[function(require,module,exports){
function MillerRabin(r){this.rand=r||new brorand.Rand}var bn=require("bn.js"),brorand=require("brorand");module.exports=MillerRabin,MillerRabin.create=function(r){return new MillerRabin(r)},MillerRabin.prototype._rand=function(r){var n=r.bitLength(),e=this.rand.generate(Math.ceil(n/8));e[0]|=3;var t=7&n;return 0!==t&&(e[e.length-1]>>=7-t),new bn(e)},MillerRabin.prototype.test=function(r,n,e){var t=r.bitLength(),a=bn.mont(r),i=new bn(1).toRed(a);n||(n=Math.max(1,t/48|0));for(var o=r.subn(1),b=o.subn(1),d=0;!o.testn(d);d++);for(var u=r.shrn(d),f=o.toRed(a),c=!0;n>0;n--){var s=this._rand(b);e&&e(s);var l=s.toRed(a).redPow(u);if(0!==l.cmp(i)&&0!==l.cmp(f)){for(var m=1;m<d;m++){if(l=l.redSqr(),0===l.cmp(i))return!1;if(0===l.cmp(f))break}if(m===d)return!1}}return c},MillerRabin.prototype.getDivisor=function(r,n){var e=r.bitLength(),t=bn.mont(r),a=new bn(1).toRed(t);n||(n=Math.max(1,e/48|0));for(var i=r.subn(1),o=i.subn(1),b=0;!i.testn(b);b++);for(var d=r.shrn(b),u=i.toRed(t);n>0;n--){var f=this._rand(o),c=r.gcd(f);if(0!==c.cmpn(1))return c;var s=f.toRed(t).redPow(d);if(0!==s.cmp(a)&&0!==s.cmp(u)){for(var l=1;l<b;l++){if(s=s.redSqr(),0===s.cmp(a))return s.fromRed().subn(1).gcd(r);if(0===s.cmp(u))break}if(l===b)return s=s.redSqr(),s.fromRed().subn(1).gcd(r)}}return!1};
},{"bn.js":17,"brorand":18}],103:[function(require,module,exports){
function assert(r,e){if(!r)throw new Error(e||"Assertion failed")}module.exports=assert,assert.equal=function(r,e,s){if(r!=e)throw new Error(s||"Assertion failed: "+r+" != "+e)};
},{}],104:[function(require,module,exports){
var globalRequire=require;require=function(){};var exports=module.exports={Lexer:require("./lib/N3Lexer"),Parser:require("./lib/N3Parser"),Writer:require("./lib/N3Writer"),Store:require("./lib/N3Store"),StreamParser:require("./lib/N3StreamParser"),StreamWriter:require("./lib/N3StreamWriter"),Util:require("./lib/N3Util")};Object.keys(exports).forEach(function(e){Object.defineProperty(exports,e,{configurable:!0,enumerable:!0,get:function(){return delete exports[e],exports[e]=globalRequire("./lib/N3"+e)}})});
},{"./lib/N3Lexer":105,"./lib/N3Parser":106,"./lib/N3Store":107,"./lib/N3StreamParser":108,"./lib/N3StreamWriter":109,"./lib/N3Util":110,"./lib/N3Writer":111}],105:[function(require,module,exports){
function N3Lexer(e){if(!(this instanceof N3Lexer))return new N3Lexer(e);if(e&&e.lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var f=this;this._tokenize=this.tokenize,this.tokenize=function(e,u){this._tokenize(e,function(e,t){!e&&/^(?:IRI|prefixed|literal|langcode|type|\.|eof)$/.test(t.type)?u&&u(e,t):u&&u(e||f._syntaxError(t.type,u=null))})}}}var fromCharCode=String.fromCharCode,immediately="function"==typeof setImmediate?setImmediate:function(e){setTimeout(e,0)},escapeSequence=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,escapeReplacements={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},illegalIriChars=/[\x00-\x20<>\\"\{\}\|\^\`]/;N3Lexer.prototype={_iri:/^<((?:[^>\\]|\\[uU])+)>/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>/,_unescapedString:/^"[^"\\]+"(?=[^"\\])/,_singleQuotedString:/^"[^"\\]*(?:\\.[^"\\]*)*"(?=[^"\\])|^'[^'\\]*(?:\\.[^'\\]*)*'(?=[^'\\])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?=\.?[,;\s#()\[\]\{\}"'<])/,_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=\.?[,;:\s#()\[\]\{\}"'<])/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=[.,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;:\s#()\[\]\{\}"'<])/,_keyword:/^@[a-z]+(?=[\s#<:])/,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<:])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(e,f){function u(f){e(f._syntaxError(/^\S*/.exec(t)[0]))}for(var t=this._input;;){for(var i;i=this._newline.exec(t);)t=t.substr(i[0].length,t.length),this._line++;if((i=this._whitespace.exec(t))&&(t=t.substr(i[0].length,t.length)),this._endOfFile.test(t))return f&&e(t=null,{line:this._line,type:"eof",value:"",prefix:""}),this._input=t;var n,r=this._line,d="",s="",a="",c=t[0],o=null,l=0,x=!1;switch(c){case"^":if(1===t.length)break;if("^"!==t[1])return u(this);if(this._prevTokenType="^",t=t.substr(2),"<"!==t[0]){x=!0;break}case"<":if(o=this._unescapedIri.exec(t))d="IRI",s=o[1];else if(o=this._iri.exec(t)){if(n=this._unescape(o[1]),null===n||illegalIriChars.test(n))return u(this);d="IRI",s=n}break;case"_":((o=this._blank.exec(t))||f&&(o=this._blank.exec(t+" ")))&&(d="prefixed",a="_",s=o[1]);break;case'"':case"'":if(o=this._unescapedString.exec(t))d="literal",s=o[0];else if(o=this._singleQuotedString.exec(t)){if(n=this._unescape(o[0]),null===n)return u(this);d="literal",s=n.replace(/^'|'$/g,'"')}else if(o=this._tripleQuotedString.exec(t)){if(n=o[1]||o[2],this._line+=n.split(/\r\n|\r|\n/).length-1,n=this._unescape(n),null===n)return u(this);d="literal",s=n.replace(/^'|'$/g,'"')}break;case"@":"literal"===this._prevTokenType&&(o=this._langcode.exec(t))?(d="langcode",s=o[1]):(o=this._keyword.exec(t))&&(d=o[0]);break;case".":if(1===t.length?f:t[1]<"0"||t[1]>"9"){d=".",l=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(o=this._number.exec(t))&&(d="literal",s='"'+o[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(o[1]?"double":/^[+\-]?\d+$/.test(o[0])?"integer":"decimal"));break;case"B":case"b":case"p":case"P":case"G":case"g":(o=this._sparqlKeyword.exec(t))?d=o[0].toUpperCase():x=!0;break;case"f":case"t":(o=this._boolean.exec(t))?(d="literal",s='"'+o[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'):x=!0;break;case"a":(o=this._shortPredicates.exec(t))?(d="abbreviation",s="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):x=!0;break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":l=1,d=c;break;default:x=!0}if(x&&("@prefix"!==this._prevTokenType&&"PREFIX"!==this._prevTokenType||!(o=this._prefix.exec(t))?((o=this._prefixed.exec(t))||f&&(o=this._prefixed.exec(t+" ")))&&(d="prefixed",a=o[1]||"",s=this._unescape(o[2])):(d="prefix",s=o[1]||"")),"^"===this._prevTokenType&&(d="IRI"===d||"prefixed"===d?"type":""),!d)return f||!/^'''|^"""/.test(t)&&/\n|\r/.test(t)?u(this):this._input=t;e(null,{line:r,type:d,value:s,prefix:a}),this._prevTokenType=d,t=t.substr(l||o[0].length,t.length)}},_unescape:function(e){try{return e.replace(escapeSequence,function(e,f,u,t){var i;if(f){if(i=parseInt(f,16),isNaN(i))throw new Error;return fromCharCode(i)}if(u){if(i=parseInt(u,16),isNaN(i))throw new Error;return i<=65535?fromCharCode(i):fromCharCode(55296+(i-=65536)/1024,56320+(1023&i))}var n=escapeReplacements[t];if(!n)throw new Error;return n})}catch(e){return null}},_syntaxError:function(e){return this._input=null,new Error('Syntax error: unexpected "'+e+'" on line '+this._line+".")},tokenize:function(e,f){function u(e){null!==i._input&&(i._input+=e,i._tokenizeToEnd(f,!1))}function t(){null!==i._input&&i._tokenizeToEnd(f,!0)}var i=this;this._line=1,"string"==typeof e?(this._input=e,immediately(function(){i._tokenizeToEnd(f,!0)})):(this._input="",e&&"function"!=typeof e?("function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",u),e.on("end",t)):(this.addChunk=u,this.end=t,f||(f=e)))}},module.exports=N3Lexer;
},{}],106:[function(require,module,exports){
function N3Parser(e){if(!(this instanceof N3Parser))return new N3Parser(e);this._tripleStack=[],this._graph=null,e=e||{},this._setBase(e.documentIRI);var t="string"==typeof e.format&&e.format.match(/\w*$/)[0].toLowerCase(),r="turtle"===t,a="trig"===t,s=/triple/.test(t),i=/quad/.test(t),n=s||i;(this._supportsNamedGraphs=!r)||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(r||a||s),n&&(this._base="",this._resolveIRI=function(e){return this._error("Disallowed relative IRI",e),this._callback=noop,this._subject=null}),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":"_:"+e.blankNodePrefix.replace(/^_:/,""),this._lexer=e.lexer||new N3Lexer({lineMode:n})}function noop(){}var N3Lexer=require("./N3Lexer"),RDF_PREFIX="http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDF_NIL=RDF_PREFIX+"nil",RDF_FIRST=RDF_PREFIX+"first",RDF_REST=RDF_PREFIX+"rest",absoluteIRI=/^[a-z][a-z0-9+.-]*:/i,schemeAuthority=/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i,dotSegments=/(?:^|\/)\.\.?(?:$|[\/#?])/,blankNodePrefix=0,blankNodeCount=0;N3Parser._resetBlankNodeIds=function(){blankNodePrefix=blankNodeCount=0},N3Parser.prototype={_setBase:function(e){if(e){if(e.indexOf("#")>=0)throw new Error("Invalid base IRI "+e)}else e=null;(this._base=e)&&(this._basePath=e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(schemeAuthority),this._baseRoot=e[0],this._baseScheme=e[1])},_readInTopContext:function(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"@prefix":return this._sparqlStyle=!1,this._readPrefix;case"PREFIX":return this._sparqlStyle=!0,this._readPrefix;case"@base":return this._sparqlStyle=!1,this._readBaseIRI;case"BASE":return this._sparqlStyle=!0,this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}},_readSubject:function(e){switch(this._predicate=null,e.type){case"IRI":null===this._base||absoluteIRI.test(e.value)?this._subject=e.value:this._subject=this._resolveIRI(e);break;case"prefixed":var t=this._prefixes[e.prefix];if(void 0===t)return this._error('Undefined prefix "'+e.prefix+':"',e);this._subject=t+e.value;break;case"[":return this._subject="_:b"+blankNodeCount++,this._tripleStack.push({subject:this._subject,predicate:null,object:null,type:"blank"}),this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:RDF_NIL,predicate:null,object:null,type:"list"}),this._subject=null,this._readListItem;case"}":return this._readPunctuation(e);default:return this._error("Expected subject but got "+e.type,e)}return this._readPredicateOrNamedGraph},_readPredicate:function(e){var t=e.type;switch(t){case"IRI":case"abbreviation":null===this._base||absoluteIRI.test(e.value)?this._predicate=e.value:this._predicate=this._resolveIRI(e);break;case"prefixed":if("_"===e.prefix)return this._error("Disallowed blank node as predicate",e);var r=this._prefixes[e.prefix];if(void 0===r)return this._error('Undefined prefix "'+e.prefix+':"',e);this._predicate=r+e.value;break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+t,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return this._readPredicate;default:return this._error('Expected predicate to follow "'+this._subject+'"',e)}return this._readObject},_readObject:function(e){switch(e.type){case"IRI":null===this._base||absoluteIRI.test(e.value)?this._object=e.value:this._object=this._resolveIRI(e);break;case"prefixed":var t=this._prefixes[e.prefix];if(void 0===t)return this._error('Undefined prefix "'+e.prefix+':"',e);this._object=t+e.value;break;case"literal":return this._object=e.value,this._readDataTypeOrLang;case"[":var r="_:b"+blankNodeCount++;return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:r,type:"blank"}),this._subject=r,this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:RDF_NIL,type:"list"}),this._subject=null,this._readListItem;default:return this._error('Expected object to follow "'+this._predicate+'"',e)}return this._getTripleEndReader()},_readPredicateOrNamedGraph:function(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)},_readGraph:function(e){return"{"!==e.type?this._error("Expected graph but got "+e.type,e):(this._graph=this._subject,this._subject=null,this._readSubject)},_readBlankNodeHead:function(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))},_readBlankNodeTail:function(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""});var t=this._tripleStack.pop();return this._subject=t.subject,null!==t.object?(this._predicate=t.predicate,this._object=t.object,this._getTripleEndReader()):null!==this._predicate?this._readPredicate:this._readPredicateOrNamedGraph},_readDataTypeOrLang:function(e){switch(e.type){case"type":var t;if(""===e.prefix)t=null===this._base||absoluteIRI.test(e.value)?e.value:this._resolveIRI(e);else{var r=this._prefixes[e.prefix];if(void 0===r)return this._error('Undefined prefix "'+e.prefix+':"',e);t=r+e.value}return this._object+="^^"+t,this._getTripleEndReader();case"langcode":return this._object+="@"+e.value.toLowerCase(),this._getTripleEndReader();default:return this._getTripleEndReader().call(this,e)}},_readListItem:function(e){var t=null,r=null,a=this._subject,s=this._tripleStack,i=s[s.length-1],n=this._readListItem;switch(e.type){case"IRI":t=null===this._base||absoluteIRI.test(e.value)?e.value:this._resolveIRI(e);break;case"prefixed":var l=this._prefixes[e.prefix];if(void 0===l)return this._error('Undefined prefix "'+e.prefix+':"',e);t=l+e.value;break;case"literal":t=e.value,n=this._readDataTypeOrLang;break;case"[":r="_:b"+blankNodeCount++,t="_:b"+blankNodeCount++,s.push({subject:r,predicate:RDF_FIRST,object:t,type:"blank"}),this._subject=t,n=this._readBlankNodeHead;break;case"(":r="_:b"+blankNodeCount++,s.push({subject:r,predicate:RDF_FIRST,object:RDF_NIL,type:"list"}),this._subject=null,n=this._readListItem;break;case")":if(s.pop(),0!==s.length&&"list"===s[s.length-1].type&&this._callback(null,{subject:i.subject,predicate:i.predicate,object:i.object,graph:this._graph||""}),this._subject=i.subject,null===i.predicate){if(n=this._readPredicate,i.subject===RDF_NIL)return n}else if(this._predicate=i.predicate,this._object=i.object,n=this._getTripleEndReader(),i.object===RDF_NIL)return n;r=RDF_NIL;break;default:return this._error('Expected list item instead of "'+e.type+'"',e)}return null===r&&(this._subject=r="_:b"+blankNodeCount++),null===a?i.object===RDF_NIL?i.object=r:i.subject=r:this._callback(null,{subject:a,predicate:RDF_REST,object:r,graph:this._graph||""}),null!==t&&this._callback(null,{subject:r,predicate:RDF_FIRST,object:t,graph:this._graph||""}),n},_readPunctuation:function(e){var t,r=this._subject,a=this._graph;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);this._graph=null;case".":this._subject=null,t=this._readInTopContext;break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;case"IRI":if(this._supportsQuads&&null===this._graph){a=null===this._base||absoluteIRI.test(e.value)?e.value:this._resolveIRI(e),r=this._subject,t=this._readQuadPunctuation;break}case"prefixed":if(this._supportsQuads&&null===this._graph){var s=this._prefixes[e.prefix];if(void 0===s)return this._error('Undefined prefix "'+e.prefix+':"',e);a=s+e.value,t=this._readQuadPunctuation;break}default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return null!==r&&this._callback(null,{subject:r,predicate:this._predicate,object:this._object,graph:a||""}),t},_readBlankNodePunctuation:function(e){var t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""}),t},_readQuadPunctuation:function(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext},_readPrefix:function(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)},_readPrefixIRI:function(e){if("IRI"!==e.type)return this._error('Expected IRI to follow prefix "'+this._prefix+':"',e);var t;return t=null===this._base||absoluteIRI.test(e.value)?e.value:this._resolveIRI(e),this._prefixes[this._prefix]=t,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation},_readBaseIRI:function(e){if("IRI"!==e.type)return this._error("Expected IRI to follow base declaration",e);try{this._setBase(null===this._base||absoluteIRI.test(e.value)?e.value:this._resolveIRI(e))}catch(t){this._error(t.message,e)}return this._readDeclarationPunctuation},_readNamedGraphLabel:function(e){switch(e.type){case"IRI":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}},_readNamedGraphBlankLabel:function(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject="_:b"+blankNodeCount++,this._readGraph)},_readDeclarationPunctuation:function(e){return this._sparqlStyle?this._readInTopContext(e):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext},_getTripleEndReader:function(){var e=this._tripleStack;if(0===e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem}},_error:function(e,t){this._callback(new Error(e+" at line "+t.line+"."))},_resolveIRI:function(e){var t=e.value;switch(t[0]){case void 0:return this._base;case"#":return this._base+t;case"?":return this._base.replace(/(?:\?.*)?$/,t);case"/":return("/"===t[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(t);default:return this._removeDotSegments(this._basePath+t)}},_removeDotSegments:function(e){if(!dotSegments.test(e))return e;for(var t="",r=e.length,a=-1,s=-1,i=0,n="/";a<r;){switch(n){case":":if(s<0&&"/"===e[++a]&&"/"===e[++a])for(;(s=a+1)<r&&"/"!==e[s];)a=s;break;case"?":case"#":a=r;break;case"/":if("."===e[a+1])switch(n=e[++a+1]){case"/":t+=e.substring(i,a-1),i=a+1;break;case void 0:case"?":case"#":return t+e.substring(i,a)+e.substr(a+1);case".":if(n=e[++a+1],void 0===n||"/"===n||"?"===n||"#"===n){if(t+=e.substring(i,a-2),(i=t.lastIndexOf("/"))>=s&&(t=t.substr(0,i)),"/"!==n)return t+"/"+e.substr(a+1);i=a+1}}}n=e[++a]}return t+e.substring(i)},parse:function(e,t,r){this._readCallback=this._readInTopContext,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix||"_:b"+blankNodePrefix++ +"_","function"==typeof e&&(r=t,t=e,e=null),this._callback=t||noop,this._prefixCallback=r||noop;var a=this;this._lexer.tokenize(e,function(e,t){null!==e?(a._callback(e),a._callback=noop):void 0!==a._readCallback&&(a._readCallback=a._readCallback(t))}),e||(this.addChunk=this._lexer.addChunk,this.end=this._lexer.end)}},module.exports=N3Parser;
},{"./N3Lexer":105}],107:[function(require,module,exports){
function N3Store(e,t){return this instanceof N3Store?(this._size=0,this._graphs=Object.create(null),this._entities=Object.create(null),this._entities["><"]=0,this._entityCount=0,this._blankNodeIndex=0,t||!e||e[0]||(t=e,e=null),this._prefixes=Object.create(null),t&&t.prefixes&&this.addPrefixes(t.prefixes),void(e&&this.addTriples(e))):new N3Store(e,t)}var expandPrefixedName=require("./N3Util").expandPrefixedName;N3Store.prototype={get size(){var e=this._size;if(null!==e)return e;var t,i,n=this._graphs;for(var r in n)for(var s in t=n[r].subjects)for(var d in i=t[s])e+=Object.keys(i[d]).length;return this._size=e},_addToIndex:function(e,t,i,n){var r=e[t]||(e[t]={}),s=r[i]||(r[i]={});s[n]=null},_removeFromIndex:function(e,t,i,n){var r,s=e[t],d=s[i];delete d[n];for(r in d)return;delete s[i];for(r in s)return;delete e[t]},_findInIndex:function(e,t,i,n,r,s,d,a){var o,c,u,h=[],f=Object.keys(this._entities);t&&((o=e,e={})[t]=o[t]);for(var _ in e){var l=f[_];if(c=e[_]){i&&((o=c,c={})[i]=o[i]);for(var x in c){var p=f[x];if(u=c[x])for(var b=(n?n in u?[n]:[]:Object.keys(u)),j=b.length-1;j>=0;j--){var I={subject:"",predicate:"",object:"",graph:a};I[r]=l,I[s]=p,I[d]=f[b[j]],h.push(I)}}}}return h},_countInIndex:function(e,t,i,n){var r,s,d,a=0;t&&((r=e,e={})[t]=r[t]);for(var o in e)if(s=e[o]){i&&((r=s,s={})[i]=r[i]);for(var c in s)(d=s[c])&&(n?n in d&&a++:a+=Object.keys(d).length)}return a},addTriple:function(e,t,i,n){t||(n=e.graph,i=e.object,t=e.predicate,e=e.subject),n=n||"";var r=this._graphs[n];r||(r=this._graphs[n]={subjects:{},predicates:{},objects:{}},Object.freeze(r));var s=this._entities;e=s[e]||(s[e]=++this._entityCount),t=s[t]||(s[t]=++this._entityCount),i=s[i]||(s[i]=++this._entityCount),this._addToIndex(r.subjects,e,t,i),this._addToIndex(r.predicates,t,i,e),this._addToIndex(r.objects,i,e,t),this._size=null},addTriples:function(e){for(var t=e.length-1;t>=0;t--)this.addTriple(e[t])},addPrefix:function(e,t){this._prefixes[e]=t},addPrefixes:function(e){for(var t in e)this.addPrefix(t,e[t])},removeTriple:function(e,t,i,n){t||(n=e.graph,i=e.object,t=e.predicate,e=e.subject),n=n||"";var r,s=this._entities,d=this._graphs;if((e=s[e])&&(t=s[t])&&(i=s[i])&&(r=d[n])){var a,o;if((a=r.subjects[e])&&(o=a[t])&&i in o){this._removeFromIndex(r.subjects,e,t,i),this._removeFromIndex(r.predicates,t,i,e),this._removeFromIndex(r.objects,i,e,t),null!==this._size&&this._size--;for(e in r.subjects)return;delete d[n]}}},removeTriples:function(e){for(var t=e.length-1;t>=0;t--)this.removeTriple(e[t])},find:function(e,t,i,n){var r=this._prefixes;return this.findByIRI(expandPrefixedName(e,r),expandPrefixedName(t,r),expandPrefixedName(i,r),expandPrefixedName(n,r))},findByIRI:function(e,t,i,n){n=n||"";var r=this._graphs[n],s=this._entities;return r?e&&!(e=s[e])?[]:t&&!(t=s[t])?[]:i&&!(i=s[i])?[]:e?i?this._findInIndex(r.objects,i,e,t,"object","subject","predicate",n):this._findInIndex(r.subjects,e,t,null,"subject","predicate","object",n):t?this._findInIndex(r.predicates,t,i,null,"predicate","object","subject",n):i?this._findInIndex(r.objects,i,null,null,"object","subject","predicate",n):this._findInIndex(r.subjects,null,null,null,"subject","predicate","object",n):[]},count:function(e,t,i,n){var r=this._prefixes;return this.countByIRI(expandPrefixedName(e,r),expandPrefixedName(t,r),expandPrefixedName(i,r),expandPrefixedName(n,r))},countByIRI:function(e,t,i,n){n=n||"";var r=this._graphs[n],s=this._entities;return r?e&&!(e=s[e])?0:t&&!(t=s[t])?0:i&&!(i=s[i])?0:e?i?this._countInIndex(r.objects,i,e,t):this._countInIndex(r.subjects,e,t,i):t?this._countInIndex(r.predicates,t,i,e):this._countInIndex(r.objects,i,e,t):0},createBlankNode:function(e){var t,i;if(e)for(t=e="_:"+e,i=1;this._entities[t];)t=e+i++;else do t="_:b"+this._blankNodeIndex++;while(this._entities[t]);return this._entities[t]=++this._entityCount,t}},module.exports=N3Store;
},{"./N3Util":110}],108:[function(require,module,exports){
function N3StreamParser(r){if(!(this instanceof N3StreamParser))return new N3StreamParser(r);Transform.call(this,{decodeStrings:!0}),this._readableState.objectMode=!0;var e=this,t=new N3Parser(r);t.parse(function(r,t){t&&e.push(t)||r&&e.emit("error",r)},this.emit.bind(this,"prefix")),this._transform=function(r,e,s){t.addChunk(r),s()},this._flush=function(r){t.end(),r()}}var Transform=require("stream").Transform,util=require("util"),N3Parser=require("./N3Parser.js");util.inherits(N3StreamParser,Transform),module.exports=N3StreamParser;
},{"./N3Parser.js":106,"stream":229,"util":241}],109:[function(require,module,exports){
function N3StreamWriter(r){if(!(this instanceof N3StreamWriter))return new N3StreamWriter(r);Transform.call(this,{encoding:"utf8"}),this._writableState.objectMode=!0;var t=this,e=new N3Writer({write:function(r,e,i){t.push(r),i&&i()},end:function(r){t.push(null),r&&r()}},r);this._transform=function(r,t,i){e.addTriple(r,i)},this._flush=function(r){e.end(r)}}var Transform=require("stream").Transform,util=require("util"),N3Writer=require("./N3Writer.js");util.inherits(N3StreamWriter,Transform),module.exports=N3StreamWriter;
},{"./N3Writer.js":111,"stream":229,"util":241}],110:[function(require,module,exports){
function addN3Util(t,e){for(var r in N3Util)e?t.prototype[r]=applyToThis(N3Util[r]):t[r]=N3Util[r];return t}function applyToThis(t){return function(e){return t(this,e)}}var Xsd="http://www.w3.org/2001/XMLSchema#",XsdString=Xsd+"string",XsdInteger=Xsd+"integer",XsdDecimal=Xsd+"decimal",XsdBoolean=Xsd+"boolean",RdfLangString="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",N3Util={isIRI:function(t){if(!t)return t;var e=t[0];return'"'!==e&&"_"!==e},isLiteral:function(t){return t&&'"'===t[0]},isBlank:function(t){return t&&"_:"===t.substr(0,2)},getLiteralValue:function(t){var e=/^"([^]*)"/.exec(t);if(!e)throw new Error(t+" is not a literal");return e[1]},getLiteralType:function(t){var e=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(t);if(!e)throw new Error(t+" is not a literal");return e[1]||(e[2]?RdfLangString:XsdString)},getLiteralLanguage:function(t){var e=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(t);if(!e)throw new Error(t+" is not a literal");return e[1]?e[1].toLowerCase():""},isPrefixedName:function(t){return t&&/^[^:\/"']*:[^:\/"']+$/.test(t)},expandPrefixedName:function(t,e){var r,n,i,a=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(t);return a&&(r=a[1],n=e[r],i=a.index),void 0===n?t:0===i?n+t.substr(r.length+1):t.substr(0,i+3)+n+t.substr(i+r.length+4)},createIRI:function(t){return t&&'"'===t[0]?N3Util.getLiteralValue(t):t},createLiteral:function(t,e){if(!e)switch(typeof t){case"boolean":e=XsdBoolean;break;case"number":if(isFinite(t)){e=t%1===0?XsdInteger:XsdDecimal;break}default:return'"'+t+'"'}return'"'+t+(/^[a-z]+(-[a-z0-9]+)*$/i.test(e)?'"@'+e.toLowerCase():'"^^'+e)}};module.exports=addN3Util(addN3Util);
},{}],111:[function(require,module,exports){
function N3Writer(e,t){if(!(this instanceof N3Writer))return new N3Writer(e,t);if(e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{var r="";this._outputStream={write:function(e,t,i){r+=e,i&&i()},end:function(e){e&&e(null,r)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?this._writeTriple=this._writeTripleLine:(this._graph="",this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes))}function characterReplacer(e){var t=escapeReplacements[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}var N3LiteralMatcher=/^"([^]*)"(?:\^\^(.+)|@([\-a-z]+))?$/i,RDF_PREFIX="http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDF_TYPE=RDF_PREFIX+"type",escape=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,escapeAll=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,escapeReplacements={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};N3Writer.prototype={_write:function(e,t){this._outputStream.write(e,"utf8",t)},_writeTriple:function(e,t,r,i,n){try{this._graph!==i&&(this._write((null===this._subject?"":this._graph?"\n}\n":".\n")+(i?this._encodeIriOrBlankNode(i)+" {\n":"")),this._subject=null,this._graph="["!==i[0]?i:"]"),this._subject===e?this._predicate===t?this._write(", "+this._encodeObject(r),n):this._write(";\n    "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(r),n):this._write((null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)+" "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(r),n)}catch(e){n&&n(e)}},_writeTripleLine:function(e,t,r,i,n){delete this._prefixMatch;try{this._write(this._encodeIriOrBlankNode(e)+" "+this._encodeIriOrBlankNode(t)+" "+this._encodeObject(r)+(i?" "+this._encodeIriOrBlankNode(i)+".\n":".\n"),n)}catch(e){n&&n(e)}},_encodeIriOrBlankNode:function(e){var t=e[0];if("["===t||"("===t||"_"===t&&":"===e[1])return e;escape.test(e)&&(e=e.replace(escapeAll,characterReplacer));var r=this._prefixRegex.exec(e);return r?r[1]?this._prefixIRIs[r[1]]+r[2]:e:"<"+e+">"},_encodeLiteral:function(e,t,r){return escape.test(e)&&(e=e.replace(escapeAll,characterReplacer)),r?'"'+e+'"@'+r:t?'"'+e+'"^^'+this._encodeIriOrBlankNode(t):'"'+e+'"'},_encodeSubject:function(e){if('"'===e[0])throw new Error("A literal as subject is not allowed: "+e);return"["===e[0]&&(this._subject="]"),this._encodeIriOrBlankNode(e)},_encodePredicate:function(e){if('"'===e[0])throw new Error("A literal as predicate is not allowed: "+e);return e===RDF_TYPE?"a":this._encodeIriOrBlankNode(e)},_encodeObject:function(e){if('"'!==e[0])return this._encodeIriOrBlankNode(e);var t=N3LiteralMatcher.exec(e);if(!t)throw new Error("Invalid literal: "+e);return this._encodeLiteral(t[1],t[2],t[3])},_blockedWrite:function(){throw new Error("Cannot write because the writer has been closed.")},addTriple:function(e,t,r,i,n){void 0===r?this._writeTriple(e.subject,e.predicate,e.object,e.graph||"",t):"string"!=typeof i?this._writeTriple(e,t,r,"",i):this._writeTriple(e,t,r,i,n)},addTriples:function(e){for(var t=0;t<e.length;t++)this.addTriple(e[t])},addPrefix:function(e,t,r){var i={};i[e]=t,this.addPrefixes(i,r)},addPrefixes:function(e,t){var r=this._prefixIRIs,i=!1;for(var n in e){var c=e[n];/[#\/]$/.test(c)&&r[c]!==(n+=":")&&(i=!0,r[c]=n,null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null,this._graph=""),this._write("@prefix "+n+" <"+c+">.\n"))}if(i){var s="",a="";for(var h in r)s+=s?"|"+h:h,a+=(a?"|":"")+r[h];s=s.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+a+")[^/]*$|^("+s+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(i?"\n":"",t)},blank:function(e,t){var r,i,n=e;switch(void 0===e?n=[]:"string"==typeof e?n=[{predicate:e,object:t}]:"length"in e||(n=[e]),i=n.length){case 0:return"[]";case 1:if(r=n[0],"["!==r.object[0])return"[ "+this._encodePredicate(r.predicate)+" "+this._encodeObject(r.object)+" ]";default:for(var c="[",s=0;s<i;s++)r=n[s],r.predicate===e?c+=", "+this._encodeObject(r.object):(c+=(s?";\n  ":"\n  ")+this._encodePredicate(r.predicate)+" "+this._encodeObject(r.object),e=r.predicate);return c+"\n]"}},list:function(e){for(var t=e&&e.length||0,r=new Array(t),i=0;i<t;i++)r[i]=this._encodeObject(e[i]);return"("+r.join(" ")+")"},_prefixRegex:/$0^/,end:function(e){null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null),this._write=this._blockedWrite;var t=e&&function(r,i){t=null,e(r,i)};if(this._endStream)try{return this._outputStream.end(t)}catch(e){}t&&t()}},module.exports=N3Writer;
},{}],112:[function(require,module,exports){
(function (Buffer){
!function(n){"use strict";function e(){var e=n.crypto||n.msCrypto;if(!f&&e&&e.getRandomValues)try{var r=new Uint8Array(16);s=f=function(){return e.getRandomValues(r),r},f()}catch(n){}if(!f){var o=new Array(16);i=f=function(){for(var n,e=0;e<16;e++)0===(3&e)&&(n=4294967296*Math.random()),o[e]=n>>>((3&e)<<3)&255;return o},"undefined"!=typeof console&&console.warn&&console.warn("[SECURITY] node-uuid: crypto not usable, falling back to insecure Math.random()")}}function r(){if("function"==typeof require)try{var n=require("crypto").randomBytes;c=f=n&&function(){return n(16)},f()}catch(n){}}function o(n,e,r){var o=e&&r||0,t=0;for(e=e||[],n.toLowerCase().replace(/[0-9a-f]{2}/g,function(n){t<16&&(e[o+t++]=y[n])});t<16;)e[o+t++]=0;return e}function t(n,e){var r=e||0,o=v;return o[n[r++]]+o[n[r++]]+o[n[r++]]+o[n[r++]]+"-"+o[n[r++]]+o[n[r++]]+"-"+o[n[r++]]+o[n[r++]]+"-"+o[n[r++]]+o[n[r++]]+"-"+o[n[r++]]+o[n[r++]]+o[n[r++]]+o[n[r++]]+o[n[r++]]+o[n[r++]]}function u(n,e,r){var o=e&&r||0,u=e||[];n=n||{};var a=null!=n.clockseq?n.clockseq:g,f=null!=n.msecs?n.msecs:(new Date).getTime(),i=null!=n.nsecs?n.nsecs:C+1,c=f-h+(i-C)/1e4;if(c<0&&null==n.clockseq&&(a=a+1&16383),(c<0||f>h)&&null==n.nsecs&&(i=0),i>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=f,C=i,g=a,f+=122192928e5;var s=(1e4*(268435455&f)+i)%4294967296;u[o++]=s>>>24&255,u[o++]=s>>>16&255,u[o++]=s>>>8&255,u[o++]=255&s;var l=f/4294967296*1e4&268435455;u[o++]=l>>>8&255,u[o++]=255&l,u[o++]=l>>>24&15|16,u[o++]=l>>>16&255,u[o++]=a>>>8|128,u[o++]=255&a;for(var d=n.node||w,v=0;v<6;v++)u[o+v]=d[v];return e?e:t(u)}function a(n,e,r){var o=e&&r||0;"string"==typeof n&&(e="binary"===n?new d(16):null,n=null),n=n||{};var u=n.random||(n.rng||f)();if(u[6]=15&u[6]|64,u[8]=63&u[8]|128,e)for(var a=0;a<16;a++)e[o+a]=u[a];return e||t(u)}var f,i,c,s,l;n?e():r();for(var d="function"==typeof Buffer?Buffer:Array,v=[],y={},m=0;m<256;m++)v[m]=(m+256).toString(16).substr(1),y[v[m]]=m;var p=f(),w=[1|p[0],p[1],p[2],p[3],p[4],p[5]],g=16383&(p[6]<<8|p[7]),h=0,C=0,R=a;R.v1=u,R.v4=a,R.parse=o,R.unparse=t,R.BufferClass=d,R._rng=f,R._mathRNG=i,R._nodeRNG=c,R._whatwgRNG=s,"undefined"!=typeof module&&module.exports?module.exports=R:"function"==typeof define&&define.amd?define(function(){return R}):(l=n.uuid,R.noConflict=function(){return n.uuid=l,R},n.uuid=R)}("undefined"!=typeof window?window:null);
}).call(this,require("buffer").Buffer)

},{"buffer":47,"crypto":56}],113:[function(require,module,exports){
module.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}
},{}],114:[function(require,module,exports){
var asn1=require("asn1.js"),RSAPrivateKey=asn1.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});exports.RSAPrivateKey=RSAPrivateKey;var RSAPublicKey=asn1.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});exports.RSAPublicKey=RSAPublicKey;var PublicKey=asn1.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPublicKey").bitstr())});exports.PublicKey=PublicKey;var AlgorithmIdentifier=asn1.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),PrivateKeyInfo=asn1.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPrivateKey").octstr())});exports.PrivateKey=PrivateKeyInfo;var EncryptedPrivateKeyInfo=asn1.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});exports.EncryptedPrivateKey=EncryptedPrivateKeyInfo;var DSAPrivateKey=asn1.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});exports.DSAPrivateKey=DSAPrivateKey,exports.DSAparam=asn1.define("DSAparam",function(){this.int()});var ECPrivateKey=asn1.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(ECParameters),this.key("publicKey").optional().explicit(1).bitstr())});exports.ECPrivateKey=ECPrivateKey;var ECParameters=asn1.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});exports.signature=asn1.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())});
},{"asn1.js":1}],115:[function(require,module,exports){
(function (Buffer){
var findProc=/Proc-Type: 4,ENCRYPTED\r?\nDEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)\r?\n\r?\n([0-9A-z\n\r\+\/\=]+)\r?\n/m,startRegex=/^-----BEGIN (.*) KEY-----\r?\n/m,fullRegex=/^-----BEGIN (.*) KEY-----\r?\n([0-9A-z\n\r\+\/\=]+)\r?\n-----END \1 KEY-----$/m,evp=require("evp_bytestokey"),ciphers=require("browserify-aes");module.exports=function(e,r){var a,n=e.toString(),t=n.match(findProc);if(t){var f="aes"+t[1],c=new Buffer(t[2],"hex"),s=new Buffer(t[3].replace(/\r?\n/g,""),"base64"),i=evp(r,c.slice(0,8),parseInt(t[1],10)).key,p=[],u=ciphers.createDecipheriv(f,i,c);p.push(u.update(s)),p.push(u.final()),a=Buffer.concat(p)}else{var o=n.match(fullRegex);a=new Buffer(o[2].replace(/\r?\n/g,""),"base64")}var E=n.match(startRegex)[1]+" KEY";return{tag:E,data:a}};
}).call(this,require("buffer").Buffer)

},{"browserify-aes":22,"buffer":47,"evp_bytestokey":87}],116:[function(require,module,exports){
(function (Buffer){
function parseKeys(e){var r;"object"!=typeof e||Buffer.isBuffer(e)||(r=e.passphrase,e=e.key),"string"==typeof e&&(e=new Buffer(e));var a,t,s=fixProc(e,r),i=s.tag,c=s.data;switch(i){case"PUBLIC KEY":switch(t=asn1.PublicKey.decode(c,"der"),a=t.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return asn1.RSAPublicKey.decode(t.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return t.subjectPrivateKey=t.subjectPublicKey,{type:"ec",data:t};case"1.2.840.10040.4.1":return t.algorithm.params.pub_key=asn1.DSAparam.decode(t.subjectPublicKey.data,"der"),{type:"dsa",data:t.algorithm.params};default:throw new Error("unknown key id "+a)}throw new Error("unknown key type "+i);case"ENCRYPTED PRIVATE KEY":c=asn1.EncryptedPrivateKey.decode(c,"der"),c=decrypt(c,r);case"PRIVATE KEY":switch(t=asn1.PrivateKey.decode(c,"der"),a=t.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return asn1.RSAPrivateKey.decode(t.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:t.algorithm.curve,privateKey:asn1.ECPrivateKey.decode(t.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return t.algorithm.params.priv_key=asn1.DSAparam.decode(t.subjectPrivateKey,"der"),{type:"dsa",params:t.algorithm.params};default:throw new Error("unknown key id "+a)}throw new Error("unknown key type "+i);case"RSA PUBLIC KEY":return asn1.RSAPublicKey.decode(c,"der");case"RSA PRIVATE KEY":return asn1.RSAPrivateKey.decode(c,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:asn1.DSAPrivateKey.decode(c,"der")};case"EC PRIVATE KEY":return c=asn1.ECPrivateKey.decode(c,"der"),{curve:c.parameters.value,privateKey:c.privateKey};default:throw new Error("unknown key type "+i)}}function decrypt(e,r){var a=e.algorithm.decrypt.kde.kdeparams.salt,t=parseInt(e.algorithm.decrypt.kde.kdeparams.iters.toString(),10),s=aesid[e.algorithm.decrypt.cipher.algo.join(".")],i=e.algorithm.decrypt.cipher.iv,c=e.subjectPrivateKey,d=parseInt(s.split("-")[1],10)/8,n=compat.pbkdf2Sync(r,a,t,d),o=ciphers.createDecipheriv(s,n,i),u=[];return u.push(o.update(c)),u.push(o.final()),Buffer.concat(u)}var asn1=require("./asn1"),aesid=require("./aesid.json"),fixProc=require("./fixProc"),ciphers=require("browserify-aes"),compat=require("pbkdf2");module.exports=parseKeys,parseKeys.signature=asn1.signature;
}).call(this,require("buffer").Buffer)

},{"./aesid.json":113,"./asn1":114,"./fixProc":115,"browserify-aes":22,"buffer":47,"pbkdf2":117}],117:[function(require,module,exports){
(function (process,Buffer){
var createHmac=require("create-hmac"),checkParameters=require("./precondition");exports.pbkdf2=function(e,r,t,n,f,a){if("function"==typeof f&&(a=f,f=void 0),checkParameters(t,n),"function"!=typeof a)throw new Error("No callback provided to pbkdf2");setTimeout(function(){a(null,exports.pbkdf2Sync(e,r,t,n,f))})};var defaultEncoding;if(process.browser)defaultEncoding="utf-8";else{var pVersionMajor=parseInt(process.version.split(".")[0].slice(1),10);defaultEncoding=pVersionMajor>=6?"utf-8":"binary"}exports.pbkdf2Sync=function(e,r,t,n,f){Buffer.isBuffer(e)||(e=new Buffer(e,defaultEncoding)),Buffer.isBuffer(r)||(r=new Buffer(r,defaultEncoding)),checkParameters(t,n),f=f||"sha1";var a,o=1,c=new Buffer(n),i=new Buffer(r.length+4);r.copy(i,0,0,r.length);for(var u,s,d=1;d<=o;d++){i.writeUInt32BE(d,r.length);var p=createHmac(f,e).update(i).digest();a||(a=p.length,s=new Buffer(a),o=Math.ceil(n/a),u=n-(o-1)*a),p.copy(s,0,0,a);for(var l=1;l<t;l++){p=createHmac(f,e).update(p).digest();for(var v=0;v<a;v++)s[v]^=p[v]}var g=(d-1)*a,h=d===o?u:a;s.copy(c,g,0,h)}return c};
}).call(this,require('_process'),require("buffer").Buffer)

},{"./precondition":118,"_process":120,"buffer":47,"create-hmac":55}],118:[function(require,module,exports){
var MAX_ALLOC=Math.pow(2,30)-1;module.exports=function(r,e){if("number"!=typeof r)throw new TypeError("Iterations not a number");if(r<0)throw new TypeError("Bad iterations");if("number"!=typeof e)throw new TypeError("Key length not a number");if(e<0||e>MAX_ALLOC||e!==e)throw new TypeError("Bad key length")};
},{}],119:[function(require,module,exports){
(function (process){
"use strict";function nextTick(e,n,c,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var s,t,o=arguments.length;switch(o){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,n)});case 3:return process.nextTick(function(){e.call(null,n,c)});case 4:return process.nextTick(function(){e.call(null,n,c,r)});default:for(s=new Array(o-1),t=0;t<s.length;)s[t++]=arguments[t];return process.nextTick(function(){e.apply(null,s)})}}!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?module.exports=nextTick:module.exports=process.nextTick;
}).call(this,require('_process'))

},{"_process":120}],120:[function(require,module,exports){
function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}var process=module.exports={},cachedSetTimeout,cachedClearTimeout;!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var queue=[],draining=!1,currentQueue,queueIndex=-1;process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var u=1;u<arguments.length;u++)t[u-1]=arguments[u];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};
},{}],121:[function(require,module,exports){
exports.publicEncrypt=require("./publicEncrypt"),exports.privateDecrypt=require("./privateDecrypt"),exports.privateEncrypt=function(r,p){return exports.publicEncrypt(r,p,!0)},exports.publicDecrypt=function(r,p){return exports.privateDecrypt(r,p,!0)};
},{"./privateDecrypt":123,"./publicEncrypt":124}],122:[function(require,module,exports){
(function (Buffer){
function i2ops(e){var r=new Buffer(4);return r.writeUInt32BE(e,0),r}var createHash=require("create-hash");module.exports=function(e,r){for(var t,a=new Buffer(""),n=0;a.length<r;)t=i2ops(n++),a=Buffer.concat([a,createHash("sha1").update(e).update(t).digest()]);return a.slice(0,r)};
}).call(this,require("buffer").Buffer)

},{"buffer":47,"create-hash":52}],123:[function(require,module,exports){
(function (Buffer){
function oaep(r,e){var n=(r.modulus,r.modulus.byteLength()),t=(e.length,createHash("sha1").update(new Buffer("")).digest()),i=t.length;if(0!==e[0])throw new Error("decryption error");var o=e.slice(1,i+1),u=e.slice(i+1),a=xor(o,mgf(u,i)),c=xor(u,mgf(a,n-i-1));if(compare(t,c.slice(0,i)))throw new Error("decryption error");for(var f=i;0===c[f];)f++;if(1!==c[f++])throw new Error("decryption error");return c.slice(f)}function pkcs1(r,e,n){for(var t=e.slice(0,2),i=2,o=0;0!==e[i++];)if(i>=e.length){o++;break}var u=e.slice(2,i-1);e.slice(i-1,i);if(("0002"!==t.toString("hex")&&!n||"0001"!==t.toString("hex")&&n)&&o++,u.length<8&&o++,o)throw new Error("decryption error");return e.slice(i)}function compare(r,e){r=new Buffer(r),e=new Buffer(e);var n=0,t=r.length;r.length!==e.length&&(n++,t=Math.min(r.length,e.length));for(var i=-1;++i<t;)n+=r[i]^e[i];return n}var parseKeys=require("parse-asn1"),mgf=require("./mgf"),xor=require("./xor"),bn=require("bn.js"),crt=require("browserify-rsa"),createHash=require("create-hash"),withPublic=require("./withPublic");module.exports=function(r,e,n){var t;t=r.padding?r.padding:n?1:4;var i=parseKeys(r),o=i.modulus.byteLength();if(e.length>o||new bn(e).cmp(i.modulus)>=0)throw new Error("decryption error");var u;u=n?withPublic(new bn(e),i):crt(e,i);var a=new Buffer(o-u.length);if(a.fill(0),u=Buffer.concat([a,u],o),4===t)return oaep(i,u);if(1===t)return pkcs1(i,u,n);if(3===t)return u;throw new Error("unknown padding")};
}).call(this,require("buffer").Buffer)

},{"./mgf":122,"./withPublic":125,"./xor":126,"bn.js":17,"browserify-rsa":38,"buffer":47,"create-hash":52,"parse-asn1":116}],124:[function(require,module,exports){
(function (Buffer){
function oaep(e,r){var n=e.modulus.byteLength(),o=r.length,t=createHash("sha1").update(new Buffer("")).digest(),f=t.length,u=2*f;if(o>n-u-2)throw new Error("message too long");var a=new Buffer(n-o-u-2);a.fill(0);var s=n-f-1,i=randomBytes(f),w=xor(Buffer.concat([t,a,new Buffer([1]),r],s),mgf(i,s)),c=xor(i,mgf(w,f));return new bn(Buffer.concat([new Buffer([0]),c,w],n))}function pkcs1(e,r,n){var o=r.length,t=e.modulus.byteLength();if(o>t-11)throw new Error("message too long");var f;return n?(f=new Buffer(t-o-3),f.fill(255)):f=nonZero(t-o-3),new bn(Buffer.concat([new Buffer([0,n?1:2]),f,new Buffer([0]),r],t))}function nonZero(e,r){for(var n,o=new Buffer(e),t=0,f=randomBytes(2*e),u=0;t<e;)u===f.length&&(f=randomBytes(2*e),u=0),n=f[u++],n&&(o[t++]=n);return o}var parseKeys=require("parse-asn1"),randomBytes=require("randombytes"),createHash=require("create-hash"),mgf=require("./mgf"),xor=require("./xor"),bn=require("bn.js"),withPublic=require("./withPublic"),crt=require("browserify-rsa"),constants={RSA_PKCS1_OAEP_PADDING:4,RSA_PKCS1_PADDIN:1,RSA_NO_PADDING:3};module.exports=function(e,r,n){var o;o=e.padding?e.padding:n?1:4;var t,f=parseKeys(e);if(4===o)t=oaep(f,r);else if(1===o)t=pkcs1(f,r,n);else{if(3!==o)throw new Error("unknown padding");if(t=new bn(r),t.cmp(f.modulus)>=0)throw new Error("data too long for modulus")}return n?crt(t,f):withPublic(t,f)};
}).call(this,require("buffer").Buffer)

},{"./mgf":122,"./withPublic":125,"./xor":126,"bn.js":17,"browserify-rsa":38,"buffer":47,"create-hash":52,"parse-asn1":116,"randombytes":131}],125:[function(require,module,exports){
(function (Buffer){
function withPublic(e,n){return new Buffer(e.toRed(bn.mont(n.modulus)).redPow(new bn(n.publicExponent)).fromRed().toArray())}var bn=require("bn.js");module.exports=withPublic;
}).call(this,require("buffer").Buffer)

},{"bn.js":17,"buffer":47}],126:[function(require,module,exports){
module.exports=function(r,e){for(var n=r.length,o=-1;++o<n;)r[o]^=e[o];return r};
},{}],127:[function(require,module,exports){
(function (global){
!function(e){function o(e){throw new RangeError(T[e])}function n(e,o){for(var n=e.length,r=[];n--;)r[n]=o(e[n]);return r}function r(e,o){var r=e.split("@"),t="";r.length>1&&(t=r[0]+"@",e=r[1]),e=e.replace(S,".");var u=e.split("."),i=n(u,o).join(".");return t+i}function t(e){for(var o,n,r=[],t=0,u=e.length;t<u;)o=e.charCodeAt(t++),o>=55296&&o<=56319&&t<u?(n=e.charCodeAt(t++),56320==(64512&n)?r.push(((1023&o)<<10)+(1023&n)+65536):(r.push(o),t--)):r.push(o);return r}function u(e){return n(e,function(e){var o="";return e>65535&&(e-=65536,o+=P(e>>>10&1023|55296),e=56320|1023&e),o+=P(e)}).join("")}function i(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:b}function f(e,o){return e+22+75*(e<26)-((0!=o)<<5)}function c(e,o,n){var r=0;for(e=n?M(e/j):e>>1,e+=M(e/o);e>L*C>>1;r+=b)e=M(e/L);return M(r+(L+1)*e/(e+m))}function l(e){var n,r,t,f,l,s,d,a,p,h,v=[],g=e.length,w=0,m=I,j=A;for(r=e.lastIndexOf(E),r<0&&(r=0),t=0;t<r;++t)e.charCodeAt(t)>=128&&o("not-basic"),v.push(e.charCodeAt(t));for(f=r>0?r+1:0;f<g;){for(l=w,s=1,d=b;f>=g&&o("invalid-input"),a=i(e.charCodeAt(f++)),(a>=b||a>M((x-w)/s))&&o("overflow"),w+=a*s,p=d<=j?y:d>=j+C?C:d-j,!(a<p);d+=b)h=b-p,s>M(x/h)&&o("overflow"),s*=h;n=v.length+1,j=c(w-l,n,0==l),M(w/n)>x-m&&o("overflow"),m+=M(w/n),w%=n,v.splice(w++,0,m)}return u(v)}function s(e){var n,r,u,i,l,s,d,a,p,h,v,g,w,m,j,F=[];for(e=t(e),g=e.length,n=I,r=0,l=A,s=0;s<g;++s)v=e[s],v<128&&F.push(P(v));for(u=i=F.length,i&&F.push(E);u<g;){for(d=x,s=0;s<g;++s)v=e[s],v>=n&&v<d&&(d=v);for(w=u+1,d-n>M((x-r)/w)&&o("overflow"),r+=(d-n)*w,n=d,s=0;s<g;++s)if(v=e[s],v<n&&++r>x&&o("overflow"),v==n){for(a=r,p=b;h=p<=l?y:p>=l+C?C:p-l,!(a<h);p+=b)j=a-h,m=b-h,F.push(P(f(h+j%m,0))),a=M(j/m);F.push(P(f(a,0))),l=c(r,w,u==i),r=0,++u}++r,++n}return F.join("")}function d(e){return r(e,function(e){return F.test(e)?l(e.slice(4).toLowerCase()):e})}function a(e){return r(e,function(e){return O.test(e)?"xn--"+s(e):e})}var p="object"==typeof exports&&exports&&!exports.nodeType&&exports,h="object"==typeof module&&module&&!module.nodeType&&module,v="object"==typeof global&&global;v.global!==v&&v.window!==v&&v.self!==v||(e=v);var g,w,x=2147483647,b=36,y=1,C=26,m=38,j=700,A=72,I=128,E="-",F=/^xn--/,O=/[^\x20-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,T={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},L=b-y,M=Math.floor,P=String.fromCharCode;if(g={version:"1.4.1",ucs2:{decode:t,encode:u},decode:l,encode:s,toASCII:a,toUnicode:d},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return g});else if(p&&h)if(module.exports==p)h.exports=g;else for(w in g)g.hasOwnProperty(w)&&(p[w]=g[w]);else e.punycode=g}(this);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],128:[function(require,module,exports){
"use strict";function hasOwnProperty(r,e){return Object.prototype.hasOwnProperty.call(r,e)}module.exports=function(r,e,t,n){e=e||"&",t=t||"=";var o={};if("string"!=typeof r||0===r.length)return o;var a=/\+/g;r=r.split(e);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var p=r.length;s>0&&p>s&&(p=s);for(var y=0;y<p;++y){var u,c,i,l,f=r[y].replace(a,"%20"),v=f.indexOf(t);v>=0?(u=f.substr(0,v),c=f.substr(v+1)):(u=f,c=""),i=decodeURIComponent(u),l=decodeURIComponent(c),hasOwnProperty(o,i)?isArray(o[i])?o[i].push(l):o[i]=[o[i],l]:o[i]=l}return o};var isArray=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)};
},{}],129:[function(require,module,exports){
"use strict";function map(r,e){if(r.map)return r.map(e);for(var t=[],n=0;n<r.length;n++)t.push(e(r[n],n));return t}var stringifyPrimitive=function(r){switch(typeof r){case"string":return r;case"boolean":return r?"true":"false";case"number":return isFinite(r)?r:"";default:return""}};module.exports=function(r,e,t,n){return e=e||"&",t=t||"=",null===r&&(r=void 0),"object"==typeof r?map(objectKeys(r),function(n){var i=encodeURIComponent(stringifyPrimitive(n))+t;return isArray(r[n])?map(r[n],function(r){return i+encodeURIComponent(stringifyPrimitive(r))}).join(e):i+encodeURIComponent(stringifyPrimitive(r[n]))}).join(e):n?encodeURIComponent(stringifyPrimitive(n))+t+encodeURIComponent(stringifyPrimitive(r)):""};var isArray=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)},objectKeys=Object.keys||function(r){var e=[];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&e.push(t);return e};
},{}],130:[function(require,module,exports){
"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode");
},{"./decode":128,"./encode":129}],131:[function(require,module,exports){
(function (process,global,Buffer){
"use strict";function oldBrowser(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}function randomBytes(r,o){if(r>65536)throw new Error("requested too many random bytes");var e=new global.Uint8Array(r);r>0&&crypto.getRandomValues(e);var t=new Buffer(e.buffer);return"function"==typeof o?process.nextTick(function(){o(null,t)}):t}var crypto=global.crypto||global.msCrypto;crypto&&crypto.getRandomValues?module.exports=randomBytes:module.exports=oldBrowser;
}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("buffer").Buffer)

},{"_process":120,"buffer":47}],132:[function(require,module,exports){
"use strict";function Namespace(e){this.rdf=e}function rdfNamespace(e){return new Namespace(e)}module.exports=rdfNamespace,Namespace.prototype.base=function(e){var r=this;return function(t){return r.rdf?r.rdf.namedNode(e+t):e+t}};
},{}],133:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),ClassOrder=require("./class-order"),Node=require("./node"),BlankNode=function(e){function t(e){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return r.termType=t.termType,r.id=t.nextId++,r.value=e||r.id.toString(),r}return _inherits(t,e),_createClass(t,[{key:"compareTerm",value:function(e){return this.classOrder<e.classOrder?-1:this.classOrder>e.classOrder?1:this.id<e.id?-1:this.id>e.id?1:0}},{key:"copy",value:function(e){var r=new t;return e.copyTo(this,r),r}},{key:"toCanonical",value:function(){return"_:"+this.value}},{key:"toString",value:function(){return t.NTAnonymousNodePrefix+this.id}}]),t}(Node);BlankNode.nextId=0,BlankNode.termType="BlankNode",BlankNode.NTAnonymousNodePrefix="_:n",BlankNode.prototype.classOrder=ClassOrder.BlankNode,BlankNode.prototype.isBlank=1,BlankNode.prototype.isVar=1,module.exports=BlankNode;
},{"./class-order":134,"./node":150}],134:[function(require,module,exports){
"use strict";var ClassOrder={Literal:1,Collection:3,Formula:4,NamedNode:5,BlankNode:6,Variable:7};module.exports=ClassOrder;
},{}],135:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),BlankNode=require("./blank-node"),ClassOrder=require("./class-order"),Node=require("./node"),Collection=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return n.termType=t.termType,n.id=BlankNode.nextId++,n.elements=[],n.closed=!1,e&&e.length>0&&e.forEach(function(e){n.elements.push(Node.fromValue(e))}),n}return _inherits(t,e),_createClass(t,[{key:"append",value:function(e){return this.elements.push(e)}},{key:"close",value:function(){return this.closed=!0,this.closed}},{key:"shift",value:function(){return this.elements.shift()}},{key:"substitute",value:function(e){var n=this.elements.map(function(t){t.substitute(e)});return new t(n)}},{key:"toNT",value:function(){return BlankNode.NTAnonymousNodePrefix+this.id}},{key:"toString",value:function(){return"("+this.elements.join(" ")+")"}},{key:"unshift",value:function(e){return this.elements.unshift(e)}}]),t}(Node);Collection.termType="collection",Collection.prototype.classOrder=ClassOrder.Collection,Collection.prototype.compareTerm=BlankNode.prototype.compareTerm,Collection.prototype.isVar=0,module.exports=Collection;
},{"./blank-node":133,"./class-order":134,"./node":150}],136:[function(require,module,exports){
"use strict";function convertToJson(n,o){var r,t=N3.Parser(),e=N3.Writer({format:"N-Quads"});asyncLib.waterfall([function(o){t.parse(n,o)},function(n,o,r){null!==n&&e.addTriple(n),"function"==typeof r&&e.end(r)},function(n,o){try{jsonld.fromRDF(n,{format:"application/nquads"},o)}catch(n){o(n)}},function(n,t){r=JSON.stringify(n),o(null,r)}],function(n,t){o(n,r)})}function convertToNQuads(n,o){var r,t=N3.Parser(),e=N3.Writer({format:"N-Quads"});asyncLib.waterfall([function(o){t.parse(n,o)},function(n,o,r){null!==n&&e.addTriple(n),"function"==typeof r&&e.end(r)},function(n,t){r=n,o(null,r)}],function(n,t){o(n,r)})}module.exports.convertToJson=convertToJson,module.exports.convertToNQuads=convertToNQuads;var asyncLib=require("async"),jsonld=require("jsonld"),N3=require("n3");
},{"async":15,"jsonld":101,"n3":104}],137:[function(require,module,exports){
"use strict";function blankNode(e){return new BlankNode(e)}function collection(e){return new Collection(e)}function defaultGraph(){return new DefaultGraph}function fetcher(e,r,t){return new Fetcher(e,r,t)}function graph(){return new IndexedFormula}function lit(e,r,t){return new Literal(""+e,r,t)}function literal(e,r){return"string"==typeof r?r.indexOf(":")===-1?new Literal(e,r):new Literal(e,null,namedNode(r)):new Literal(e,null,r)}function namedNode(e){return new NamedNode(e)}function quad(e,r,t,n){return n=n||new DefaultGraph,new Statement(e,r,t,n)}function st(e,r,t,n){return new Statement(e,r,t,n)}function triple(e,r,t){return quad(e,r,t)}function variable(e){return new Variable(e)}var BlankNode=require("./blank-node"),Collection=require("./collection"),DefaultGraph=require("./default-graph"),Fetcher=require("./fetcher"),IndexedFormula=require("./indexed-formula"),Literal=require("./literal"),NamedNode=require("./named-node"),Statement=require("./statement"),Variable=require("./variable");module.exports.blankNode=blankNode,module.exports.defaultGraph=defaultGraph,module.exports.graph=graph,module.exports.literal=literal,module.exports.namedNode=namedNode,module.exports.quad=quad,module.exports.triple=triple,module.exports.variable=variable,module.exports.collection=collection,module.exports.fetcher=fetcher,module.exports.lit=lit,module.exports.st=st;
},{"./blank-node":133,"./collection":135,"./default-graph":138,"./fetcher":140,"./indexed-formula":143,"./literal":145,"./named-node":148,"./statement":160,"./variable":165}],138:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),Node=require("./node"),DefaultGraph=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return e.termType="DefaultGraph",e.value="",e}return _inherits(t,e),_createClass(t,[{key:"toCanonical",value:function(){return this.value}}]),t}(Node);module.exports=DefaultGraph;
},{"./node":150}],139:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),Node=require("./node"),Empty=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return e.termType=t.termType,e}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"()"}}]),t}(Node);Empty.termType="empty",module.exports=Empty;
},{"./node":150}],140:[function(require,module,exports){
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},log=require("./log"),N3Parser=require("./n3parser"),NamedNode=require("./named-node"),Namespace=require("./namespace"),rdfParse=require("./parse"),parseRDFaDOM=require("./rdfaparser").parseRDFaDOM,RDFParser=require("./rdfxmlparser"),Uri=require("./uri"),Util=require("./util"),Parsable={"text/n3":!0,"text/turtle":!0,"application/rdf+xml":!0,"application/xhtml+xml":!0,"text/html":!0,"application/ld+json":!0},Fetcher=function e(t,r,a){this.store=t,this.thisURI="http://dig.csail.mit.edu/2005/ajar/ajaw/rdf/sources.js#SourceFetcher",this.timeout=r||3e4,this.async=null==a||a,this.appNode=this.store.bnode(),this.store.fetcher=this,this.requested={},this.redirectedTo={},this.fetchCallbacks={},this.nonexistant={},this.lookedUp={},this.handlers=[],this.mediatypes={};var i=this,n=this.store,s={};s.link=Namespace("http://www.w3.org/2007/ont/link#"),s.http=Namespace("http://www.w3.org/2007/ont/http#"),s.httph=Namespace("http://www.w3.org/2007/ont/httph#"),s.rdf=Namespace("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),s.rdfs=Namespace("http://www.w3.org/2000/01/rdf-schema#"),s.dc=Namespace("http://purl.org/dc/elements/1.1/"),i.mediatypes["image/*"]={q:.9},i.mediatypes["*/*"]={q:.1},e.crossSiteProxy=function(t){return e.crossSiteProxyTemplate?e.crossSiteProxyTemplate.replace("{uri}",encodeURIComponent(t)):void 0},e.RDFXMLHandler=function(e){e&&(this.dom=e[0]),this.handlerFactory=function(e){e.handle=function(t){var r=i.store;this.dom||(this.dom=Util.parseXML(e.responseText));var a=this.dom.documentElement;if("parsererror"===a.nodeName)throw i.failFetch(e,"Badly formed XML in "+e.resource.uri),new Error("Badly formed XML in "+e.resource.uri);var n=new RDFParser(r);try{n.parse(this.dom,e.original.uri,e.original)}catch(t){i.addStatus(e.req,"Syntax error parsing RDF/XML! "+t),console.log("Syntax error parsing RDF/XML! "+t)}e.options.noMeta||r.add(e.original,s.rdf("type"),s.link("RDFDocument"),i.appNode),t()}}},e.RDFXMLHandler.toString=function(){return"RDFXMLHandler"},e.RDFXMLHandler.register=function(e){e.mediatypes["application/rdf+xml"]={q:.9}},e.RDFXMLHandler.pattern=new RegExp("application/rdf\\+xml"),e.XHTMLHandler=function(e){e&&(this.dom=e[0]),this.handlerFactory=function(e){e.handle=function(t){var r,a;this.dom||(this.dom=Util.parseXML(e.responseText));var n=i.store,o=this.dom.getElementsByTagName("title");o.length>0&&n.add(e.resource,s.dc("title"),n.literal(o[0].textContent),e.resource);for(var d=this.dom.getElementsByTagName("link"),l=d.length-1;l>=0;l--)r=d[l].getAttribute("rel"),a=!1,r||(r=d[l].getAttribute("rev"),a=!0),r&&i.linkData(e,r,d[l].getAttribute("href"),e.resource,a);for(var c=this.dom.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u].getAttribute("type");Parsable[h]&&rdfParse(c[u].textContent,n,e.original.uri,h)}if(e.options.noMeta||n.add(e.resource,s.rdf("type"),s.link("WebPage"),i.appNode),!e.options.noRDFa&&parseRDFaDOM)try{parseRDFaDOM(this.dom,n,e.original.uri)}catch(t){var p="Error trying to parse "+e.resource+" as RDFa:\n"+t+":\n"+t.stack;return void i.failFetch(e,p)}t()}}},e.XHTMLHandler.toString=function(){return"XHTMLHandler"},e.XHTMLHandler.register=function(e){e.mediatypes["application/xhtml+xml"]={}},e.XHTMLHandler.pattern=new RegExp("application/xhtml"),e.XMLHandler=function(){this.handlerFactory=function(e){e.handle=function(t){for(var r=Util.parseXML(e.responseText),a=0;a<r.childNodes.length;a++)if(1===r.childNodes[a].nodeType){var n=r.childNodes[a].namespaceURI;if(n&&n===n.rdf)return i.addStatus(e.req,"Has XML root element in the RDF namespace, so assume RDF/XML."),void i.switchHandler("RDFXMLHandler",e,t,[r]);break}if(r.doctype&&"html"===r.doctype.name&&r.doctype.publicId.match(/^-\/\/W3C\/\/DTD XHTML/)&&r.doctype.systemId.match(/http:\/\/www.w3.org\/TR\/xhtml/))return i.addStatus(e.req,"Has XHTML DOCTYPE. Switching to XHTML Handler.\n"),void i.switchHandler("XHTMLHandler",e,t);var s=r.getElementsByTagName("html")[0];if(s){var o=s.getAttribute("xmlns");if(o&&o.match(/^http:\/\/www.w3.org\/1999\/xhtml/))return i.addStatus(e.req,"Has a default namespace for XHTML. Switching to XHTMLHandler.\n"),void i.switchHandler("XHTMLHandler",e,t)}i.failFetch(e,"Unsupported dialect of XML: not RDF or XHTML namespace, etc.\n"+e.responseText.slice(0,80))}}},e.XMLHandler.toString=function(){return"XMLHandler"},e.XMLHandler.register=function(e){e.mediatypes["text/xml"]={q:.5},e.mediatypes["application/xml"]={q:.5}},e.XMLHandler.pattern=new RegExp("(text|application)/(.*)xml"),e.HTMLHandler=function(){this.handlerFactory=function(e){e.handle=function(t){var r=e.responseText;if(r.match(/\s*<\?xml\s+version\s*=[^<>]+\?>/))return i.addStatus(e.req,"Has an XML declaration. We'll assume it's XHTML as the content-type was text/html.\n"),void i.switchHandler("XHTMLHandler",e,t);if(r.match(/.*<!DOCTYPE\s+html[^<]+-\/\/W3C\/\/DTD XHTML[^<]+http:\/\/www.w3.org\/TR\/xhtml[^<]+>/))return i.addStatus(e.req,"Has XHTML DOCTYPE. Switching to XHTMLHandler.\n"),void i.switchHandler("XHTMLHandler",e,t);if(r.match(/[^(<html)]*<html\s+[^<]*xmlns=['"]http:\/\/www.w3.org\/1999\/xhtml["'][^<]*>/))return i.addStatus(e.req,"Has default namespace for XHTML, so switching to XHTMLHandler.\n"),void i.switchHandler("XHTMLHandler",e,t);var a=new RegExp("<title>([\\s\\S]+?)</title>","im").exec(r);if(a){var n=i.store;return n.add(e.resource,s.dc("title"),n.literal(a[1]),e.resource),n.add(e.resource,s.rdf("type"),s.link("WebPage"),i.appNode),void t()}i.addStatus(e.req,"non-XML HTML document, not parsed for data."),i.doneFetch(e)}}},e.HTMLHandler.toString=function(){return"HTMLHandler"},e.HTMLHandler.register=function(e){e.mediatypes["text/html"]={q:.9}},e.HTMLHandler.pattern=new RegExp("text/html"),e.TextHandler=function(){this.handlerFactory=function(e){e.handle=function(t){var r=e.responseText;return r.match(/\s*<\?xml\s+version\s*=[^<>]+\?>/)?(i.addStatus(e.req,"Warning: "+e.resource+" has an XML declaration. We'll assume it's XML but its content-type wasn't XML.\n"),void i.switchHandler("XMLHandler",e,t)):r.slice(0,500).match(/xmlns:/)?(i.addStatus(e.req,"May have an XML namespace. We'll assume it's XML but its content-type wasn't XML.\n"),void i.switchHandler("XMLHandler",e,t)):(i.addStatus(e.req,"Plain text document, no known RDF semantics."),void i.doneFetch(e))}}},e.TextHandler.toString=function(){return"TextHandler"},e.TextHandler.register=function(e){e.mediatypes["text/plain"]={q:.5}},e.TextHandler.pattern=new RegExp("text/plain"),e.N3Handler=function(){this.handlerFactory=function(e){e.handle=function(t){var r=N3Parser(n,n,e.original.uri,e.original.uri,null,null,"",null);try{r.loadBuf(e.responseText)}catch(t){var a="Error trying to parse "+e.resource+" as Notation3:\n"+t+":\n"+t.stack;return void i.failFetch(e,a)}i.addStatus(e.req,"N3 parsed: "+r.statementCount+" triples in "+r.lines+" lines."),i.store.add(e.original,s.rdf("type"),s.link("RDFDocument"),i.appNode),i.doneFetch(e)}}},e.N3Handler.toString=function(){return"N3Handler"},e.N3Handler.register=function(e){e.mediatypes["text/n3"]={q:"1.0"},e.mediatypes["text/turtle"]={q:1}},e.N3Handler.pattern=new RegExp("(application|text)/(x-)?(rdf\\+)?(n3|turtle)"),Util.callbackify(this,["request","recv","headers","load","fail","refresh","retract","done"]),this.addHandler=function(e){i.handlers.push(e),e.register(i)},this.switchHandler=function(t,r,a,n){for(var s=null,o=0;o<this.handlers.length;o++)""+this.handlers[o]===t&&(s=this.handlers[o]);if(!s)throw new Error("web.js: switchHandler: name="+t+" , this.handlers ="+this.handlers+"\nswitchHandler: switching to "+s+"; sf="+i+"; typeof Fetcher="+("undefined"==typeof e?"undefined":_typeof(e))+";\n\t Fetcher.HTMLHandler="+e.HTMLHandler+"\n\n\tsf.handlers="+i.handlers+"\n");new s(n).handlerFactory(r),r.handle(a)},this.addStatus=function(e,t){var r=new Date;t="["+r.getHours()+":"+r.getMinutes()+":"+r.getSeconds()+"."+r.getMilliseconds()+"] "+t;var a=this.store,i=a.the(e,s.link("status"));i&&i.append?i.append(a.literal(t)):log.warn("web.js: No list to add to: "+i+","+t)},this.failFetch=function(e,t){for(this.addStatus(e.req,t),e.options.noMeta||n.add(e.original,s.link("error"),t),e.resource.sameTerm(e.original)?console.log("@@ Recording failure for "+e.original+": "+e.status):console.log("@@ Recording failure original "+e.original+"( as "+e.resource+") : "+e.status),this.requested[Uri.docpart(e.original.uri)]=e.status;this.fetchCallbacks[e.original.uri]&&this.fetchCallbacks[e.original.uri].length;)this.fetchCallbacks[e.original.uri].shift()(!1,"Fetch of <"+e.original.uri+"> failed: "+t,e);return delete this.fetchCallbacks[e.original.uri],this.fireCallbacks("fail",[e.original.uri,t]),e.abort(),e},this.linkData=function(e,t,r,a,i){if(r){var o,d=n.sym(Uri.join(r,e.original.uri));if("alternate"===t||"seeAlso"===t||"meta"===t||"describedby"===t){if(d.uri===e.original.uri)return;o=s.rdfs("seeAlso")}else o="type"===t?n.sym("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):n.sym(Uri.join(t,"http://www.iana.org/assignments/link-relations/"));i?n.add(d,o,e.original,a):n.add(e.original,o,d,a)}},this.parseLinkHeader=function(e,t){var r;try{r=e.getResponseHeader("link")}catch(e){}if(r)for(var a=/<[^>]*>\s*(\s*;\s*[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*")))*(,|$)/g,i=/[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*"))/g,n=r.match(a),s=0;s<n.length;s++)for(var o=n[s].split(">"),d=o[0].substring(1),l=o[1],c=l.match(i),u=0;u<c.length;u++){var h=c[u],p=h.split("="),f=p[1].replace(/["']/g,"");this.linkData(e,f,d,t)}},this.doneFetch=function(e){for(this.addStatus(e.req,"Done."),this.requested[e.original.uri]="done";this.fetchCallbacks[e.original.uri]&&this.fetchCallbacks[e.original.uri].length;)this.fetchCallbacks[e.original.uri].shift()(!0,void 0,e);delete this.fetchCallbacks[e.original.uri],this.fireCallbacks("done",[e.original.uri])};var o=[e.RDFXMLHandler,e.XHTMLHandler,e.XMLHandler,e.HTMLHandler,e.TextHandler,e.N3Handler];o.map(this.addHandler),this.nowKnownAs=function(e,t){this.lookedUp[e.uri]?this.lookedUp[t.uri]||this.lookUpThing(t,e):this.lookedUp[t.uri]&&(this.lookedUp[e.uri]||this.lookUpThing(e,t))},this.putBack=function(e,t){e=e.uri||e;var r=$rdf.sym(e).doc();return t.data=$rdf.serialize(r,this.store,r.uri,t.contentType||"text/turtle"),this.webOperation("PUT",e,t)},this.webOperation=function(e,t,r){t=t.uri||t,r=r||{},t=this.proxyIfNecessary(t);var a=this;return new Promise(function(i,n){var s=Util.XMLHTTPFactory();s.options=r,s.original=a.store.sym(t),r.noMeta||"undefined"==typeof tabulator||a.saveRequestMetadata(s,a.store,t),s.onreadystatechange=function(){if(4===s.readyState){var e=!s.status||s.status>=200&&s.status<300;r.noMeta||"undefined"==typeof tabulator||a.saveResponseMetadata(s,a.store),e?i(s):n(s.status+" "+s.statusText)}},s.open(e,t,!0),r.contentType&&s.setRequestHeader("Content-type",r.contentType),s.send(r.data?r.data:void 0)})},this.webCopy=function(e,t,r){var a=this;return e=e.uri||e,new Promise(function(i,n){a.webOperation("GET",e).then(function(e){a.webOperation("PUT",t,{data:e.responseText,contentType:r}).then(function(e){i(e)}).catch(function(e){n(e)})}).catch(function(e){n(e)})})},this.lookUpThing=function(e,t,r,a,i){var s,o=n.uris(e),d=!0,l="",c={};if(r===!1||r===!0?(s=r,r={force:s}):(void 0===r&&(r={}),s=!!r.force),"undefined"!=typeof o)for(var u=0;u<o.length;u++){var h=o[u];c[h]=!0,this.lookedUp[h]=!0;var p=this,f=function(e){p.requestURI(Uri.docpart(e),t,r,function(t,r,n){t?a&&a(!0,e):(a&&a(!1,r),d=!1,l+=r+"\n"),delete c[h],Object.keys(c).length>0||i&&i(d,l)})};f(h)}return o.length},this.load=function(e,t){var r=this;if(e instanceof Array){var a=e.map(function(e){return r.load(e)});return Promise.all(a)}return e=e.uri||e,new Promise(function(a,i){r.nowOrWhenFetched(e,t,function(e,t,r){e?a(r):i(t)})})},this.nowOrWhenFetched=function(e,t,r,a){e=e.uri||e,"function"==typeof t?(a={},r=t):"undefined"==typeof t||(a=t instanceof NamedNode?{referingTerm:t}:t),this.requestURI(e,t,a||{},r)},this.get=this.nowOrWhenFetched,this.getHeader=function(e,t){for(var r=this.store,a=r.each(void 0,s.link("requestedURI"),e.uri),i=0;i<a.length;i++){var n=a[i];if(void 0!==n){var o=r.any(n,s.link("response"));if(void 0!==n){var d=r.each(o,s.httph(t.toLowerCase()));return d.length?d.map(function(e){return e.value}):[]}}}},this.proxyIfNecessary=function(t){if("undefined"!=typeof tabulator&&tabulator.isExtension)return t;if("undefined"!=typeof $SolidTestEnvironment&&$SolidTestEnvironment.localSiteMap){var r=t.split("/").slice(2),a=function e(t,r){var a=r[t.shift()];return a?"string"==typeof a?a+t.join("/"):t?e(t,a):null:null},i=a(r,$SolidTestEnvironment.localSiteMap);if(i)return i}return e.crossSiteProxyTemplate&&"undefined"!=typeof document&&document.location&&"https:"===(""+document.location).slice(0,6)&&"http:"===t.slice(0,5)?e.crossSiteProxyTemplate.replace("{uri}",encodeURIComponent(t)):t},this.saveRequestMetadata=function(e,t,r){var a=t.bnode();if(e.resource=t.sym(r),e.req=a,!e.options.noMeta){var i=new Date,n="["+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()+"] ";t.add(a,s.rdfs("label"),t.literal(n+" Request for "+r),this.appNode),t.add(a,s.link("requestedURI"),t.literal(r),this.appNode),e.original&&e.original.uri!==r&&t.add(a,s.link("orginalURI"),t.literal(e.original.uri),this.appNode),t.add(a,s.link("status"),t.collection(),this.appNode)}return a},this.saveResponseMetadata=function(e,t){var r=t.bnode();if(e.req&&t.add(e.req,s.link("response"),r),t.add(r,s.http("status"),t.literal(e.status),r),t.add(r,s.http("statusText"),t.literal(e.statusText),r),e.headers={},"http"===Uri.protocol(e.resource.uri)||"https"===Uri.protocol(e.resource.uri)){e.headers=Util.getHTTPHeaders(e);for(var a in e.headers){var i=e.headers[a].trim(),n=a.toLowerCase();t.add(r,s.httph(n),i,r),"content-type"===n&&t.add(e.resource,s.rdf("type"),$rdf.Util.mediaTypeClass(i),r)}}return r},this.requestURI=function(t,r,a,i){t=t.uri||t,t=t.split("#")[0],"boolean"==typeof a&&(a={force:a}),"undefined"==typeof a&&(a={});var n=!!a.force,o=this.store,d=arguments,l=a.baseURI||t;a.userCallback=i;var c=Uri.protocol(t);if("tel"===c||"mailto"===c||"urn"===c)return console.log("Unsupported protocol in: "+t),i(!1,"Unsupported protocol",{status:900})||void 0;var u=o.sym(t),h=this.getState(t);if(n)delete this.nonexistant[t];else{if("fetched"===h)return i?i(!0):void 0;if("failed"===h)return i?i(!1,"Previously failed. "+this.requested[t],{status:this.requested[t]}):void 0}if(this.fireCallbacks("request",d),i&&(this.fetchCallbacks[t]?this.fetchCallbacks[t].push(i):this.fetchCallbacks[t]=[i]),this.requested[t]!==!0){this.requested[t]=!0,!a.noMeta&&r&&r.uri&&o.add(u.uri,s.link("requestedBy"),r.uri,this.appNode);var p=Util.XMLHTTPFactory(),f=p.req=o.bnode();p.original=o.sym(l),p.options=a,p.resource=u;var m=this,g=new Date,y="["+g.getHours()+":"+g.getMinutes()+":"+g.getSeconds()+"] ";a.noMeta||(o.add(f,s.rdfs("label"),o.literal(y+" Request for "+t),this.appNode),o.add(f,s.link("requestedURI"),o.literal(t),this.appNode),o.add(f,s.link("status"),o.collection(),this.appNode));var v=function(){if(!p.withCredentials)return!1;if(p.retriedWithCredentials)return!0;p.retriedWithCredentials=!0,console.log("web: Retrying with no credentials for "+p.resource),p.abort(),delete m.requested[t];var e={};for(var i in a)a.hasOwnProperty(i)&&(e[i]=a[i]);return e.withCredentials=!1,m.addStatus(p.req,"Abort: Will retry with credentials SUPPRESSED to see if that helps"),m.requestURI(t,r,e,p.userCallback),!0},w=function(t){return function(r){if(t.onErrorWasCalled=!0,"undefined"!=typeof document&&e.crossSiteProxyTemplate&&document.location&&!t.proxyUsed){var a=Uri.hostpart,i=""+document.location,n=t.resource.uri;if(a(i)&&a(n)&&a(i)!==a(n))if(401===t.status||403===t.status||404===t.status)b(t)();else{if(v(t))return;var o=e.crossSiteProxy(n);if(console.log("web: Direct failed so trying proxy "+o),m.addStatus(t.req,"BLOCKED -> Cross-site Proxy to <"+o+">"),t.aborted)return;var d=m.store,l=t.req;t.options.noMeta||d.add(l,s.http("redirectedTo"),d.sym(o),l),t.abort(),t.aborted=!0,m.addStatus(l,"redirected to new request"),m.requested[t.resource.uri]="redirected",m.redirectedTo[t.resource.uri]=o,m.fetchCallbacks[t.resource.uri]&&(m.fetchCallbacks[o]||(m.fetchCallbacks[o]=[]),m.fetchCallbacks[o]===m.fetchCallbacks[o].concat(m.fetchCallbacks[t.resource.uri]),delete m.fetchCallbacks[t.resource.uri]);var c=m.requestURI(o,t.resource,t.options,t.userCallback);if(c&&(c.proxyUsed=!0,c.original=t.original,console.log("Proxying but original still "+c.original)),c&&c.req)return void(t.options.noMeta||d.add(t.req,d.sym("http://www.w3.org/2007/ont/link#redirectedRequest"),c.req,m.appNode))}t.CORS_status=999}}},b=function(e){return function(){var r=function(){if(!e.handleResponseDone){e.handleResponseDone=!0;var r=null,i=e.req;m.fireCallbacks("recv",d);var o=m.store;if(m.saveResponseMetadata(e,o),m.fireCallbacks("headers",[{uri:t,headers:e.headers}]),0===e.status){if(console.log("Masked error - status 0 for "+e.resource.uri),v(e))return;return void(e.CORS_status=900)}if(e.status>=400){if(404===e.status&&(o.fetcher.nonexistant[e.resource.uri]=!0),e.responseText.length>10){var l=o.bnode();o.add(l,s.http("content"),o.literal(e.responseText),l),e.statusText&&o.add(l,s.http("statusText"),o.literal(e.statusText),l)}return void m.failFetch(e,"HTTP error for "+e.resource+": "+e.status+" "+e.statusText)}var c,u=e.headers["content-location"],h=function(e){var t=i;if(u){var r=o.any(t,s.link("requestedURI"));r!==u&&o.add(o.sym(u),s.rdf("type"),e,m.appNode)}for(;;){var a=o.any(t,s.link("requestedURI"));if(a&&a.value&&o.add(o.sym(a.value),s.rdf("type"),e,m.appNode),t=o.any(void 0,o.sym("http://www.w3.org/2007/ont/link#redirectedRequest"),t),!t)break;var n=o.any(t,o.sym("http://www.w3.org/2007/ont/link#response"));if(!n)break;var d=o.any(n,o.sym("http://www.w3.org/2007/ont/http#status"));if(!d)break;if("301"!==d&&"302"!==d)break}},p={rdf:"application/rdf+xml",owl:"application/rdf+xml",n3:"text/n3",ttl:"text/turtle",nt:"text/n3",acl:"text/n3",html:"text/html",xml:"text/xml"};if(200===e.status){h(s.link("Document"));var f=e.headers["content-type"];a.forceContentType&&(e.headers["content-type"]=a.forceContentType),(!f||f.indexOf("application/octet-stream")>=0)&&(c=p[e.resource.uri.split(".").pop()],c&&(e.headers["content-type"]=c)),f&&(0!==f.indexOf("image/")&&0!==f.indexOf("application/pdf")||h(o.sym("http://purl.org/dc/terms/Image"))),a.clearPreviousData&&o.removeDocument(e.resource)}if("file"!==Uri.protocol(e.resource.uri)&&"chrome"!==Uri.protocol(e.resource.uri)||(a.forceContentType?e.headers["content-type"]=a.forceContentType:(c=p[e.resource.uri.split(".").pop()],c?e.headers["content-type"]=c:e.headers["content-type"]="text/xml")),u){var g=Uri.join(e.resource.uri,u);if(!n&&g!==e.resource.uri&&m.requested[g]&&"done"===m.requested[g])return m.doneFetch(e),void e.abort();m.requested[g]=!0}for(var y=0;y<m.handlers.length;y++)if(e.headers["content-type"]&&e.headers["content-type"].match(m.handlers[y].pattern)){r=new m.handlers[y];break}if(m.parseLinkHeader(e,i),!r)return void m.doneFetch(e);try{r.handlerFactory(e)}catch(t){m.failFetch(e,"Exception handling content-type "+e.headers["content-type"]+" was: "+t)}}};switch(e.readyState){case 0:var i,o=e.resource.uri;if(this.crossSiteProxyTemplate&&"undefined"!=typeof document&&document.location){var l=Uri.hostpart,c=""+document.location;if(l(c)&&l(o)&&l(c)!==l(o)){if(i=this.crossSiteProxyTemplate.replace("{uri}",encodeURIComponent(o)),m.addStatus(e.req,"BLOCKED -> Cross-site Proxy to <"+i+">"),e.aborted)return;var u=m.store,h=e.req;u.add(h,s.http("redirectedTo"),u.sym(i),h);var p=e.req=u.bnode();u.add(h,s.http("redirectedRequest"),p,e.req);var f=new Date,g="["+f.getHours()+":"+f.getMinutes()+":"+f.getSeconds()+"] ";u.add(p,s.rdfs("label"),u.literal(g+" Request for "+i),this.appNode),u.add(p,s.link("status"),u.collection(),this.appNode),u.add(p,s.link("requestedURI"),u.literal(i),this.appNode);var y=u.bnode();u.add(h,s.link("response"),y),e.abort(),e.aborted=!0,e.redirected=!0,m.addStatus(h,"redirected XHR"),m.fetchCallbacks[e.resource.uri]&&(m.fetchCallbacks[i]||(m.fetchCallbacks[i]=[]),m.fetchCallbacks[i]===m.fetchCallbacks[i].concat(m.fetchCallbacks[e.resource.uri]),delete m.fetchCallbacks[e.resource.uri]),m.fireCallbacks("redirected",d),m.requested[e.resource.uri]="redirected";var w=m.requestURI(i,e.resource,e.options||{},e.userCallback);if(w&&w.req)return void u.add(e.req,u.sym("http://www.w3.org/2007/ont/link#redirectedRequest"),w.req,m.appNode)}}m.failFetch(e,"HTTP Blocked. (ReadyState 0) Cross-site violation for <"+t+">");break;case 3:break;case 4:if(r(),e.handle&&void 0!==e.responseText){if("redirected"===m.requested[e.resource.uri])break;m.fireCallbacks("load",d),e.handle(function(){m.doneFetch(e)})}else e.redirected?m.addStatus(e.req,"Aborted and redirected to new request."):m.addStatus(e.req,"Fetch over. No data handled. Aborted = "+e.aborted)}}},q=t;"undefined"!=typeof tabulator&&tabulator.preferences.get("offlineModeUsingLocalhost")&&"http://"===q.slice(0,7)&&"localhost/"!==q.slice(7,17)&&(q="http://localhost/"+q.slice(7),log.warn("Localhost kludge for offline use: actually getting <"+q+">"));var T="https:"===q.slice(0,6);void 0!==a.withCredentials&&(T=a.withCredentials);var k=this.proxyIfNecessary(q);p.onerror=w(p),p.onreadystatechange=b(p),p.timeout=m.timeout,p.withCredentials=T,p.actualProxyURI=k,p.req=f,p.options=a,p.options=a,p.resource=u,p.requestedURI=q,p.ontimeout=function(){m.failFetch(p,"requestTimeout")};try{p.open("GET",k,this.async)}catch(e){return this.failFetch(p,"XHR open for GET failed for <"+q+">:\n\t"+e)}if(n&&p.setRequestHeader("Cache-control","no-cache"),"undefined"!=typeof tabulator&&tabulator.isExtension&&p.channel&&("http"===Uri.protocol(p.resource.uri)||"https"===Uri.protocol(p.resource.uri)))try{p.channel.notificationCallbacks={getInterface:function(e){return e.equals(Components.interfaces.nsIChannelEventSink)?{onChannelRedirect:function(e,t,i){if(!p.aborted){var n=m.store,o=t.URI.spec,l=p.req;if(!p.options.noMeta){m.addStatus(p.req,"Redirected: "+p.status+" to <"+o+">"),n.add(l,s.http("redirectedTo"),n.sym(o),p.req);var c=p.req=n.bnode();n.add(l,s.http("redirectedRequest"),c,this.appNode);var u=new Date,h="["+u.getHours()+":"+u.getMinutes()+":"+u.getSeconds()+"] ";n.add(c,s.rdfs("label"),n.literal(h+" Request for "+o),this.appNode),n.add(c,s.link("status"),n.collection(),this.appNode),n.add(c,s.link("requestedURI"),n.literal(o),this.appNode);var f=n.bnode();n.add(l,s.link("response"),f),n.add(f,s.http("status"),n.literal(p.status),f),p.statusText&&n.add(f,s.http("statusText"),n.literal(p.statusText),f)}if(p.status-0!==303&&(n.HTTPRedirects[p.resource.uri]=o),p.status-0===301&&r){var g=Uri.docpart(r.uri),y="Warning: "+p.resource+" has moved to <"+o+">.";r&&(y+=" Link in <"+g+" >should be changed",n.add(g,n.sym("http://www.w3.org/2007/ont/link#warning"),y,m.appNode))}p.abort(),p.aborted=!0,m.fetchCallbacks[p.resource.uri]&&(m.fetchCallbacks[o]||(m.fetchCallbacks[o]=[]),m.fetchCallbacks[o]===m.fetchCallbacks[o].concat(m.fetchCallbacks[p.resource.uri]),delete m.fetchCallbacks[p.resource.uri]),m.addStatus(l,"redirected"),m.fireCallbacks("redirected",d),m.requested[p.resource.uri]="redirected",m.redirectedTo[p.resource.uri]=o;var v=o.indexOf("#");v>=0&&(p.options.noMeta||n.add(p.resource,n.sym("http://www.w3.org/2007/ont/link#warning"),"Warning: "+p.resource+" HTTP redirects to"+o+' which should not contain a "#" sign'),o=o.slice(0,v));var w=m.requestURI(o,p.resource,p.options,p.userCallback);w&&w.req&&!a.noMeta&&n.add(p.req,n.sym("http://www.w3.org/2007/ont/link#redirectedRequest"),w.req,m.appNode)}},asyncOnChannelRedirect:function(e,t,a,i){if(!p.aborted){var n=m.store,o=t.URI.spec,d=p.req;m.addStatus(p.req,"Redirected: "+p.status+" to <"+o+">"),n.add(d,s.http("redirectedTo"),n.sym(o),p.req);var l=p.req=n.bnode();n.add(d,s.http("redirectedRequest"),l,p.req);var c=new Date,u="["+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds()+"] ";n.add(l,s.rdfs("label"),n.literal(u+" Request for "+o),this.appNode),n.add(l,s.link("status"),n.collection(),this.appNode),n.add(l,s.link("requestedURI"),n.literal(o),this.appNode);var h=n.bnode();if(n.add(d,s.link("response"),h),n.add(h,s.http("status"),n.literal(p.status),h),p.statusText&&n.add(h,s.http("statusText"),n.literal(p.statusText),h),p.status-0!==303&&(n.HTTPRedirects[p.resource.uri]=o),p.status-0===301&&r){var f=Uri.docpart(r.uri),g="Warning: "+p.resource+" has moved to <"+o+">.";r&&(g+=" Link in <"+f+" >should be changed",n.add(f,n.sym("http://www.w3.org/2007/ont/link#warning"),g,m.appNode))}p.abort(),p.aborted=!0;var y=o.indexOf("#");if(y>=0){var v="Warning: "+p.resource+" HTTP redirects to"+o+' which do not normally contain a "#" sign';n.add(p.resource,n.sym("http://www.w3.org/2007/ont/link#warning"),v),o=o.slice(0,y)}m.requested[p.resource.uri]="redirected",m.redirectedTo[p.resource.uri]=o;var w=m.requestURI(o,p.resource,p.options,p.userCallback);w&&(w.original=p.original,w.req&&n.add(p.req,n.sym("http://www.w3.org/2007/ont/link#redirectedRequest"),w.req,m.appNode))}}}:Components.results.NS_NOINTERFACE}}}catch(e){return m.failFetch(p,"@@ Couldn't set callback for redirects: "+e)}try{var H="";for(var x in this.mediatypes){""!==H&&(H+=", "),H+=x;for(var M in this.mediatypes[x])H+=";"+M+"="+this.mediatypes[x][M]}p.setRequestHeader("Accept",H),this.addStatus(p.req,"Accept: "+H)}catch(e){throw new Error("Can't set Accept header: "+e)}try{p.send(null)}catch(e){return this.failFetch(p,"XHR send failed:"+e)}return setTimeout(function(){4!==p.readyState&&m.isPending(p.resource.uri)&&m.failFetch(p,"requestTimeout")},this.timeout),this.addStatus(p.req,"HTTP Request sent."),p}},this.objectRefresh=function(e){var t=n.uris(e);if("undefined"!=typeof t)for(var r=0;r<t.length;r++)this.refresh(this.store.sym(Uri.docpart(t[r])))},this.unload=function(e){this.store.removeMany(void 0,void 0,void 0,e),delete this.requested[e.uri]},this.refresh=function(e,t){this.fireCallbacks("refresh",arguments),this.requestURI(e.uri,void 0,{force:!0,clearPreviousData:!0},t)},this.retract=function(e){this.store.removeMany(void 0,void 0,void 0,e),e.uri&&delete this.requested[Uri.docpart(e.uri)],this.fireCallbacks("retract",arguments)},this.getState=function(e){return"undefined"==typeof this.requested[e]?"unrequested":this.requested[e]===!0?"requested":"done"===this.requested[e]?"fetched":"redirected"===this.requested[e]?this.getState(this.redirectedTo[e]):"failed"},this.isPending=function(e){return this.requested[e]===!0}};module.exports=Fetcher;
},{"./log":146,"./n3parser":147,"./named-node":148,"./namespace":149,"./parse":151,"./rdfaparser":155,"./rdfxmlparser":156,"./uri":163,"./util":164}],141:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),BlankNode=require("./blank-node"),ClassOrder=require("./class-order"),Collection=require("./collection"),Literal=require("./literal"),log=require("./log"),NamedNode=require("./named-node"),Node=require("./node"),Serializer=require("./serialize"),Statement=require("./statement"),Variable=require("./variable"),Formula=function(e){function t(e,r,n,s){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return i.termType=t.termType,i.statements=e||[],i.constraints=r||[],i.initBindings=n||[],i.optional=s||[],i}return _inherits(t,e),_createClass(t,[{key:"add",value:function(e,t,r,n){return this.statements.push(new Statement(e,t,r,n))}},{key:"addStatement",value:function(e){return this.statements.push(e)}},{key:"bnode",value:function(e){return new BlankNode(e)}},{key:"bottomTypeURIs",value:function(e){var t,r,n,s,i,o,a,u,l;t=[];for(i in e)if(e.hasOwnProperty(i)){for(l=e[i],u=this.each(void 0,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),this.sym(i)),r=!0,s=0,o=u.length;s<o;s++)if(n=u[s],a=n.uri,a in e){r=!1;break}r&&(t[i]=l)}return t}},{key:"collection",value:function(){return new Collection}},{key:"each",value:function(e,t,r,n){var s,i,o,a,u,l,h,c,f,w=[],m=this.statementsMatching(e,t,r,n,!1);if(null==e)for(i=0,l=m.length;i<l;i++)s=m[i],w.push(s.subject);else if(null==t)for(o=0,h=m.length;o<h;o++)s=m[o],w.push(s.predicate);else if(null==r)for(a=0,c=m.length;a<c;a++)s=m[a],w.push(s.object);else if(null==n)for(u=0,f=m.length;u<f;u++)s=m[u],w.push(s.why);return w}},{key:"equals",value:function(e){return!!e&&this.hashString()===e.hashString()}},{key:"findMembersNT",value:function(e){var t,r,n,s,i,o,a,u,l,h,c,f,w,m,p,d,y,v,g,b,T;v={},v[e.toNT()]=!0,l={},f=this.transitiveClosure(v,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),!0);for(b in f)if(f.hasOwnProperty(b)){for(w=this.statementsMatching(void 0,this.sym("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),this.fromNT(b)),t=0,n=w.length;t<n;t++)g=w[t],l[g.subject.toNT()]=g;for(m=this.each(void 0,this.sym("http://www.w3.org/2000/01/rdf-schema#domain"),this.fromNT(b)),r=0,s=m.length;r<s;r++)for(h=m[r],p=this.statementsMatching(void 0,h),u=0,i=p.length;u<i;u++)g=p[u],l[g.subject.toNT()]=g;for(d=this.each(void 0,this.sym("http://www.w3.org/2000/01/rdf-schema#range"),this.fromNT(b)),c=0,o=d.length;c<o;c++)for(h=d[c],y=this.statementsMatching(void 0,h),T=0,a=y.length;T<a;T++)g=y[T],l[g.object.toNT()]=g}return l}},{key:"findMemberURIs",value:function(e){return this.NTtoURI(this.findMembersNT(e))}},{key:"findSubClassesNT",value:function(e){var t={};return t[e.toNT()]=!0,this.transitiveClosure(t,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),!0)}},{key:"findSuperClassesNT",value:function(e){var t={};return t[e.toNT()]=!0,this.transitiveClosure(t,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),!1)}},{key:"findTypesNT",value:function(e){var t,r,n,s,i,o,a,u,l,h,c,f,w,m,p,d,y;for(c="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",y=[],f=this.statementsMatching(e,void 0,void 0),r=0,s=f.length;r<s;r++)if(d=f[r],d.predicate.uri===c)y[d.object.toNT()]=d;else for(w=this.each(d.predicate,this.sym("http://www.w3.org/2000/01/rdf-schema#domain")),n=0,i=w.length;n<i;n++)h=w[n],y[h.toNT()]=d;for(m=this.statementsMatching(void 0,void 0,e),u=0,o=m.length;u<o;u++)for(d=m[u],p=this.each(d.predicate,this.sym("http://www.w3.org/2000/01/rdf-schema#range")),l=0,a=p.length;l<a;l++)t=p[l],y[t.toNT()]=d;return this.transitiveClosure(y,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),!1)}},{key:"findTypeURIs",value:function(e){return this.NTtoURI(this.findTypesNT(e))}},{key:"formula",value:function(){return new t}},{key:"fromNT",value:function(e){var t,r,n,s;switch(e[0]){case"<":return this.sym(e.slice(1,-1));case'"':if(n=void 0,t=void 0,r=e.lastIndexOf('"'),r<e.length-1)if("@"===e[r+1])n=e.slice(r+2);else{if("^^"!==e.slice(r+1,r+3))throw new Error("Can't convert string from NT: "+e);t=this.fromNT(e.slice(r+3))}return e=e.slice(1,r),e=e.replace(/\\"/g,'"'),e=e.replace(/\\n/g,"\n"),e=e.replace(/\\\\/g,"\\"),this.literal(e,n,t);case"_":return s=new BlankNode,s.id=parseInt(e.slice(3),10),BlankNode.nextId--,s;case"?":return new Variable(e.slice(1))}throw new Error("Can't convert from NT: "+e)}},{key:"holds",value:function(e,t,r,n){var s=this.anyStatementMatching(e,t,r,n);return null!=s}},{key:"holdsStatement",value:function(e){return this.holds(e.subject,e.predicate,e.object,e.why)}},{key:"list",value:function(e){var t=new Collection;return e.forEach(function(e){t.append(e)}),t}},{key:"literal",value:function(e,t,r){return new Literal(""+e,t,r)}},{key:"NTtoURI",value:function(e){var t,r,n={};for(t in e)e.hasOwnProperty(t)&&(r=e[t],"<"===t[0]&&(n[t.slice(1,-1)]=r));return n}},{key:"serialize",value:function(e,t,r){var n,s,i;switch(i=Serializer(this),i.suggestNamespaces(this.namespaces),i.setBase(e),s=r?this.statementsMatching(void 0,void 0,void 0,r):this.statements,null!=t?t:"text/n3"){case"application/rdf+xml":n=i.statementsToXML(s);break;case"text/n3":case"text/turtle":n=i.statementsToN3(s);break;default:throw new Error("serialize: Content-type "+t+" not supported.")}return n}},{key:"substitute",value:function(e){var r=this.statements.map(function(t){t.substitute(e)});return new t(r)}},{key:"sym",value:function(e,t){if(t)throw new Error("This feature (kb.sym with 2 args) is removed. Do not assume prefix mappings.");return new NamedNode(e)}},{key:"the",value:function(e,t,r,n){var s=this.any(e,t,r,n);return null==s&&log.error("No value found for the() {"+e+" "+t+" "+r+"}."),s}},{key:"transitiveClosure",value:function(e,t,r){var n,s,i,o,a,u,l={};Object.assign(l,e);for(var h={};;){if(u=function(){for(var e in l)if(l.hasOwnProperty(e))return e}(),null==u)return h;for(a=r?this.each(void 0,t,this.fromNT(u)):this.each(this.fromNT(u),t),s=0,i=a.length;s<i;s++)n=a[s],o=n.toNT(),o in h||o in l||(l[o]=l[u]);h[u]=l[u],delete l[u]}}},{key:"topTypeURIs",value:function(e){var t,r,n,s,i,o,a,u;a=[];for(n in e)if(e.hasOwnProperty(n)){for(u=e[n],i=0,o=this.each(this.sym(n),this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf")),t=0,s=o.length;t<s;t++)if(r=o[t],"http://www.w3.org/2000/01/rdf-schema#Resource"!==r.uri){i++;break}i||(a[n]=u)}return a["http://www.w3.org/2000/01/rdf-schema#Resource"]&&delete a["http://www.w3.org/2000/01/rdf-schema#Resource"],a["http://www.w3.org/2002/07/owl#Thing"]&&delete a["http://www.w3.org/2002/07/owl#Thing"],a}},{key:"toString",value:function(){return"{"+this.statements.join("\n")+"}"}},{key:"whether",value:function(e,t,r,n){return this.statementsMatching(e,t,r,n,!1).length}}]),t}(Node);Formula.termType="formula",Formula.prototype.classOrder=ClassOrder.Formula,Formula.prototype.isVar=0,Formula.prototype.ns=require("./namespace"),Formula.prototype.variable=require("./data-factory").variable,module.exports=Formula;
},{"./blank-node":133,"./class-order":134,"./collection":135,"./data-factory":137,"./literal":145,"./log":146,"./named-node":148,"./namespace":149,"./node":150,"./serialize":157,"./statement":160,"./variable":165}],142:[function(require,module,exports){
"use strict";var $rdf={BlankNode:require("./blank-node"),Collection:require("./collection"),convert:require("./convert"),DataFactory:require("./data-factory"),Empty:require("./empty"),Fetcher:require("./fetcher"),Formula:require("./formula"),IndexedFormula:require("./indexed-formula"),jsonParser:require("./jsonparser"),Literal:require("./literal"),log:require("./log"),N3Parser:require("./n3parser"),NamedNode:require("./named-node"),Namespace:require("./namespace"),Node:require("./node"),parse:require("./parse"),Query:require("./query").Query,queryToSPARQL:require("./query-to-sparql"),RDFaProcessor:require("./rdfaparser"),RDFParser:require("./rdfxmlparser"),serialize:require("./serialize"),Serializer:require("./serializer"),SPARQLToQuery:require("./sparql-to-query"),sparqlUpdateParser:require("./patch-parser"),Statement:require("./statement"),term:require("./node").fromValue,UpdateManager:require("./update-manager"),UpdatesSocket:require("./updates-via").UpdatesSocket,UpdatesVia:require("./updates-via").UpdatesVia,uri:require("./uri"),Util:require("./util"),Variable:require("./variable")};$rdf.NextId=$rdf.BlankNode.nextId,$rdf.fromNT=$rdf.Formula.prototype.fromNT,$rdf.fetcher=$rdf.DataFactory.fetcher,$rdf.graph=$rdf.DataFactory.graph,$rdf.lit=$rdf.DataFactory.lit,$rdf.st=$rdf.DataFactory.st,$rdf.sym=$rdf.DataFactory.namedNode,$rdf.variable=$rdf.DataFactory.variable,$rdf.blankNode=$rdf.DataFactory.blankNode,$rdf.defaultGraph=$rdf.DataFactory.defaultGraph,$rdf.literal=$rdf.DataFactory.literal,$rdf.namedNode=$rdf.DataFactory.namedNode,$rdf.quad=$rdf.DataFactory.quad,$rdf.triple=$rdf.DataFactory.triple,module.exports=$rdf;
},{"./blank-node":133,"./collection":135,"./convert":136,"./data-factory":137,"./empty":139,"./fetcher":140,"./formula":141,"./indexed-formula":143,"./jsonparser":144,"./literal":145,"./log":146,"./n3parser":147,"./named-node":148,"./namespace":149,"./node":150,"./parse":151,"./patch-parser":152,"./query":154,"./query-to-sparql":153,"./rdfaparser":155,"./rdfxmlparser":156,"./serialize":157,"./serializer":158,"./sparql-to-query":159,"./statement":160,"./update-manager":161,"./updates-via":162,"./uri":163,"./util":164,"./variable":165}],143:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function handle_FP(e,t,n,r){var i=e.any(t,n,void 0);return!!i&&(e.equate(i,r),!0)}function handle_IFP(e,t,n,r){var i=e.any(void 0,n,r);return!!i&&(e.equate(i,t),!0)}function handleRDFType(e,t,n,r,i){e.typeCallback&&e.typeCallback(e,r,i);var a=e.classActions[r.hashString()],s=!1;if(a)for(var o=0;o<a.length;o++)s=s||a[o](e,t,n,r,i);return s}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ArrayIndexOf=require("./util").ArrayIndexOf,Formula=require("./formula"),RDFArrayRemove=require("./util").RDFArrayRemove,Statement=require("./statement"),Node=require("./node"),Variable=require("./variable"),owl_ns="http://www.w3.org/2002/07/owl#",IndexedFormula=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return n.statements=[],n.optional=[],n.propertyActions=[],n.classActions=[],n.redirections=[],n.aliases=[],n.HTTPRedirects=[],n.subjectIndex=[],n.predicateIndex=[],n.objectIndex=[],n.whyIndex=[],n.index=[n.subjectIndex,n.predicateIndex,n.objectIndex,n.whyIndex],n.namespaces={},n.features=e||["sameAs","InverseFunctionalProperty","FunctionalProperty"],n.initPropertyActions(n.features),n}return _inherits(t,e),_createClass(t,[{key:"applyPatch",value:function(e,t,n){var r,i=require("./query"),a=this,s=function(i){if(e.delete){r=e.delete,o&&(r=r.substitute(o)),r=r.statements;var s=[],h=r.map(function(e){var n=a.statementsMatching(e.subject,e.predicate,e.object,t);return 0===n.length?(s.push(e),null):n[0]});if(s.length)return n("Couldn't find to delete: "+s[0]);h.map(function(e){a.remove(e)})}e.insert&&(r=e.insert,o&&(r=r.substitute(o)),r=r.statements,r.map(function(e){e.why=t,a.add(e.subject,e.predicate,e.object,e.why)})),i()},o=null;if(e.where){var h=new i("patch");h.pat=e.where,h.pat.statements.map(function(e){e.why=t});var u=[];a.query(h,function(e){u.push(e)},a.fetcher,function(){return 0===u.length?n("No match found to be patched:"+e.where):u.length>1?n("Patch ambiguous. No patch done."):(o=u[0],void s(n))})}else s(n)}},{key:"declareExistential",value:function(e){return this._existentialVariables||(this._existentialVariables=[]),this._existentialVariables.push(e),e}},{key:"initPropertyActions",value:function(e){this.propertyActions["<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>"]=[handleRDFType],ArrayIndexOf(e,"sameAs")>=0&&(this.propertyActions["<http://www.w3.org/2002/07/owl#sameAs>"]=[function(e,t,n,r,i){return e.equate(t,r),!0}]),ArrayIndexOf(e,"InverseFunctionalProperty")>=0&&(this.classActions["<"+owl_ns+"InverseFunctionalProperty>"]=[function(e,t,n,r,i){return e.newPropertyAction(t,handle_IFP)}]),ArrayIndexOf(e,"FunctionalProperty")>=0&&(this.classActions["<"+owl_ns+"FunctionalProperty>"]=[function(e,t,n,r,i){return e.newPropertyAction(t,handle_FP)}])}},{key:"add",value:function(e,n,r,i){var a;if(1===arguments.length){if(e instanceof Array)for(a=0;a<e.length;a++)this.add(e[a]);else e instanceof Statement?this.add(e.subject,e.predicate,e.object,e.why):e instanceof t&&this.add(e.statements);return this}var s,o;i||(i=this.fetcher?this.fetcher.appNode:this.sym("chrome:theSession")),e=Node.fromValue(e),n=Node.fromValue(n),r=Node.fromValue(r),i=Node.fromValue(i),this.predicateCallback&&this.predicateCallback(this,n,i);var h=this.canon(n).hashString();s=this.propertyActions[h];var u=!1;if(s)for(a=0;a<s.length;a++)u=u||s[a](this,e,n,r,i);if(this.holds(e,n,r,i))return console.log("rdflib: Ignoring dup! {"+e+" "+n+" "+r+" "+i+"}"),null;var c=[this.canon(e).hashString(),h,this.canon(r).hashString(),this.canon(i).hashString()];for(o=new Statement(e,n,r,i),a=0;a<4;a++){var l=this.index[a],f=c[a];l[f]||(l[f]=[]),l[f].push(o)}return this.statements.push(o),o}},{key:"addAll",value:function(e){var t=this;e.forEach(function(e){t.add(e.subject,e.predicate,e.object,e.graph)})}},{key:"any",value:function(e,t,n,r){var i=this.anyStatementMatching(e,t,n,r);if(null!=i)return null==e?i.subject:null==t?i.predicate:null==n?i.object:void 0}},{key:"anyValue",value:function(e,t,n,r){var i=this.any(e,t,n,r);return i?i.value:void 0}},{key:"anyStatementMatching",value:function(e,t,n,r){var i=this.statementsMatching(e,t,n,r,!0);if(i&&0!==i.length)return i[0]}},{key:"canon",value:function(e){if(!e)return e;var t=this.redirections[e.hashString()];return t?t:e}},{key:"check",value:function(){this.checkStatementList(this.statements);for(var e=0;e<4;e++){var t=this.index[e];for(var n in t)t.hasOwnProperty(n)&&this.checkStatementList(t[n],e)}}},{key:"checkStatementList",value:function(e,t){for(var n,r=["subject","predicate","object","why"],i=" found in "+r[t]+" index.",a=0;a<e.length;a++){n=e[a];for(var s=[n.subject,n.predicate,n.object,n.why],o=function(e,t){for(var n=0;n<e.length;n++)if(e[n].subject.sameTerm(t.subject)&&e[n].predicate.sameTerm(t.predicate)&&e[n].object.sameTerm(t.object)&&e[n].why.sameTerm(t.why))return!0},h=0;h<4;h++){var u=this.canon(s[h]),c=u.hashString();this.index[h][c]&&!o(this.index[h][c],n)}if(!o(this.statements,n))throw new Error("Statement list does not statement "+n+"@"+n.why+i)}}},{key:"close",value:function(){return this}},{key:"copyTo",value:function(e,t,n){n||(n=[]);var r=this.statementsMatching(e);ArrayIndexOf(n,"two-direction")!==-1&&r.concat(this.statementsMatching(void 0,void 0,e));for(var i=0;i<r.length;i++){var a=r[i];switch(a.object.termType){case"NamedNode":this.add(t,a.predicate,a.object);break;case"Literal":case"BlankNode":case"collection":this.add(t,a.predicate,a.object.copy(this))}ArrayIndexOf(n,"delete")!==-1&&this.remove(a)}}},{key:"equate",value:function(e,t){e=this.canon(e),t=this.canon(t);var n=e.compareTerm(t);return!n||(n<0?this.replaceWith(t,e):this.replaceWith(e,t))}},{key:"formula",value:function(e){return new t(e)}},{key:"match",value:function(e,t,n,r){return this.statementsMatching(Node.fromValue(e),Node.fromValue(t),Node.fromValue(n),Node.fromValue(r))}},{key:"mentionsURI",value:function(e){var t="<"+e+">";return!!this.subjectIndex[t]||!!this.objectIndex[t]||!!this.predicateIndex[t]}},{key:"newExistential",value:function(e){if(!e)return this.bnode();var t=this.sym(e);return this.declareExistential(t)}},{key:"newPropertyAction",value:function(e,t){var n=e.hashString();this.propertyActions[n]||(this.propertyActions[n]=[]),this.propertyActions[n].push(t);for(var r=this.statementsMatching(void 0,e,void 0),i=!1,a=0;a<r.length;a++)i=i||t(this,r[a].subject,e,r[a].object);return i}},{key:"newUniversal",value:function(e){var t=this.sym(e);return this._universalVariables||(this._universalVariables=[]),this._universalVariables.push(t),t}},{key:"variable",value:function(e){return new Variable(e)}},{key:"nextSymbol",value:function(e){for(var t=0;;t++){var n=e.uri+"#n"+t;if(!this.mentionsURI(n))return this.sym(n)}}},{key:"query",value:function(e,t,n,r){var i=require("./query").indexedFormulaQuery;return i.call(this,e,t,n,r)}},{key:"remove",value:function(e){if(e instanceof Array){for(var n=0;n<e.length;n++)this.remove(e[n]);return this}if(e instanceof t)return this.remove(e.statements);var r=this.statementsMatching(e.subject,e.predicate,e.object,e.why);if(!r.length)throw new Error("Statement to be removed is not on store: "+e);return this.removeStatement(r[0]),this}},{key:"removeDocument",value:function(e){for(var t=this.statementsMatching(void 0,void 0,void 0,e).slice(),n=0;n<t.length;n++)this.removeStatement(t[n]);return this}},{key:"removeMany",value:function(e,t,n,r,i){for(var a=this.statementsMatching(e,t,n,r,!1),s=[],o=0;o<a.length;o++)s.push(a[o]);for(i&&(s=s.slice(0,i)),o=0;o<s.length;o++)this.remove(s[o])}},{key:"removeMatches",value:function(e,t,n,r){return this.removeStatements(this.statementsMatching(e,t,n,r)),this}},{key:"removeStatement",value:function(e){for(var t=[e.subject,e.predicate,e.object,e.why],n=0;n<4;n++){var r=this.canon(t[n]),i=r.hashString();this.index[n][i]&&RDFArrayRemove(this.index[n][i],e)}return RDFArrayRemove(this.statements,e),this}},{key:"removeStatements",value:function(e){for(var t=0;t<e.length;t++)this.remove(e[t]);return this}},{key:"replaceWith",value:function(e,t){for(var n=e.hashString(),r=t.hashString(),i=function(e){var t=e[n];if(t){var i=e[r];i?e[r]=t.concat(i):e[r]=t,delete e[n]}},a=0;a<4;a++)i(this.index[a]);if(this.redirections[n]=t,e.uri){if(this.aliases[r]||(this.aliases[r]=[]),this.aliases[r].push(e),this.aliases[n])for(a=0;a<this.aliases[n].length;a++)this.redirections[this.aliases[n][a].hashString()]=t,this.aliases[r].push(this.aliases[n][a]);this.add(t,this.sym("http://www.w3.org/2007/ont/link#uri"),e.uri),this.fetcher&&this.fetcher.nowKnownAs(e,t)}return i(this.classActions),i(this.propertyActions),!0}},{key:"allAliases",value:function(e){var t=this.aliases[this.canon(e).hashString()]||[];return t.push(this.canon(e)),t}},{key:"sameThings",value:function(e,t){if(e.sameTerm(t))return!0;var n=this.canon(e);if(!n)return!1;var r=this.canon(t);return!!r&&n.uri===r.uri}},{key:"setPrefixForURI",value:function(e,t){"tab"===e&&this.namespaces.tab||"ns"!==e.slice(0,2)&&"default"!==e.slice(0,7)&&(this.namespaces[e]=t)}},{key:"statementsMatching",value:function(e,t,n,r,i){var a,s,o=[e,t,n,r],h=[],u=[],c=[],l=[];for(a=0;a<4;a++)h[a]=this.canon(Node.fromValue(o[a])),h[a]?(l.push(a),u[a]=h[a].hashString()):c.push(a);if(0===l.length)return this.statements;if(1===l.length)return a=l[0],s=this.index[a][u[a]],s&&i&&s.length>1&&(s=s.slice(0,1)),s=s||[];var f,d,v=1e10;for(d=0;d<l.length;d++){if(a=l[d],s=this.index[a][u[a]],!s)return[];s.length<v&&(v=s.length,f=d)}for(var y=l[f],p=this.index[y][u[y]],m=l.slice(0,f).concat(l.slice(f+1)),b=[],g=["subject","predicate","object","why"],w=0;w<p.length;w++){var k=p[w];for(d=0;d<m.length;d++)if(a=m[d],!this.canon(k[g[a]]).sameTerm(h[a])){k=null;break}if(null!=k&&(b.push(k),i))break}return b}},{key:"uris",value:function(e){var t=this.canon(e),n=this.aliases[t.hashString()];if(!t.uri)return[];var r=[t.uri];if(n)for(var i=0;i<n.length;i++)r.push(n[i].uri);return r}},{key:"length",get:function(){return this.statements.length}}]),t}(Formula);module.exports=IndexedFormula,module.exports.handleRDFType=handleRDFType;
},{"./formula":141,"./node":150,"./query":154,"./statement":160,"./util":164,"./variable":165}],144:[function(require,module,exports){
"use strict";var jsonParser=function(){return{parseJSON:function(e,a,r){var t,l,n,v={},i=r.sym(a);for(var o in e){0===o.indexOf("_:")?v[o]?t=v[o]:(t=r.bnode(o),v[o]=t):t=r.sym(o);var d=e[o];for(var s in d){var u=d[s];l=r.sym(s);for(var y in u){var p=u[y];if("uri"===p.type)n=r.sym(p.value),r.add(t,l,n,i);else if("BlankNode"===p.type)v[p.value]?n=v[p.value]:(n=r.bnode(p.value),v[p.value]=n),r.add(t,l,n,i);else{if("Literal"!==p.type)throw new Error("error: unexpected termtype: "+y.type);n=p.datatype?r.literal(p.value,void 0,r.sym(p.datatype)):p.lang?r.literal(p.value,p.lang):r.literal(p.value),r.add(t,l,n,i)}}}}}}}();module.exports=jsonParser;
},{}],145:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),ClassOrder=require("./class-order"),NamedNode=require("./named-node"),Node=require("./node"),XSD=require("./xsd"),Literal=function(e){function t(e,r,n){_classCallCheck(this,t);var o=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return o.termType=t.termType,o.value=e,r&&(o.lang=r,n=XSD.langString),n&&(o.datatype=NamedNode.fromValue(n)),o}return _inherits(t,e),_createClass(t,[{key:"copy",value:function(){return new t(this.value,this.lang,this.datatype)}},{key:"equals",value:function(e){return!!e&&(this.termType===e.termType&&this.value===e.value&&this.language===e.language&&(!this.datatype&&!e.datatype||this.datatype&&this.datatype.equals(e.datatype)))}},{key:"toNT",value:function(){if("number"==typeof this.value)return this.toString();if("string"!=typeof this.value)throw new Error("Value of RDF literal is not string or number: "+this.value);var e=this.value;return e=e.replace(/\\/g,"\\\\"),e=e.replace(/\"/g,'\\"'),e=e.replace(/\n/g,"\\n"),e='"'+e+'"',this.language?e+="@"+this.language:this.datatype.equals(XSD.string)||(e+="^^"+this.datatype.toCanonical()),e}},{key:"toString",value:function(){return""+this.value}},{key:"language",get:function(){return this.lang},set:function(e){this.lang=e||""}}],[{key:"fromBoolean",value:function(e){var r=e?"1":"0";return new t(r,null,XSD.boolean)}},{key:"fromDate",value:function(e){if(!(e instanceof Date))throw new TypeError("Invalid argument to Literal.fromDate()");var r=function(e){return(""+(100+e)).slice(1,3)},n=""+e.getUTCFullYear()+"-"+r(e.getUTCMonth()+1)+"-"+r(e.getUTCDate())+"T"+r(e.getUTCHours())+":"+r(e.getUTCMinutes())+":"+r(e.getUTCSeconds())+"Z";return new t(n,null,XSD.dateTime)}},{key:"fromNumber",value:function(e){if("number"!=typeof e)throw new TypeError("Invalid argument to Literal.fromNumber()");var r=void 0;return r=(""+e).indexOf("e")>=0?XSD.float:(""+e).indexOf(".")>=0?XSD.decimal:XSD.integer,new t(""+e,null,r)}},{key:"fromValue",value:function(e){if("undefined"==typeof e||null===e)return e;if(e&&e.termType)return e;switch("undefined"==typeof e?"undefined":_typeof(e)){case"object":if(e instanceof Date)return t.fromDate(e);case"boolean":return t.fromBoolean(e);case"number":return t.fromNumber(e);case"string":return new t(e)}throw new Error("Can't make literal from "+e+" of type "+("undefined"==typeof e?"undefined":_typeof(e)))}}]),t}(Node);Literal.termType="Literal",Literal.prototype.classOrder=ClassOrder.Literal,Literal.prototype.datatype=XSD.string,Literal.prototype.lang="",Literal.prototype.isVar=0,module.exports=Literal;
},{"./class-order":134,"./named-node":148,"./node":150,"./xsd":166}],146:[function(require,module,exports){
"use strict";module.exports={debug:function(n){},warn:function(n){},info:function(n){},error:function(n){},success:function(n){},msg:function(n){}};
},{}],147:[function(require,module,exports){
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},Uri=require("./uri"),ArrayIndexOf=require("./util").ArrayIndexOf,N3Parser=function(){function t(t){return encodeURI(t)}function e(t,e,r,s,n,o,h,a){return new i(t,e,r,s,n,o,h,a)}function i(t,e,i,r,s,n,o,h){"undefined"==typeof e&&(e=null),"undefined"==typeof i&&(i=""),"undefined"==typeof r&&(r=null),"undefined"==typeof s&&(s=""),"undefined"==typeof n&&(n=null),"undefined"==typeof o&&(o=""),"undefined"==typeof h&&(h=null),this._bindings=new f([]),this._flags=o,""!=i&&(v(i.indexOf(":")>=0,"Document URI not absolute: "+i),this._bindings[""]=i+"#"),this._store=t,s&&t.setGenPrefix(s),this._thisDoc=i,this.source=t.sym(i),this.lines=0,this.statementCount=0,this.startOfLine=0,this.previousLine=0,this._genPrefix=s,this.keywords=new a(["a","this","bind","has","is","of","true","false"]),this.keywordsSet=0,this._anonymousNodes=new f([]),this._variables=new f([]),this._parentVariables=new f([]),this._reason=h,this._reason2=null,m&&(this._reason2=why_BecauseOfData(t.sym(i),this._reason)),r?this._baseURI=r:i?this._baseURI=i:this._baseURI=null,v(!this._baseURI||this._baseURI.indexOf(":")>=0),this._genPrefix||(this._thisDoc?this._genPrefix=this._thisDoc+"#_g":this._genPrefix=RDFSink_uniqueURI()),null==e?this._thisDoc?this._formula=t.formula(i+"#_formula"):this._formula=t.formula():this._formula=e,this._context=this._formula,this._parentContext=null}function r(t,e,i,r,s){this._str=i.encode("utf-8"),this._str=i,this._i=r,this._why=s,this.lines=e,this._uri=t}function s(t,e,i,r,s){return"Line "+(e+1)+" of <"+t+">: Bad syntax: "+s+'\nat: "'+c(i,r,r+30)+'"'}var n={encode:function(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var r=t.charCodeAt(i);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e},decode:function(t){for(var e="",i=0;i<t.length;){var r=t.charCodeAt(i);r<128?(e+=String.fromCharCode(r),i++):r>191&&r<224?(e+=String.fromCharCode((31&r)<<6|63&t.charCodeAt(i+1)),i+=2):(e+=String.fromCharCode((15&r)<<12|(63&t.charCodeAt(i+1))<<6|63&t.charCodeAt(i+2)),i+=3)}return e}},o="http://www.w3.org/2000/10/swap/log#",h=function(t){return t},a=function(t){return t},f=function(t){if(t.length>0)throw"missing.js: oops nnonempty dict not imp";return[]},u=function(t){return t.length},c=function(t,e,i){if("undefined"==typeof t.slice)throw"@@ mising.js: No .slice function for "+t+" of type "+("undefined"==typeof t?"undefined":_typeof(t));return"undefined"==typeof i||null==i?t.slice(e):t.slice(e,i)},p=Error("dummy error stop iteration"),l=function(t){return this.last=0,this.li=t,this.next=function(){if(this.last==this.li.length)throw p;return this.li[this.last++]},this},d=function(t,e){return t.indexOf(e)},v=function(t,e){if(!t){if(e)throw"python Assertion failed: "+e;throw"(python) Assertion failed."}},_=function(t){return String.fromCharCode(t)};String.prototype.encode=function(t){if("utf-8"!=t)throw"UTF8_converter: can only do utf-8";return n.encode(this)},String.prototype.decode=function(t){if("utf-8"!=t)throw"UTF8_converter: can only do utf-8";return this};var w=function(t,e){return Uri.join(e,t)},y=null,m=0,x=0,b=function(t){},g="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",k="http://www.w3.org/2002/07/owl#sameAs",S="#",D="http://www.w3.org/2001/XMLSchema#integer",O="http://www.w3.org/2001/XMLSchema#double",A="http://www.w3.org/2001/XMLSchema#decimal",I="http://www.w3.org/2001/XMLSchema#date",C="http://www.w3.org/2001/XMLSchema#dateTime",R="\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~",U=R+":",L=(new RegExp("^[ \\t]*(#[^\\n]*)?\\r?\\n","g"),new RegExp("^[ \\t]*(#[^\\n]*)?$","g"),new RegExp("^[ \\t]*","g"),new RegExp("^[-+]?[0-9]+","g"),new RegExp("^([-+]?[0-9]+)(\\.[0-9]+)?(e[-+]?[0-9]+)?","g")),E=new RegExp("^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9](T[0-9][0-9]:[0-9][0-9](:[0-9][0-9](\\.[0-9]*)?)?)?Z?"),N=(new RegExp("^[0-9]+","g"),new RegExp('[\\\\\\r\\n\\"]',"g")),j=new RegExp("^[a-zA-Z0-9]+(-[a-zA-Z0-9]+)?","g");return i.prototype.here=function(t){return this._genPrefix+"_L"+this.lines+"C"+(t-this.startOfLine+1)},i.prototype.formula=function(){return this._formula},i.prototype.loadStream=function(t){return this.loadBuf(t.read())},i.prototype.loadBuf=function(t){return this.startDoc(),this.feed(t),this.endDoc()},i.prototype.feed=function(t){for(var e=t.decode("utf-8"),i=0;i>=0;){var r=this.skipSpace(e,i);if(r<0)return;var i=this.directiveOrStatement(e,r);if(i<0)throw s(this._thisDoc,this.lines,e,r,"expected directive or statement")}},i.prototype.directiveOrStatement=function(t,e){var i=this.skipSpace(t,e);if(i<0)return i;var r=this.directive(t,i);if(r>=0)return this.checkDot(t,r);var r=this.statement(t,i);return r>=0?this.checkDot(t,r):r},i.prototype.tok=function(t,e,i){if("@"==c(e,i,i+1))var i=i+1;else if(ArrayIndexOf(this.keywords,t)<0)return-1;var r=i+u(t);return c(e,i,r)==t&&R.indexOf(e.charAt(r))>=0?r:-1},i.prototype.directive=function(e,i){var r=this.skipSpace(e,i);if(r<0)return r;var n=new a([]),r=this.tok("bind",e,i);if(r>0)throw s(this._thisDoc,this.lines,e,i,"keyword bind is obsolete: use @prefix");var r=this.tok("keywords",e,i);if(r>0){var i=this.commaSeparatedList(e,r,n,!1);if(i<0)throw s(this._thisDoc,this.lines,e,i,"'@keywords' needs comma separated list of words");return this.setKeywords(c(n,null,null)),x>80&&b("Keywords ",this.keywords),i}var r=this.tok("forAll",e,i);if(r>0){var i=this.commaSeparatedList(e,r,n,!0);if(i<0)throw s(this._thisDoc,this.lines,e,i,"Bad variable list after @forAll");var o=new l(n);try{for(;;){var h=o.next();(ArrayIndexOf(this._variables,h)<0||ArrayIndexOf(this._parentVariables,h)>=0)&&(this._variables[h]=this._context.newUniversal(h))}}catch(t){if(t!=p)throw t}return i}var r=this.tok("forSome",e,i);if(r>0){var i=this.commaSeparatedList(e,r,n,this.uri_ref2);if(i<0)throw s(this._thisDoc,this.lines,e,i,"Bad variable list after @forSome");var o=new l(n);try{for(;;){var h=o.next();this._context.declareExistential(h)}}catch(t){if(t!=p)throw t}return i}var r=this.tok("prefix",e,i);if(r>=0){var f=new a([]),i=this.qname(e,r,f);if(i<0)throw s(this._thisDoc,this.lines,e,r,"expected qname after @prefix");var r=this.uri_ref2(e,i,f);if(r<0)throw s(this._thisDoc,this.lines,e,i,"expected <uriref> after @prefix _qname_");var u=f[1].uri;if(this._baseURI)var u=w(this._baseURI,u);else v(u.indexOf(":")>=0,"With no base URI, cannot handle relative URI for NS");return v(u.indexOf(":")>=0),this._bindings[f[0][0]]=u,this.bind(f[0][0],t(u)),r}var r=this.tok("base",e,i);if(r>=0){var f=new a([]),i=this.uri_ref2(e,r,f);if(i<0)throw s(this._thisDoc,this.lines,e,r,"expected <uri> after @base ");var u=f[0].uri;if(!this._baseURI)throw s(this._thisDoc,this.lines,e,r,"With no previous base URI, cannot use relative URI in @base  <"+u+">");var u=w(this._baseURI,u);return v(u.indexOf(":")>=0),this._baseURI=u,i}return-1},i.prototype.bind=function(t,e){""==t||this._store.setPrefixForURI(t,e)},i.prototype.setKeywords=function(t){null==t?this.keywordsSet=0:(this.keywords=t,this.keywordsSet=1)},i.prototype.startDoc=function(){},i.prototype.endDoc=function(){return this._formula},i.prototype.makeStatement=function(t){t[0].add(t[2],t[1],t[3],this.source),this.statementCount+=1},i.prototype.statement=function(t,e){var i=new a([]),e=this.object(t,e,i);if(e<0)return e;var r=this.property_list(t,e,i[0]);if(r<0)throw s(this._thisDoc,this.lines,t,e,"expected propertylist");return r},i.prototype.subject=function(t,e,i){return this.item(t,e,i)},i.prototype.verb=function(t,e,i){var r=this.skipSpace(t,e);if(r<0)return r;var n=new a([]),r=this.tok("has",t,e);if(r>=0){var e=this.prop(t,r,n);if(e<0)throw s(this._thisDoc,this.lines,t,r,"expected property after 'has'");return i.push(new h(["->",n[0]])),e}var r=this.tok("is",t,e);if(r>=0){var e=this.prop(t,r,n);if(e<0)throw s(this._thisDoc,this.lines,t,r,"expected <property> after 'is'");var r=this.skipSpace(t,e);if(r<0)throw s(this._thisDoc,this.lines,t,e,"End of file found, expected property after 'is'");var e=r,r=this.tok("of",t,e);if(r<0)throw s(this._thisDoc,this.lines,t,e,"expected 'of' after 'is' <prop>");return i.push(new h(["<-",n[0]])),r}var r=this.tok("a",t,e);if(r>=0)return i.push(new h(["->",this._store.sym(g)])),r;if("<="==c(t,e,e+2))return i.push(new h(["<-",this._store.sym(o+"implies")])),e+2;if("="==c(t,e,e+1))return">"==c(t,e+1,e+2)?(i.push(new h(["->",this._store.sym(o+"implies")])),e+2):(i.push(new h(["->",this._store.sym(k)])),e+1);if(":="==c(t,e,e+2))return i.push(new h(["->",o+"becomes"])),e+2;var r=this.prop(t,e,n);if(r>=0)return i.push(new h(["->",n[0]])),r;if(">-"==c(t,e,e+2)||"<-"==c(t,e,e+2))throw s(this._thisDoc,this.lines,t,r,">- ... -> syntax is obsolete.");return-1},i.prototype.prop=function(t,e,i){return this.item(t,e,i)},i.prototype.item=function(t,e,i){return this.path(t,e,i)},i.prototype.blankNode=function(t){return this._context.bnode(t,this._reason2)},i.prototype.path=function(t,e,i){var r=this.nodeOrLiteral(t,e,i);if(r<0)return r;for(;"!^.".indexOf(c(t,r,r+1))>=0;){var n=c(t,r,r+1);if("."==n){var o=c(t,r+1,r+2);if(!o||U.indexOf(o)>=0&&":?<[{(".indexOf(o)<0)break}var a=i.pop(),f=this.blankNode(this.here(r)),r=this.node(t,r+1,i);if(r<0)throw s(this._thisDoc,this.lines,t,r,"EOF found in middle of path syntax");var u=i.pop();"^"==n?this.makeStatement(new h([this._context,u,f,a])):this.makeStatement(new h([this._context,u,a,f])),i.push(f)}return r},i.prototype.anonymousNode=function(t){var e=this._anonymousNodes[t];if(e)return e;var e=this._store.bnode(this._context,this._reason2);return this._anonymousNodes[t]=e,e},i.prototype.node=function(t,e,i,r){"undefined"==typeof r&&(r=null);var n=r,o=this.skipSpace(t,e);if(o<0)return o;var e=o,d=c(t,e,e+1);if("["==d){var v=this.here(e),o=this.skipSpace(t,e+1);if(o<0)throw s(this._thisDoc,this.lines,t,e,"EOF after '['");if("="==c(t,o,o+1)){var e=o+1,_=new a([]),o=this.objectList(t,e,_);if(!(o>=0))throw s(this._thisDoc,this.lines,t,e,"objectList expected after [= ");var n=_[0];if(u(_)>1){var w=new l(_);try{for(;;){var m=w.next();this.makeStatement(new h([this._context,this._store.sym(k),n,m]))}}catch(t){if(t!=p)throw t}}var o=this.skipSpace(t,o);if(o<0)throw s(this._thisDoc,this.lines,t,e,"EOF when objectList expected after [ = ");if(";"==c(t,o,o+1))var o=o+1}if(null==n)var n=this.blankNode(v);var e=this.property_list(t,o,n);if(e<0)throw s(this._thisDoc,this.lines,t,o,"property_list expected");var o=this.skipSpace(t,e);if(o<0)throw s(this._thisDoc,this.lines,t,e,"EOF when ']' expected after [ <propertyList>");if("]"!=c(t,o,o+1))throw s(this._thisDoc,this.lines,t,o,"']' expected");return i.push(n),o+1}if("{"==d){var x=c(t,e+1,e+2);if("$"==x){e+=1;for(var o=e+1,b=new a([]),g=!0;;){var e=this.skipSpace(t,o);if(e<0)throw s(this._thisDoc,this.lines,t,e,"needed '$}', found end.");if("$}"==c(t,e,e+2)){var o=e+2;break}if(g)var g=!1;else{if(","!=c(t,e,e+1))throw s(this._thisDoc,this.lines,t,e,"expected: ','");e+=1}var S=new a([]),o=this.item(t,e,S);if(o<0)throw s(this._thisDoc,this.lines,t,e,"expected item in set or '$}'");b.push(S[0])}return i.push(this._store.newSet(b,this._context)),o}var o=e+1,D=this._parentContext;this._parentContext=this._context;var O=this._anonymousNodes,A=this._parentVariables;this._parentVariables=this._variables,this._anonymousNodes=new f([]),this._variables=this._variables.slice();var I=this._reason2;if(this._reason2=y,null==n)var n=this._store.formula();for(this._context=n;;){var e=this.skipSpace(t,o);if(e<0)throw s(this._thisDoc,this.lines,t,e,"needed '}', found end.");if("}"==c(t,e,e+1)){var o=e+1;break}var o=this.directiveOrStatement(t,e);if(o<0)throw s(this._thisDoc,this.lines,t,e,"expected statement or '}'")}return this._anonymousNodes=O,this._variables=this._parentVariables,this._parentVariables=A,this._context=this._parentContext,this._reason2=I,this._parentContext=D,i.push(n.close()),o}if("("==d){var C=this._store.list,x=c(t,e+1,e+2);if("$"==x){var C=this._store.newSet;e+=1}for(var o=e+1,b=new a([]);;){var e=this.skipSpace(t,o);if(e<0)throw s(this._thisDoc,this.lines,t,e,"needed ')', found end.");if(")"==c(t,e,e+1)){var o=e+1;break}var S=new a([]),o=this.item(t,e,S);if(o<0)throw s(this._thisDoc,this.lines,t,e,"expected item in list or ')'");b.push(S[0])}return i.push(C(b,this._context)),o}var o=this.tok("this",t,e);if(o>=0)throw s(this._thisDoc,this.lines,t,e,"Keyword 'this' was ancient N3. Now use @forSome and @forAll keywords.");var o=this.tok("true",t,e);if(o>=0)return i.push(!0),o;var o=this.tok("false",t,e);if(o>=0)return i.push(!1),o;if(null==n){var o=this.uri_ref2(t,e,i);if(o>=0)return o}return-1},i.prototype.property_list=function(t,e,i){for(;;){var r=this.skipSpace(t,e);if(r<0)throw s(this._thisDoc,this.lines,t,e,"EOF found when expected verb in property list");if(":-"!=c(t,r,r+2)){var e=r,n=new a([]),r=this.verb(t,e,n);if(r<=0)return e;var o=new a([]),e=this.objectList(t,r,o);if(e<0)throw s(this._thisDoc,this.lines,t,r,"objectList expected");var f=new l(o);try{for(;;){var u=f.next(),d=n[0],v=d[0],_=d[1];"->"==v?this.makeStatement(new h([this._context,_,i,u])):this.makeStatement(new h([this._context,_,u,i]))}}catch(t){if(t!=p)throw t}var r=this.skipSpace(t,e);if(r<0)throw s(this._thisDoc,this.lines,t,r,"EOF found in list of objects");if(";"!=c(t,e,e+1))return e;var e=e+1}else{var e=r+2,w=new a([]),r=this.node(t,e,w,i);if(r<0)throw s(this._thisDoc,this.lines,t,e,"bad {} or () or [] node after :- ");var e=r}}},i.prototype.commaSeparatedList=function(t,e,i,r){var n=this.skipSpace(t,e);if(n<0)throw s(this._thisDoc,this.lines,t,n,"EOF found expecting comma sep list");if("."==t.charAt(n))return e;if(r)var n=this.uri_ref2(t,n,i);else var n=this.bareWord(t,n,i);if(n<0)return-1;for(;;){var e=this.skipSpace(t,n);if(e<0)return e;var o=c(t,e,e+1);if(","!=o)return"."!=o?-1:e;if(r)var n=this.uri_ref2(t,e+1,i);else var n=this.bareWord(t,e+1,i);if(n<0)throw s(this._thisDoc,this.lines,t,n,"bad list content")}},i.prototype.objectList=function(t,e,i){var e=this.object(t,e,i);if(e<0)return-1;for(;;){var r=this.skipSpace(t,e);if(r<0)throw s(this._thisDoc,this.lines,t,r,"EOF found after object");if(","!=c(t,r,r+1))return r;var e=this.object(t,r+1,i);if(e<0)return e}},i.prototype.checkDot=function(t,e){var i=this.skipSpace(t,e);if(i<0)return i;if("."==c(t,i,i+1))return i+1;if("}"==c(t,i,i+1))return i;if("]"==c(t,i,i+1))return i;throw s(this._thisDoc,this.lines,t,i,"expected '.' or '}' or ']' at end of statement")},i.prototype.uri_ref2=function(t,e,i){var r=new a([]),n=this.qname(t,e,r);if(n>=0){var o=r[0],h=o[0],f=o[1];if(null==h){v(0,"not used?");var p=this._baseURI+S}else{var p=this._bindings[h];if(!p){if("_"==h)return i.push(this.anonymousNode(f)),n;throw s(this._thisDoc,this.lines,t,e,"Prefix "+h+" not bound.")}}var l=this._store.sym(p+f);return ArrayIndexOf(this._variables,l)>=0?i.push(this._variables[l]):i.push(l),n}var e=this.skipSpace(t,e);if(e<0)return-1;if("?"==t.charAt(e)){var d=new a([]),n=this.variable(t,e,d);return n>0?(i.push(d[0]),n):-1}if("<"==t.charAt(e)){for(var e=e+1,_=e;e<u(t);){if(">"==t.charAt(e)){var y=c(t,_,e);if(this._baseURI)var y=w(this._baseURI,y);else v(y.indexOf(":")>=0,"With no base URI, cannot deal with relative URIs");if("#"==c(t,e-1,e)&&"#"!=c(y,-1,null))var y=y+"#";var l=this._store.sym(y);return ArrayIndexOf(this._variables,l)>=0?i.push(this._variables[l]):i.push(l),e+1}var e=e+1}throw s(this._thisDoc,this.lines,t,n,"unterminated URI reference")}if(this.keywordsSet){var d=new a([]),n=this.bareWord(t,e,d);if(n<0)return-1;if(ArrayIndexOf(this.keywords,d[0])>=0)throw s(this._thisDoc,this.lines,t,e,'Keyword "'+d[0]+'" not allowed here.');return i.push(this._store.sym(this._bindings[""]+d[0])),n}return-1},i.prototype.skipSpace=function(t,e){for(var i=" \n\r\t\f\v\u2028\u2029",r=e?e:0;r<t.length;r++){var s=t.charAt(r);if(i.indexOf(s)<0){if("#"!==t.charAt(r))return r;for(;;r++){if(r===t.length)return-1;if("\n"===t.charAt(r)){this.lines=this.lines+1;break}}}else"\n"===t.charAt(r)&&(this.lines=this.lines+1)}return-1},i.prototype.variable=function(t,e,i){var r=this.skipSpace(t,e);if(r<0)return-1;if("?"!=c(t,r,r+1))return-1;var r=r+1,e=r;if("0123456789-".indexOf(t.charAt(r))>=0)throw s(this._thisDoc,this.lines,t,r,"Varible name can't start with '"+t.charAt(r)+"s'");for(;e<u(t)&&U.indexOf(t.charAt(e))<0;)var e=e+1;if(null==this._parentContext)throw s(this._thisDoc,this.lines,t,r,"Can't use ?xxx syntax for variable in outermost level: "+c(t,r-1,e));return i.push(this._store.variable(c(t,r,e))),e},i.prototype.bareWord=function(t,e,i){var r=this.skipSpace(t,e);if(r<0)return-1;var s=t.charAt(r);if("0123456789-".indexOf(s)>=0)return-1;if(U.indexOf(s)>=0)return-1;for(var e=r;e<u(t)&&U.indexOf(t.charAt(e))<0;)var e=e+1;return i.push(c(t,r,e)),e},i.prototype.qname=function(t,e,i){var e=this.skipSpace(t,e);if(e<0)return-1;var r=t.charAt(e);if("0123456789-+".indexOf(r)>=0)return-1;if(U.indexOf(r)<0)for(var s=r,e=e+1;e<u(t);){var r=t.charAt(e);if(!(U.indexOf(r)<0))break;var s=s+r,e=e+1}else var s="";if(e<u(t)&&":"==t.charAt(e)){for(var n=s,e=e+1,s="";e<u(t);){var r=t.charAt(e);if(!(U.indexOf(r)<0))break;var s=s+r,e=e+1}return i.push(new h([n,s])),e}return s&&this.keywordsSet&&ArrayIndexOf(this.keywords,s)<0?(i.push(new h(["",s])),e):-1},i.prototype.object=function(t,e,i){var r=this.subject(t,e,i);if(r>=0)return r;var r=this.skipSpace(t,e);if(r<0)return-1;var e=r;if('"'==t.charAt(e)){if('"""'==c(t,e,e+3))var s='"""';else var s='"';var e=e+u(s),n=this.strconst(t,e,s),r=n[0],o=n[1];return i.push(this._store.literal(o)),b("New string const ",o,r),r}return-1},i.prototype.nodeOrLiteral=function(t,e,i){var r=this.node(t,e,i);if(r>=0)return r;var r=this.skipSpace(t,e);if(r<0)return-1;var e=r,n=t.charAt(e);if("-+0987654321".indexOf(n)>=0){E.lastIndex=0;var o=E.exec(t.slice(e));if(null!=o){var h=o[0];r=e+h.length,h.indexOf("T")>=0?i.push(this._store.literal(h,void 0,this._store.sym(C))):i.push(this._store.literal(h,void 0,this._store.sym(I)))}else{L.lastIndex=0;var o=L.exec(t.slice(e));if(null==o)throw s(this._thisDoc,this.lines,t,e,"Bad number or date syntax");r=e+L.lastIndex;var h=c(t,e,r);h.indexOf("e")>=0?i.push(this._store.literal(parseFloat(h),void 0,this._store.sym(O))):c(t,e,r).indexOf(".")>=0?i.push(this._store.literal(parseFloat(h),void 0,this._store.sym(A))):i.push(this._store.literal(parseInt(h),void 0,this._store.sym(D)))}return r}if('"'==t.charAt(e)){if('"""'==c(t,e,e+3))var f='"""';else var f='"';var e=e+u(f),p=null,l=this.strconst(t,e,f),r=l[0],d=l[1],v=null;if("@"==c(t,r,r+1)){j.lastIndex=0;var o=j.exec(t.slice(r+1));if(null==o)throw s(this._thisDoc,startline,t,e,"Bad language code syntax on string literal, after @");var e=j.lastIndex+r+1,v=c(t,r+1,e),r=e}if("^^"==c(t,r,r+2))var _=new a([]),r=this.uri_ref2(t,r+2,_),p=_[0];return i.push(this._store.literal(d,v,p)),r}return-1},i.prototype.strconst=function(t,e,i){for(var r=e,n="",o=this.lines;r<u(t);){var e=r+u(i);if(c(t,r,e)==i)return new h([e,n]);if('"'!=t.charAt(r)){N.lastIndex=0;var a=N.exec(t.slice(r));if(!a)throw s(this._thisDoc,o,t,r,"Closing quote missing in string at ^ in "+c(t,r-20,r)+"^"+c(t,r,r+20));var e=r+N.lastIndex-1,n=n+c(t,r,e),f=t.charAt(e);if('"'!=f)if("\r"!=f){if("\n"==f){if('"'==i)throw s(this._thisDoc,o,t,e,"newline found in string literal");this.lines=this.lines+1;var n=n+f,r=e+1;this.previousLine=this.startOfLine,this.startOfLine=r}else if("\\"==f){var r=e+1,f=c(t,r,r+1);if(!f)throw s(this._thisDoc,o,t,e,"unterminated string literal (2)");var p=d('abfrtvn\\"',f);if(p>=0)var l='a\b\f\r\t\v\n\\"'.charAt(p),n=n+l,r=r+1;else if("u"==f)var v=this.uEscape(t,r+1,o),r=v[0],f=v[1],n=n+f;else{if("U"!=f)throw s(this._thisDoc,this.lines,t,e,"bad escape");var v=this.UEscape(t,r+1,o),r=v[0],f=v[1],n=n+f}}}else var r=e+1;else var r=e}else var n=n+'"',r=r+1}throw s(this._thisDoc,this.lines,t,e,"unterminated string literal")},i.prototype.uEscape=function(t,e,i){for(var r=e,n=0,o=0;n<4;){var a=c(t,r,r+1),f=a.toLowerCase(),r=r+1;if(""==f)throw s(this._thisDoc,i,t,e,"unterminated string literal(3)");var u=d("0123456789abcdef",f);if(u<0)throw s(this._thisDoc,i,t,e,"bad string literal hex escape");var o=16*o+u,n=n+1}var p=String.fromCharCode(o);return new h([r,p])},i.prototype.UEscape=function(t,e,i){for(var r=e,n=0,o="\\U";n<8;){var a=c(t,r,r+1),f=a.toLowerCase(),r=r+1;if(""==f)throw s(this._thisDoc,i,t,e,"unterminated string literal(3)");var u=d("0123456789abcdef",f);if(u<0)throw s(this._thisDoc,i,t,e,"bad string literal hex escape");var o=o+f,n=n+1}var p=_("0x"+c(o,2,10)-0);return new h([r,p])},r.prototype.toString=function(){var t=this._str,e=this._i,i=0;if(e>60)var r="...",i=e-60;else var r="";if(u(t)-e>60)var s="...";else var s="";return'Line %i of <%s>: Bad syntax (%s) at ^ in:\n"%s%s^%s%s"'%new h([this.lines+1,this._uri,this._why,r,c(t,i,e),c(t,e,e+60),s])},e}();module.exports=N3Parser;
},{"./uri":163,"./util":164}],148:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),ClassOrder=require("./class-order"),Node=require("./node"),NamedNode=function(e){function t(e){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return r.termType=t.termType,e.indexOf(":")<0&&console.log("Warning: NamedNode URI must be absolute. Relative URIs will fail in future versions"),r.value=e,r}return _inherits(t,e),_createClass(t,[{key:"dir",value:function(){var e=this.uri.split("#")[0],r=e.slice(0,-1).lastIndexOf("/"),n=e.indexOf("//");return n>=0&&r<n+2||r<0?null:new t(e.slice(0,r+1))}},{key:"doc",value:function(){return this.uri.indexOf("#")<0?this:new t(this.uri.split("#")[0])}},{key:"toString",value:function(){return"<"+this.uri+">"}},{key:"uri",get:function(){return this.value},set:function(e){this.value=e}}],[{key:"fromValue",value:function(e){if("undefined"==typeof e||null===e)return e;var r=e&&e.termType;return r?e:new t(e)}}]),t}(Node);NamedNode.termType="NamedNode",NamedNode.prototype.classOrder=ClassOrder.NamedNode,NamedNode.prototype.isVar=0,module.exports=NamedNode;
},{"./class-order":134,"./node":150}],149:[function(require,module,exports){
"use strict";function Namespace(e){return function(n){return new NamedNode(e+(n||""))}}var NamedNode=require("./named-node");module.exports=Namespace;
},{"./named-node":148}],150:[function(require,module,exports){
"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),Node=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"substitute",value:function(e){return this}},{key:"compareTerm",value:function(e){return this.classOrder<e.classOrder?-1:this.classOrder>e.classOrder?1:this.value<e.value?-1:this.value>e.value?1:0}},{key:"equals",value:function(e){return!!e&&(this.termType===e.termType&&this.value===e.value)}},{key:"hashString",value:function(){return this.toCanonical()}},{key:"sameTerm",value:function(e){return this.equals(e)}},{key:"toCanonical",value:function(){return this.toNT()}},{key:"toNT",value:function(){return this.toString()}},{key:"toString",value:function(){throw new Error("Node.toString() is abstract - see the subclasses instead")}}]),e}();module.exports=Node,Node.fromValue=function(e){var r=require("./collection"),t=require("./literal");require("./named-node");if("undefined"==typeof e||null===e)return e;var n=e&&e.termType;return n?e:Array.isArray(e)?new r(e):t.fromValue(e)};
},{"./collection":135,"./literal":145,"./named-node":148}],151:[function(require,module,exports){
"use strict";function parse(e,r,a,t,l){function n(){l&&l(null,r)}function i(e){if("application/ld+json"!==t||"application/nquads"!==t||"application/n-quads"!==t){if(!l)throw new Error("Error trying to parse <"+a+"> as "+t+":\n"+e+":\n"+e.stack);l(e,r)}}function s(e,a){e&&l(e,r);try{f.parse(a,p)}catch(e){l(e,r)}}function p(e,a,t){if(e&&l(e,r),a)N.push(a);else{for(var n=0;n<N.length;n++)o(r,N[n]);l(null,r)}}function o(e,r){var a=u(r.subject),t=u(r.predicate),l=u(r.object),n=null;r.graph&&(n=u(r.graph)),e.add(a,t,l,n)}function u(e){var r;if(N3.Util.isLiteral(e)){r=N3.Util.getLiteralValue(e);var a=N3.Util.getLiteralLanguage(e),t=new NamedNode(N3.Util.getLiteralType(e));return new Literal(r,a,t)}return N3.Util.isIRI(e)?new NamedNode(e):N3.Util.isBlank(e)?(r=e.substring(2,e.length),new BlankNode(r)):null}try{if("text/n3"===t||"text/turtle"===t){var c=N3Parser(r,r,a,a,null,null,"",null);c.loadBuf(e),n()}else if("application/rdf+xml"===t){var d=new RDFParser(r);d.parse(Util.parseXML(e),a,r.sym(a)),n()}else if("application/xhtml+xml"===t)parseRDFaDOM(Util.parseXML(e,{contentType:"application/xhtml+xml"}),r,a),n();else if("text/html"===t)parseRDFaDOM(Util.parseXML(e,{contentType:"text/html"}),r,a),n();else if("application/sparql-update"===t)sparqlUpdateParser(e,r,a),n();else{if("application/ld+json"!==t&&"application/nquads"!==t&&"application/n-quads"!==t)throw new Error("Don't know how to parse "+t+" yet");var f=N3.Parser(),N=[];if("application/ld+json"===t){var q;try{q=JSON.parse(e)}catch(e){l(e,null)}jsonld.toRDF(q,{format:"application/nquads"},s)}else s(null,e)}}catch(e){i(e)}}module.exports=parse;var BlankNode=require("./blank-node"),jsonld=require("jsonld"),Literal=require("./literal"),N3=require("n3"),N3Parser=require("./n3parser"),NamedNode=require("./named-node"),parseRDFaDOM=require("./rdfaparser").parseRDFaDOM,RDFParser=require("./rdfxmlparser"),sparqlUpdateParser=require("./patch-parser"),Util=require("./util");
},{"./blank-node":133,"./literal":145,"./n3parser":147,"./named-node":148,"./patch-parser":152,"./rdfaparser":155,"./rdfxmlparser":156,"./util":164,"jsonld":101,"n3":104}],152:[function(require,module,exports){
"use strict";function sparqlUpdateParser(e,r,t){var a,i,s,n=["INSERT","DELETE","WHERE"],o=Namespace("http://www.w3.org/ns/pim/patch#"),c=N3Parser(r,r,t,t,null,null,"",null),f={},l=function(e,r,t,a,i){return"Line "+(r+1)+" of <"+e+">: Bad syntax:\n   "+i+'\n   at: "'+t.slice(a,a+30)+'"'};a=0;var p=r.sym(t+"#query");for(f.query=p;;){if(i=c.skipSpace(e,a),i<0)return f;if(";"===e[i]){if(a=c.skipSpace(e,i+1),a<0)return f;i=a}var h=!1;for(s=0;s<n.length;s++){var d=n[s];if(e.slice(i,i+d.length)===d){if(a=c.skipSpace(e,i+d.length),a<0)throw l(c._thisDoc,c.lines,e,i+d.length,"found EOF, needed {...} after "+d);if(("INSERT"===d||"DELETE"===d)&&"DATA"===e.slice(a,a+4)){if(i=c.skipSpace(e,a+4),i<0)throw l(c._thisDoc,c.lines,e,a+4,"needed {...} after INSERT DATA "+d);a=i}var u=[];if(i=c.node(e,a,u),i<0)throw l(c._thisDoc,c.lines,e,a,"bad syntax or EOF in {...} after "+d);f[d.toLowerCase()]=u[0],r.add(p,o(d.toLowerCase()),u[0]),h=!0,a=i}}if(!h&&"@prefix"===e.slice(i,i+7)){if(a=c.directive(e,i),a<0)throw l(c._thisDoc,c.lines,e,a,"bad syntax or EOF after @prefix ");a=c.checkDot(e,a),h=!0}if(!h)throw l(c._thisDoc,c.lines,e,i,"Unknown syntax at start of statememt: '"+e.slice(i).slice(0,20)+"'")}}module.exports=sparqlUpdateParser;var N3Parser=require("./n3parser"),Namespace=require("./namespace");
},{"./n3parser":147,"./namespace":149}],153:[function(require,module,exports){
"use strict";function queryToSPARQL(n){function r(n){for(var r=a()+"SELECT ",t=0;t<n.vars.length;t++)r+=n.vars[t]+" ";return r+="\n"}function t(n){var r="",t=n.statements;for(var o in t)log.debug("Found statement: "+t),r+=a()+t[o]+"\n";return r}function o(n){var r="";for(var t in n.constraints){var o=n.constraints[t];r+=a()+"FILTER ( "+o.describe(t)+" ) \n"}return r}function e(n){for(var r="",u=0;u<n.optional.length;u++)log.debug("Found optional query"),r+=a()+"OPTIONAL { \n",f++,r+=t(n.optional[u]),r+=o(n.optional[u]),r+=e(n.optional[u]),f--,r+=a()+"}\n";return r}function u(n){var r=a()+"WHERE \n{ \n";return f++,r+=t(n),r+=o(n),r+=e(n),f--,r+="}"}function a(){for(var n="",r=0;r<f;r++)n+="    ";return n}function i(n){return r(n)+u(n.pat)}var f=0;return i(n)}var log=require("./log");module.exports=queryToSPARQL;
},{"./log":146}],154:[function(require,module,exports){
"use strict";function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function indexedFormulaQuery(n,t,e,r){function o(n,t){return n.nvars!==t.nvars?n.nvars-t.nvars:n.index.length-t.index.length}var i=function(n){var t,e="";for(t in n)n.hasOwnProperty(t)&&(e+="    "+t+" -> "+n[t]);return e},s=function(n){var t,e="Bindings: ",r=n.length;for(t=0;t<r;t++)e+=i(n[t][0])+";\n\t";return e},a=function(n,t,e,r){var o=e[n];if(void 0===o){if(n.isVar){var i=[];return i[n]=t,[[i,null]]}o=n}if(!o.complexType)return r.redirections[o]&&(o=r.redirections[o]),r.redirections[t]&&(t=r.redirections[t]),o.sameTerm(t)?[[[],null]]:[];if(n instanceof Array)return t instanceof Array?u(n,t,e):[];throw new Error("query.js: oops - code not written yet")},u=function n(t,e,r,o){var i;if(t.length!==e.length)return[];if(!t.length)return[[[],null]];var s=a(t[0],e[0],r,o);if(0===s.length)return s;var u,c,l,h,d,f,g,p=[],b=s.length;for(u=0;u<b;u++){c=s[u][0],g=[];for(d in c)c.hasOwnProperty(d)&&(g[d]=c[d]);for(d in r)r.hasOwnProperty(d)&&(g[d]=r[d]);for(i=n(t.slice(1),e.slice(1),g,o),h=i.length,l=0;l<h;l++){f=i[l][0];for(d in c)c.hasOwnProperty(d)&&(f[d]=c[d]);p.push([f,null])}}return p},c=function(n,t){var e=t[n];return void 0===e?n:e},l=function(n,t){var e,r={};for(e in n)n.hasOwnProperty(e)&&(r[e]=n[e]);for(e in t)t.hasOwnProperty(e)&&(r[e]=t[e]);return r},h=function(n,t){return this.trunkBindings=t,this.originalCallback=n,this.branches=[],this};h.prototype.checkAllDone=function(){var n;for(n=0;n<this.branches.length;n++)if(!this.branches[n].done)return;log.debug("OPTIONAL BIDNINGS ALL DONE:"),this.doCallBacks(this.branches.length-1,this.trunkBindings)},h.prototype.doCallBacks=function(n,t){var e;if(n<0)return this.originalCallback(t);for(e=0;e<this.branches[n].results.length;e++)this.doCallBacks(n-1,l(t,this.branches[n].results[e]))};var d=function(n,t){return this.count=0,this.success=!1,this.done=!1,this.callback=n,this.onDone=t,this};d.prototype.reportMatch=function(n){this.callback(n),this.success=!0},d.prototype.reportDone=function(){this.done=!0,log.info("Mandatory query branch finished.***"),void 0!==this.onDone&&this.onDone()};var f=function(n){return this.count=0,this.done=!1,this.results=[],this.junction=n,n.branches.push(this),this};f.prototype.reportMatch=function(n){this.results.push(n)},f.prototype.reportDone=function(){log.debug("Optional branch finished - results.length = "+this.results.length),0===this.results.length&&(this.results.push({}),log.debug("Optional branch FAILED - that's OK.")),this.done=!0,this.junction.checkAllDone()};var g=function(n,t,e){var r,o,i,s,a;for(t.nvars=0,t.index=null,o=[t.subject,t.predicate,t.object],a=[n.subjectIndex,n.predicateIndex,n.objectIndex],s=0;s<3;s++)if(o[s].isVar&&void 0===e[o[s]])t.nvars++;else{if(r=c(o[s],e),n.redirections[r.hashString()]&&(r=n.redirections[r.hashString()]),i=a[s][r.hashString()],!i)return t.index=[],!1;(null===t.index||t.index.length>i.length)&&(t.index=i)}return null===t.index&&(t.index=n.statements),!0},p=0,b=function n(e,r,o,s,a,u,c){log.debug("Match begins, Branch count now: "+c.count+" for "+c.pattern_debug);var l=e.fetcher?e.fetcher:null,d=r.statements;if(0===d.length){if(log.debug("FOUND MATCH WITH BINDINGS:"+i(o)),0===r.optional.length)c.reportMatch(o);else{log.debug("OPTIONAL: "+r.optional);var g,b=new h(t,o),v=[];for(g=0;g<r.optional.length;g++)v[g]=new f(b),v[g].pattern_debug=r.optional[g];for(g=0;g<r.optional.length;g++)v[g].count=v[g].count+1,n(e,r.optional[g],o,"",a,t,v[g])}return c.count--,void log.debug("Match ends -- success , Branch count now: "+c.count+" for "+c.pattern_debug)}var m,x,w=d.length;if(l){var j="match"+p++,O=function(t,i){var h=t.uri.split("#")[0];l.nowOrWhenFetched(h,void 0,function(i,l,h){i&&console.log("Error following link to <"+t.uri+"> in query: "+l),n(e,r,o,s,a,u,c)})};for(x=0;x<w;x++){if(m=d[x],void 0!==o[m.subject]&&o[m.subject].uri&&l&&"unrequested"===l.getState(docpart(o[m.subject].uri)))return void O(o[m.subject],j);if(void 0!==o[m.object]&&o[m.object].uri&&l&&"unrequested"===l.getState(docpart(o[m.object].uri)))return void O(o[m.object],j)}}y(e,r,o,s,a,u,c)},v=function(n,t){var e,r,o=!0;for(e in n)n.hasOwnProperty(e)&&t[e]&&(r=t[e].test,r&&!r(n[e])&&(o=!1));return o},y=function(n,t,e,r,a,c,l){var h,d,f,p,y,m,x,w=t.statements,j=w.length;for(h=0;h<j;h++)x=w[h],log.info("match2: item="+x+", bindingsSoFar="+i(e)),g(n,x,e);w.sort(o),x=w[0];var O=n.formula();O.optional=t.optional,O.constraints=t.constraints,O.statements=w.slice(1),log.debug(r+"match2 searching "+x.index.length+" for "+x+"; bindings so far="+i(e));var k,B,D,I=x.index.length,C=0;for(k=0;k<I;k++)for(D=x.index[k],B=u([x.subject,x.predicate,x.object],[D.subject,D.predicate,D.object],e,n),log.info(r+" From first: "+B.length+": "+s(B)),f=B.length,d=0;d<f;d++)if(y=[],m=B[d][0],v(m,t.constraints)){for(p in m)m.hasOwnProperty(p)&&(y[p]=m[p]);for(p in e)e.hasOwnProperty(p)&&(y[p]=e[p]);l.count++,C++,b(n,O,y,r+"  ",a,c,l)}else log.debug("Branch count CS: "+l.count);l.count--,0===C&&log.debug("Match2 fails completely on "+x),log.debug("Match2 ends, Branch count: "+l.count+" for "+l.pattern_debug),0===l.count&&(log.debug("Branch finished."),l.reportDone())},m=this;log.debug("Query on "+this.statements.length);var x=new d(t,r);x.count++,setTimeout(function(){b(m,n.pat,n.pat.initBindings,"",e,t,x)},0)}var IndexedFormula=require("./indexed-formula"),log=require("./log"),docpart=require("./uri").docpart,Query=function n(t,e){_classCallCheck(this,n),this.pat=new IndexedFormula,this.vars=[],this.name=t,this.id=e};module.exports.Query=Query,module.exports.indexedFormulaQuery=indexedFormulaQuery;
},{"./indexed-formula":143,"./log":146,"./uri":163}],155:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),BlankNode=require("./blank-node"),Literal=require("./literal"),rdf=require("./data-factory"),NamedNode=require("./named-node"),Uri=require("./uri"),Util=require("./util");if("undefined"==typeof Node)var Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12};var RDFaProcessor=function(){function e(t,a){_classCallCheck(this,e),this.options=a||{},this.kb=t,this.target=a.target||{graph:{subjects:{},prefixes:{},terms:{}}},this.blankNodes=[],this.htmlOptions={selfClosing:"br img input area base basefont col colgroup source wbr isindex link meta param hr"},this.theOne="_:"+(new Date).getTime(),this.language=null,this.vocabulary=null,this.blankCounter=0,this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"}],this.inXHTMLMode=!1,this.absURIRE=/[\w\_\-]+:\S+/,this.finishedHandlers=[],this.init()}return _createClass(e,[{key:"addTriple",value:function(e,t,a,r){var s,i,n,o;s="undefined"==typeof t?rdf.namedNode(this.options.base):this.toRDFNodeObject(t),n=this.toRDFNodeObject(a),i=this.toRDFNodeObject(r),o=rdf.namedNode(this.options.base),this.kb.add(s,n,i,o)}},{key:"ancestorPath",value:function(e){for(var t="";e&&e.nodeType!==Node.DOCUMENT_NODE;)t="/"+e.localName+t,e=e.parentNode;return t}},{key:"copyMappings",value:function(e){var t={};for(var a in e)t[a]=e[a];return t}},{key:"copyProperties",value:function(){}},{key:"deriveDateTimeType",value:function(t){for(var a=0;a<e.dateTimeTypes.length;a++){var r=e.dateTimeTypes[a].pattern.exec(t);if(r&&r[0].length===t.length)return e.dateTimeTypes[a].type}return null}},{key:"init",value:function(){}},{key:"newBlankNode",value:function(){return this.blankCounter++,"_:"+this.blankCounter}},{key:"newSubjectOrigin",value:function(e,t){}},{key:"parseCURIE",value:function(t,a,r){var s,i=t.indexOf(":");if(i>=0){var n=t.substring(0,i);if(""===n)return s=a[""],s?s+t.substring(i+1):null;if("_"===n)return"_:"+t.substring(i+1);if(e.NCNAME.test(n)&&(s=a[n]))return s+t.substring(i+1)}return null}},{key:"parseCURIEOrURI",value:function(e,t,a){var r=this.parseCURIE(e,t,a);return r?r:this.resolveAndNormalize(a,e)}},{key:"parsePredicate",value:function(e,t,a,r,s,i){if(""===e)return null;var n=this.parseTermOrCURIEOrAbsURI(e,t,i?null:a,r,s);return n&&0===n.indexOf("_:")?null:n}},{key:"parsePrefixMappings",value:function(e,t){for(var a=this.tokenize(e),r=null,s=0;s<a.length;s++)":"===a[s][a[s].length-1]?r=a[s].substring(0,a[s].length-1):r&&(t[r]=this.options.base?Uri.join(a[s],this.options.base):a[s],r=null)}},{key:"parseSafeCURIEOrCURIEOrURI",value:function(e,t,a){return e=this.trim(e),"["===e.charAt(0)&&"]"===e.charAt(e.length-1)?(e=e.substring(1,e.length-1),e=e.trim(e),0===e.length?null:"_:"===e?this.theOne:this.parseCURIE(e,t,a)):this.parseCURIEOrURI(e,t,a)}},{key:"parseTermOrCURIEOrAbsURI",value:function(e,t,a,r,s){e=this.trim(e);var i=this.parseCURIE(e,r,s);if(i)return i;if(a){if(t&&!this.absURIRE.exec(e))return t+e;var n=a[e];if(n)return n;var o=e.toLowerCase();if(n=a[o])return n}return this.absURIRE.exec(e)?this.resolveAndNormalize(s,e):null}},{key:"parseTermOrCURIEOrURI",value:function(e,t,a,r,s){e=this.trim(e);var i=this.parseCURIE(e,r,s);if(i)return i;var n=a[e];if(n)return n;var o=e.toLowerCase();return(n=a[o])?n:t&&!this.absURIRE.exec(e)?t+e:this.resolveAndNormalize(s,e)}},{key:"parseURI",value:function(e){return e}},{key:"process",value:function(t,a){var r;t.nodeType===Node.DOCUMENT_NODE?(r=t.baseURI,t=t.documentElement,t.baseURI=r,this.setContext(t)):t.parentNode.nodeType===Node.DOCUMENT_NODE&&this.setContext(t);var s=[],i=function(e){if(!e&&a&&a.baseURI)return a.baseURI;var t=e.indexOf("#");return t>=0&&(e=e.substring(0,t)),a&&a.baseURIMap&&(e=a.baseURIMap(e)),e};for(s.push({current:t,context:this.push(null,i(t.baseURI))});s.length>0;){var n=s.shift();if(n.parent){if(n.context.parent&&n.context.parent.listMapping===n.listMapping)continue;for(var o in n.listMapping){var l=n.listMapping[o];if(0!==l.length){for(var h=[],p=0;p<l.length;p++)h.push(this.newBlankNode());for(var u=0;u<h.length;u++)this.addTriple(n.parent,h[u],"http://www.w3.org/1999/02/22-rdf-syntax-ns#first",l[u]),this.addTriple(n.parent,h[u],"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest",{type:e.objectURI,value:u+1<h.length?h[u+1]:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"});this.addTriple(n.parent,n.subject,o,{type:e.objectURI,value:h[0]})}else this.addTriple(n.parent,n.subject,o,{type:e.objectURI,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"})}}else{var c=n.current,d=n.context,g=!1,w=null,v=null,b=null,m=d.prefixes,f=!1,R=[],N=d.listMapping,U=!d.parent,I=d.language,y=d.vocabulary;r=this.parseURI(i(c.baseURI)),c.item=null;var T=c.getAttributeNode("vocab");if(T){var M=this.trim(T.value);if(M.length>0){y=M;var O=r.spec;this.addTriple(c,O,"http://www.w3.org/ns/rdfa#usesVocabulary",{type:e.objectURI,value:y})}else y=this.vocabulary}for(var x=0;x<c.attributes.length;x++){var E=c.attributes[x];if("x"===E.nodeName.charAt(0)&&0===E.nodeName.indexOf("xmlns:")){f||(m=this.copyMappings(m),f=!0);var C=E.nodeName.substring(6),L=e.trim(E.value);m[C]=this.options.base?Uri.join(L,this.options.base):L}}var k=c.getAttributeNode("prefix");k&&(f||(m=this.copyMappings(m),f=!0),this.parsePrefixMappings(k.value,m));for(var D=null,j=0;!D&&j<this.langAttributes.length;j++)D=c.getAttributeNodeNS(this.langAttributes[j].namespaceURI,this.langAttributes[j].localName);if(D){var A=e.trim(D.value);I=A.length>0?A:null}var H,_,P=c.getAttributeNode("rel"),X=c.getAttributeNode("rev"),S=c.getAttributeNode("typeof"),F=c.getAttributeNode("property"),z=c.getAttributeNode("datatype"),B=this.inHTMLMode?c.getAttributeNode("datetime"):null,q=c.getAttributeNode("content"),Y=c.getAttributeNode("about"),Z=c.getAttributeNode("src"),G=c.getAttributeNode("resource"),W=c.getAttributeNode("href"),$=c.getAttributeNode("inlist"),V=[];if(P){_=this.tokenize(P.value);for(var J=0;J<_.length;J++)H=this.parsePredicate(_[J],y,d.terms,m,r,this.inHTMLMode&&null!==F),H&&V.push(H)}var K=[];if(X){_=this.tokenize(X.value);for(var Q=0;Q<_.length;Q++)H=this.parsePredicate(_[Q],y,d.terms,m,r,this.inHTMLMode&&F),H&&K.push(H)}if(this.inHTMLMode&&(P||X)&&F&&(0===V.length&&(P=null),0===K.length&&(X=null)),P||X?(Y&&(w=this.parseSafeCURIEOrCURIEOrURI(Y.value,m,r)),S&&(b=w),w||(c.parentNode.nodeType===Node.DOCUMENT_NODE?w=i(c.baseURI):d.parentObject&&(w=i(c.parentNode.baseURI)===d.parentObject?i(c.baseURI):d.parentObject)),G&&(v=this.parseSafeCURIEOrCURIEOrURI(G.value,m,r)),v||(W?v=this.resolveAndNormalize(r,encodeURI(W.value)):Z?v=this.resolveAndNormalize(r,encodeURI(Z.value)):!S||Y||this.inXHTMLMode&&("head"===c.localName||"body"===c.localName)||(v=this.newBlankNode())),!S||Y||!this.inXHTMLMode||"head"!==c.localName&&"body"!==c.localName?S&&!Y&&(b=v):b=w):!F||q||z?(Y&&(w=this.parseSafeCURIEOrCURIEOrURI(Y.value,m,r)),!w&&G&&(w=this.parseSafeCURIEOrCURIEOrURI(G.value,m,r)),!w&&W&&(w=this.resolveAndNormalize(r,encodeURI(W.value))),!w&&Z&&(w=this.resolveAndNormalize(r,encodeURI(Z.value))),w||(c.parentNode.nodeType===Node.DOCUMENT_NODE?w=i(c.baseURI):!this.inXHTMLMode&&!this.inHTMLMode||"head"!==c.localName&&"body"!==c.localName?S?w=this.newBlankNode():d.parentObject&&(w=i(c.parentNode.baseURI)===d.parentObject?i(c.baseURI):d.parentObject,F||(g=!0)):w=i(c.parentNode.baseURI)===d.parentObject?i(c.baseURI):d.parentObject),S&&(b=w)):(Y&&(w=this.parseSafeCURIEOrCURIEOrURI(Y.value,m,r),S&&(b=w)),w||c.parentNode.nodeType!==Node.DOCUMENT_NODE?!w&&d.parentObject&&(w=i(c.parentNode.baseURI)===d.parentObject?i(c.baseURI):d.parentObject):(w=i(c.baseURI),S&&(b=w)),S&&!b&&(G&&(b=this.parseSafeCURIEOrCURIEOrURI(G.value,m,r)),!b&&W&&(b=this.resolveAndNormalize(r,encodeURI(W.value))),!b&&Z&&(b=this.resolveAndNormalize(r,encodeURI(Z.value))),b||!this.inXHTMLMode&&!this.inHTMLMode||"head"!==c.localName&&"body"!==c.localName||(b=w),b||(b=this.newBlankNode()),v=b)),w&&(Y||G||b)){var ee=w;S&&!Y&&!G&&v&&(ee=v),this.newSubjectOrigin(c,ee)}if(b){_=this.tokenize(S.value);for(var te=0;te<_.length;te++){var ae=this.parseTermOrCURIEOrAbsURI(_[te],y,d.terms,m,r);ae&&this.addTriple(c,b,e.typeURI,{type:e.objectURI,value:ae})}}if(w&&w!==d.parentObject&&(N={},U=!0),v){if(P&&$)for(var re=0;re<V.length;re++){var se=N[V[re]];se||(se=[],N[V[re]]=se),se.push({type:e.objectURI,value:v})}else if(P)for(var ie=0;ie<V.length;ie++)this.addTriple(c,w,V[ie],{type:e.objectURI,value:v});if(X)for(var ne=0;ne<K.length;ne++)this.addTriple(c,v,K[ne],{type:e.objectURI,value:w})}else{if(w&&!v&&(P||X)&&(v=this.newBlankNode()),P&&$)for(var oe=0;oe<V.length;oe++){var le=N[V[oe]];le||(le=[],N[H]=le),R.push({predicate:V[oe],list:le})}else if(P)for(var he=0;he<V.length;he++)R.push({predicate:V[he],forward:!0});if(X)for(var pe=0;pe<K.length;pe++)R.push({predicate:K[pe],forward:!1})}if(F){var ue=null,ce=null;z?(ue=""===z.value?e.PlainLiteralURI:this.parseTermOrCURIEOrAbsURI(z.value,y,d.terms,m,r),ce=B&&!q?B.value:ue===e.XMLLiteralURI||ue===e.HTMLLiteralURI?null:q?q.value:c.textContent):q?(ue=e.PlainLiteralURI,ce=q.value):B?(ce=B.value,ue=e.deriveDateTimeType(ce),ue||(ue=e.PlainLiteralURI)):P||X||(G&&(ce=this.parseSafeCURIEOrCURIEOrURI(G.value,m,r)),!ce&&W?ce=this.resolveAndNormalize(r,encodeURI(W.value)):!ce&&Z&&(ce=this.resolveAndNormalize(r,encodeURI(Z.value))),ce&&(ue=e.objectURI)),ue||(S&&!Y?(ue=e.objectURI,ce=b):(ce=c.textContent,this.inHTMLMode&&"time"===c.localName&&(ue=e.deriveDateTimeType(ce)),ue||(ue=e.PlainLiteralURI))),_=this.tokenize(F.value);for(var de=0;de<_.length;de++){var ge=this.parsePredicate(_[de],y,d.terms,m,r);if(ge)if($){var we=N[ge];we||(we=[],N[ge]=we),we.push(ue===e.XMLLiteralURI||ue===e.HTMLLiteralURI?{type:ue,value:c.childNodes}:{type:ue?ue:e.PlainLiteralURI,value:ce,language:I})}else ue===e.XMLLiteralURI||ue===e.HTMLLiteralURI?this.addTriple(c,w,ge,{type:ue,value:c.childNodes}):this.addTriple(c,w,ge,{type:ue?ue:e.PlainLiteralURI,value:ce,language:I})}}if(w&&!g)for(var ve=0;ve<d.incomplete.length;ve++)d.incomplete[ve].list?d.incomplete[ve].list.push({type:e.objectURI,value:w}):d.incomplete[ve].forward?this.addTriple(c,d.subject,d.incomplete[ve].predicate,{type:e.objectURI,value:w}):this.addTriple(c,w,d.incomplete[ve].predicate,{type:e.objectURI,value:d.subject});var be=null,me=w;g?(be=this.push(d,d.subject),be.parentObject=i(c.parentNode.baseURI)===d.parentObject?i(c.baseURI):d.parentObject,be.incomplete=d.incomplete,be.language=I,be.prefixes=m,be.vocabulary=y):(be=this.push(d,w),be.parentObject=v?v:w?w:d.subject,be.prefixes=m,be.incomplete=R,v&&(me=v,N={},U=!0),be.listMapping=N,be.language=I,be.vocabulary=y),U&&s.unshift({parent:c,context:d,subject:me,listMapping:N});for(var fe=c.lastChild;fe;fe=fe.previousSibling)fe.nodeType===Node.ELEMENT_NODE&&(fe.baseURI=c.baseURI,s.unshift({current:fe,context:be}))}}this.inHTMLMode&&this.copyProperties();for(var Re=0;Re<this.finishedHandlers.length;Re++)this.finishedHandlers[Re](t)}},{key:"push",value:function(e,t){return{parent:e,subject:t?t:e?e.subject:null,parentObject:null,incomplete:[],listMapping:e?e.listMapping:{},language:e?e.language:this.language,prefixes:e?e.prefixes:this.target.graph.prefixes,terms:e?e.terms:this.target.graph.terms,vocabulary:e?e.vocabulary:this.vocabulary}}},{key:"resolveAndNormalize",value:function(e,t){return Uri.join(t,e)}},{key:"setContext",value:function(e){"html"===e.localName&&"XHTML+RDFa 1.1"===e.getAttribute("version")?this.setXHTMLContext():"html"===e.localName||"http://www.w3.org/1999/xhtml"===e.namespaceURI?"undefined"!=typeof document&&document.doctype?"-//W3C//DTD XHTML+RDFa 1.0//EN"===document.doctype.publicId&&"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd"===document.doctype.systemId?(console.log("WARNING: RDF 1.0 is not supported.  Defaulting to HTML5 mode."),this.setHTMLContext()):"-//W3C//DTD XHTML+RDFa 1.1//EN"===document.doctype.publicId&&"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-2.dtd"===document.doctype.systemId?this.setXHTMLContext():this.setHTMLContext():this.setHTMLContext():this.setXMLContext()}},{key:"setHTMLContext",value:function(){this.setInitialContext(),this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"},{namespaceURI:null,localName:"lang"}],this.inXHTMLMode=!1,this.inHTMLMode=!0}},{key:"setInitialContext",value:function(){this.vocabulary=null,this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"}]}},{key:"setXHTMLContext",value:function(){this.setInitialContext(),this.inXHTMLMode=!0,this.inHTMLMode=!1,this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"},{namespaceURI:null,localName:"lang"}],this.target.graph.terms.alternate="http://www.w3.org/1999/xhtml/vocab#alternate",this.target.graph.terms.appendix="http://www.w3.org/1999/xhtml/vocab#appendix",this.target.graph.terms.bookmark="http://www.w3.org/1999/xhtml/vocab#bookmark",this.target.graph.terms.cite="http://www.w3.org/1999/xhtml/vocab#cite",this.target.graph.terms.chapter="http://www.w3.org/1999/xhtml/vocab#chapter",this.target.graph.terms.contents="http://www.w3.org/1999/xhtml/vocab#contents",this.target.graph.terms.copyright="http://www.w3.org/1999/xhtml/vocab#copyright",this.target.graph.terms.first="http://www.w3.org/1999/xhtml/vocab#first",this.target.graph.terms.glossary="http://www.w3.org/1999/xhtml/vocab#glossary",this.target.graph.terms.help="http://www.w3.org/1999/xhtml/vocab#help",this.target.graph.terms.icon="http://www.w3.org/1999/xhtml/vocab#icon",this.target.graph.terms.index="http://www.w3.org/1999/xhtml/vocab#index",this.target.graph.terms.last="http://www.w3.org/1999/xhtml/vocab#last",this.target.graph.terms.license="http://www.w3.org/1999/xhtml/vocab#license",this.target.graph.terms.meta="http://www.w3.org/1999/xhtml/vocab#meta",this.target.graph.terms.next="http://www.w3.org/1999/xhtml/vocab#next",this.target.graph.terms.prev="http://www.w3.org/1999/xhtml/vocab#prev",this.target.graph.terms.previous="http://www.w3.org/1999/xhtml/vocab#previous",this.target.graph.terms.section="http://www.w3.org/1999/xhtml/vocab#section",this.target.graph.terms.stylesheet="http://www.w3.org/1999/xhtml/vocab#stylesheet",this.target.graph.terms.subsection="http://www.w3.org/1999/xhtml/vocab#subsection",this.target.graph.terms.start="http://www.w3.org/1999/xhtml/vocab#start",this.target.graph.terms.top="http://www.w3.org/1999/xhtml/vocab#top",this.target.graph.terms.up="http://www.w3.org/1999/xhtml/vocab#up",this.target.graph.terms.p3pv1="http://www.w3.org/1999/xhtml/vocab#p3pv1",this.target.graph.terms.related="http://www.w3.org/1999/xhtml/vocab#related",this.target.graph.terms.role="http://www.w3.org/1999/xhtml/vocab#role",this.target.graph.terms.transformation="http://www.w3.org/1999/xhtml/vocab#transformation"}},{key:"setXMLContext",value:function(){this.setInitialContext(),this.inXHTMLMode=!1,this.inHTMLMode=!1}},{key:"tokenize",value:function(e){return this.trim(e).split(/\s+/)}},{key:"toRDFNodeObject",value:function(t){if("undefined"!=typeof t){if("string"==typeof t)return"_:"===t.substring(0,2)?("undefined"==typeof this.blankNodes[t.substring(2)]&&(this.blankNodes[t.substring(2)]=new BlankNode(t.substring(2))),this.blankNodes[t.substring(2)]):rdf.namedNode(t);switch(t.type){case e.objectURI:return"_:"===t.value.substring(0,2)?("undefined"==typeof this.blankNodes[t.value.substring(2)]&&(this.blankNodes[t.value.substring(2)]=new BlankNode(t.value.substring(2))),this.blankNodes[t.value.substring(2)]):rdf.namedNode(t.value);case e.PlainLiteralURI:return new Literal(t.value,t.language||"");case e.XMLLiteralURI:case e.HTMLLiteralURI:var a="";return Object.keys(t.value).forEach(function(e){a+=Util.domToString(t.value[e],this.htmlOptions)}),new Literal(a,"",new NamedNode(t.type));default:return new Literal(t.value,"",new NamedNode(t.type))}}}},{key:"trim",value:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}],[{key:"parseRDFaDOM",value:function(t,a,r){var s=new e(a,{base:r});t.baseURI=r,s.process(t)}}]),e}();RDFaProcessor.XMLLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral",RDFaProcessor.HTMLLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#HTML",RDFaProcessor.PlainLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#PlainLiteral",RDFaProcessor.objectURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#object",RDFaProcessor.typeURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",RDFaProcessor.nameChar="[-A-Z_a-z-----------0-F.0-9--]",RDFaProcessor.nameStartChar="[A-Za-z------------------------------------------------------------------------------------------------------------------------------------------------------_]",RDFaProcessor.NCNAME=new RegExp("^"+RDFaProcessor.nameStartChar+RDFaProcessor.nameChar+"*$"),RDFaProcessor.dateTimeTypes=[{pattern:/-?P(?:[0-9]+Y)?(?:[0-9]+M)?(?:[0-9]+D)?(?:T(?:[0-9]+H)?(?:[0-9]+M)?(?:[0-9]+(?:\.[0-9]+)?S)?)?/,type:"http://www.w3.org/2001/XMLSchema#duration"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]-[0-9][0-9]T(?:[0-1][0-9]|2[0-4]):[0-5][0-9]:[0-5][0-9](?:\.[0-9]+)?(?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#dateTime"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]-[0-9][0-9](?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#date"},{pattern:/(?:[0-1][0-9]|2[0-4]):[0-5][0-9]:[0-5][0-9](?:\.[0-9]+)?(?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#time"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]/,type:"http://www.w3.org/2001/XMLSchema#gYearMonth"},{pattern:/-?[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9]/,type:"http://www.w3.org/2001/XMLSchema#gYear"}],module.exports=RDFaProcessor;
},{"./blank-node":133,"./data-factory":137,"./literal":145,"./named-node":148,"./uri":163,"./util":164}],156:[function(require,module,exports){
"use strict";var uriUtil=require("./uri"),RDFParser=function e(t){var e={};e.ns={RDF:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDFS:"http://www.w3.org/2000/01/rdf-schema#"},e.nodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},this.frameFactory=function(t,i,n){return{NODE:1,ARC:2,parent:i,parser:t,store:t.store,element:n,lastChild:0,base:null,lang:null,node:null,nodeType:null,listIndex:1,rdfid:null,datatype:null,collection:!1,terminateFrame:function(){this.collection&&this.node.close()},addSymbol:function(e,t){t=uriUtil.join(t,this.base),this.node=this.store.sym(t),this.nodeType=e},loadTriple:function(){if(this.parent.parent.collection?this.parent.parent.node.append(this.node):this.store.add(this.parent.parent.node,this.parent.node,this.node,this.parser.why),null!=this.parent.rdfid){var t=this.store.sym(uriUtil.join("#"+this.parent.rdfid,this.base));this.store.add(t,this.store.sym(e.ns.RDF+"type"),this.store.sym(e.ns.RDF+"Statement"),this.parser.why),this.store.add(t,this.store.sym(e.ns.RDF+"subject"),this.parent.parent.node,this.parser.why),this.store.add(t,this.store.sym(e.ns.RDF+"predicate"),this.parent.node,this.parser.why),this.store.add(t,this.store.sym(e.ns.RDF+"object"),this.node,this.parser.why)}},isTripleToLoad:function(){return null!=this.parent&&null!=this.parent.parent&&this.nodeType===this.NODE&&this.parent.nodeType===this.ARC&&this.parent.parent.nodeType===this.NODE},addNode:function(e){this.addSymbol(this.NODE,e),this.isTripleToLoad()&&this.loadTriple()},addCollection:function(){this.nodeType=this.NODE,this.node=this.store.collection(),this.collection=!0,this.isTripleToLoad()&&this.loadTriple()},addCollectionArc:function(){this.nodeType=this.ARC},addBNode:function(e){null!=e?null!=this.parser.bnodes[e]?this.node=this.parser.bnodes[e]:this.node=this.parser.bnodes[e]=this.store.bnode():this.node=this.store.bnode(),this.nodeType=this.NODE,this.isTripleToLoad()&&this.loadTriple()},addArc:function(t){t===e.ns.RDF+"li"&&(t=e.ns.RDF+"_"+this.parent.listIndex,this.parent.listIndex++),this.addSymbol(this.ARC,t)},addLiteral:function(e){this.parent.datatype?this.node=this.store.literal(e,"",this.store.sym(this.parent.datatype)):this.node=this.store.literal(e,this.lang),this.nodeType=this.NODE,this.isTripleToLoad()&&this.loadTriple()}}},this.getAttributeNodeNS=function(e,t,i){var n=null;if(e.getAttributeNodeNS)n=e.getAttributeNodeNS(t,i);else for(var s,r,o=e.attributes,a=0;a<o.length;++a)if(s=o[a],s.namespaceURI===t&&(r=s.prefix?s.prefix+":"+i:i,r===s.nodeName)){n=s;break}return n},this.store=t,this.bnodes={},this.why=null,this.reify=!1,this.parse=function(t,i,n){var s=t.childNodes;this.cleanParser();var r;if(t.nodeType===e.nodeType.DOCUMENT){for(var o=0;o<s.length;o++)if(s[o].nodeType===e.nodeType.ELEMENT){r=s[o];break}}else{if(t.nodeType!==e.nodeType.ELEMENT)throw new Error("RDFParser: can't find root in "+i+". Halting. ");r=t}this.why=n;var a=this.frameFactory(this);return this.base=i,a.base=i,a.lang=null,this.parseDOM(this.buildFrame(a,r)),!0},this.parseDOM=function(t){for(var i,n=function(e){var t="";if(null==e.namespaceURI)throw new Error("RDF/XML syntax error: No namespace for "+e.localName+" in "+this.base);return e.namespaceURI&&(t+=e.namespaceURI),e.localName?t+=e.localName:e.nodeName&&(t+=e.nodeName.indexOf(":")>=0?e.nodeName.split(":")[1]:e.nodeName),t}.bind(this),s=!0;t.parent;){var r=t.element,o=r.attributes;if(r.nodeType===e.nodeType.TEXT||r.nodeType===e.nodeType.CDATA_SECTION)t.parent.nodeType===t.NODE&&(t.addArc(e.ns.RDF+"value"),t=this.buildFrame(t)),t.addLiteral(r.nodeValue);else if(n(r)!==e.ns.RDF+"RDF")if(t.parent&&t.parent.collection&&(t.addCollectionArc(),t=this.buildFrame(t,t.element),t.parent.element=null),t.parent&&t.parent.nodeType&&t.parent.nodeType!==t.ARC){t.addArc(n(r)),this.reify&&(i=this.getAttributeNodeNS(r,e.ns.RDF,"ID"),i&&(t.rdfid=i.nodeValue,r.removeAttributeNode(i)));var a=this.getAttributeNodeNS(r,e.ns.RDF,"parseType"),d=this.getAttributeNodeNS(r,e.ns.RDF,"datatype");if(d&&(t.datatype=d.nodeValue,r.removeAttributeNode(d)),a){var l=a.nodeValue;"Literal"===l?(t.datatype=e.ns.RDF+"XMLLiteral",t=this.buildFrame(t),t.addLiteral(r),s=!1):"Resource"===l?(t=this.buildFrame(t,t.element),t.parent.element=null,t.addBNode()):"Collection"===l&&(t=this.buildFrame(t,t.element),t.parent.element=null,t.addCollection()),r.removeAttributeNode(a)}if(0!==o.length){var h=this.getAttributeNodeNS(r,e.ns.RDF,"resource"),p=this.getAttributeNodeNS(r,e.ns.RDF,"nodeID");t=this.buildFrame(t),h?(t.addNode(h.nodeValue),r.removeAttributeNode(h)):p?(t.addBNode(p.nodeValue),r.removeAttributeNode(p)):t.addBNode();for(var u=o.length-1;u>=0;u--){var N=this.buildFrame(t);N.addArc(n(o[u])),n(o[u])===e.ns.RDF+"type"?this.buildFrame(N).addNode(o[u].nodeValue):this.buildFrame(N).addLiteral(o[u].nodeValue)}}else 0===r.childNodes.length&&this.buildFrame(t).addLiteral("")}else{var T=this.getAttributeNodeNS(r,e.ns.RDF,"about");if(i=this.getAttributeNodeNS(r,e.ns.RDF,"ID"),T&&i)throw new Error("RDFParser: "+r.nodeName+" has both rdf:id and rdf:about. Halting. Only one of these properties may be specified on a node.");if(!T&&i)t.addNode("#"+i.nodeValue),r.removeAttributeNode(i);else if(null==T&&null==i){var m=this.getAttributeNodeNS(r,e.ns.RDF,"nodeID");m?(t.addBNode(m.nodeValue),r.removeAttributeNode(m)):t.addBNode()}else t.addNode(T.nodeValue),r.removeAttributeNode(T);var y=this.getAttributeNodeNS(r,e.ns.RDF,"type");e.ns.RDF+"Description"!==n(r)&&(y={nodeValue:n(r)}),null!=y&&(this.store.add(t.node,this.store.sym(e.ns.RDF+"type"),this.store.sym(uriUtil.join(y.nodeValue,t.base)),this.why),y.nodeName&&r.removeAttributeNode(y));for(var b=o.length-1;b>=0;b--)this.store.add(t.node,this.store.sym(n(o[b])),this.store.literal(o[b].nodeValue,t.lang),this.why)}for(r=t.element;t.parent;){for(var c=t;null==r;)t=t.parent,r=t.element;var f=r.childNodes&&r.childNodes[t.lastChild];if(f&&s){if((f.nodeType===e.nodeType.ELEMENT||f.nodeType===e.nodeType.TEXT||f.nodeType===e.nodeType.CDATA_SECTION)&&(f.nodeType!==e.nodeType.TEXT&&f.nodeType!==e.nodeType.CDATA_SECTION||1===r.childNodes.length)){t.lastChild++,t=this.buildFrame(c,r.childNodes[t.lastChild-1]);break}t.lastChild++}else{if(t.terminateFrame(),!(t=t.parent))break;r=t.element,s=!0}}}},this.cleanParser=function(){this.bnodes={},this.why=null},this.buildFrame=function(t,i){var n=this.frameFactory(this,t,i);if(t&&(n.base=t.base,n.lang=t.lang),!i||i.nodeType===e.nodeType.TEXT||i.nodeType===e.nodeType.CDATA_SECTION)return n;var s=i.attributes,r=i.getAttributeNode("xml:base");null!=r&&(n.base=r.nodeValue,i.removeAttribute("xml:base"));var o=i.getAttributeNode("xml:lang");null!=o&&(n.lang=o.nodeValue,i.removeAttribute("xml:lang"));for(var a=s.length-1;a>=0;a--)if("xml"===s[a].nodeName.substr(0,3)){if("xmlns:"===s[a].name.slice(0,6)){var d=s[a].nodeValue;this.base&&(d=uriUtil.join(d,this.base)),this.store.setPrefixForURI(s[a].name.slice(6),d)}i.removeAttributeNode(s[a])}return n}};module.exports=RDFParser;
},{"./uri":163}],157:[function(require,module,exports){
"use strict";function serialize(e,t,s,a,r){function n(e,t){return r?void r(e,t):t}var i=null;try{var l,o=Serializer(t),c=t.statementsMatching(void 0,void 0,void 0,e);switch(o.suggestNamespaces(t.namespaces),o.setBase(s),a){case"application/rdf+xml":return i=o.statementsToXML(c),n(null,i);case"text/n3":case"application/n3":return i=o.statementsToN3(c),n(null,i);case"text/turtle":case"application/x-turtle":return o.setFlags("si"),i=o.statementsToN3(c),n(null,i);case"application/n-triples":return o.setFlags("deinprstux"),i=o.statementsToNTriples(c),n(null,i);case"application/ld+json":o.setFlags("deinprstux"),l=o.statementsToNTriples(c),convert.convertToJson(l,r);break;case"application/n-quads":case"application/nquads":return o.setFlags("deinprstux q"),i=o.statementsToNTriples(c),n(null,i);default:throw new Error("Serialize: Content-type "+a+" not supported for data write.")}}catch(e){if(r)return r(e);throw e}}module.exports=serialize;var convert=require("./convert"),Serializer=require("./serializer");
},{"./convert":136,"./serializer":158}],158:[function(require,module,exports){
"use strict";var NamedNode=require("./named-node"),Uri=require("./uri"),Util=require("./util"),XSD=require("./xsd"),Serializer=function(){function e(e){return encodeURI(e)}function t(e){for(var t,r="",i=0;i<e.length;i++)t=e.charCodeAt(i),r+=t>65535?"\\U"+("00000000"+t.toString(16)).slice(-8):t>126?"\\u"+("0000"+t.toString(16)).slice(-4):e[i];return r}var r=function(e){this.flags="",this.base=null,this.prefixes=[],this.namespaces=[],this.suggestPrefix("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),this.suggestPrefix("xml","reserved:reservedForFutureUse"),this.namespacesUsed=[],this.keywords=["a"],this.prefixchars="abcdefghijklmnopqustuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",this.incoming=null,this.formulas=[],this.store=e};r.prototype.setBase=function(e){this.base=e},r.prototype.setFlags=function(e){this.flags=e?e:""},r.prototype.toStr=function(e){var t=e.toNT();return"formula"==e.termType&&(this.formulas[t]=e),t},r.prototype.fromStr=function(e){if("{"==e[0]){var t=this.formulas[e];return t||console.log("No formula object for "+e),t}return this.store.fromNT(e)},r.prototype.suggestPrefix=function(e,t){"default"!==e.slice(0,7)&&"ns"!==e.slice(0,2)&&e&&t&&(e in this.namespaces||t in this.prefixes||(this.prefixes[t]=e,this.namespaces[e]=t))},r.prototype.suggestNamespaces=function(e){for(var t in e)this.suggestPrefix(t,e[t])},r.prototype.checkIntegrity=function(){var e,t;for(e in this.namespaces)if(this.prefixes[this.namespaces[e]]!==e)throw"Serializer integity error 1: "+e+", "+this.namespaces[e]+", "+this.prefixes[this.namespaces[e]]+"!";for(t in this.prefixes)if(this.namespaces[this.prefixes[t]]!==t)throw"Serializer integity error 2: "+t+", "+this.prefixs[t]+", "+this.namespaces[this.prefixes[t]]+"!"},r.prototype.makeUpPrefix=function(e){function t(t){return!!r.prototype.validPrefix.test(t)&&("ns"!==t&&(!(t in this.namespaces)&&(this.prefixes[e]=t,this.namespaces[t]=e,i=t,!0)))}var i,n=e;t=t.bind(this),"#/".indexOf(n[n.length-1])>=0&&(n=n.slice(0,-1));var s=n.lastIndexOf("/");s>=0&&(n=n.slice(s+1));for(var a=0;a<n.length&&this.prefixchars.indexOf(n[a]);)a++;if(n=n.slice(0,a),n.length<6&&t(n))return i;if(t(n.slice(0,3)))return i;if(t(n.slice(0,2)))return i;if(t(n.slice(0,4)))return i;if(t(n.slice(0,1)))return i;if(t(n.slice(0,5)))return i;r.prototype.validPrefix.test(n)||(n="n");for(var a=0;;a++)if(t(n.slice(0,3)+a))return i},r.prototype.rootSubjects=function(e){for(var t={},r={},i={},n=0;n<e.length;n++){var s=e[n],a=[s.subject,s.predicate,s.object];a.map(function(e){"BlankNode"==e.termType&&(i[e.toNT()]=!0)});var o=e[n].object;t.hasOwnProperty(o)||(t[o]=[]),t[o].push(s.subject);var c=r[this.toStr(s.subject)];c||(c=[]),c.push(s),r[this.toStr(s.subject)]=c}var f=[];for(var u in r)if(r.hasOwnProperty(u)){var o=this.fromStr(u);"BlankNode"==o.termType&&t[o]&&1==t[o].length||f.push(o)}this.incoming=t;for(var p={},n=0;n<f.length;n++)p[f[n].toNT()]=!0;return{roots:f,subjects:r,rootsHash:p,incoming:t}},r.prototype.toN3=function(e){return this.statementsToN3(e.statements)},r.prototype._notQNameChars="\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~",r.prototype._notNameChars=r.prototype._notQNameChars+":",r.prototype.explicitURI=function(r){return r=this.flags.indexOf("r")<0&&this.base?Uri.refTo(this.base,r):this.flags.indexOf("u")>=0?t(r):e(r),"<"+r+">"},r.prototype.statementsToNTriples=function(e){var t=e.slice();t.sort();for(var r="",i="http://www.w3.org/1999/02/22-rdf-syntax-ns#",n=this,s=this.store,a=function e(t){if("collection"!==t.termType)return n.atomicTermToN3(t);for(var a=t.elements,o=s.sym(i+"nill"),c=a.length-1;c>=0;c--){var f=new $rdf.BlankNode;r+=e(f)+" "+e(s.sym(i+"first"))+" "+e(a[c])+".\n",r+=e(f)+" "+e(s.sym(i+"rest"))+" "+e(o)+".\n",o=f}return n.atomicTermToN3(o)},o=0;o<t.length;o++){var c=t[o],f="";f+=a(c.subject)+" ",f+=a(c.predicate)+" ",f+=a(c.object)+" ",this.flags.indexOf("q")>=0&&(f+=a(c.why)+" "),f+=".\n",r+=f}return r},r.prototype.statementsToN3=function(e){function t(e){for(var t=this.rootSubjects(e),r=t.roots,n=[],s=0;s<r.length;s++){var a=r[s];n.push(i(a,t))}return n}function i(e,t){return"BlankNode"!=e.termType||t.incoming[e]?[a(e,t)].concat([n(e,t)]).concat(["."]):s(e,t,!0).concat(["."])}function n(e,t){var r=[],i=null,n=t.subjects[this.toStr(e)];if("undefined"==typeof n)throw"Cant find statements for "+e;n.sort();for(var o=[],c=0;c<n.length;c++){var f=n[c];f.predicate.uri==i?o.push(","):(i&&(r=r.concat([o]).concat([";"]),o=[]),r.push(u[f.predicate.uri]?u[f.predicate.uri]:a(f.predicate,t))),i=f.predicate.uri,o.push(s(f.object,t))}return r=r.concat([o])}function s(e,t,r){return"BlankNode"==e.termType&&t.subjects[this.toStr(e)]&&(r||void 0==t.rootsHash[e.toNT()])?["["].concat(n(e,t)).concat(["]"]):a(e,t)}function a(e,r){var i;switch(e.termType){case"formula":var n=["{"];return n=n.concat(t(e.statements)),n.concat(["}"]);case"collection":var n=["("];for(i=0;i<e.elements.length;i++)n.push([s(e.elements[i],r)]);return n.push(")"),n;default:return this.atomicTermToN3(e)}}function o(){var e="";this.defaultNamespace&&(e+="@prefix : <"+this.defaultNamespace+">.\n");for(var t in this.prefixes)this.prefixes.hasOwnProperty(t)&&this.namespacesUsed[t]&&(e+="@prefix "+this.prefixes[t]+": "+this.explicitURI(t)+".\n");return e+"\n"}var c=4,f=80,u={};this.flags.indexOf("s")<0&&(u["http://www.w3.org/2002/07/owl#sameAs"]="="),this.flags.indexOf("t")<0&&(u["http://www.w3.org/1999/02/22-rdf-syntax-ns#type"]="a"),this.flags.indexOf("i")<0&&(u["http://www.w3.org/2000/10/swap/log#implies"]="=>");var p=function(e){for(var t="",r=0;r<e;r++)t+=" ";return t},h=function e(t){for(var r="",i=0;i<t.length;i++){var n=t[i],s="string"==typeof n?n:e(n);0!=i&&","!=s&&";"!=s&&(r+=" "),r+=s}return r},l=function e(t,r){var i="",n=1e5;r||(r=0);for(var s=0;s<t.length;s++){var a=t[s];if("string"!=typeof a){var o=e(a,r+1);if(o.length<10*(f-c*r)&&o.indexOf('"""')<0){var u=h(a);u.length<f-c*r&&(a="   "+u,o="")}o&&(n=1e4),i+=o}if("string"==typeof a){if("1"==a.length&&"\n"==i.slice(-1)){if(",.;".indexOf(a)>=0){i=i.slice(0,-1)+a+"\n",n+=1;continue}if("])}".indexOf(a)>=0){i=i.slice(0,-1)+" "+a+"\n",n+=2;continue}}if(n<c*r+4)i=i.slice(0,-1)+" "+a+"\n",n+=a.length+1;else{var u=p(c*r)+a;i+=u+"\n",n=u.length}}}return i};t=t.bind(this),n=n.bind(this),s=s.bind(this),r.prototype.termToN3=a,a=a.bind(this);var o=o.bind(this),d=t(e);return o()+l(d,-1)},r.prototype.atomicTermToN3=function(e,t){switch(e.termType){case"BlankNode":case"Variable":return e.toNT();case"Literal":if(e.datatype&&this.flags.indexOf("x")<0)switch(e.datatype.uri){case"http://www.w3.org/2001/XMLSchema#integer":return e.value.toString();case"http://www.w3.org/2001/XMLSchema#boolean":return e.value?"true":"false"}var r=this.stringToN3(e.value);return e.language?r+="@"+e.language:e.datatype.equals(XSD.string)||(r+="^^"+this.atomicTermToN3(e.datatype,t)),r;case"NamedNode":return this.symbolToN3(e);default:throw"Internal: atomicTermToN3 cannot handle "+e+" of termType: "+e.termType+"\n"}},r.prototype.validPrefix=new RegExp(/^[a-zA-Z][a-zA-Z0-9]*$/),r.prototype.forbidden1=new RegExp(/[\\"\b\f\r\v\t\n\u0080-\uffff]/gm),r.prototype.forbidden3=new RegExp(/[\\"\b\f\r\v\u0080-\uffff]/gm),r.prototype.stringToN3=function(e,t){t||(t="e");var i,n,s="",a=0,o=0;e.length>20&&'"'!=e.slice(-1)&&t.indexOf("n")<0&&(e.indexOf("\n")>0||e.indexOf('"')>0)?(i='"""',n=r.prototype.forbidden3):(i='"',n=r.prototype.forbidden1);for(var a=0;a<e.length;){n.lastIndex=0;var c=n.exec(e.slice(a));if(null==c)break;o=a+n.lastIndex-1,s+=e.slice(a,o);var f=e[o];if('"'==f&&'"""'==i&&'"""'!=e.slice(o,o+3))s+=f;else{var u='\b\f\r\t\v\n\\"'.indexOf(f);s+=u>=0?"\\"+'bfrtvn\\"'[u]:t.indexOf("e")>=0?"\\u"+("000"+f.charCodeAt(0).toString(16).toLowerCase()).slice(-4):f}a=o+1}return i+s+e.slice(a)+i},r.prototype.symbolToN3=function(e){var t=e.uri,i=t.indexOf("#");if(i<0&&this.flags.indexOf("/")<0&&(i=t.lastIndexOf("/")),i>=0&&this.flags.indexOf("p")<0&&(0===t.indexOf("http")||0===t.indexOf("ws")||0===t.indexOf("file"))){for(var n=!0,s=i+1;s<t.length;s++)if(r.prototype._notNameChars.indexOf(t[s])>=0){n=!1;break}if(t.slice(0,i+1)==this.base+"#")return"<#"+t.slice(i+1)+">";if(n){var a=t.slice(i+1),o=t.slice(0,i+1);if(this.defaultNamespace&&this.defaultNamespace==o&&this.flags.indexOf("d")<0)return this.flags.indexOf("k")>=0&&this.keyords.indexOf(a)<0?a:":"+a;this.checkIntegrity();var c=this.prefixes[o];if(c||(c=this.makeUpPrefix(o)),c)return this.namespacesUsed[o]=!0,c+":"+a}}return this.explicitURI(t)},r.prototype.writeStore=function(e){var t=this.store,r=t.fetcher,i=r&&r.appNode,n=this.store.index[3];for(var s in n){var a=t.fromNT(s);i&&a.sameTerm(i)||e("\n"+this.atomicTermToN3(a)+" "+this.atomicTermToN3(t.sym("http://www.w3.org/2000/10/swap/log#semantics"))+" { "+this.statementsToN3(t.statementsMatching(void 0,void 0,void 0,a))+" }.\n")}t.statementsMatching(void 0,t.sym("http://www.w3.org/2007/ont/link#requestedURI")).map(function(r){e("\n<"+r.object.value+"> log:metadata {\n");var i=t.statementsMatching(void 0,void 0,void 0,r.subject);e(this.statementsToN3(this.statementsToN3(i))),e("}.\n")});var o=[];i&&o.push(i);var c=[];o.map(function(e){c=c.concat(t.statementsMatching(void 0,void 0,void 0,e))}),e(this.statementsToN3(c))},r.prototype.statementsToXML=function(e){function t(e){this.suggestPrefix("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#");for(var t=this.rootSubjects(e),r=t.roots,i=[],n=0;n<r.length;n++)root=r[n],i.push(s(root,t));return i}function i(e){return"undefined"==typeof e?"@@@undefined@@@@":e.replace(/[&<"]/g,function(e){switch(e[0]){case"&":return"&amp;";case"<":return"&lt;";case'"':return"&quot;"}})}function n(e){return i(this.base?Util.uri.refTo(this.base,e.uri):e.uri)}function s(e,t){var r,o,f,u,p=[],l=t.subjects[this.toStr(e)];if("undefined"==typeof l)throw"Serializing XML - Cant find statements for "+e;l.sort(function(e,t){var r=e.predicate.uri,i=t.predicate.uri;if(r.substring(0,h.length)==h||i.substring(0,h.length)==h)return r.localeCompare(i);var n=r.substring(h.length),s=i.substring(h.length),a=parseInt(n),o=parseInt(s);return isNaN(a)||isNaN(o)||a!=n||o!=s?r.localeCompare(i):a-o});for(var d=0;d<l.length;d++)if(f=l[d],"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"!=f.predicate.uri||r||"symbol"!=f.object.termType){if(u=f.predicate,u.uri.substr(0,h.length)==h){var g=u.uri.substr(h.length),m=parseInt(g);g==m.toString()&&(u=new NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#li"))}switch(o=c(u),f.object.termType){case"BlankNode":p=1==t.incoming[f.object].length?p.concat(["<"+o+">",s(f.object,t),"</"+o+">"]):p.concat(["<"+o+' rdf:nodeID="'+f.object.toNT().slice(2)+'"/>']);break;case"NamedNode":p=p.concat(["<"+o+' rdf:resource="'+n(f.object)+'"/>']);break;case"Literal":p=p.concat(["<"+o+(f.object.datatype.equals(XSD.string)?"":' rdf:datatype="'+i(f.object.datatype.uri)+'"')+(f.object.language?' xml:lang="'+f.object.language+'"':"")+">"+i(f.object.value)+"</"+o+">"]);break;case"collection":p=p.concat(["<"+o+' rdf:parseType="Collection">',a(f.object,t),"</"+o+">"]);break;default:throw"Can't serialize object of type "+f.object.termType+" into XML"}}else r=f.object;var v=r?c(r):"rdf:Description",y="";return"BlankNode"==e.termType?t.incoming[e]&&1==t.incoming[e].length||(y=' rdf:nodeID="'+e.toNT().slice(2)+'"'):y=' rdf:about="'+n(e)+'"',["<"+v+y+">"].concat([p]).concat(["</"+v+">"])}function a(e,t){for(var r=[],i=0;i<e.elements.length;i++)r.push(s(e.elements[i],t));return r}function o(e,t){var r=[],s=t.subjects[this.toStr(e)];if(void 0==s)return r;s.sort();for(var f=0;f<s.length;f++){var u=s[f];switch(u.object.termType){case"BlankNode":r=t.rootsHash[u.object.toNT()]?r.concat(["<"+c(u.predicate)+' rdf:nodeID="'+u.object.toNT().slice(2)+'">',"</"+c(u.predicate)+">"]):r.concat(["<"+c(u.predicate)+' rdf:parseType="Resource">',o(u.object,t),"</"+c(u.predicate)+">"]);break;case"NamedNode":r=r.concat(["<"+c(u.predicate)+' rdf:resource="'+n(u.object)+'"/>']);break;case"Literal":r=r.concat(["<"+c(u.predicate)+(u.object.datatype.equals(XSD.string)?"":' rdf:datatype="'+i(u.object.datatype.value)+'"')+(u.object.language?' xml:lang="'+u.object.language+'"':"")+">"+i(u.object.value)+"</"+c(u.predicate)+">"]);break;case"collection":r=r.concat(["<"+c(u.predicate)+' rdf:parseType="Collection">',a(u.object,t),"</"+c(u.predicate)+">"]);break;default:throw"Can't serialize object of type "+u.object.termType+" into XML"}}return r}function c(e){var t=e.uri,i=t.indexOf("#");if(i<0&&this.flags.indexOf("/")<0&&(i=t.lastIndexOf("/")),i<0)throw"Cannot make qname out of <"+t+">";for(var n=i+1;n<t.length;n++)if(r.prototype._notNameChars.indexOf(t[n])>=0)throw'Invalid character "'+t[n]+'" cannot be in XML qname for URI: '+t;var s=t.slice(i+1),a=t.slice(0,i+1);if(this.defaultNamespace&&this.defaultNamespace==a&&this.flags.indexOf("d")<0)return s;var o=this.prefixes[a];return o||(o=this.makeUpPrefix(a)),p[a]=!0,o+":"+s}var f=4,u=80,p=[];p["http://www.w3.org/1999/02/22-rdf-syntax-ns#"]=!0;var h="http://www.w3.org/1999/02/22-rdf-syntax-ns#_",l=function(e){for(var t="",r=0;r<e;r++)t+=" ";return t},d=function e(t){for(var r="",i=0;i<t.length;i++){var n=t[i],s="string"==typeof n?n:e(n);r+=s}return r},g=function e(t,r){var i="",n=1e5;r||(r=0);for(var s=0;s<t.length;s++){var a=t[s];if("string"!=typeof a){var o=e(a,r+1);if(o.length<10*(u-f*r)&&o.indexOf('"""')<0){var c=d(a);c.length<u-f*r&&(a="   "+c,o="")}o&&(n=1e4),i+=o}if("string"==typeof a)if(n<f*r+4)i=i.slice(0,-1)+" "+a+"\n",n+=a.length+1;else{var c=l(f*r)+a;i+=c+"\n",n=c.length}}return i};t=t.bind(this),n=n.bind(this),s=s.bind(this),o=o.bind(this),c=c.bind(this);var m=t(e),v="<rdf:RDF";this.defaultNamespace&&(v+=' xmlns="'+i(this.defaultNamespace)+'"');for(var y in p)p.hasOwnProperty(y)&&(v+="\n xmlns:"+this.prefixes[y]+'="'+i(y)+'"');v+=">";var b=[v,m,"</rdf:RDF>"];return g(b,-1)};var i=function(e){return new r(e)};return i}();module.exports=Serializer;
},{"./named-node":148,"./uri":163,"./util":164,"./xsd":166}],159:[function(require,module,exports){
"use strict";function SPARQLToQuery(e,r,n){function t(e){if(O[e])return O[e];var r=n.variable(e);return O[e]=r,r}function o(e){return"string"==typeof e&&e.match(/[^ \n\t]/)}function i(e){return"string"==typeof e&&e.match(/^[\?\$]/)}function a(e){return"string"==typeof e?e.replace(/^&lt;/,"<").replace(/&gt;$/,">"):e}function l(e){return"string"==typeof e&&e.match(/^<[^>]*>$/)}function c(e){return"string"==typeof e&&(e.match(/^_:/)||e.match(/^$/))}function s(e){return"string"==typeof e&&e.match(/:$/)}function f(e){return"string"==typeof e&&e.match(/^:|^[^_][^:]*:/)}function u(e){var r=e.split(":");return r[0]}function g(e){var r=e.split(":");return r[1]}function p(e){return l(e)?e.slice(1,e.length-1):e}function d(e){var r=e.indexOf("'")===-1?null:e.indexOf("'"),t=e.indexOf('"')===-1?null:e.indexOf('"');if(!r&&!t){var o=new Array(1);return o[0]=e,o}var i,a,l=new Array(2);if(!r||t&&t<r)i='"',a=t;else{if(t&&!(r&&r<t))return log.error("SQARQL QUERY OOPS!"),l;i="'",a=r}l[0]=e.slice(0,a);var c=e.slice(a+1).indexOf(i);if(c===-1)return log.error("SPARQL parsing error: no matching parentheses in literal "+e),e;var s;return e.slice(c+a+2).match(/^\^\^/)?(s=e.slice(c+a+2).indexOf(" "),l[1]=n.literal(e.slice(a+1,a+1+c),"",n.sym(p(e.slice(a+4+c,a+2+c+s)))),l=l.concat(d(e.slice(c+a+3+s)))):e.slice(c+a+2).match(/^@/)?(s=e.slice(c+a+2).indexOf(" "),l[1]=n.literal(e.slice(a+1,a+1+c),e.slice(a+3+c,a+2+c+s),null),l=l.concat(d(e.slice(c+a+2+s)))):(l[1]=n.literal(e.slice(a+1,a+1+c),"",null),log.info("Literal found: "+l[1]),l=l.concat(d(e.slice(c+a+2)))),l}function v(e){e=e.replace(/\(/g," ( ").replace(/\)/g," ) ").replace(/</g," <").replace(/>/g,"> ").replace(/{/g," { ").replace(/}/g," } ").replace(/[\t\n\r]/g," ").replace(/; /g," ; ").replace(/\. /g," . ").replace(/, /g," , "),log.info("New str into spaceDelimit: \n"+e);var r=[],n=e.split(" ");for(var t in n)o(n[t])&&(r=r.concat(n[t]));return r}function h(e){for(var r=e,n=0;n<r.length;n++)if("a"===r[n]&&(r[n]="<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>"),"is"===r[n]&&"of"===r[n+2]){r.splice(n,1),r.splice(n+1,1);var t=r[n-1];r[n-1]=r[n+1],r[n+1]=t}return r}function y(e){for(var r=[],o=0;o<e.length;o++)"string"==typeof e[o]?(e[o]=a(e[o]),i(e[o])?r[o]=t(e[o].slice(1)):c(e[o])?(log.info(e[o]+" was identified as a bnode."),r[o]=n.bnode()):l(e[o])?(log.info(e[o]+" was identified as a symbol."),r[o]=n.sym(p(e[o]))):f(e[o])?(log.info(e[o]+" was identified as a prefixed symbol"),I[u(e[o])]?r[o]=n.sym(e[o]=I[u(e[o])]+g(e[o])):(log.error("SPARQL error: "+e[o]+" with prefix "+u(e[o])+" does not have a correct prefix entry."),r[o]=e[o])):r[o]=e[o]):r[o]=e[o];return r}function w(e){var r=d(e),n=[];for(var t in r)n="string"==typeof r[t]?n.concat(v(r[t])):n.concat(r[t]);return n=h(n),log.info("SPARQL Tokens: "+n),n}function m(e,r){for(var n=0;n<r.length;n++)if("string"==typeof r[n]&&r[n].toLowerCase()===e.toLowerCase())return n;return null}function b(e,r){for(var n=[],t=0;t<r.length;t++)"string"==typeof r[t]&&r[t].toLowerCase()===e.toLowerCase()&&n.push(t);return n}function L(e,r){log.info("SPARQL vars: "+e);for(var n in e)if(i(e[n])){log.info("Added "+e[n]+" to query variables from SPARQL");var o=t(e[n].slice(1));r.vars.push(o),o.label=e[n].slice(1)}else log.warn("Incorrect SPARQL variable in SELECT: "+e[n])}function R(e){var r=b("PREFIX",e),n=[];for(var t in r){var o=e[r[t]+1],i=e[r[t]+2];if(s(o))if(l(i)){log.info("Prefix found: "+o+" -> "+i);var a=u(o),c=p(i);n[a]=c}else log.error("Invalid SPARQL symbol: "+i);else log.error("Invalid SPARQL prefix: "+o)}return n}function E(e,r,n){log.info("Looking for a close bracket of type "+n+" in "+e);for(var t=0,o=0;o<e.length;o++)if(e[o]===r&&t++,e[o]===n&&t--,t<0)return o;return log.error("Statement had no close parenthesis in SPARQL query"),0}function T(e){return this.describe=function(r){return r+" = "+e.toNT()},this.test=function(r){return e.sameTerm(r)},this}function P(e){this.describe=function(r){return"REGEXP( '"+e+"' , "+r+" )"},this.test=function(r){var n=e,t=new RegExp(n);return!!r.value&&t.test(r.value)}}function A(e,r){3!==e.length||"Variable"!==e[0].termType||"NamedNode"!==e[2].termType&&"Literal"!==e[2].termType?6===e.length&&"string"==typeof e[0]&&"regexp"===e[0].toLowerCase()&&"("===e[1]&&")"===e[5]&&","===e[3]&&"Variable"===e[4].termType&&"Literal"===e[2].termType&&(log.debug("Constraint added: "+e),r.constraints[e[4]]=new P(e[2].value)):"="===e[1]?(log.debug("Constraint added: "+e),r.constraints[e[0]]=new T(e[2])):">"===e[1]?(log.debug("Constraint added: "+e),r.constraints[e[0]]=new T(e[2])):"<"===e[1]?(log.debug("Constraint added: "+e),r.constraints[e[0]]=new T(e[2])):log.warn("I don't know how to handle the constraint: "+e)}function Q(e,r){log.debug("Optional query: "+e+" not yet implemented.");var t=n.formula();S(e,t),r.optional.push(t)}function S(e,r){var n,t=y(e);log.debug("WHERE: "+t);for(var o;m("OPTIONAL",t);)o=m("OPTIONAL",t),log.debug("OPT: "+o+" "+t[o]+" in "+t),"{"!==t[o+1]&&log.warn("Bad optional opening bracket in word "+o),n=E(t.slice(o+2),"{","}"),n===-1?log.error("No matching bracket in word "+o):(Q(t.slice(o+2,o+2+n),r),o=m("OPTIONAL",t),n=E(t.slice(o+2),"{","}"),t.splice(o,n+3));for(log.debug("WHERE after optionals: "+t);m("FILTER",t);){var i=m("FILTER",t);"("!==t[i+1]&&log.warn("Bad filter opening bracket in word "+i),n=E(t.slice(i+2),"(",")"),n===-1?log.error("No matching bracket in word "+i):(A(t.slice(i+2,i+2+n),r),i=m("FILTER",t),n=E(t.slice(i+2),"(",")"),t.splice(i,n+3))}log.debug("WHERE after filters and optionals: "+t),x(t,r)}function x(e,r){var n=new Array(1);n[0]=-1;for(var t=n.concat(b(".",e)),o=[],i=0;i<t.length-1;i++)o[i]=e.slice(t[i]+1,t[i+1]);for(i in o){log.info("s+p+o "+i+" = "+o[i]);var a=o[i][0];o[i].splice(0,1);var l=n.concat(b(";",o[i]));l.push(o[i].length);for(var c=[],s=0;s<l.length-1;s++)c[s]=o[i].slice(l[s]+1,l[s+1]);for(i in c){log.info("p+o "+i+" = "+o[i]);var f=c[i][0];c[i].splice(0,1);var u=n.concat(b(",",c[i]));u.push(c[i].length);var g=[];for(s=0;s<u.length-1;s++)g[s]=c[i].slice(u[s]+1,u[s+1]);for(i in g){var p=g[i][0];log.info("Subj="+a+" Pred="+f+" Obj="+p),r.add(a,f,p)}}}}var O=[];log.info("SPARQL input: \n"+e);var N=new Query,C=w(e),I=R(C);I.rdf||(I.rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"),I.rdfs||(I.rdfs="http://www.w3.org/2000/01/rdf-schema#");var k=m("SELECT",C),q=m("WHERE",C);if(k<0||q<0||k>q)return log.error("Invalid or nonexistent SELECT and WHERE tags in SPARQL query"),!1;if(L(C.slice(k+1,q),N),S(C.slice(q+2,C.length-1),N.pat),r)return N;for(var j in N.pat.statements){var H=N.pat.statements[j];"NamedNode"===H.subject.termType&&n.fetcher&&n.fetcher.lookUpThing(H.subject,"sparql:"+H.subject),"NamedNode"===H.object.termType&&n.fetcher&&n.fetcher.lookUpThing(H.object,"sparql:"+H.object)}return N}var log=require("./log"),Query=require("./query").Query;module.exports=SPARQLToQuery;
},{"./log":146,"./query":154}],160:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),Node=require("./node"),Statement=function(){function t(e,i,n,a){_classCallCheck(this,t),this.subject=Node.fromValue(e),this.predicate=Node.fromValue(i),this.object=Node.fromValue(n),this.why=a}return _createClass(t,[{key:"equals",value:function(t){return t.subject.equals(this.subject)&&t.predicate.equals(this.predicate)&&t.object.equals(this.object)&&t.graph.equals(this.graph)}},{key:"substitute",value:function(e){return new t(this.subject.substitute(e),this.predicate.substitute(e),this.object.substitute(e),this.why)}},{key:"toCanonical",value:function(){var t=[this.subject.toCanonical(),this.predicate.toCanonical(),this.object.toCanonical()];return this.graph&&"DefaultGraph"!==this.graph.termType&&t.push(this.graph.toCanonical()),t.join(" ")+" ."}},{key:"toNT",value:function(){return[this.subject.toNT(),this.predicate.toNT(),this.object.toNT()].join(" ")+" ."}},{key:"toString",value:function(){return this.toNT()}},{key:"graph",get:function(){return this.why},set:function(t){this.why=t}}]),t}();module.exports=Statement;
},{"./node":150}],161:[function(require,module,exports){
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},docpart=require("./uri").docpart,Fetcher=require("./fetcher"),graph=require("./data-factory").graph,IndexedFormula=require("./indexed-formula"),namedNode=require("./data-factory").namedNode,Namespace=require("./namespace"),Serializer=require("./serializer"),uriJoin=require("./uri").join,Util=require("./util"),UpdateManager=function(){var e=function(e){if(this.store=e,e.updater)throw new Error("You can't have two UpdateManagers for the same store");e.fetcher||new Fetcher(e),e.updater=this,this.ifps={},this.fps={},this.ns={},this.ns.link=Namespace("http://www.w3.org/2007/ont/link#"),this.ns.http=Namespace("http://www.w3.org/2007/ont/http#"),this.ns.httph=Namespace("http://www.w3.org/2007/ont/httph#"),this.ns.ldp=Namespace("http://www.w3.org/ns/ldp#"),this.ns.rdf=Namespace("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),this.ns.rdfs=Namespace("http://www.w3.org/2000/01/rdf-schema#"),this.ns.rdf=Namespace("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),this.ns.owl=Namespace("http://www.w3.org/2002/07/owl#"),this.patchControl=[]};return e.prototype.patchControlFor=function(e){return this.patchControl[e.uri]||(this.patchControl[e.uri]=[]),this.patchControl[e.uri]},e.prototype.editable=function(e,t){if(!e)return!1;if(t||(t=this.store),"file:///"===e.slice(0,8)){if(t.holds(t.sym(e),namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),namedNode("http://www.w3.org/2007/ont/link#MachineEditableDocument")))return"LOCALFILE";var n=t.statementsMatching(t.sym(e),void 0,void 0);return console.log("sparql.editable: Not MachineEditableDocument file "+e+"\n"),console.log(n.map(function(e){return e.toNT()}).join("\n")),!1}var o,r=!1,a=t.each(void 0,this.ns.link("requestedURI"),docpart(e));if(t.holds(namedNode(e),this.ns.rdf("type"),this.ns.ldp("Resource")))return"SPARQL";for(var s,i,l=0;l<a.length;l++)if(o=a[l],void 0!==o){var c=t.any(o,this.ns.link("response"));if(void 0!==o){var d=t.each(c,this.ns.httph("accept-patch"));if(d.length)for(s=0;s<d.length;s++)if(i=d[s].value.trim(),i.indexOf("application/sparql-update")>=0)return"SPARQL";var h=t.each(c,this.ns.httph("ms-author-via"));if(h.length)for(s=0;s<h.length;s++){if(i=h[s].value.trim(),i.indexOf("SPARQL")>=0)return"SPARQL";if(i.indexOf("DAV")>=0)return"DAV"}var u=t.each(c,this.ns.http("status"));if(u.length)for(s=0;s<u.length;s++)200!==u[s]&&404!==u[s]||(r=!0)}else console.log("sparql.editable: No response for "+e+"\n")}if(0===a.length)console.log("sparql.editable: No request for "+e+"\n");else if(r)return!1;console.log("sparql.editable: inconclusive for "+e+"\n")},e.prototype.anonymize=function(e){return"_:"===e.toNT().substr(0,2)&&this._mentioned(e)?"?"+e.toNT().substr(2):e.toNT()},e.prototype.anonymizeNT=function(e){return this.anonymize(e.subject)+" "+this.anonymize(e.predicate)+" "+this.anonymize(e.object)+" ."},e.prototype._statement_bnodes=function(e){return[e.subject,e.predicate,e.object].filter(function(e){return e.isBlank})},e.prototype._statement_array_bnodes=function(e){for(var t=[],n=0;n<e.length;n++)t=t.concat(this._statement_bnodes(e[n]));t.sort();for(var o=[],r=0;r<t.length;r++)0!==r&&t[r].sameTerm(t[r-1])||o.push(t[r]);return o},e.prototype._cache_ifps=function(){this.ifps={};for(var e=this.store.each(void 0,this.ns.rdf("type"),this.ns.owl("InverseFunctionalProperty")),t=0;t<e.length;t++)this.ifps[e[t].uri]=!0;for(this.fps={},e=this.store.each(void 0,this.ns.rdf("type"),this.ns.owl("FunctionalProperty")),t=0;t<e.length;t++)this.fps[e[t].uri]=!0},e.prototype._bnode_context2=function(e,t,n){for(var o,r,a=this.store.statementsMatching(void 0,void 0,e,t),s=0;s<a.length;s++)if(this.fps[a[s].predicate.uri]){if(o=a[s].subject,!o.isBlank)return[a[s]];if(n&&(r=this._bnode_context2(o,t,n-1)))return r.concat([a[s]])}for(a=this.store.statementsMatching(e,void 0,void 0,t),s=0;s<a.length;s++)if(this.ifps[a[s].predicate.uri]){if(o=a[s].object,!o.isBlank)return[a[s]];if(n&&(r=this._bnode_context2(o,t,n-1)))return r.concat([a[s]])}return null},e.prototype._bnode_context_1=function(e,t){for(var n=0;n<3;n++){var o=this._bnode_context2(e,t,n);if(null!==o)return o}throw new Error("Unable to uniquely identify bnode: "+e.toNT())},e.prototype._mentioned=function(e){return 0!==this.store.statementsMatching(e).length||0!==this.store.statementsMatching(void 0,e).length||0!==this.store.statementsMatching(void 0,void 0,e).length},e.prototype._bnode_context=function(e,t){var n=[];if(e.length){this._cache_ifps();for(var o=0;o<e.length;o++){var r=e[o];this._mentioned(r)&&(n=n.concat(this._bnode_context_1(r,t)))}}return n},e.prototype._statement_context=function(e){var t=this._statement_bnodes(e);return this._bnode_context(t,e.why)},e.prototype._context_where=function(e){var t=this;return e&&0!==e.length?"WHERE { "+e.map(function(e){return t.anonymizeNT(e)}).join("\n")+" }\n":""},e.prototype._fire=function(e,t,n){if(!e)throw new Error("No URI given for remote editing operation: "+t);console.log("sparql: sending update to <"+e+">");var o=Util.XMLHTTPFactory();o.options={},o.onreadystatechange=function(){if(4===o.readyState){var r=!o.status||o.status>=200&&o.status<300;r?console.log("sparql: update Ok for <"+e+">"):console.log("sparql: update failed for <"+e+"> status="+o.status+", "+o.statusText+", body length="+o.responseText.length+"\n   for query: "+t),n(e,r,o.responseText,o)}},o.open("PATCH",e,!0),o.setRequestHeader("Content-type","application/sparql-update"),o.send(t)},e.prototype.update_statement=function(e){if(!e||e.why){var t=this,n=this._statement_context(e);return{statement:e?[e.subject,e.predicate,e.object,e.why]:void 0,statementNT:e?this.anonymizeNT(e):void 0,where:t._context_where(n),set_object:function(e,n){var o=this.where;o+="DELETE DATA { "+this.statementNT+" } ;\n",o+="INSERT DATA { "+this.anonymize(this.statement[0])+" "+this.anonymize(this.statement[1])+" "+this.anonymize(e)+"  . }\n",t._fire(this.statement[3].uri,o,n)}}}},e.prototype.insert_statement=function(e,t){var n=e instanceof Array?e[0]:e,o=this._context_where(this._statement_context(n));if(e instanceof Array){for(var r="",a=0;a<e.length;a++)r+=e[a]+"\n";o+="INSERT DATA { "+r+" }\n"}else o+="INSERT DATA { "+this.anonymize(e.subject)+" "+this.anonymize(e.predicate)+" "+this.anonymize(e.object)+"  . }\n";this._fire(n.why.uri,o,t)},e.prototype.delete_statement=function(e,t){var n=e instanceof Array?e[0]:e,o=this._context_where(this._statement_context(n));if(e instanceof Array){for(var r="",a=0;a<e.length;a++)r+=e[a]+"\n";o+="DELETE DATA { "+r+" }\n"}else o+="DELETE DATA { "+this.anonymize(e.subject)+" "+this.anonymize(e.predicate)+" "+this.anonymize(e.object)+"  . }\n";this._fire(n.why.uri,o,t)},e.prototype.requestDownstreamAction=function(e,t){var n=this.patchControlFor(e);if(n.pendingUpstream){if(n.downstreamAction){if(n.downstreamAction===t)return;throw new Error("Can't wait for > 1 differnt downstream actions")}n.downstreamAction=t}else t(e)},e.prototype.clearUpstreamCount=function(e){var t=this.patchControlFor(e);t.upstreamCount=0},e.prototype.getUpdatesVia=function(e){var t=this.store.fetcher.getHeader(e,"updates-via");return t&&t.length?t[0].trim():null},e.prototype.addDownstreamChangeListener=function(e,t){var n=this.patchControlFor(e);n.downstreamChangeListeners||(n.downstreamChangeListeners=[]),n.downstreamChangeListeners.push(t);var o=this;this.setRefreshHandler(e,function(e){o.reloadAndSync(e)})},e.prototype.reloadAndSync=function(e){var t=this.patchControlFor(e),n=this;if(t.reloading)return void console.log("   Already reloading - stop");t.reloading=!0;var o=1e3,r=function r(){console.log("try reload - timeout = "+o),n.reload(n.store,e,function(n,a,s){if(t.reloading=!1,n){if(t.downstreamChangeListeners)for(var i=0;i<t.downstreamChangeListeners.length;i++)console.log("        Calling downstream listener "+i),t.downstreamChangeListeners[i]()}else 0===s.status?(console.log("Network error refreshing the data. Retrying in "+o/1e3),t.reloading=!0,o*=2,setTimeout(r,o)):console.log("Error "+s.status+"refreshing the data:"+a+". Stopped"+e)})};r()},e.prototype.setRefreshHandler=function(e,t){var n=this.getUpdatesVia(e),o=t,r=this,a=this,s=1500,i=0;if(!n)return console.log("Server doies not support live updates thoughUpdates-Via :-("),!1;n=uriJoin(n,e.uri),n=n.replace(/^http:/,"ws:").replace(/^https:/,"wss:"),console.log("Web socket URI "+n);var l=function t(){var l;if("undefined"!=typeof WebSocket)l=new WebSocket(n);else if("undefined"!=typeof Services)l=Services.wm.getMostRecentWindow("navigator:browser").WebSocket(n);else{if("undefined"==typeof window||!window.WebSocket)return void console.log("Live update disabled, as WebSocket not supported by platform :-(");l=window.WebSocket(n)}l.onopen=function(){console.log("    websocket open"),s=1500,this.send("sub "+e.uri),i&&(console.log("Web socket has been down, better check for any news."),a.requestDownstreamAction(e,o))};var c=r.patchControlFor(e);c.upstreamCount=0,l.onclose=function(e){console.log("*** Websocket closed with code "+e.code+", reason '"+e.reason+"' clean = "+e.clean),s*=2,i+=1,console.log("Retrying in "+s+"ms"),setTimeout(function(){console.log("Trying websocket again"),t()},s)},l.onmessage=function(t){if(t.data&&"pub"===t.data.slice(0,3)){if("upstreamCount"in c&&(c.upstreamCount-=1,c.upstreamCount>=0))return void console.log("just an echo: "+c.upstreamCount);console.log("Assume a real downstream change: "+c.upstreamCount+" -> 0"),c.upstreamCount=0,r.requestDownstreamAction(e,o)}}};return l(),!0},e.prototype.update=function(e,t,n){try{var o=this.store,r=e?e instanceof IndexedFormula?e.statements:e instanceof Array?e:[e]:[],a=t?t instanceof IndexedFormula?t.statements:t instanceof Array?t:[t]:[];if(!(r instanceof Array))throw new Error("Type Error "+("undefined"==typeof r?"undefined":_typeof(r))+": "+r);if(!(a instanceof Array))throw new Error("Type Error "+("undefined"==typeof a?"undefined":_typeof(a))+": "+a);if(0===r.length&&0===a.length)return n(null,!0);var s=r.length?r[0].why:a[0].why,i=this.patchControlFor(s),l=Date.now(),c=["subject","predicate","object","why"],d=["insert","delete"],h={delete:r,insert:a};d.map(function(e){h[e].map(function(e){if(!s.sameTerm(e.why))throw new Error("update: destination "+s+" inconsistent with delete quad "+e.why);c.map(function(t){if("undefined"==typeof e[t])throw new Error("update: undefined "+t+" of statement.")})})});var u=this.editable(s.uri,o);if(!u)throw new Error("Can't make changes in uneditable "+s);var p,f,m,g;if(u.indexOf("SPARQL")>=0){var w=[];r.length&&(w=this._statement_array_bnodes(r)),a.length&&(w=w.concat(this._statement_array_bnodes(a)));var y=this._bnode_context(w,s),v=this._context_where(y),_="";if(v.length){if(r.length){for(_+="DELETE { ",p=0;p<r.length;p++)_+=this.anonymizeNT(r[p])+"\n";_+=" }\n"}if(a.length){for(_+="INSERT { ",p=0;p<a.length;p++)_+=this.anonymizeNT(a[p])+"\n";_+=" }\n"}_+=v}else{if(r.length){for(_+="DELETE DATA { ",p=0;p<r.length;p++)_+=this.anonymizeNT(r[p])+"\n";_+=" } \n"}if(a.length){for(r.length&&(_+=" ; "),_+="INSERT DATA { ",p=0;p<a.length;p++)_+=this.anonymizeNT(a[p])+"\n";_+=" }\n"}}i.pendingUpstream=i.pendingUpstream?i.pendingUpstream+1:1,"upstreamCount"in i&&(i.upstreamCount+=1,console.log("upstream count up to : "+i.upstreamCount)),this._fire(s.uri,_,function(e,t,c,d){if(d.elapsedTime_ms=Date.now()-l,console.log("    sparql: Return "+(t?"success":"FAILURE "+d.status)+" elapsed "+d.elapsedTime_ms+"ms"),t){try{o.remove(r)}catch(e){t=!1,c="Remote Ok BUT error deleting "+r.length+" from store!!! "+e}for(var h=0;h<a.length;h++)o.add(a[h].subject,a[h].predicate,a[h].object,s)}if(n(e,t,c,d),i.pendingUpstream-=1,0===i.pendingUpstream&&i.downstreamAction){var u=i.downstreamAction;delete i.downstreamAction,console.log("delayed downstream action:"),u(s)}})}else if(u.indexOf("DAV")>=0){var T=o.any(s,this.ns.link("request"));if(!T)throw new Error("No record of our HTTP GET request for document: "+s);var b=o.any(T,this.ns.link("response"));if(!b)return null;var E=o.the(b,this.ns.httph("content-type")).value;for(f=o.statementsMatching(void 0,void 0,void 0,s).slice(),p=0;p<r.length;p++)Util.RDFArrayRemove(f,r[p]);for(p=0;p<a.length;p++)f.push(a[p]);switch(g=Serializer(o),g.suggestNamespaces(o.namespaces),g.setBase(s.uri),E){case"application/rdf+xml":m=g.statementsToXML(f);break;case"text/n3":case"text/turtle":case"application/x-turtle":case"application/n3":m=g.statementsToN3(f);break;default:throw new Error("Content-type "+E+" not supported for data write")}var x,A=o.the(b,this.ns.httph("content-location"));A&&(x=uriJoin(A.value,x));var C=Util.XMLHTTPFactory();C.options={},C.onreadystatechange=function(){if(4===C.readyState){var e=!C.status||C.status>=200&&C.status<300;if(e){for(var t=0;t<r.length;t++)o.remove(r[t]);for(t=0;t<a.length;t++)o.add(a[t].subject,a[t].predicate,a[t].object,s)}n(s.uri,e,C.responseText)}},C.open("PUT",x,!0),C.setRequestHeader("Content-type",E),C.send(m)}else{if(!(u.indexOf("LOCALFILE")>=0))throw new Error("Unhandled edit method: '"+u+"' for "+s);try{for(console.log("Writing back to local file\n"),f=o.statementsMatching(void 0,void 0,void 0,s).slice(),p=0;p<r.length;p++)Util.RDFArrayRemove(f,r[p]);for(p=0;p<a.length;p++)f.push(a[p]);g=Serializer(o),g.suggestNamespaces(o.namespaces),g.setBase(s.uri);var N=s.uri.lastIndexOf(".");if(N<1)throw new Error("Rewriting file: No filename extension: "+s.uri);var R=s.uri.slice(N+1);switch(R){case"rdf":case"owl":case"xml":m=g.statementsToXML(f);break;case"n3":case"nt":case"ttl":m=g.statementsToN3(f);break;default:throw new Error("File extension ."+R+" not supported for data write")}console.log("Writing back: <<<"+m+">>>");var k=s.uri.slice(7),S=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);if(S.initWithPath(k),!S.exists())throw new Error("Rewriting file <"+s.uri+"> but it does not exist!");var q=Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);for(q.init(S,42,parseInt("0666",8),0),q.write(m,m.length),q.close(),p=0;p<r.length;p++)o.remove(r[p]);for(p=0;p<a.length;p++)o.add(a[p].subject,a[p].predicate,a[p].object,s);n(s.uri,!0,"")}catch(e){n(s.uri,!1,"Exception trying to write back file <"+s.uri+">\n")}}}catch(e){n(void 0,!1,"Exception in update: "+e)}},e.prototype.put=function(e,t,n,o){var r,a=this.store;if(("undefined"==typeof t?"undefined":_typeof(t))===_typeof(""))r=t;else{var s=Serializer(a);switch(s.suggestNamespaces(a.namespaces),s.setBase(e.uri),n){case"application/rdf+xml":r=s.statementsToXML(t);break;case"text/n3":case"text/turtle":case"application/x-turtle":case"application/n3":r=s.statementsToN3(t);break;default:throw new Error("Content-type "+n+" not supported for data PUT")}}var i=Util.XMLHTTPFactory();i.options={},i.onreadystatechange=function(){if(4===i.readyState){var n=!i.status||i.status>=200&&i.status<300;n&&"string"!=typeof t&&t.map(function(e){a.addStatement(e)}),n&&(delete a.fetcher.nonexistant[e.uri],delete a.fetcher.requested[e.uri]),o(e.uri,n,i.responseText,i)}},i.open("PUT",e.uri,!0),i.setRequestHeader("Content-type",n),i.send(r)},e.prototype.reload=function(e,t,n){var o=Date.now();e.fetcher.nowOrWhenFetched(t.uri,{force:!0,noMeta:!0,clearPreviousData:!0},function(e,r,a){if(e)if(a.onErrorWasCalled||200!==a.status)console.log("    Non-HTTP error reloading data! onErrorWasCalled="+a.onErrorWasCalled+" status: "+a.status),n(!1,"Non-HTTP error reloading data: "+r,a);else{var s=Date.now()-o;t.reloadTime_total||(t.reloadTime_total=0),t.reloadTime_count||(t.reloadTime_count=0),t.reloadTime_total+=s,t.reloadTime_count+=1,console.log("    Fetch took "+s+"ms, av. of "+t.reloadTime_count+" = "+t.reloadTime_total/t.reloadTime_count+"ms."),n(!0)}else console.log("    ERROR reloading data: "+r),n(!1,"Error reloading data: "+r,a)})},e.prototype.oldReload=function(e,t,n){var o=graph(),r=fetcher(o),a=Date.now();r.nowOrWhenFetched(t.uri,{force:!0,noMeta:!0,clearPreviousData:!0},function(r,s,i){if(r)if(i.onErrorWasCalled||200!==i.status)console.log("    Non-HTTP error reloading data! onErrorWasCalled="+i.onErrorWasCalled+" status: "+i.status),n(!1,"Non-HTTP error reloading data: "+s,i);else{var l=e.statementsMatching(void 0,void 0,void 0,t).slice(),c=o.statementsMatching(void 0,void 0,void 0,t).slice();console.log("    replacing "+l.length+" with "+c.length+" out of total statements "+e.statements.length),e.remove(l),e.add(c);var d=Date.now()-a;0===c.length&&console.log("????????????????? 0000000"),t.reloadTime_total||(t.reloadTime_total=0),t.reloadTime_count||(t.reloadTime_count=0),t.reloadTime_total+=d,t.reloadTime_count+=1,console.log("    fetch took "+d+"ms, av. of "+t.reloadTime_count+" = "+t.reloadTime_total/t.reloadTime_count+"ms."),n(!0)}else console.log("    ERROR reloading data: "+s),n(!1,"Error reloading data: "+s,i)})},e}();module.exports=UpdateManager;
},{"./data-factory":137,"./fetcher":140,"./indexed-formula":143,"./namespace":149,"./serializer":158,"./uri":163,"./util":164}],162:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),namedNode=require("./data-factory").namedNode,UpdatesSocket=function(){function e(t,n){_classCallCheck(this,e),this.parent=t,this.via=n,this.connected=!1,this.pending={},this.subscribed={},this.socket={};try{this.socket=new WebSocket(n),this.socket.onopen=this.onOpen,this.socket.onclose=this.onClose,this.socket.onmessage=this.onMessage,this.socket.onerror=this.onError}catch(e){this.onError(e)}}return _createClass(e,[{key:"_decode",value:function(e){var t,n,s,i,r,o,a;i={},r=function(){var n,s,i,r;for(i=e.split("&"),r=[],n=0,s=i.length;n<s;n++)t=i[n],r.push(t.split("="));return r}();for(n in r)t=r[n],o=[decodeURIComponent(t[0]),decodeURIComponent(t[1])],s=o[0],a=o[1],null==i[s]&&(i[s]=[]),i[s].push(a);return i}},{key:"_send",value:function(e,t,n){var s,i;return i=[e,t,n].join(" "),"function"==typeof(s=this.socket).send?s.send(i):void 0}},{key:"_subscribe",value:function(e){return this._send("sub",e,""),this.subscribed[e]=!0,this.subscribed[e]}},{key:"onClose",value:function(e){var t;this.connected=!1;for(t in this.subscribed)this.pending[t]=!0;return this.subscribed={},this.subscribed}},{key:"onError",value:function(e){throw new Error("onError"+e)}},{key:"onMessage",value:function(e){var t,n;return n=e.data.split(" "),"ping"===n[0]?"function"==typeof(t=this.socket).send?t.send("pong "+n.slice(1).join(" ")):void 0:"pub"===n[0]?this.parent.onUpdate(n[1],this._decode(n[2])):void 0}},{key:"onOpen",value:function(e){var t,n;this.connected=!0,t=[];for(n in this.pending)delete this.pending[n],t.push(this._subscribe(n));return t}},{key:"subscribe",value:function(e){return this.connected?this._subscribe(e):(this.pending[e]=!0,this.pending[e])}}]),e}(),UpdatesVia=function(){function e(t){_classCallCheck(this,e),this.fetcher=t,this.graph={},this.via={},this.fetcher.addCallback("headers",this.onHeaders)}return _createClass(e,[{key:"onHeaders",value:function(e){var t,n,s;return null==e.headers||("undefined"==typeof WebSocket||null===WebSocket||(t=e.headers.etag,s=e.headers["updates-via"],n=e.uri,t&&s&&(this.graph[n]={etag:t,via:s},this.register(s,n)),!0))}},{key:"onUpdate",value:function(e,t){return this.fetcher.refresh(namedNode(e))}},{key:"register",value:function(e,t){return null==this.via[e]&&(this.via[e]=new UpdatesSocket(this,e)),this.via[e].subscribe(t)}}]),e}();module.exports.UpdatesSocket=UpdatesSocket,module.exports.UpdatesVia=UpdatesVia;
},{"./data-factory":137}],163:[function(require,module,exports){
"use strict";function docpart(e){var r;return r=e.indexOf("#"),r<0?e:e.slice(0,r)}function document(e){return namedNode(docpart(e.uri))}function hostpart(e){var r=/[^\/]*\/\/([^\/]*)\//.exec(e);return r?r[1]:""}function join(e,r){var n,t,i,o,f,l,u=r.indexOf("#");if(u>0&&(r=r.slice(0,u)),0===e.length)return r;if(0===e.indexOf("#"))return r+e;if(o=e.indexOf(":"),o>=0)return e;if(n=r.indexOf(":"),0===r.length)return e;if(n<0)return alert("Invalid base: "+r+" in join with given: "+e),e;if(t=r.slice(0,+n+1||9e9),0===e.indexOf("//"))return t+e;if(r.indexOf("//",n)===n+1){if(i=r.indexOf("/",n+3),i<0)return r.length-n-3>0?r+"/"+e:t+e}else if(i=r.indexOf("/",n+1),i<0)return r.length-n-1>0?r+"/"+e:t+e;if(0===e.indexOf("/"))return r.slice(0,i)+e;if(l=r.slice(i),f=l.lastIndexOf("/"),f<0)return t+e;for(f>=0&&f<l.length-1&&(l=l.slice(0,+f+1||9e9)),l+=e;l.match(/[^\/]*\/\.\.\//);)l=l.replace(/[^\/]*\/\.\.\//,"");return l=l.replace(/\.\//g,""),l=l.replace(/\/\.$/,"/"),r.slice(0,i)+l}function protocol(e){var r;return r=e.indexOf(":"),r<0?null:e.slice(0,r)}function refTo(e,r){var n,t,i,o,f,l,u,c,d,a,s,x,p,O=new RegExp("^[-_a-zA-Z0-9.]+:(//[^/]*)?/[^/]*$");if(!e)return r;if(e===r)return"";for(t=c=0,f=r.length;c<f&&(n=r[t],n===e[t]);t=++c);if(e.slice(0,t).match(O)&&(i=r.indexOf("//"),i<0&&(i=-2),o=r.indexOf("/",i+2),"/"!==r[o+1]&&"/"!==e[o+1]&&r.slice(0,o)===e.slice(0,o)))return r.slice(o);if("#"===r[t]&&e.length===t)return r.slice(t);for(;t>0&&"/"!==r[t-1];)t--;if(t<3)return r;if(e.indexOf("//",t-2)>0||r.indexOf("//",t-2)>0)return r;if(e.indexOf(":",t)>0)return r;for(u=0,s=e.slice(t),d=0,l=s.length;d<l;d++)n=s[d],"/"===n&&u++;if(0===u&&t<r.length&&"#"===r[t])return"./"+r.slice(t);if(0===u&&t===r.length)return"./";if(p="",u>0)for(a=1,x=u;x>=1?a<=x:a>=x;x>=1?++a:--a)p+="../";return p+r.slice(t)}var alert=alert||console.log;module.exports.docpart=docpart,module.exports.document=document,module.exports.hostpart=hostpart,module.exports.join=join,module.exports.protocol=protocol,module.exports.refTo=refTo;var namedNode=require("./data-factory").namedNode;
},{"./data-factory":137}],164:[function(require,module,exports){
"use strict";function ajarHandleNewTerm(e,t,r){var a=null;if("undefined"!=typeof e.fetcher&&(a=e.fetcher,"NamedNode"===t.termType)){var o,n=docpart(t.uri);if(t.uri.indexOf("#")<0){if(stringStartsWith(t.uri,"http://dbpedia.org/resource/Category:"))return;stringStartsWith(t.uri,"http://purl.org/dc/elements/1.1/")||stringStartsWith(t.uri,"http://purl.org/dc/terms/")?o="http://dublincore.org/2005/06/13/dcq":stringStartsWith(t.uri,"http://xmlns.com/wot/0.1/")?o="http://xmlns.com/wot/0.1/index.rdf":stringStartsWith(t.uri,"http://web.resource.org/cc/")&&(o="http://web.resource.org/cc/schema.rdf")}o&&(n=o),a&&"unrequested"!==a.getState(n)||(o&&log.warn("Assuming server still broken, faking redirect of <"+t.uri+"> to <"+n+">"),a.requestURI(n,r))}}function arrayIndexOf(e,t,r){r||(r=0);var a=e.length;for(r<0&&(r=a+r);r<a;r++)if(e[r]===t)return r;return-1}function callbackify(e,t){e.callbacks={};for(var r=t.length-1;r>=0;r--)e.callbacks[t[r]]=[];e.addHook=function(t){e.callbacks[t]||(e.callbacks[t]=[])},e.addCallback=function(t,r){e.callbacks[t].push(r)},e.removeCallback=function(t,r){for(var a=0;a<e.callbacks[t].length;a++)if(e.callbacks[t][a].name===r)return e.callbacks[t].splice(a,1),!0;return!1},e.insertCallback=function(t,r){e.callbacks[t].unshift(r)},e.fireCallbacks=function(t,r){var a,o=[],n=[],s=e.callbacks[t].length;for(a=s-1;a>=0;a--)e.callbacks[t][a].apply(e,r)&&o.push(e.callbacks[t][a]);for(a=o.length-1;a>=0;a--)n.push(o[a]);for(a=s;a<e.callbacks[t].length;a++)n.push(e.callbacks[t][a]);e.callbacks[t]=n}}function domParser(){return tabulator&&tabulator.isExtension?Components.classes["@mozilla.org/xmlextras/domparser;1"].getService(Components.interfaces.nsIDOMParser):window.DOMParser?new DOMParser:!!window.ActiveXObject&&new ActiveXObject("Microsoft.XMLDOM")}function domToString(e,t){t=t||{};var r=[];"selfClosing"in t&&t.selfClosing.split(" ").forEach(function(e){r[e]=!0});var a=[];return"skipAttributes"in t&&t.skipAttributes.split(" ").forEach(function(e){a[e]=!0}),dumpNode(e,t,r,a)}function dumpNode(e,t,r,a){var o,n="",s=[!1];if("undefined"==typeof e.nodeType)return n;if(1===e.nodeType){if(e.hasAttribute("class")&&"classWithChildText"in t&&e.matches(t.classWithChildText.class))n+=e.querySelector(t.classWithChildText.element).textContent;else if(!("skipNodeWithClass"in t&&e.matches("."+t.skipNodeWithClass))){var i=e.nodeName.toLowerCase();n+="<"+i;var l=[];for(o=e.attributes.length-1;o>=0;o--){var c=e.attributes[o];if(!(a.length>0&&a[c.name]||/^\d+$/.test(c.name))){if("class"===c.name&&"replaceClassItemWith"in t&&c.value.split(" ").indexOf(t.replaceClassItemWith.source)>-1){var u=new RegExp(t.replaceClassItemWith.source,"g");c.value=c.value.replace(u,t.replaceClassItemWith.target).trim()}"class"===c.name&&"skipClassWithValue"in t&&t.skipClassWithValue===c.value||l.push(c.name+"='"+c.value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&quot;")+"'")}}if(l.length>0&&("sortAttributes"in t&&t.sortAttributes&&l.sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}),n+=" "+l.join(" ")),r[i])n+=" />";else{for(n+=">",n+="html"===i?"\n  ":"",s.push("style"===i||"script"===i),o=0;o<e.childNodes.length;o++)n+=dumpNode(e.childNodes[o]);s.pop(),n+="body"===i?"</"+i+">\n":"</"+i+">"}}}else if(8===e.nodeType)n+="<!--"+e.nodeValue+"-->";else if(3===e.nodeType||4===e.nodeType){var p=e.nodeValue.replace(/\n+$/,"");n+=s[s.length-1]?p:p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}else console.log("Warning; Cannot handle serialising nodes of type: "+e.nodeType),console.log(e);return n}function dtstamp(){var e=new Date,t=e.getYear()+1900,r=e.getMonth()+1,a=e.getDate(),o=e.getUTCHours(),n=e.getUTCMinutes(),s=e.getSeconds();return r<10&&(r="0"+r),a<10&&(a="0"+a),o<10&&(o="0"+o),n<10&&(n="0"+n),s<10&&(s="0"+s),t+"-"+r+"-"+a+"T"+o+":"+n+":"+s+"Z"}function getHTTPHeaders(e){for(var t,r=e.getAllResponseHeaders().split("\n"),a={},o=0;o<r.length;o++)if(r[o].length>0){var n=r[o].split(": ");"undefined"==typeof n[1]?a[t]+="\n"+n[0]:(t=n[0].toLowerCase(),a[t]=n[1])}return a}function heavyCompare(e,t,r){var a=function(e){return"BlankNode"===e.termType?null:e},o=function(t){var o=r.statementsMatching(e).map(function(e){return""+a(e.subject)+" "+a(e.predicate)+" "+a(e.object)}).concat(r.statementsMatching(void 0,void 0,e).map(function(e){return""+a(e.subject)+" "+a(e.predicate)+" "+a(e.object)}));return o.sort(),o.join("\n")};return"BlankNode"===e.termType||"BlankNode"===t.termType?0===e.compareTerm(t)?0:o(e)>o(t)?1:o(e)<o(t)?-1:e.compareTerm(t):e.compareTerm(t)}function heavyCompareSPO(e,t,r){var a=heavyCompare(e.subject,t.subject,r);return a?a:(a=heavyCompare(e.predicate,t.predicate,r),a?a:heavyCompare(e.object,t.object,r))}function output(e){var t=document.createElement("div");t.textContent=e,document.body.appendChild(t)}function parseXML(e,t){var r;if(t=t||{},"undefined"!=typeof tabulator&&tabulator.isExtension)r=Components.classes["@mozilla.org/xmlextras/domparser;1"].getService(Components.interfaces.nsIDOMParser);else{if("undefined"!=typeof module&&module&&module.exports){var a=require("xmldom").DOMParser,o=(new a).parseFromString(e,t.contentType||"application/xhtml+xml");return o}r="undefined"!=typeof window&&window.DOMParser?new window.DOMParser:new a}return r.parseFromString(e,"application/xml")}function rdfArrayRemove(e,t){for(var r=0;r<e.length;r++)if(e[r].subject.sameTerm(t.subject)&&e[r].predicate.sameTerm(t.predicate)&&e[r].object.sameTerm(t.object)&&e[r].why.sameTerm(t.why))return void e.splice(r,1);throw new Error("RDFArrayRemove: Array did not contain "+t+" "+t.why)}function stringStartsWith(e,t){return e.slice(0,t.length)===t}function stringTemplate(e,t){for(var r=e.split("%s"),a="",o=0;o<t.length;o++)t[o]+="",a+=r[o]+t[o];return a+r.slice(t.length).join()}function xhr(){var e;if("undefined"!=typeof tabulator&&tabulator.isExtension)return Components.classes["@mozilla.org/xmlextras/xmlhttprequest;1"].createInstance().QueryInterface(Components.interfaces.nsIXMLHttpRequest);if("undefined"!=typeof window&&"XMLHttpRequest"in window)return new(e=window.XMLHttpRequest);if("undefined"!=typeof module&&module&&module.exports)return new(e=require("xmlhttprequest").XMLHttpRequest);if(!window.ActiveXObject)return!1;try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){return new ActiveXObject("Microsoft.XMLHTTP")}}var docpart=require("./uri").docpart,log=require("./log");module.exports.AJAR_handleNewTerm=ajarHandleNewTerm,module.exports.ArrayIndexOf=arrayIndexOf,module.exports.callbackify=callbackify,module.exports.dtstamp=dtstamp,module.exports.DOMParserFactory=domParser,module.exports.domToString=domToString,module.exports.dumpNode=dumpNode,module.exports.getHTTPHeaders=getHTTPHeaders,module.exports.heavyCompare=heavyCompare,module.exports.heavyCompareSPO=heavyCompareSPO,module.exports.output=output,module.exports.parseXML=parseXML,module.exports.RDFArrayRemove=rdfArrayRemove,module.exports.string_startswith=stringStartsWith,module.exports.string={},module.exports.string.template=stringTemplate,module.exports.uri=require("./uri"),module.exports.XMLHTTPFactory=xhr,module.exports.log=log,module.exports.mediaTypeClass=function(e){return $rdf.sym("http://www.w3.org/ns/iana/media-types/"+e+"#Resource")};
},{"./log":146,"./uri":163,"xmldom":243,"xmlhttprequest":246}],165:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),ClassOrder=require("./class-order"),Node=require("./node"),Uri=require("./uri"),Variable=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];_classCallCheck(this,t);var r=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return r.termType=t.termType,r.value=e,r.base="varid:",r.uri=Uri.join(e,r.base),r}return _inherits(t,e),_createClass(t,[{key:"equals",value:function(e){return!!e&&(this.termType===e.termType&&this.value===e.value)}},{key:"hashString",value:function(){return this.toString()}},{key:"substitute",value:function(e){var t;return null!=(t=e[this.toNT()])?t:this}},{key:"toString",value:function(){return this.uri.slice(0,this.base.length)===this.base?"?"+this.uri.slice(this.base.length):"?"+this.uri}}]),t}(Node);Variable.termType="Variable",Variable.prototype.classOrder=ClassOrder.Variable,Variable.prototype.isVar=1,module.exports=Variable;
},{"./class-order":134,"./node":150,"./uri":163}],166:[function(require,module,exports){
"use strict";function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}var NamedNode=require("./named-node"),XSD=function e(){_classCallCheck(this,e)};XSD.boolean=new NamedNode("http://www.w3.org/2001/XMLSchema#boolean"),XSD.dateTime=new NamedNode("http://www.w3.org/2001/XMLSchema#dateTime"),XSD.decimal=new NamedNode("http://www.w3.org/2001/XMLSchema#decimal"),XSD.float=new NamedNode("http://www.w3.org/2001/XMLSchema#float"),XSD.integer=new NamedNode("http://www.w3.org/2001/XMLSchema#integer"),XSD.langString=new NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),XSD.string=new NamedNode("http://www.w3.org/2001/XMLSchema#string"),module.exports=XSD;
},{"./named-node":148}],167:[function(require,module,exports){
module.exports=require("./lib/_stream_duplex.js");
},{"./lib/_stream_duplex.js":168}],168:[function(require,module,exports){
"use strict";function Duplex(e){return this instanceof Duplex?(Readable.call(this,e),Writable.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",onend)):new Duplex(e)}function onend(){this.allowHalfOpen||this._writableState.ended||processNextTick(onEndNT,this)}function onEndNT(e){e.end()}function forEach(e,t){for(var r=0,i=e.length;r<i;r++)t(e[r],r)}var objectKeys=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};module.exports=Duplex;var processNextTick=require("process-nextick-args"),util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}
},{"./_stream_readable":170,"./_stream_writable":172,"core-util-is":50,"inherits":97,"process-nextick-args":119}],169:[function(require,module,exports){
"use strict";function PassThrough(r){return this instanceof PassThrough?void Transform.call(this,r):new PassThrough(r)}module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(r,s,i){i(null,r)};
},{"./_stream_transform":171,"core-util-is":50,"inherits":97}],170:[function(require,module,exports){
(function (process){
"use strict";function prependListener(e,t,r){return"function"==typeof e.prependListener?e.prependListener(t,r):void(e._events&&e._events[t]?isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r))}function ReadableState(e,t){Duplex=Duplex||require("./_stream_duplex"),e=e||{},this.objectMode=!!e.objectMode,t instanceof Duplex&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){return Duplex=Duplex||require("./_stream_duplex"),this instanceof Readable?(this._readableState=new ReadableState(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),void Stream.call(this)):new Readable(e)}function readableAddChunk(e,t,r,n,a){var i=chunkInvalid(t,r);if(i)e.emit("error",i);else if(null===r)t.reading=!1,onEofChunk(e,t);else if(t.objectMode||r&&r.length>0)if(t.ended&&!a){var d=new Error("stream.push() after EOF");e.emit("error",d)}else if(t.endEmitted&&a){var o=new Error("stream.unshift() after end event");e.emit("error",o)}else{var u;!t.decoder||a||n||(r=t.decoder.write(r),u=!t.objectMode&&0===r.length),a||(t.reading=!1),u||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,a?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&emitReadable(e))),maybeReadMore(e,t)}else a||(t.reading=!1);return needMoreData(t)}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function computeNewHighWaterMark(e){return e>=MAX_HWM?e=MAX_HWM:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function howMuchToRead(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=computeNewHighWaterMark(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function chunkInvalid(e,t){var r=null;return Buffer.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function onEofChunk(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,emitReadable(e)}}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?processNextTick(emitReadable_,e):emitReadable_(e))}function emitReadable_(e){debug("emit readable"),e.emit("readable"),flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,processNextTick(maybeReadMore_,e,t))}function maybeReadMore_(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EElistenerCount(e,"data")&&(t.flowing=!0,flow(e))}}function nReadingNextTick(e){debug("readable nexttick read 0"),e.read(0)}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,processNextTick(resume_,e,t))}function resume_(e,t){t.reading||(debug("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;for(debug("flow",t.flowing);t.flowing&&null!==e.read(););}function fromList(e,t){if(0===t.length)return null;var r;return t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=fromListPartial(e,t.buffer,t.decoder),r}function fromListPartial(e,t,r){var n;return e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?copyFromBufferString(e,t):copyFromBuffer(e,t),n}function copyFromBufferString(e,t){var r=t.head,n=1,a=r.data;for(e-=a.length;r=r.next;){var i=r.data,d=e>i.length?i.length:e;if(a+=d===i.length?i:i.slice(0,e),e-=d,0===e){d===i.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=i.slice(d));break}++n}return t.length-=n,a}function copyFromBuffer(e,t){var r=bufferShim.allocUnsafe(e),n=t.head,a=1;for(n.data.copy(r),e-=n.data.length;n=n.next;){var i=n.data,d=e>i.length?i.length:e;if(i.copy(r,r.length-e,0,d),e-=d,0===e){d===i.length?(++a,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=i.slice(d));break}++a}return t.length-=a,r}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,processNextTick(endReadableNT,t,e))}function endReadableNT(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function forEach(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}function indexOf(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}module.exports=Readable;var processNextTick=require("process-nextick-args"),isArray=require("isarray"),Duplex;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter,EElistenerCount=function(e,t){return e.listeners(t).length},Stream;!function(){try{Stream=require("stream")}catch(e){}finally{Stream||(Stream=require("events").EventEmitter)}}();var Buffer=require("buffer").Buffer,bufferShim=require("buffer-shims"),util=require("core-util-is");util.inherits=require("inherits");var debugUtil=require("util"),debug=void 0;debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){};var BufferList=require("./internal/streams/BufferList"),StringDecoder;util.inherits(Readable,Stream),Readable.prototype.push=function(e,t){var r=this._readableState;return r.objectMode||"string"!=typeof e||(t=t||r.defaultEncoding,t!==r.encoding&&(e=bufferShim.from(e,t),t="")),readableAddChunk(this,r,e,t,!1)},Readable.prototype.unshift=function(e){var t=this._readableState;return readableAddChunk(this,t,e,"",!0)},Readable.prototype.isPaused=function(){return this._readableState.flowing===!1},Readable.prototype.setEncoding=function(e){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e,this};var MAX_HWM=8388608;Readable.prototype.read=function(e){debug("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(e=howMuchToRead(e,t),0===e&&t.ended)return 0===t.length&&endReadable(this),null;var n=t.needReadable;debug("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&(n=!0,debug("length less than watermark",n)),t.ended||t.reading?(n=!1,debug("reading or ended",n)):n&&(debug("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=howMuchToRead(r,t)));var a;return a=e>0?fromList(e,t):null,null===a?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&endReadable(this)),null!==a&&this.emit("data",a),a},Readable.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},Readable.prototype.pipe=function(e,t){function r(e){debug("onunpipe"),e===s&&a()}function n(){debug("onend"),e.end()}function a(){debug("cleanup"),e.removeListener("close",o),e.removeListener("finish",u),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",r),s.removeListener("end",n),s.removeListener("end",a),s.removeListener("data",i),g=!0,!h.awaitDrain||e._writableState&&!e._writableState.needDrain||c()}function i(t){debug("ondata"),b=!1;var r=e.write(t);!1!==r||b||((1===h.pipesCount&&h.pipes===e||h.pipesCount>1&&indexOf(h.pipes,e)!==-1)&&!g&&(debug("false write response, pause",s._readableState.awaitDrain),s._readableState.awaitDrain++,b=!0),s.pause())}function d(t){debug("onerror",t),l(),e.removeListener("error",d),0===EElistenerCount(e,"error")&&e.emit("error",t)}function o(){e.removeListener("finish",u),l()}function u(){debug("onfinish"),e.removeListener("close",o),l()}function l(){debug("unpipe"),s.unpipe(e)}var s=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=e;break;case 1:h.pipes=[h.pipes,e];break;default:h.pipes.push(e)}h.pipesCount+=1,debug("pipe count=%d opts=%j",h.pipesCount,t);var f=(!t||t.end!==!1)&&e!==process.stdout&&e!==process.stderr,p=f?n:a;h.endEmitted?processNextTick(p):s.once("end",p),e.on("unpipe",r);var c=pipeOnDrain(s);e.on("drain",c);var g=!1,b=!1;return s.on("data",i),prependListener(e,"error",d),e.once("close",o),e.once("finish",u),e.emit("pipe",s),h.flowing||(debug("pipe resume"),s.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<n;a++)r[a].emit("unpipe",this);return this}var i=indexOf(t.pipes,e);return i===-1?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Readable.prototype.on=function(e,t){var r=Stream.prototype.on.call(this,e,t);if("data"===e)this._readableState.flowing!==!1&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&emitReadable(this,n):processNextTick(nReadingNextTick,this))}return r},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug("resume"),e.flowing=!0,resume(this,e)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;e.on("end",function(){if(debug("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(a){if(debug("wrapped data"),t.decoder&&(a=t.decoder.write(a)),(!t.objectMode||null!==a&&void 0!==a)&&(t.objectMode||a&&a.length)){var i=n.push(a);i||(r=!0,e.pause())}});for(var a in e)void 0===this[a]&&"function"==typeof e[a]&&(this[a]=function(t){return function(){return e[t].apply(e,arguments)}}(a));var i=["error","close","destroy","pause","resume"];return forEach(i,function(t){e.on(t,n.emit.bind(n,t))}),n._read=function(t){debug("wrapped _read",t),r&&(r=!1,e.resume())},n},Readable._fromList=fromList;
}).call(this,require('_process'))

},{"./_stream_duplex":168,"./internal/streams/BufferList":173,"_process":120,"buffer":47,"buffer-shims":45,"core-util-is":50,"events":86,"inherits":97,"isarray":99,"process-nextick-args":119,"stream":229,"string_decoder/":234,"util":19}],171:[function(require,module,exports){
"use strict";function TransformState(r){this.afterTransform=function(t,n){return afterTransform(r,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function afterTransform(r,t,n){var e=r._transformState;e.transforming=!1;var i=e.writecb;if(!i)return r.emit("error",new Error("no writecb in Transform class"));e.writechunk=null,e.writecb=null,null!==n&&void 0!==n&&r.push(n),i(t);var a=r._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&r._read(a.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r),this._transformState=new TransformState(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(r,n){done(t,r,n)}):done(t)})}function done(r,t,n){if(t)return r.emit("error",t);null!==n&&void 0!==n&&r.push(n);var e=r._writableState,i=r._transformState;if(e.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return r.push(null)}module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,n){throw new Error("_transform() is not implemented")},Transform.prototype._write=function(r,t,n){var e=this._transformState;if(e.writecb=n,e.writechunk=r,e.writeencoding=t,!e.transforming){var i=this._readableState;(e.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0};
},{"./_stream_duplex":168,"core-util-is":50,"inherits":97}],172:[function(require,module,exports){
(function (process){
"use strict";function nop(){}function WriteReq(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function WritableState(e,t){Duplex=Duplex||require("./_stream_duplex"),e=e||{},this.objectMode=!!e.objectMode,t instanceof Duplex&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var n=e.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}function Writable(e){return Duplex=Duplex||require("./_stream_duplex"),realHasInstance.call(Writable,this)||this instanceof Duplex?(this._writableState=new WritableState(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),void Stream.call(this)):new Writable(e)}function writeAfterEnd(e,t){var r=new Error("write after end");e.emit("error",r),processNextTick(t,r)}function validChunk(e,t,r,i){var n=!0,s=!1;return null===r?s=new TypeError("May not write null values to stream"):Buffer.isBuffer(r)||"string"==typeof r||void 0===r||t.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),processNextTick(i,s),n=!1),n}function decodeChunk(e,t,r){return e.objectMode||e.decodeStrings===!1||"string"!=typeof t||(t=bufferShim.from(t,r)),t}function writeOrBuffer(e,t,r,i,n){r=decodeChunk(t,r,i),Buffer.isBuffer(r)&&(i="buffer");var s=t.objectMode?1:r.length;t.length+=s;var o=t.length<t.highWaterMark;if(o||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest=new WriteReq(r,i,n),u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else doWrite(e,t,!1,s,r,i,n);return o}function doWrite(e,t,r,i,n,s,o){t.writelen=i,t.writecb=o,t.writing=!0,t.sync=!0,r?e._writev(n,t.onwrite):e._write(n,s,t.onwrite),t.sync=!1}function onwriteError(e,t,r,i,n){--t.pendingcb,r?processNextTick(n,i):n(i),e._writableState.errorEmitted=!0,e.emit("error",i)}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var r=e._writableState,i=r.sync,n=r.writecb;if(onwriteStateUpdate(r),t)onwriteError(e,r,i,t,n);else{var s=needFinish(r);s||r.corked||r.bufferProcessing||!r.bufferedRequest||clearBuffer(e,r),i?asyncWrite(afterWrite,e,r,s,n):afterWrite(e,r,s,n)}}function afterWrite(e,t,r,i){r||onwriteDrain(e,t),t.pendingcb--,i(),finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,n=new Array(i),s=t.corkedRequestsFree;s.entry=r;for(var o=0;r;)n[o]=r,r=r.next,o+=1;doWrite(e,t,!0,t.length,n,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new CorkedRequest(t)}else{for(;r;){var u=r.chunk,f=r.encoding,a=r.callback,c=t.objectMode?1:u.length;if(doWrite(e,t,!1,c,u,f,a),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function needFinish(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function prefinish(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function finishMaybe(e,t){var r=needFinish(t);return r&&(0===t.pendingcb?(prefinish(e,t),t.finished=!0,e.emit("finish")):prefinish(e,t)),r}function endWritable(e,t,r){t.ending=!0,finishMaybe(e,t),r&&(t.finished?processNextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function CorkedRequest(e){var t=this;this.next=null,this.entry=null,this.finish=function(r){var i=t.entry;for(t.entry=null;i;){var n=i.callback;e.pendingcb--,n(r),i=i.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}module.exports=Writable;var processNextTick=require("process-nextick-args"),asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:processNextTick,Duplex;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var internalUtil={deprecate:require("util-deprecate")},Stream;!function(){try{Stream=require("stream")}catch(e){}finally{Stream||(Stream=require("events").EventEmitter)}}();var Buffer=require("buffer").Buffer,bufferShim=require("buffer-shims");util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(e){}}();var realHasInstance;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(e){return!!realHasInstance.call(this,e)||e&&e._writableState instanceof WritableState}})):realHasInstance=function(e){return e instanceof this},Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Writable.prototype.write=function(e,t,r){var i=this._writableState,n=!1;return"function"==typeof t&&(r=t,t=null),Buffer.isBuffer(e)?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=nop),i.ended?writeAfterEnd(this,r):validChunk(this,i,e,r)&&(i.pendingcb++,n=writeOrBuffer(this,i,e,t,r)),n},Writable.prototype.cork=function(){var e=this._writableState;e.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||clearBuffer(this,e))},Writable.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Writable.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,t,r){var i=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||endWritable(this,i,r)};
}).call(this,require('_process'))

},{"./_stream_duplex":168,"_process":120,"buffer":47,"buffer-shims":45,"core-util-is":50,"events":86,"inherits":97,"process-nextick-args":119,"stream":229,"util-deprecate":238}],173:[function(require,module,exports){
"use strict";function BufferList(){this.head=null,this.tail=null,this.length=0}var Buffer=require("buffer").Buffer,bufferShim=require("buffer-shims");module.exports=BufferList,BufferList.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},BufferList.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},BufferList.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},BufferList.prototype.clear=function(){this.head=this.tail=null,this.length=0},BufferList.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,i=""+e.data;e=e.next;)i+=t+e.data;return i},BufferList.prototype.concat=function(t){if(0===this.length)return bufferShim.alloc(0);if(1===this.length)return this.head.data;for(var e=bufferShim.allocUnsafe(t>>>0),i=this.head,h=0;i;)i.data.copy(e,h),h+=i.data.length,i=i.next;return e};
},{"buffer":47,"buffer-shims":45}],174:[function(require,module,exports){
module.exports=require("./lib/_stream_passthrough.js");
},{"./lib/_stream_passthrough.js":169}],175:[function(require,module,exports){
(function (process){
var Stream=function(){try{return require("stream")}catch(r){}}();exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=Stream||exports,exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js"),!process.browser&&"disable"===process.env.READABLE_STREAM&&Stream&&(module.exports=Stream);
}).call(this,require('_process'))

},{"./lib/_stream_duplex.js":168,"./lib/_stream_passthrough.js":169,"./lib/_stream_readable.js":170,"./lib/_stream_transform.js":171,"./lib/_stream_writable.js":172,"_process":120,"stream":229}],176:[function(require,module,exports){
module.exports=require("./lib/_stream_transform.js");
},{"./lib/_stream_transform.js":171}],177:[function(require,module,exports){
module.exports=require("./lib/_stream_writable.js");
},{"./lib/_stream_writable.js":172}],178:[function(require,module,exports){
(function (Buffer){
function bytesToWords(r){for(var f=[],n=0,t=0;n<r.length;n++,t+=8)f[t>>>5]|=r[n]<<24-t%32;return f}function wordsToBytes(r){for(var f=[],n=0;n<32*r.length;n+=8)f.push(r[n>>>5]>>>24-n%32&255);return f}function processBlock(r,f,n){for(var t=0;t<16;t++){var o=n+t,e=f[o];f[o]=16711935&(e<<8|e>>>24)|4278255360&(e<<24|e>>>8)}var u,l,s,h,c,i,a,v,d,p;i=u=r[0],a=l=r[1],v=s=r[2],d=h=r[3],p=c=r[4];var g;for(t=0;t<80;t+=1)g=u+f[n+zl[t]]|0,g+=t<16?f1(l,s,h)+hl[0]:t<32?f2(l,s,h)+hl[1]:t<48?f3(l,s,h)+hl[2]:t<64?f4(l,s,h)+hl[3]:f5(l,s,h)+hl[4],g|=0,g=rotl(g,sl[t]),g=g+c|0,u=c,c=h,h=rotl(s,10),s=l,l=g,g=i+f[n+zr[t]]|0,g+=t<16?f5(a,v,d)+hr[0]:t<32?f4(a,v,d)+hr[1]:t<48?f3(a,v,d)+hr[2]:t<64?f2(a,v,d)+hr[3]:f1(a,v,d)+hr[4],g|=0,g=rotl(g,sr[t]),g=g+p|0,i=p,p=d,d=rotl(v,10),v=a,a=g;g=r[1]+s+d|0,r[1]=r[2]+h+p|0,r[2]=r[3]+c+i|0,r[3]=r[4]+u+a|0,r[4]=r[0]+l+v|0,r[0]=g}function f1(r,f,n){return r^f^n}function f2(r,f,n){return r&f|~r&n}function f3(r,f,n){return(r|~f)^n}function f4(r,f,n){return r&n|f&~n}function f5(r,f,n){return r^(f|~n)}function rotl(r,f){return r<<f|r>>>32-f}function ripemd160(r){var f=[1732584193,4023233417,2562383102,271733878,3285377520];"string"==typeof r&&(r=new Buffer(r,"utf8"));var n=bytesToWords(r),t=8*r.length,o=8*r.length;n[t>>>5]|=128<<24-t%32,n[(t+64>>>9<<4)+14]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);for(var e=0;e<n.length;e+=16)processBlock(f,n,e);for(e=0;e<5;e++){var u=f[e];f[e]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}var l=wordsToBytes(f);return new Buffer(l)}var zl=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],zr=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],sl=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],sr=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],hl=[0,1518500249,1859775393,2400959708,2840853838],hr=[1352829926,1548603684,1836072691,2053994217,0];module.exports=ripemd160;
}).call(this,require("buffer").Buffer)

},{"buffer":47}],179:[function(require,module,exports){
(function (Buffer){
function Hash(t,i){this._block=new Buffer(t),this._finalSize=i,this._blockSize=t,this._len=0,this._s=0}Hash.prototype.update=function(t,i){"string"==typeof t&&(i=i||"utf8",t=new Buffer(t,i));for(var s=this._len+=t.length,e=this._s||0,h=0,o=this._block;e<s;){for(var l=Math.min(t.length,h+this._blockSize-e%this._blockSize),_=l-h,n=0;n<_;n++)o[e%this._blockSize+n]=t[n+h];e+=_,h+=_,e%this._blockSize===0&&this._update(o)}return this._s=e,this},Hash.prototype.digest=function(t){var i=8*this._len;this._block[this._len%this._blockSize]=128,this._block.fill(0,this._len%this._blockSize+1),i%(8*this._blockSize)>=8*this._finalSize&&(this._update(this._block),this._block.fill(0)),this._block.writeInt32BE(i,this._blockSize-4);var s=this._update(this._block)||this._hash();return t?s.toString(t):s},Hash.prototype._update=function(){throw new Error("_update must be implemented by subclass")},module.exports=Hash;
}).call(this,require("buffer").Buffer)

},{"buffer":47}],180:[function(require,module,exports){
var exports=module.exports=function(e){e=e.toLowerCase();var r=exports[e];if(!r)throw new Error(e+" is not supported (we accept pull requests)");return new r};exports.sha=require("./sha"),exports.sha1=require("./sha1"),exports.sha224=require("./sha224"),exports.sha256=require("./sha256"),exports.sha384=require("./sha384"),exports.sha512=require("./sha512");
},{"./sha":181,"./sha1":182,"./sha224":183,"./sha256":184,"./sha384":185,"./sha512":186}],181:[function(require,module,exports){
(function (Buffer){
function Sha(){this.init(),this._w=W,Hash.call(this,64,56)}function rotl5(t){return t<<5|t>>>27}function rotl30(t){return t<<30|t>>>2}function ft(t,i,h,r){return 0===t?i&h|~i&r:2===t?i&h|i&r|h&r:i^h^r}var inherits=require("inherits"),Hash=require("./hash"),K=[1518500249,1859775393,-1894007588,-899497514],W=new Array(80);inherits(Sha,Hash),Sha.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},Sha.prototype._update=function(t){for(var i=this._w,h=0|this._a,r=0|this._b,s=0|this._c,e=0|this._d,n=0|this._e,_=0;_<16;++_)i[_]=t.readInt32BE(4*_);for(;_<80;++_)i[_]=i[_-3]^i[_-8]^i[_-14]^i[_-16];for(var a=0;a<80;++a){var o=~~(a/20),u=rotl5(h)+ft(o,r,s,e)+n+i[a]+K[o]|0;n=e,e=s,s=rotl30(r),r=h,h=u}this._a=h+this._a|0,this._b=r+this._b|0,this._c=s+this._c|0,this._d=e+this._d|0,this._e=n+this._e|0},Sha.prototype._hash=function(){var t=new Buffer(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},module.exports=Sha;
}).call(this,require("buffer").Buffer)

},{"./hash":179,"buffer":47,"inherits":97}],182:[function(require,module,exports){
(function (Buffer){
function Sha1(){this.init(),this._w=W,Hash.call(this,64,56)}function rotl1(t){return t<<1|t>>>31}function rotl5(t){return t<<5|t>>>27}function rotl30(t){return t<<30|t>>>2}function ft(t,i,h,r){return 0===t?i&h|~i&r:2===t?i&h|i&r|h&r:i^h^r}var inherits=require("inherits"),Hash=require("./hash"),K=[1518500249,1859775393,-1894007588,-899497514],W=new Array(80);inherits(Sha1,Hash),Sha1.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},Sha1.prototype._update=function(t){for(var i=this._w,h=0|this._a,r=0|this._b,s=0|this._c,n=0|this._d,e=0|this._e,_=0;_<16;++_)i[_]=t.readInt32BE(4*_);for(;_<80;++_)i[_]=rotl1(i[_-3]^i[_-8]^i[_-14]^i[_-16]);for(var a=0;a<80;++a){var o=~~(a/20),u=rotl5(h)+ft(o,r,s,n)+e+i[a]+K[o]|0;e=n,n=s,s=rotl30(r),r=h,h=u}this._a=h+this._a|0,this._b=r+this._b|0,this._c=s+this._c|0,this._d=n+this._d|0,this._e=e+this._e|0},Sha1.prototype._hash=function(){var t=new Buffer(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},module.exports=Sha1;
}).call(this,require("buffer").Buffer)

},{"./hash":179,"buffer":47,"inherits":97}],183:[function(require,module,exports){
(function (Buffer){
function Sha224(){this.init(),this._w=W,Hash.call(this,64,56)}var inherits=require("inherits"),Sha256=require("./sha256"),Hash=require("./hash"),W=new Array(64);inherits(Sha224,Sha256),Sha224.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},Sha224.prototype._hash=function(){var t=new Buffer(28);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t},module.exports=Sha224;
}).call(this,require("buffer").Buffer)

},{"./hash":179,"./sha256":184,"buffer":47,"inherits":97}],184:[function(require,module,exports){
(function (Buffer){
function Sha256(){this.init(),this._w=W,Hash.call(this,64,56)}function ch(t,i,h){return h^t&(i^h)}function maj(t,i,h){return t&i|h&(t|i)}function sigma0(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function sigma1(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function gamma0(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}function gamma1(t){return(t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10}var inherits=require("inherits"),Hash=require("./hash"),K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],W=new Array(64);inherits(Sha256,Hash),Sha256.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},Sha256.prototype._update=function(t){for(var i=this._w,h=0|this._a,s=0|this._b,r=0|this._c,n=0|this._d,_=0|this._e,a=0|this._f,e=0|this._g,u=0|this._h,o=0;o<16;++o)i[o]=t.readInt32BE(4*o);for(;o<64;++o)i[o]=gamma1(i[o-2])+i[o-7]+gamma0(i[o-15])+i[o-16]|0;for(var f=0;f<64;++f){var c=u+sigma1(_)+ch(_,a,e)+K[f]+i[f]|0,m=sigma0(h)+maj(h,s,r)|0;u=e,e=a,a=_,_=n+c|0,n=r,r=s,s=h,h=c+m|0}this._a=h+this._a|0,this._b=s+this._b|0,this._c=r+this._c|0,this._d=n+this._d|0,this._e=_+this._e|0,this._f=a+this._f|0,this._g=e+this._g|0,this._h=u+this._h|0},Sha256.prototype._hash=function(){var t=new Buffer(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t},module.exports=Sha256;
}).call(this,require("buffer").Buffer)

},{"./hash":179,"buffer":47,"inherits":97}],185:[function(require,module,exports){
(function (Buffer){
function Sha384(){this.init(),this._w=W,Hash.call(this,128,112)}var inherits=require("inherits"),SHA512=require("./sha512"),Hash=require("./hash"),W=new Array(160);inherits(Sha384,SHA512),Sha384.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},Sha384.prototype._hash=function(){function h(h,i,s){t.writeInt32BE(h,s),t.writeInt32BE(i,s+4)}var t=new Buffer(48);return h(this._ah,this._al,0),h(this._bh,this._bl,8),h(this._ch,this._cl,16),h(this._dh,this._dl,24),h(this._eh,this._el,32),h(this._fh,this._fl,40),t},module.exports=Sha384;
}).call(this,require("buffer").Buffer)

},{"./hash":179,"./sha512":186,"buffer":47,"inherits":97}],186:[function(require,module,exports){
(function (Buffer){
function Sha512(){this.init(),this._w=W,Hash.call(this,128,112)}function Ch(h,t,i){return i^h&(t^i)}function maj(h,t,i){return h&t|i&(h|t)}function sigma0(h,t){return(h>>>28|t<<4)^(t>>>2|h<<30)^(t>>>7|h<<25)}function sigma1(h,t){return(h>>>14|t<<18)^(h>>>18|t<<14)^(t>>>9|h<<23)}function Gamma0(h,t){return(h>>>1|t<<31)^(h>>>8|t<<24)^h>>>7}function Gamma0l(h,t){return(h>>>1|t<<31)^(h>>>8|t<<24)^(h>>>7|t<<25)}function Gamma1(h,t){return(h>>>19|t<<13)^(t>>>29|h<<3)^h>>>6}function Gamma1l(h,t){return(h>>>19|t<<13)^(t>>>29|h<<3)^(h>>>6|t<<26)}function getCarry(h,t){return h>>>0<t>>>0?1:0}var inherits=require("inherits"),Hash=require("./hash"),K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],W=new Array(160);inherits(Sha512,Hash),Sha512.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},Sha512.prototype._update=function(h){for(var t=this._w,i=0|this._ah,s=0|this._bh,_=0|this._ch,r=0|this._dh,a=0|this._eh,e=0|this._fh,l=0|this._gh,n=0|this._hh,g=0|this._al,f=0|this._bl,u=0|this._cl,c=0|this._dl,m=0|this._el,o=0|this._fl,y=0|this._gl,C=0|this._hl,d=0;d<32;d+=2)t[d]=h.readInt32BE(4*d),t[d+1]=h.readInt32BE(4*d+4);for(;d<160;d+=2){var b=t[d-30],p=t[d-30+1],v=Gamma0(b,p),G=Gamma0l(p,b);b=t[d-4],p=t[d-4+1];var w=Gamma1(b,p),S=Gamma1l(p,b),B=t[d-14],E=t[d-14+1],I=t[d-32],j=t[d-32+1],H=G+E|0,q=v+B+getCarry(H,G)|0;H=H+S|0,q=q+w+getCarry(H,S)|0,H=H+j|0,q=q+I+getCarry(H,j)|0,t[d]=q,t[d+1]=H}for(var W=0;W<160;W+=2){q=t[W],H=t[W+1];var x=maj(i,s,_),A=maj(g,f,u),k=sigma0(i,g),z=sigma0(g,i),D=sigma1(a,m),F=sigma1(m,a),J=K[W],L=K[W+1],M=Ch(a,e,l),N=Ch(m,o,y),O=C+F|0,P=n+D+getCarry(O,C)|0;O=O+N|0,P=P+M+getCarry(O,N)|0,O=O+L|0,P=P+J+getCarry(O,L)|0,O=O+H|0,P=P+q+getCarry(O,H)|0;var Q=z+A|0,R=k+x+getCarry(Q,z)|0;n=l,C=y,l=e,y=o,e=a,o=m,m=c+O|0,a=r+P+getCarry(m,c)|0,r=_,c=u,_=s,u=f,s=i,f=g,g=O+Q|0,i=P+R+getCarry(g,O)|0}this._al=this._al+g|0,this._bl=this._bl+f|0,this._cl=this._cl+u|0,this._dl=this._dl+c|0,this._el=this._el+m|0,this._fl=this._fl+o|0,this._gl=this._gl+y|0,this._hl=this._hl+C|0,this._ah=this._ah+i+getCarry(this._al,g)|0,this._bh=this._bh+s+getCarry(this._bl,f)|0,this._ch=this._ch+_+getCarry(this._cl,u)|0,this._dh=this._dh+r+getCarry(this._dl,c)|0,this._eh=this._eh+a+getCarry(this._el,m)|0,this._fh=this._fh+e+getCarry(this._fl,o)|0,this._gh=this._gh+l+getCarry(this._gl,y)|0,this._hh=this._hh+n+getCarry(this._hl,C)|0},Sha512.prototype._hash=function(){function h(h,i,s){t.writeInt32BE(h,s),t.writeInt32BE(i,s+4)}var t=new Buffer(64);return h(this._ah,this._al,0),h(this._bh,this._bl,8),h(this._ch,this._cl,16),h(this._dh,this._dl,24),h(this._eh,this._el,32),h(this._fh,this._fl,40),h(this._gh,this._gl,48),h(this._hh,this._hl,56),t},module.exports=Sha512;
}).call(this,require("buffer").Buffer)

},{"./hash":179,"buffer":47,"inherits":97}],187:[function(require,module,exports){
module.exports=require("./shorthash");
},{"./shorthash":188}],188:[function(require,module,exports){
function bitwise(r){var n=0;if(0==r.length)return n;for(var t=0;t<r.length;t++){var a=r.charCodeAt(t);n=(n<<5)-n+a,n&=n}return n}function binaryTransfer(r,n){function t(r){var n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";return n[r]}n=n||62;var a,e=[],i="",o=r<0?"-":"";for(r=Math.abs(r);r>=n;)a=r%n,r=Math.floor(r/n),e.push(t(a));r>0&&e.push(t(r));for(var u=e.length-1;u>=0;u--)i+=e[u];return o+i}function unique(r){var n=binaryTransfer(bitwise(r),61);return n.replace("-","Z")}function random(r){for(var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",t="",a=r||8,e=0;e<a;e++){var i=Math.floor(Math.random()*n.length);t+=n.substring(i,i+1)}return t}exports.bitwise=bitwise,exports.binaryTransfer=binaryTransfer,exports.unique=unique,exports.random=random;
},{}],189:[function(require,module,exports){
"use strict";module.exports={authEndpoint:"https://databox.me/",signupEndpoint:"https://solid.github.io/solid-idps/",signupWindowHeight:600,signupWindowWidth:1024};
},{}],190:[function(require,module,exports){
"use strict";function ClientAuthTLS(n,t){this.webClient=n,this.config=t||defaultConfig}module.exports=ClientAuthTLS;var defaultConfig=require("./config-default");ClientAuthTLS.prototype.currentUser=function(){if("undefined"==typeof window)return null;var n=window.location.href;return this.login(n).catch(function(n){return console.log("Detecting current user failed: %o",n),null})},ClientAuthTLS.prototype.listen=function(){var n=new Promise(function(n,t){var i=window.addEventListener?"addEventListener":"attachEvent",e=window[i],o="attachEvent"===i?"onmessage":"message";e(o,function(i){var e=i.data;if("User:"===e.slice(0,5)){var o=e.slice(5,e.length);return o&&o.length>0&&"http"===o.slice(0,4)?n(o):t(o)}},!0)});return n},ClientAuthTLS.prototype.login=function(n,t){var i=this.config.authEndpoint;n=n||window.location.origin+window.location.pathname,t=t||i;var e=this.webClient;return e.head(n).then(function(n){return n.isLoggedIn()?n.user:e.head(t).then(function(n){return n.user})})},ClientAuthTLS.prototype.signup=function(n){n=n||this.config.signupEndpoint;var t=this.config.signupWindowWidth,i=this.config.signupWindowHeight,e=window.screen.width/2-(t/2+10),o=window.screen.height/2-(i/2+50),r="Solid signup",u=n+"?origin="+encodeURIComponent(window.location.origin),s="resizable,scrollbars,status,width="+t+",height="+i+",left="+e+",top="+o;window.open(u,r,s);var c=this;return new Promise(function(n){c.listen().then(function(t){return n(t)})})};
},{"./config-default":189}],191:[function(require,module,exports){
arguments[4][189][0].apply(exports,arguments)
},{"dup":189}],192:[function(require,module,exports){
"use strict";var rdf=require("./lib/util/rdf-parser"),acl=require("solid-permissions"),webClient=require("solid-web-client")(rdf),ClientAuthTLS=require("solid-auth-tls"),auth=new ClientAuthTLS(webClient),identity=require("./lib/identity"),ns=require("solid-namespace")(rdf),Solid={acl:acl.acl,AppRegistration:require("./lib/solid/app-registration"),appRegistry:require("./lib/app-registry"),auth:auth,config:require("./config"),currentUser:auth.currentUser.bind(auth),identity:require("./lib/identity"),login:auth.login.bind(auth),meta:require("./lib/meta"),rdflib:rdf,signup:auth.signup.bind(auth),status:require("./lib/status"),typeRegistry:require("./lib/type-registry"),vocab:ns,web:webClient};Solid.clearPermissions=function(e){return acl.clearPermissions(e,webClient)},Solid.discoverWebID=function(e){return identity.discoverWebID(e,webClient,ns)},Solid.getPermissions=function(e){return acl.getPermissions(e,webClient,rdf)},Solid.getProfile=function(e,i){return identity.getProfile(e,i,webClient,rdf)},module.exports=Solid;
},{"./config":191,"./lib/app-registry":193,"./lib/identity":194,"./lib/meta":195,"./lib/solid/app-registration":197,"./lib/status":200,"./lib/type-registry":201,"./lib/util/rdf-parser":203,"solid-auth-tls":190,"solid-namespace":214,"solid-permissions":216,"solid-web-client":206}],193:[function(require,module,exports){
"use strict";function addToAppRegistry(r,t,e){var i,p;if(t.isListed?(i=r.appRegistryListed.uri,p=r.appRegistryListed.graph):(i=r.appRegistryUnlisted.uri,p=r.appRegistryUnlisted.graph),!i)throw new Error("Cannot register app, registry URL missing");var a=r.rdf,n=[],s=t.rdfStatements(a);return e.patch(i,n,s).then(function(t){var e=graphUtil.graphFromStatements(s,a);return p?graphUtil.appendGraph(p,e):p=e,r})}function appsForType(r,t,e){var i=[];return i.concat(registrationsFromGraph(r.appRegistryListed.graph,t,e)).concat(registrationsFromGraph(r.appRegistryUnlisted.graph,t,e))}function blankPrivateAppRegistry(r){var t=vocab(r),e=r.namedNode(""),i=[r.triple(e,t.rdf("type"),t.solid("AppRegistry")),r.triple(e,t.rdf("type"),t.solid("UnlistedDocument"))],p={data:graphUtil.serializeStatements(i),graph:graphUtil.graphFromStatements(i,r),slug:"privateAppRegistry.ttl",uri:null};return p}function blankPublicAppRegistry(r){var t=vocab(r),e=r.namedNode(""),i=[r.triple(e,t.rdf("type"),t.solid("AppRegistry")),r.triple(e,t.rdf("type"),t.solid("ListedDocument"))],p={data:graphUtil.serializeStatements(i),graph:graphUtil.graphFromStatements(i,r),slug:"publicAppRegistry.ttl",uri:null};return p}function initAppRegistryPrivate(r,t,e){e=e||{};var i=r.rdf,p=vocab(i),a=r.appRegistryDefaultContainer(),n=i.namedNode(r.webId),s=blankPrivateAppRegistry(i);return t.post(a,s.data,s.slug).catch(function(r){throw new Error("Could not create private registry document:",r)}).then(function(o){s.uri=util.absoluteUrl(webUtil.hostname(a),o.url);var u=[i.triple(n,p.solid("privateAppRegistry"),i.namedNode(s.uri))],l=[];return t.patch(r.privateProfileUri(),l,u,e)}).catch(function(r){throw new Error("Could not update profile with private registry:"+r)}).then(function(t){return r.appRegistryUnlisted=s,r})}function initAppRegistryPublic(r,t,e){e=e||{};var i=r.rdf,p=vocab(i),a=r.appRegistryDefaultContainer(),n=i.namedNode(r.webId),s=blankPublicAppRegistry(i);return t.post(a,s.data,s.slug).catch(function(r){throw new Error("Could not create public registry document:",r)}).then(function(o){s.uri=util.absoluteUrl(webUtil.hostname(a),o.url);var u=[i.triple(n,p.solid("publicAppRegistry"),i.namedNode(s.uri))],l=[];return t.patch(r.webId,l,u,e)}).catch(function(r){throw new Error("Could not update profile with public registry:",r)}).then(function(t){return r.appRegistryListed=s,r})}function loadAppRegistry(r,t,e){e=e||{},e.headers=e.headers||{},e.headers.Accept||(e.headers.Accept="text/turtle");var i=[];return r.appRegistryListed.uri&&i.push(r.appRegistryListed.uri),r.appRegistryUnlisted.uri&&i.push(r.appRegistryUnlisted.uri),t.loadParsedGraphs(i,e).then(function(t){return t.forEach(function(t){t&&t.value&&r.addAppRegistry(t.value,t.uri)}),r})}function registerApp(r,t,e){if(!r)throw new Error("No profile provided");if(!r.isLoaded)throw new Error("Profile is not loaded");if(!t||!t.isValid())throw new Error("Invalid app registration");return loadAppRegistry(r,e).then(function(r){return t.isListed&&!r.hasAppRegistryPublic()?initAppRegistryPublic(r,e):t.isListed||r.hasAppRegistryPrivate()?r:initAppRegistryPrivate(r,e)}).then(function(r){return addToAppRegistry(r,t,e)})}function registrationsFromGraph(r,t,e){var i,p=vocab(e),a=[];return r?(r.statementsMatching(null,p.app("commonType"),t).forEach(function(t){i=t.subject;var p=new AppRegistration;p.initFromGraph(i,r,e),a.push(p)}),a):a}module.exports.addToAppRegistry=addToAppRegistry,module.exports.blankPrivateAppRegistry=blankPrivateAppRegistry,module.exports.blankPublicAppRegistry=blankPublicAppRegistry,module.exports.initAppRegistryPrivate=initAppRegistryPrivate,module.exports.initAppRegistryPublic=initAppRegistryPublic,module.exports.loadAppRegistry=loadAppRegistry,module.exports.appsForType=appsForType,module.exports.registerApp=registerApp,module.exports.registrationsFromGraph=registrationsFromGraph;var AppRegistration=require("./solid/app-registration"),graphUtil=require("./util/graph-util.js"),util=require("./util/web-util.js"),vocab=require("solid-namespace"),webUtil=require("./util/web-util.js");
},{"./solid/app-registration":197,"./util/graph-util.js":202,"./util/web-util.js":204,"solid-namespace":214}],194:[function(require,module,exports){
"use strict";function discoverWebID(e,r,o){return r.options(e).then(function(e){var o=e.metaAbsoluteUrl();if(!o)throw new Error("Could not find a meta URL in the Link header");return r.get(o)}).then(function(r){var t=r.parsedGraph(),n=t.any(void 0,o.solid("account"));if(!n||!n.uri)throw new Error("Could not find a WebID matching the domain "+e);return n})}function getProfile(e,r,o,t){return r=r||{},r.headers=r.headers||{Accept:"text/turtle"},r.noCredentials=!0,o.get(e,r).then(function(n){var i=n.parsedGraph(),d=new SolidProfile(e,i,t,o,n);return d.isLoaded=!0,r.ignoreExtended?d:loadExtendedProfile(d,r,o)})}function loadExtendedProfile(e,r,o){var t=e.relatedProfilesLinks();return o.loadParsedGraphs(t,r).then(function(r){return r.forEach(function(r){r&&r.value&&e.appendFromGraph(r.value,r.uri)}),e})}module.exports.discoverWebID=discoverWebID,module.exports.getProfile=getProfile,module.exports.loadExtendedProfile=loadExtendedProfile;var SolidProfile=require("./solid/profile");
},{"./solid/profile":199}],195:[function(require,module,exports){
"use strict";var lib=require("../package");module.exports.version=function(){return lib.version};
},{"../package":213}],196:[function(require,module,exports){
"use strict";function isUnlisted(i,s){var e=vocab(s);return i.any(null,null,e.solid("UnlistedDocument"),i.uri)}function isListed(i,s){var e=vocab(s);return i.any(null,null,e.solid("ListedDocument"),i.uri)}module.exports.isListed=isListed,module.exports.isUnlisted=isUnlisted;var vocab=require("solid-namespace");
},{"solid-namespace":214}],197:[function(require,module,exports){
"use strict";function AppRegistration(t,e,i){t=t||{},this.isListed=i,this.name=t.name,this.redirectTemplateUri=t.redirectTemplateUri,this.registrationUri=null,this.shortdesc=t.shortdesc,this.types=e||[]}module.exports=AppRegistration;var hash=require("shorthash"),vocab=require("solid-namespace"),registry=require("../registry");AppRegistration.prototype.hashFragment=function(){var t=hash.unique(this.redirectTemplateUri);return t},AppRegistration.prototype.initFromGraph=function(t,e,i){this.registrationUri=t.uri,this.isListed=!!registry.isListed(e,i),this.types=[];var r=this,s=vocab(i);e.statementsMatching(t,s.app("commonType")).forEach(function(t){r.types.push(t.object.uri)});var p;p=e.any(t,s.app("name")),p&&(this.name=p.value),p=e.any(t,s.app("shortdesc")),p&&(this.shortdesc=p.value),p=e.any(t,s.app("redirectTemplateUri")),p&&(this.redirectTemplateUri=p.value)},AppRegistration.prototype.isValid=function(){return this.name&&this.redirectTemplateUri&&this.types.length>0},AppRegistration.prototype.rdfStatements=function(t){var e=t.namedNode("#"+this.hashFragment()),i=[],r=vocab(t);return i.push(t.triple(e,r.rdf("type"),r.solid("AppRegistration")),t.triple(e,r.app("name"),this.name),t.triple(e,r.app("shortdesc"),this.shortdesc),t.triple(e,r.app("redirectTemplateUri"),this.redirectTemplateUri)),this.types.forEach(function(s){i.push(t.triple(e,r.app("commonType"),s))}),i};
},{"../registry":196,"shorthash":187,"solid-namespace":214}],198:[function(require,module,exports){
"use strict";function IndexRegistration(t,i,n,e,o){this.isListed=o,this.locationType=n,this.locationUri=e,this.rdfClass=i,this.registrationUri=t}module.exports=IndexRegistration,IndexRegistration.prototype.isContainer=function(){return"container"===this.locationType},IndexRegistration.prototype.isInstance=function(){return"instance"===this.locationType};
},{}],199:[function(require,module,exports){
"use strict";function SolidProfile(e,i,t,r,s){this.appRegistryListed={uri:null,graph:null},this.appRegistryUnlisted={uri:null,graph:null},this.inbox={uri:null,graph:null},this.isLoaded=!1,this.picture=null,this.name=null,this.rdf=t,this.storage=[],this.typeIndexListed={uri:null,graph:null},this.typeIndexUnlisted={uri:null,graph:null},this.parsedGraph=null,this.preferences={uri:null,graph:null},this.response=s,this.relatedProfiles={sameAs:[],seeAlso:[]},this.webId=null,this.webClient=r,e&&(this.baseProfileUrl=e.indexOf("#")>=0?e.slice(0,e.indexOf("#")):e,i&&(this.initWebId(i),this.appendFromGraph(i,this.baseProfileUrl)))}function extractWebId(e,i,t){var r=vocab(t),s=t.namedNode(e),p=r.foaf("primaryTopic"),o=i.any(s,p);return o}function parseLink(e,i,t,r,s){var p=e.any(i,t,r,s);return p?p.uri:null}module.exports=SolidProfile;var appRegistry=require("../app-registry"),vocab=require("solid-namespace"),registry=require("../registry"),typeRegistry=require("../type-registry"),graphUtil=require("../util/graph-util"),parseLinks=graphUtil.parseLinks,PREFERENCES_DEFAULT_URI="/settings/prefs.ttl",PROFILE_CONTAINER_DEFAULT_URI="/profile/";SolidProfile.prototype.appendFromGraph=function(e,i){if(e){var t=this.rdf,r=vocab(t);this.parsedGraph=this.parsedGraph||t.graph(),graphUtil.appendGraph(this.parsedGraph,e,i);var s,p=t.namedNode(this.webId);this.name||(this.name=this.find(r.foaf("name"))),this.picture||(this.picture=this.find(r.foaf("img"))),s=parseLinks(e,null,r.owl("sameAs")),this.relatedProfiles.sameAs=this.relatedProfiles.sameAs.concat(s),s=parseLinks(e,null,r.rdfs("seeAlso")),this.relatedProfiles.seeAlso=this.relatedProfiles.seeAlso.concat(s),this.preferences.uri||(this.preferences.uri=parseLink(e,p,r.pim("preferencesFile"))),this.inbox.uri||(this.inbox.uri=parseLink(e,p,r.solid("inbox"))),s=parseLinks(e,p,r.pim("storage")),this.storage=this.storage.concat(s),this.typeIndexListed.uri||(this.typeIndexListed.uri=parseLink(e,p,r.solid("publicTypeIndex"))),this.typeIndexUnlisted.uri||(this.typeIndexUnlisted.uri=parseLink(e,p,r.solid("privateTypeIndex"))),this.appRegistryListed.uri||(this.appRegistryListed.uri=parseLink(e,p,r.solid("publicAppRegistry"))),this.appRegistryUnlisted.uri||(this.appRegistryUnlisted.uri=parseLink(e,p,r.solid("privateAppRegistry")))}},SolidProfile.prototype.appRegistryDefaultContainer=function(){var e,i=this.webId||this.baseProfileUrl;return e=i?i.replace(/\\/g,"/").replace(/\/[^\/]*\/?$/,"")+"/":PROFILE_CONTAINER_DEFAULT_URI},SolidProfile.prototype.appsForType=function(e){return appRegistry.appsForType(this,e,this.rdf)},SolidProfile.prototype.find=function(e){if(!this.parsedGraph)throw new Error("Profile graph not yet loaded.");var i=this.rdf.namedNode(this.webId),t=this.parsedGraph.any(i,e);return t?t.value||t.uri:t},SolidProfile.prototype.findAll=function(e){if(!this.parsedGraph)throw new Error("Profile graph not yet loaded.");var i=this.rdf.namedNode(this.webId),t=this.parsedGraph.statementsMatching(i,e);return t=t.map(function(e){return e.object.value||e.object.uri}),t.sort()},SolidProfile.prototype.initWebId=function(e){if(e)try{this.webId=extractWebId(this.baseProfileUrl,e,this.rdf).uri}catch(e){throw new Error("Unable to parse WebID from profile: "+e)}},SolidProfile.prototype.relatedProfilesLinks=function(){var e=[];return e=e.concat(this.relatedProfiles.sameAs).concat(this.relatedProfiles.seeAlso),this.preferences.uri&&(e=e.concat(this.preferences.uri)),e},SolidProfile.prototype.hasAppRegistryPrivate=function(){if(!this.isLoaded)throw new Error("Must load profile before checking if registry exists.");return this.appRegistryUnlisted.uri},SolidProfile.prototype.hasAppRegistryPublic=function(){if(!this.isLoaded)throw new Error("Must load profile before checking if registry exists.");return this.appRegistryListed.uri},SolidProfile.prototype.hasStorage=function(){return this.storage&&this.storage.length>0},SolidProfile.prototype.hasTypeRegistryPrivate=function(){if(!this.isLoaded)throw new Error("Must load profile before checking if registry exists.");return this.typeIndexUnlisted.uri},SolidProfile.prototype.hasTypeRegistryPublic=function(){if(!this.isLoaded)throw new Error("Must load profile before checking if registry exists.");return this.typeIndexListed.uri},SolidProfile.prototype.loadAppRegistry=function(e,i){return e=e||this.webClient,appRegistry.loadAppRegistry(this,e,i)},SolidProfile.prototype.loadTypeRegistry=function(e,i){return e=e||this.webClient,typeRegistry.loadTypeRegistry(this,e,i)},SolidProfile.prototype.addAppRegistry=function(e,i){if(registry.isListed(e,this.rdf))this.appRegistryListed.graph||(this.appRegistryListed.uri=i,this.appRegistryListed.graph=e);else{if(!registry.isUnlisted(e,this.rdf))throw console.log(e),new Error("Attempting to add an invalid app registry resource");this.appRegistryUnlisted.graph||(this.appRegistryUnlisted.uri=i,this.appRegistryUnlisted.graph=e)}},SolidProfile.prototype.addTypeRegistry=function(e,i){if(registry.isListed(e,this.rdf))this.typeIndexListed.graph||(this.typeIndexListed.uri=i,this.typeIndexListed.graph=e);else{if(!registry.isUnlisted(e,this.rdf))throw new Error("Attempting to add an invalid type registry index");this.typeIndexUnlisted.graph||(this.typeIndexUnlisted.uri=i,this.typeIndexUnlisted.graph=e)}},SolidProfile.prototype.reloadAppRegistry=function(e){return this.resetAppRegistry(),this.loadAppRegistry(e)},SolidProfile.prototype.reloadTypeRegistry=function(e){return this.resetTypeRegistry(),this.loadTypeRegistry(e)},SolidProfile.prototype.resetAppRegistry=function(){this.appRegistryListed.graph=null,this.appRegistryUnlisted.graph=null},SolidProfile.prototype.resetTypeRegistry=function(){this.typeIndexListed.graph=null,this.typeIndexUnlisted.graph=null},SolidProfile.prototype.typeRegistryForClass=function(e){return typeRegistry.typeRegistryForClass(this,e,this.rdf)},SolidProfile.prototype.typeRegistryDefaultContainer=function(){var e,i=this.webId||this.baseProfileUrl;return e=i?i.replace(/\\/g,"/").replace(/\/[^\/]*\/?$/,"")+"/":PROFILE_CONTAINER_DEFAULT_URI},SolidProfile.prototype.privateProfileUri=function(){return this.preferences&&this.preferences.uri?this.preferences.uri:PREFERENCES_DEFAULT_URI},SolidProfile.prototype.registerApp=function(e,i){return i=i||this.webClient,appRegistry.registerApp(this,e,i)},SolidProfile.prototype.registerType=function(e,i,t,r){return typeRegistry.registerType(this,e,i,t,r,this.webClient)},SolidProfile.prototype.unregisterType=function(e,i,t){return typeRegistry.unregisterType(this,e,i,t,this.webClient)};
},{"../app-registry":193,"../registry":196,"../type-registry":201,"../util/graph-util":202,"solid-namespace":214}],200:[function(require,module,exports){
"use strict";function isOnline(){return window.navigator.onLine}function onOffline(n){window.addEventListener("offline",n,!1)}function onOnline(n){window.addEventListener("online",n,!1)}module.exports.isOnline=isOnline,module.exports.onOffline=onOffline,module.exports.onOnline=onOnline;
},{}],201:[function(require,module,exports){
"use strict";function blankPrivateTypeIndex(e){var t=e.namedNode(""),r=vocab(e),i=[e.triple(t,r.rdf("type"),r.solid("TypeIndex")),e.triple(t,r.rdf("type"),r.solid("UnlistedDocument"))],n={data:graphUtil.serializeStatements(i),graph:graphUtil.graphFromStatements(i,e),slug:"privateTypeIndex.ttl",uri:null};return n}function blankPublicTypeIndex(e){var t=e.namedNode(""),r=vocab(e),i=[e.triple(t,r.rdf("type"),r.solid("TypeIndex")),e.triple(t,r.rdf("type"),r.solid("ListedDocument"))],n={data:graphUtil.serializeStatements(i),graph:graphUtil.graphFromStatements(i,e),slug:"publicTypeIndex.ttl",uri:null};return n}function initTypeRegistryPrivate(e,t,r){r=r||{};var i=t.rdf,n=vocab(i),o=e.typeRegistryDefaultContainer(),a=i.namedNode(e.webId),s=blankPrivateTypeIndex(i);return t.post(o,s.data,s.slug).catch(function(e){throw new Error("Could not create privateIndex document:",e)}).then(function(d){s.uri=util.absoluteUrl(webUtil.hostname(o),d.url);var p=[i.triple(a,n.solid("privateTypeIndex"),i.namedNode(s.uri))],u=[];return t.patch(e.privateProfileUri(),u,p,r)}).catch(function(e){throw new Error("Could not update profile with private index:"+e)}).then(function(t){return e.typeIndexUnlisted=s,e})}function initTypeRegistryPublic(e,t,r){r=r||{};var i=t.rdf,n=vocab(i),o=e.typeRegistryDefaultContainer(),a=i.namedNode(e.webId),s=blankPublicTypeIndex(i);return t.post(o,s.data,s.slug).catch(function(e){throw new Error("Could not create publicIndex document:",e)}).then(function(d){s.uri=util.absoluteUrl(webUtil.hostname(o),d.url);var p=[i.triple(a,n.solid("publicTypeIndex"),i.namedNode(s.uri))],u=[];return t.patch(e.webId,u,p,r)}).catch(function(e){throw console.log(e),new Error("Could not update profile with public index:",e)}).then(function(t){return e.typeIndexListed=s,e})}function addToTypeIndex(e,t,r,i,n,o){var a,s,d=require("shorthash"),p=i.rdf,u=vocab(p),l=d.unique(t.uri);if(o?(a=e.typeIndexListed.uri,s=e.typeIndexListed.graph):(a=e.typeIndexUnlisted.uri,s=e.typeIndexUnlisted.graph),!a)throw new Error("Cannot register type, registry URL missing");var c,y=p.namedNode(a+"#"+l);"instance"===n?c=u.solid("instance"):(c=u.solid("instanceContainer"),r.lastIndexOf("/")!==r.length-1&&(r+="/"));var h=[],g=[p.triple(y,u.rdf("type"),u.solid("TypeRegistration")),p.triple(y,u.solid("forClass"),t),p.triple(y,c,p.namedNode(r))];return i.patch(a,h,g).then(function(t){var r=graphUtil.graphFromStatements(g,p);return s?graphUtil.appendGraph(s,r):s=r,e})}function loadTypeRegistry(e,t,r){r=r||{},r.headers=r.headers||{},r.headers.Accept||(r.headers.Accept="text/turtle");var i=[];return e.typeIndexListed.uri&&i.push(e.typeIndexListed.uri),e.typeIndexUnlisted.uri&&i.push(e.typeIndexUnlisted.uri),t.loadParsedGraphs(i,r).then(function(t){return t.forEach(function(t){t&&t.value&&e.addTypeRegistry(t.value,t.uri)}),e})}function registerType(e,t,r,i,n,o){if(!e)throw new Error("No profile provided");if(!e.isLoaded)throw new Error("Profile is not loaded");if(!t||!r)throw new Error("Type registration requires type class and location");if(i=i||"container","container"!==i&&"instance"!==i)throw new Error("Invalid location type");return loadTypeRegistry(e,o).then(function(e){return n&&!e.hasTypeRegistryPublic()?initTypeRegistryPublic(e,o):n||e.hasTypeRegistryPrivate()?e:initTypeRegistryPrivate(e,o)}).then(function(e){return addToTypeIndex(e,t,r,o,i,n)})}function typeRegistryForClass(e,t,r){var i=[],n=!0;return i.concat(registrationsFromGraph(e.typeIndexListed.graph,t,n,r)).concat(registrationsFromGraph(e.typeIndexUnlisted.graph,t,!n,r))}function registrationsFromGraph(e,t,r,i){var n,o,a,s=vocab(i),d=[];if(!e)return d;var p=e.statementsMatching(null,null,t);return p.forEach(function(i){n=i.subject,o=e.statementsMatching(n,s.solid("instance")),o.forEach(function(e){d.push(new IndexRegistration(n.uri,t,"instance",e.object.uri,r))}),a=e.statementsMatching(n,s.solid("instanceContainer")),a.forEach(function(e){d.push(new IndexRegistration(n.uri,t,"container",e.object.uri,r))})}),d}function removeFromTypeIndex(e,t,r,i,n){var o,a,s=r.rdf;if(i?(o=e.typeIndexListed.uri,a=e.typeIndexListed.graph):(o=e.typeIndexUnlisted.uri,a=e.typeIndexUnlisted.graph),!o)throw new Error("Cannot unregister type, registry URL missing");var d=registrationsFromGraph(a,t,i,s);if(0===d.length)return Promise.resolve(e);n&&(d=d.filter(function(e){return e.locationUri===n}));var p=[];d.forEach(function(e){a.statementsMatching(s.namedNode(e.registrationUri)).forEach(function(e){p.push(e)})});var u=[];return r.patch(o,p,u).then(function(t){return e.reloadTypeRegistry(r)})}function unregisterType(e,t,r,i,n){if(!e)throw new Error("No profile provided");if(!e.isLoaded)throw new Error("Profile is not loaded");if(!t)throw new Error("Unregistering a type requires type class");return loadTypeRegistry(e,n).then(function(e){if(r&&!e.typeIndexListed.graph)throw new Error("Profile has no Listed type index");if(!r&&!e.typeIndexUnlisted.graph)throw new Error("Profile has no Unlisted type index");return removeFromTypeIndex(e,t,n,r,i)})}module.exports.blankPrivateTypeIndex=blankPrivateTypeIndex,module.exports.blankPublicTypeIndex=blankPublicTypeIndex,module.exports.initTypeRegistryPrivate=initTypeRegistryPrivate,module.exports.initTypeRegistryPublic=initTypeRegistryPublic,module.exports.loadTypeRegistry=loadTypeRegistry,module.exports.registerType=registerType,module.exports.typeRegistryForClass=typeRegistryForClass,module.exports.unregisterType=unregisterType;var IndexRegistration=require("./solid/index-registration"),util=require("./util/web-util.js"),graphUtil=require("./util/graph-util.js"),webUtil=require("./util/web-util.js"),vocab=require("solid-namespace");
},{"./solid/index-registration":198,"./util/graph-util.js":202,"./util/web-util.js":204,"shorthash":187,"solid-namespace":214}],202:[function(require,module,exports){
"use strict";function appendGraph(t,e){e.statementsMatching(ALL_STATEMENTS).forEach(function(e){t.add(e.subject,e.predicate,e.object,e.why)})}function statementToNT(t,e){return"string"!=typeof t&&(t=t.toNT()),e&&t.endsWith(".")&&(t=t.slice(0,-1)),t}function graphFromStatements(t,e){var r=e.graph();return t.forEach(function(t){r.addStatement(t)}),r}function parseGraph(t,e,r,n){var a=n.graph();return n.parse(e,a,t,r),a}function parseLinks(t,e,r,n,a){var s={},o=t.statementsMatching(e,r,n,a);return o.forEach(function(t){s[t.object.uri]=!0}),Object.keys(s)}function serializeStatements(t){var e=t.map(function(t){return t.toNT()});return e=e.join("\n")}module.exports.appendGraph=appendGraph,module.exports.parseGraph=parseGraph,module.exports.parseLinks=parseLinks,module.exports.serializeStatements=serializeStatements,module.exports.graphFromStatements=graphFromStatements,module.exports.statementToNT=statementToNT;var ALL_STATEMENTS=null;
},{}],203:[function(require,module,exports){
"use strict";var rdf;"undefined"!=typeof $rdf?rdf=$rdf:"undefined"!=typeof tabulator?rdf=tabulator.rdf:"function"==typeof require&&(rdf=require("rdflib")),module.exports=rdf;
},{"rdflib":142}],204:[function(require,module,exports){
"use strict";function parseAllowedMethods(t,e){var r={};if(t){var n=t.split(",");n.forEach(function(e){e&&t.indexOf(e)>=0&&(r[e.trim().toLowerCase()]=!0)})}return e&&e.indexOf("application/sparql-update")>=0&&(r.patch=!0),r}function parseLinkHeader(t){if(!t)return{};for(var e=/<[^>]*>\s*(\s*;\s*[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*")))*(,|$)/g,r=/[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*"))/g,n=t.match(e),o={},a=0;a<n.length;a++)for(var s=n[a].split(">"),l=s[0].substring(1),i=s[1],u=i.match(r),p=0;p<u.length;p++){var h=u[p],c=h.split("="),m=c[1].replace(/["']/g,"");o[m]||(o[m]=[]),o[m].push(l),o[m].length>1&&o[m].sort()}return o}function hostname(t){var e,r,n,o,a=t.split("//");return 2===a.length?(e=a[0],r=a[1]):r=t,o=r.split("/"),n=e?e+"//"+o[0]:o[0],t.startsWith("//")&&(n="//"+n),n}function absoluteUrl(t,e){return e&&"http"!==e.slice(0,4)?[t,e].map(function(t){return"/"===t[0]&&(t=t.slice(1)),"/"===t[t.length-1]&&(t=t.slice(0,t.length-1)),t}).join("/"):e}function composePatchQuery(t,e){var r="",n=!0;return t&&t.length>0&&(t=t.map(function(t){return graphUtil.statementToNT(t,n)}),r+="DELETE DATA { "+t.join(" . ")+" };\n"),e&&e.length>0&&(e=e.map(function(t){return graphUtil.statementToNT(t,n)}),r+="INSERT DATA { "+e.join(" . ")+" };\n"),r}module.exports.composePatchQuery=composePatchQuery,module.exports.parseAllowedMethods=parseAllowedMethods,module.exports.parseLinkHeader=parseLinkHeader,module.exports.absoluteUrl=absoluteUrl,module.exports.hostname=hostname;var graphUtil=require("./graph-util");
},{"./graph-util":202}],205:[function(require,module,exports){
"use strict";module.exports={proxyUrl:"https://databox.me/,proxy?uri={uri}",timeout:5e4};
},{}],206:[function(require,module,exports){
"use strict";function SolidWebClient(e,t){this.rdf=e,this.vocab=vocab(e),this.config=t||defaultConfig}function getClient(e,t){return new SolidWebClient(e,t)}var DEFAULT_ACCEPT="text/turtle;q=0.8,*/*;q=0.5",DEFAULT_MIME_TYPE="text/turtle",defaultConfig=require("../config-default"),composePatchQuery=require("./util/web-util").composePatchQuery,SolidResponse=require("./models/response"),SolidContainer=require("./models/container"),XMLHttpRequest=require("./util/xhr"),HttpError=require("standard-http-error"),vocab=require("solid-namespace");SolidWebClient.prototype.createContainer=function(e,t,r,o){return this.post(e,o,t,!0)},SolidWebClient.prototype.createResponse=function(e,t){var r=new SolidResponse(this.rdf,e,t);return"get"===r.method&&r.isContainer()?new SolidContainer(this.rdf,r.location,r):r},SolidWebClient.prototype.currentUrl=function(){return"undefined"!=typeof window?window.location.href:null},SolidWebClient.prototype.del=function(e){return this.solidRequest(e,"DELETE")},SolidWebClient.prototype.get=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t.headers=t.headers||{},t.headers.Accept||(t.headers.Accept=DEFAULT_ACCEPT),this.solidRequest(e,"GET",t)},SolidWebClient.prototype.head=function(e,t){return this.solidRequest(e,"HEAD",t)},SolidWebClient.prototype.loadParsedGraphs=function(e,t){var r=this,o=e.map(function(e){return r.get(e,t).then(function(e){return e.parsedGraph()}).catch(function(){return null}).then(function(t){return{uri:e,value:t}})});return Promise.all(o)},SolidWebClient.prototype.needsProxy=function(e){var t=this.currentUrl(),r=t&&"https:"===t.slice(0,6),o=e&&"http:"===e.slice(0,5);return r&&o},SolidWebClient.prototype.options=function(e){return this.solidRequest(e,"OPTIONS")},SolidWebClient.prototype.patch=function(e,t,r,o){var i=composePatchQuery(t,r),n="application/sparql-update";return o=o||{},o.headers=o.headers||{},o.headers["Content-Type"]=n,this.solidRequest(e,"PATCH",o,i)},SolidWebClient.prototype.post=function(e,t,r,o,i){var n;o?(n=this.vocab.ldp("BasicContainer"),i="text/turtle"):(n=this.vocab.ldp("Resource"),i=i||DEFAULT_MIME_TYPE);var s={};return s.headers={},s.headers.Link=n+'; rel="type"',s.headers["Content-Type"]=i,r&&r.length>0&&(s.headers.Slug=r),this.solidRequest(e,"POST",s,t)},SolidWebClient.prototype.proxyUrl=function(e,t){return t=t||this.config.proxyUrl,t.replace("{uri}",encodeURIComponent(e))},SolidWebClient.prototype.put=function(e,t,r,o){return o=o||{},o.headers=o.headers||{},r=r||DEFAULT_MIME_TYPE,o.headers["Content-Type"]=r,this.solidRequest(e,"PUT",o,t)},SolidWebClient.prototype.solidRequest=function(e,t,r,o){r=r||{},r.headers=r.headers||{},r.proxyUrl=r.proxyUrl||this.config.proxyUrl,r.timeout=r.timeout||this.config.timeout,(this.needsProxy(e)||r.forceProxy)&&(e=this.proxyUrl(e));var i=this;return new Promise(function(n,s){var u=new XMLHttpRequest;u.open(t,e),r.noCredentials||(u.withCredentials=!0);for(var l in r.headers)u.setRequestHeader(l,r.headers[l]);r.timeout&&(u.timeout=r.timeout),u.onload=function(){this.status>=200&&this.status<300?n(i.createResponse(this,t)):s(new HttpError(this.status,this.statusText,{xhr:this}))},u.onerror=function(){s(new HttpError(this.status,this.statusText,{xhr:this}))},"undefined"!=typeof o&&o?u.send(o):u.send()})},module.exports=getClient,module.exports.SolidWebClient=SolidWebClient;
},{"../config-default":205,"./models/container":207,"./models/response":209,"./util/web-util":211,"./util/xhr":212,"solid-namespace":214,"standard-http-error":228}],207:[function(require,module,exports){
"use strict";function SolidContainer(r,t,e){SolidResource.call(this,t,e),this.containers={},this.contentsUris=[],this.rdf=r,this.resources={},this.vocab=vocab(r),e&&this.initFromResponse(this.uri,e)}module.exports=SolidContainer;var graphUtil=require("../util/graph-util"),parseLinks=graphUtil.parseLinks,vocab=require("solid-namespace"),SolidResource=require("./resource");SolidContainer.prototype=Object.create(SolidResource.prototype),SolidContainer.prototype.constructor=SolidContainer,SolidContainer.prototype.appendFromGraph=function(r,t){var e=this.rdf.namedNode(this.uri);this.types=Object.keys(r.findTypeURIs(e));var i=parseLinks(r,null,this.vocab.ldp("contains"));this.contentsUris=this.contentsUris.concat(i.sort());var o,n=r.each(null,null,this.vocab.ldp("Container")),s=this;n.forEach(function(t){t.uri!==s.uri&&(o=new SolidContainer(s.rdf,t.uri),o.types=Object.keys(r.findTypeURIs(t)),s.containers[o.uri]=o)});var a,p,c,u;i.forEach(function(t){p=t in s.containers,a=t!==s.uri&&!p,a&&(c=new SolidResource(t),u=s.rdf.namedNode(t),c.types=Object.keys(r.findTypeURIs(u)),s.resources[t]=c)})},SolidContainer.prototype.findByType=function(r){var t,e,i=[];for(t in this.containers)e=this.containers[t],e.isType(r)&&i.push(e);var o;for(t in this.resources)o=this.resources[t],o.isType(r)&&i.push(o);return i},SolidContainer.prototype.initFromResponse=function(r,t){var e=t.contentType();if(!e)throw new Error("Cannot parse container without a Content-Type: header");var i=graphUtil.parseGraph(this.rdf,r,t.raw(),e);this.parsedGraph=i,this.appendFromGraph(i,r)},SolidResource.prototype.isContainer=function(){return!0},SolidContainer.prototype.isEmpty=function(){return 0===this.contentsUris.length};
},{"../util/graph-util":210,"./resource":208,"solid-namespace":214}],208:[function(require,module,exports){
"use strict";function SolidResource(i,t){this.name=null,this.parsedGraph=null,this.response=t,this.types=[],this.uri=i,t&&t.url!==i&&(this.uri=t.url),this.initName()}module.exports=SolidResource,SolidResource.prototype.initName=function(){if(this.uri){var i=this.uri.split("/");this.name=i.pop(),!this.name&&i.length>0&&(this.name=i.pop())}},SolidResource.prototype.isContainer=function(){return!1},SolidResource.prototype.isType=function(i){return this.types.indexOf(i)!==-1};
},{}],209:[function(require,module,exports){
"use strict";function SolidResponse(e,t,s){if(!t)return this.xhr=null,this.user="",this.method=null,this.types=[],void(this.graph=null);this.rdf=e;var i=t.getResponseHeader("Link");this.linkHeaders=webUtil.parseLinkHeader(i)||{},s=s?s.toLowerCase():"",this.method=s,this.acl=this.linkHeaders.acl,this.acl&&(this.acl=this.acl[0]),this.allowedMethods=this.parseAllowedMethods(t,s),this.graph=null,this.meta=this.linkHeaders.meta||this.linkHeaders.describedBy,this.meta&&(this.meta=this.meta[0]),this.types=this.typeLinkHeaders(),this.url=t.getResponseHeader("Location")||t.responseURL,this.user=t.getResponseHeader("User")||"",this.websocket=t.getResponseHeader("Updates-Via")||"",this.xhr=t}module.exports=SolidResponse;var webUtil=require("../util/web-util"),graphUtil=require("../util/graph-util");SolidResponse.prototype.aclAbsoluteUrl=function e(){if(!this.acl)return this.acl;var e=webUtil.absoluteUrl(this.url,this.acl);return e},SolidResponse.prototype.contentType=function(){return this.xhr?this.xhr.getResponseHeader("Content-Type"):null},SolidResponse.prototype.exists=function(){return this.xhr&&this.xhr.status>=200&&this.xhr.status<400},SolidResponse.prototype.isContainer=function(){return this.isType("http://www.w3.org/ns/ldp#Container")||this.isType("http://www.w3.org/ns/ldp#BasicContainer")},SolidResponse.prototype.isLoggedIn=function(){return this.user},SolidResponse.prototype.isType=function(e){return this.types.indexOf(e)!==-1},SolidResponse.prototype.metaAbsoluteUrl=function e(){if(!this.meta)return this.meta;var e=webUtil.absoluteUrl(this.url,this.meta);return e},SolidResponse.prototype.parseAllowedMethods=function(e,t){return"get"===t?{}:webUtil.parseAllowedMethods(e.getResponseHeader("Allow"),e.getResponseHeader("Accept-Patch"))},SolidResponse.prototype.parsedGraph=function(){return this.graph||(this.graph=graphUtil.parseGraph(this.rdf,this.url,this.raw(),this.contentType())),this.graph},SolidResponse.prototype.raw=function(){return this.xhr?this.xhr.response:null},SolidResponse.prototype.typeLinkHeaders=function(){if(!Array.isArray(this.linkHeaders.type))return[];var e=new Set(this.linkHeaders.type||[]);return Array.from(e)};
},{"../util/graph-util":210,"../util/web-util":211}],210:[function(require,module,exports){
"use strict";function appendGraph(e,t,r){t.statementsMatching(ALL_STATEMENTS).forEach(function(t){e.add(t.subject,t.predicate,t.object,t.why)})}function graphFromStatements(e,t){var r=e.graph();return t.forEach(function(e){r.addStatement(e)}),r}function parseGraph(e,t,r,a){var n=e.graph();return e.parse(r,n,t,a),n}function parseLinks(e,t,r,a,n){var s={},p=e.statementsMatching(t,r,a,n);return p.forEach(function(e){s[e.object.uri]=!0}),Object.keys(s)}function serializeStatements(e){var t=e.map(function(e){return e.toNT()});return t=t.join("\n")}module.exports.appendGraph=appendGraph,module.exports.parseGraph=parseGraph,module.exports.parseLinks=parseLinks,module.exports.serializeStatements=serializeStatements,module.exports.graphFromStatements=graphFromStatements;var ALL_STATEMENTS=null;
},{}],211:[function(require,module,exports){
"use strict";function absoluteUrl(t,e){return e&&"http"!==e.slice(0,4)?[t,e].map(function(t){return"/"===t[0]&&(t=t.slice(1)),"/"===t[t.length-1]&&(t=t.slice(0,t.length-1)),t}).join("/"):e}function composePatchQuery(t,e){var n="",r=!0;return t&&t.length>0&&(t=t.map(function(t){return statementToNT(t,r)}),n+="DELETE DATA { "+t.join(" . ")+" };\n"),e&&e.length>0&&(e=e.map(function(t){return statementToNT(t,r)}),n+="INSERT DATA { "+e.join(" . ")+" };\n"),n}function hostname(t){var e,n,r,o,s=t.split("//");return 2===s.length?(e=s[0],n=s[1]):n=t,o=n.split("/"),r=e?e+"//"+o[0]:o[0],t.startsWith("//")&&(r="//"+r),r}function parseAllowedMethods(t,e){var n={};if(t){var r=t.split(",");r.forEach(function(e){e&&t.indexOf(e)>=0&&(n[e.trim().toLowerCase()]=!0)})}return e&&e.indexOf("application/sparql-update")>=0&&(n.patch=!0),n}function parseLinkHeader(t){if(!t)return{};for(var e=/<[^>]*>\s*(\s*;\s*[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*")))*(,|$)/g,n=/[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*"))/g,r=t.match(e),o={},s=0;s<r.length;s++)for(var a=r[s].split(">"),l=a[0].substring(1),i=a[1],u=i.match(n),p=0;p<u.length;p++){var c=u[p],h=c.split("="),m=h[1].replace(/["']/g,"");o[m]||(o[m]=[]),o[m].push(l),o[m].length>1&&o[m].sort()}return o}function statementToNT(t,e){return"string"!=typeof t&&(t=t.toCanonical()),e&&t.endsWith(".")&&(t=t.slice(0,-1)),t}module.exports.absoluteUrl=absoluteUrl,module.exports.composePatchQuery=composePatchQuery,module.exports.hostname=hostname,module.exports.parseAllowedMethods=parseAllowedMethods,module.exports.parseLinkHeader=parseLinkHeader,module.exports.statementToNT=statementToNT;
},{}],212:[function(require,module,exports){
"use strict";var XMLHttpRequest;XMLHttpRequest="undefined"!=typeof tabulator&&tabulator.isExtension?Components.classes["@mozilla.org/xmlextras/xmlhttprequest;1"].createInstance().QueryInterface(Components.interfaces.nsIXMLHttpRequest):"undefined"!=typeof window&&"XMLHttpRequest"in window?window.XMLHttpRequest:require("xhr2"),module.exports=XMLHttpRequest;
},{"xhr2":undefined}],213:[function(require,module,exports){
module.exports={"_args":[[{"raw":"solid-client@^0.22.4","scope":null,"escapedName":"solid-client","name":"solid-client","rawSpec":"^0.22.4","spec":">=0.22.4 <0.23.0","type":"range"},"/var/www/ld/melvincarvalho/solid-ui"]],"_from":"solid-client@>=0.22.4 <0.23.0","_id":"solid-client@0.22.4","_inCache":true,"_location":"/solid-client","_nodeVersion":"6.4.0","_npmOperationalInternal":{"host":"packages-16-east.internal.npmjs.com","tmp":"tmp/solid-client-0.22.4.tgz_1472154074831_0.20079654408618808"},"_npmUser":{"name":"dan-f","email":"dfriedman58@gmail.com"},"_npmVersion":"3.10.3","_phantomChildren":{"solid-namespace":"0.0.1","standard-http-error":"2.0.0","xhr2":"0.1.3"},"_requested":{"raw":"solid-client@^0.22.4","scope":null,"escapedName":"solid-client","name":"solid-client","rawSpec":"^0.22.4","spec":">=0.22.4 <0.23.0","type":"range"},"_requiredBy":["/"],"_resolved":"https://registry.npmjs.org/solid-client/-/solid-client-0.22.4.tgz","_shasum":"191fc573b15830fa7aad851adc4428cd4a2f2621","_shrinkwrap":null,"_spec":"solid-client@^0.22.4","_where":"/var/www/ld/melvincarvalho/solid-ui","author":{"name":"Andrei Sambra","email":"andrei@fcns.eu"},"babel":{"presets":["es2015"]},"bugs":{"url":"https://github.com/solid/solid-client/issues"},"dependencies":{"rdflib":"^0.12.1","shorthash":"0.0.2","solid-auth-tls":"0.0.4","solid-namespace":"0.0.1","solid-permissions":"^0.2.1","solid-web-client":"0.0.8"},"description":"Common library for writing Solid read-write-web applications","devDependencies":{"babel-cli":"^6.11.4","babel-core":"^6.11.4","babel-loader":"^6.2.4","babel-preset-es2015":"^6.9.0","blue-tape":"^0.2.0","json-loader":"^0.5.4","qunit":"^0.9.0","standard":"^5.4.1","tape":"^4.4.0","webpack":"^1.13.1"},"directories":{},"dist":{"shasum":"191fc573b15830fa7aad851adc4428cd4a2f2621","tarball":"https://registry.npmjs.org/solid-client/-/solid-client-0.22.4.tgz"},"files":["index.js","config.js","lib","dist"],"gitHead":"6f4538e73861ae956fe24aece8aaf135ac99e01a","homepage":"https://github.com/solid/solid-client","keywords":["solid","decentralized","web","rdf","ldp","linked","data"],"license":"MIT","main":"./index.js","maintainers":[{"name":"codenamedmitri","email":"dzagidulin@gmail.com"},{"name":"dan-f","email":"dfriedman58@gmail.com"}],"name":"solid-client","optionalDependencies":{},"readme":"ERROR: No README data found!","repository":{"type":"git","url":"git+https://github.com/solid/solid-client.git"},"scripts":{"build":"npm run clean && mkdir dist && npm run build-with-rdflib && npm run build-without-rdflib","build-full":"webpack --progress --config webpack.config.js --output-filename solid-client-full.js","build-qunit-resources":"npm run clean && mkdir -p dist/resources && npm run build-full && browserify -r ./test/resources/profile-minimal.js:test-minimal-profile -o dist/resources/test-minimal-profile.js && browserify -r ./test/resources/profile-private.js:test-minimal-prefs -o dist/resources/test-minimal-prefs.js","build-with-rdflib":"webpack --progress --colors --optimize-minimize --optimize-occurrence-order --optimize-dedupe --config webpack.config.js","build-without-rdflib":"webpack --progress --colors --optimize-minimize --optimize-occurrence-order --optimize-dedupe --config webpack-no-rdflib.config.js","clean":"rm -rf dist/","postversion":"git push --follow-tags","prepublish":"npm run build","preversion":"npm test","qunit":"npm run build-qunit-resources && open test/integration/index.html","standard":"standard lib/*","tape":"tape test/unit/*.js","test":"npm run standard && npm run tape"},"standard":{"globals":["$rdf","SolidClient","tabulator","QUnit"]},"version":"0.22.4"}
},{}],214:[function(require,module,exports){
"use strict";function vocab(s){var w=require("rdf-ns")(s),t={acl:w.base("http://www.w3.org/ns/auth/acl#"),app:w.base("http://www.w3.org/ns/solid/app#"),dct:w.base("http://purl.org/dc/terms/"),foaf:w.base("http://xmlns.com/foaf/0.1/"),ldp:w.base("http://www.w3.org/ns/ldp#"),owl:w.base("http://www.w3.org/2002/07/owl#"),pim:w.base("http://www.w3.org/ns/pim/space#"),rdf:w.base("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),rdfs:w.base("http://www.w3.org/2000/01/rdf-schema#"),schema:w.base("http://schema.org/"),sioc:w.base("http://rdfs.org/sioc/ns#"),solid:w.base("http://www.w3.org/ns/solid/terms#"),vcard:w.base("http://www.w3.org/2006/vcard/ns#"),xsd:w.base("http://www.w3.org/2001/XMLSchema#")};return t}module.exports=vocab;
},{"rdf-ns":132}],215:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function modes(){var e=vocab(),t={READ:e.acl("Read"),WRITE:e.acl("Write"),APPEND:e.acl("Append"),CONTROL:e.acl("Control"),EVERYONE:e.foaf("Agent")};return t}function hashFragmentFor(e,t){var i=e+"-"+t;return hash.unique(i)}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),hash=require("shorthash"),vocab=require("solid-namespace"),INHERIT=!0,Authorization=function(){function e(t,i){_classCallCheck(this,e),this.accessModes={},this.agent=null,this.group=null,this.inherited=i,this.mailTo=[],this.originsAllowed={},this.resourceUrl=t}return _createClass(e,[{key:"addMailTo",value:function(e){"string"!=typeof e&&(e=e.object.uri),e.startsWith("mailto:")&&(e=e.split(":")[1]),this.mailTo.push(e),this.mailTo.sort()}},{key:"addMode",value:function(e){var t=this;return Array.isArray(e)?e.forEach(function(e){t.addModeSingle(e)}):t.addModeSingle(e),t}},{key:"addModeSingle",value:function(e){return"string"!=typeof e&&(e=e.object.uri),this.accessModes[e]=!0,this}},{key:"addOrigin",value:function(e){var t=this;return Array.isArray(e)?e.forEach(function(e){t.addOriginSingle(e)}):t.addOriginSingle(e),t}},{key:"addOriginSingle",value:function(e){return"string"!=typeof e&&(e=e.object.uri),this.originsAllowed[e]=!0,this}},{key:"allModes",value:function(){return Object.keys(this.accessModes)}},{key:"allOrigins",value:function(){return Object.keys(this.originsAllowed)}},{key:"allowsMode",value:function(t){return t=e.acl[t.toUpperCase()]||t,this.accessModes[t]}},{key:"allowsOrigin",value:function(e){return e in this.originsAllowed}},{key:"allowsRead",value:function(){return this.accessModes[e.acl.READ]}},{key:"allowsWrite",value:function(){return this.accessModes[e.acl.WRITE]}},{key:"allowsAppend",value:function(){return this.accessModes[e.acl.APPEND]||this.accessModes[e.acl.WRITE]}},{key:"allowsControl",value:function(){return this.accessModes[e.acl.CONTROL]}},{key:"equals",value:function(e){var t=this.agent===e.agent,i=this.group===e.group,r=this.resourceUrl===e.resourceUrl,n=Object.keys(this.accessModes),s=Object.keys(e.accessModes),a=n.length===s.length,o=JSON.stringify(this.inherited)===JSON.stringify(e.inherited),u=!0;n.forEach(function(t){e.accessModes[t]||(u=!1)});var l=JSON.stringify(this.mailTo)===JSON.stringify(e.mailTo),c=JSON.stringify(this.originsAllowed)===JSON.stringify(e.originsAllowed);return t&&i&&r&&a&&u&&o&&l&&c}},{key:"hashFragment",value:function e(){if(!this.webId||!this.resourceUrl)throw new Error("Cannot call hashFragment() on an incomplete authorization");var e=hashFragmentFor(this.webId(),this.resourceUrl);return e}},{key:"isAgent",value:function(){return this.agent}},{key:"isEmpty",value:function(){return 0===Object.keys(this.accessModes).length}},{key:"isPublic",value:function(){return this.group===e.acl.EVERYONE}},{key:"isGroup",value:function(){return this.group}},{key:"isInherited",value:function(){return this.inherited}},{key:"isValid",value:function(){return this.webId()&&this.resourceUrl&&!this.isEmpty()}},{key:"mergeWith",value:function(e){if(this.hashFragment()!==e.hashFragment())throw new Error("Cannot merge authorizations with different agent id or resource url (accessTo)");for(var t in e.accessModes)this.addMode(t)}},{key:"rdfStatements",value:function(e){if(!this.webId()||!this.resourceUrl)return[];var t,i=e.namedNode("#"+this.hashFragment()),r=vocab(e),n=[e.triple(i,r.rdf("type"),r.acl("Authorization"))];this.agent&&(t=e.triple(i,r.acl("agent"),e.namedNode(this.agent)),n.push(t)),this.mailTo.length>0&&this.mailTo.forEach(function(s){t=e.triple(i,r.acl("agent"),e.namedNode("mailto:"+s)),n.push(t)}),this.group&&(t=e.triple(i,r.acl("agentClass"),e.namedNode(this.group)),n.push(t)),t=e.triple(i,r.acl("accessTo"),e.namedNode(this.resourceUrl)),n.push(t);var s=Object.keys(this.accessModes);return s.forEach(function(s){t=e.triple(i,r.acl("mode"),e.namedNode(s)),n.push(t)}),this.inherited&&(t=e.triple(i,r.acl("defaultForNew"),e.namedNode(this.resourceUrl)),n.push(t)),this.allOrigins().forEach(function(s){t=e.triple(i,r.acl("origin"),e.namedNode(s)),n.push(t)}),n}},{key:"removeMode",value:function(e){var t=this;return Array.isArray(e)?e.forEach(function(e){t.removeModeSingle(e)}):t.removeModeSingle(e),t}},{key:"removeModeSingle",value:function(e){"string"!=typeof e&&(e=e.object.uri),delete this.accessModes[e]}},{key:"removeOrigin",value:function(e){var t=this;return Array.isArray(e)?e.forEach(function(e){t.removeOriginSingle(e)}):t.removeOriginSingle(e),t}},{key:"removeOriginSingle",value:function(e){"string"!=typeof e&&(e=e.object.uri),delete this.originsAllowed[e]}},{key:"setAgent",value:function(t){if("string"!=typeof t&&(t=t.object.uri),t===e.acl.EVERYONE)this.setPublic();else if(this.group)throw new Error("Cannot set agent, authorization already has a group set");t.startsWith("mailto:")?this.addMailTo(t):this.agent=t}},{key:"setGroup",value:function(e){if("string"!=typeof e&&(e=e.object.uri),this.agent)throw new Error("Cannot set group, authorization already has an agent set");this.group=e}},{key:"setPublic",value:function(){this.setGroup(e.acl.EVERYONE)}},{key:"webId",value:function(){return this.agent||this.group}}]),e}();Authorization.acl=modes(),Authorization.hashFragmentFor=hashFragmentFor,Authorization.INHERIT=INHERIT,module.exports=Authorization;
},{"shorthash":187,"solid-namespace":214}],216:[function(require,module,exports){
"use strict";function clearPermissions(e,r){var n;return r.head(e).then(function(e){if(n=e.aclAbsoluteUrl(),!n)throw new Error("ACL URL not found for resource.");return r.del(n)})}function getPermissions(e,r,n){var s,o;return r.head(e).then(function(t){if(s=t.aclAbsoluteUrl(),!s)throw new Error("ACL URL not found for resource.");return o=new PermissionSet(e,s,t.isContainer(),n,r),r.get(s).then(function(e){return e.parsedGraph()})}).then(function(e){return o.initFromGraph(e),o})}var PermissionSet=require("./permission-set");module.exports.clearPermissions=clearPermissions,module.exports.getPermissions=getPermissions,module.exports.PermissionSet=PermissionSet;
},{"./permission-set":217}],217:[function(require,module,exports){
"use strict";function PermissionSet(t,i,r,e){e=e||{},this.authorizations={},this.aclUrl=i,this.rdf=e.rdf,this.resourceType=r?CONTAINER:RESOURCE,this.resourceUrl=t,this.strictOrigin=e.strictOrigin,this.origin=e.origin,this.webClient=e.webClient,e.graph&&this.initFromGraph(e.graph)}function addAuthorization(t){var i=t.hashFragment();return i in this.authorizations?this.authorizations[i].mergeWith(t):this.authorizations[i]=t,this}function addGroupPermission(t,i){var r=new Authorization(this.resourceUrl,this.isAuthInherited());return r.setGroup(t),r.addMode(i),this.addAuthorization(r),this}function addPermission(t,i,r){if(!t)throw new Error("addPermission() requires a valid webId");if(!i)throw new Error("addPermission() requires a valid accessMode");var e=new Authorization(this.resourceUrl,this.isAuthInherited());return e.setAgent(t),e.addMode(i),r&&e.addOrigin(r),this.addAuthorization(e),this}function allAuthorizations(){var t,i=[],r=this;return Object.keys(this.authorizations).forEach(function(e){t=r.authorizations[e],i.push(t)}),i}function allowsPublic(t,i){i=i||this.resourceUrl;var r=this.permissionFor(acl.EVERYONE,i);return!!r&&r.allowsMode(t)}function buildGraph(t){var i=t.graph();return this.allAuthorizations().forEach(function(r){i.add(r.rdfStatements(t))}),i}function clear(t){if(t=t||this.webClient,!t)return Promise.reject(new Error("Cannot clear - no web client"));var i=this.aclUrl;return i?t.del(i):Promise.reject(new Error("Cannot clear - unknown target url"))}function count(){return Object.keys(this.authorizations).length}function equals(t){var i=this,r=this.resourceUrl===t.resourceUrl,e=this.aclUrl===t.aclUrl,o=this.resourceType===t.resourceType,n=Object.keys(this.authorizations),s=Object.keys(t.authorizations);if(n.length!==s.length)return!1;var a,u,h=!0;return n.forEach(function(r){a=i.authorizations[r],u=t.authorizations[r],u||(h=!1),a.equals(u)||(h=!1)}),r&&e&&o&&h}function forEach(t){var i=this;this.allAuthorizations().forEach(function(r){t.call(i,r)})}function initFromGraph(t,i){i=i||this.rdf;var r,e,o,n,s,a,u,h,c=ns(i),l=t.match(null,null,c.acl("Authorization")),d=this;if(l.length)l=l.map(function(t){return t.subject});else{var m={};l=t.match(null,c.acl("mode")),l.forEach(function(t){m[t.subject.value]=!0}),l=Object.keys(m)}l.forEach(function(i){r=t.match(i,c.acl("agent")),e=r.filter(isMailTo),r=r.filter(function(t){return!isMailTo(t)}),o=t.match(i,c.acl("agentClass")),n=t.match(i,c.acl("accessTo")),a=t.match(i,c.acl("mode")),u=t.match(i,c.acl("origin")),h=t.match(i,c.acl("defaultForNew")).length||t.match(i,c.acl("default")).length,r.forEach(function(t){n.forEach(function(i){s=new Authorization(i.object.uri,h),s.setAgent(t),s.addMode(a),s.addOrigin(u),e.forEach(function(t){s.addMailTo(t)}),d.addAuthorization(s)})}),o.forEach(function(t){n.forEach(function(i){s=new Authorization(i.object.uri,h),s.setGroup(t),s.addMode(a),s.addOrigin(u),d.addAuthorization(s)})})})}function isAuthInherited(){return this.resourceType===CONTAINER}function isEmpty(){return 0===this.count()}function permissionFor(t,i){if(!t)return null;i=i||this.resourceUrl;var r=Authorization.hashFragmentFor(t,i);return this.authorizations[r]}function removeAuthorization(t){var i=t.hashFragment();return delete this.authorizations[i],this}function removePermission(t,i){var r=this.permissionFor(t,this.resourceUrl);return r?(r.removeMode(i),r.isEmpty()&&this.removeAuthorization(r),this):this}function save(t,i,r){return(t=t||this.aclUrl)?(i=i||this.rdf)?(r=r||this.webClient,r?r.put(t,this.serialize(i)):Promise.reject(new Error("Cannot save - no web client"))):Promise.reject(new Error("Cannot save - no rdf library")):Promise.reject(new Error("Cannot save - unknown target url"))}function serialize(t,i){t=t||"text/turtle",i=i||this.rdf;var r=this.buildGraph(i),e=null,o=null;return new Promise(function(n,s){i.serialize(e,r,o,t,function(i,r){return i?s(i):r?void n(r):s(new Error("Error serializing the graph to "+t))})})}function isMailTo(t){return"string"==typeof t?t.startsWith("mailto:"):t.object.uri.startsWith("mailto:")}var Authorization=require("./authorization"),acl=Authorization.acl,ns=require("solid-namespace"),RESOURCE="resource",CONTAINER="container";PermissionSet.prototype.addAuthorization=addAuthorization,PermissionSet.prototype.addGroupPermission=addGroupPermission,PermissionSet.prototype.addPermission=addPermission,PermissionSet.prototype.allAuthorizations=allAuthorizations,PermissionSet.prototype.allowsPublic=allowsPublic,PermissionSet.prototype.buildGraph=buildGraph,PermissionSet.prototype.clear=clear,PermissionSet.prototype.count=count,PermissionSet.prototype.equals=equals,PermissionSet.prototype.forEach=forEach,PermissionSet.prototype.initFromGraph=initFromGraph,PermissionSet.prototype.isAuthInherited=isAuthInherited,PermissionSet.prototype.isEmpty=isEmpty,PermissionSet.prototype.permissionFor=permissionFor,PermissionSet.prototype.removeAuthorization=removeAuthorization,PermissionSet.prototype.removePermission=removePermission,PermissionSet.prototype.save=save,PermissionSet.prototype.serialize=serialize,module.exports=PermissionSet,module.exports.RESOURCE=RESOURCE,module.exports.CONTAINER=CONTAINER,module.exports.isMailTo=isMailTo;
},{"./authorization":215,"solid-namespace":214}],218:[function(require,module,exports){
arguments[4][205][0].apply(exports,arguments)
},{"dup":205}],219:[function(require,module,exports){
"use strict";function SolidWebClient(e,t){this.rdf=e,this.vocab=vocab(e),this.config=t||defaultConfig}function getClient(e,t){return new SolidWebClient(e,t)}var DEFAULT_ACCEPT="text/turtle;q=0.8,*/*;q=0.5",DEFAULT_MIME_TYPE="text/turtle",defaultConfig=require("../config-default"),composePatchQuery=require("./util/web-util").composePatchQuery,SolidResponse=require("./models/response"),SolidContainer=require("./models/container"),XMLHttpRequest=require("./util/xhr"),HttpError=require("standard-http-error"),vocab=require("solid-namespace");SolidWebClient.prototype.createContainer=function(e,t,r,o){return this.post(e,o,t,!0)},SolidWebClient.prototype.createResponse=function(e,t){var r=new SolidResponse(this.rdf,e,t);return"get"===r.method&&r.isContainer()?new SolidContainer(this.rdf,r.location,r):r},SolidWebClient.prototype.currentUrl=function(){return"undefined"!=typeof window?window.location.href:null},SolidWebClient.prototype.del=function(e){return this.solidRequest(e,"DELETE")},SolidWebClient.prototype.get=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.headers=t.headers||{},t.headers.Accept||(t.headers.Accept=DEFAULT_ACCEPT),this.solidRequest(e,"GET",t)},SolidWebClient.prototype.head=function(e,t){return this.solidRequest(e,"HEAD",t)},SolidWebClient.prototype.loadParsedGraphs=function(e,t){var r=this,o=e.map(function(e){return r.get(e,t).then(function(e){return e.parsedGraph()}).catch(function(){return null}).then(function(t){return{uri:e,value:t}})});return Promise.all(o)},SolidWebClient.prototype.needsProxy=function(e){var t=this.currentUrl(),r=t&&"https:"===t.slice(0,6),o=e&&"http:"===e.slice(0,5);return r&&o},SolidWebClient.prototype.options=function(e){return this.solidRequest(e,"OPTIONS")},SolidWebClient.prototype.patch=function(e,t,r,o){var i=composePatchQuery(t,r),n="application/sparql-update";return o=o||{},o.headers=o.headers||{},o.headers["Content-Type"]=n,this.solidRequest(e,"PATCH",o,i)},SolidWebClient.prototype.post=function(e,t,r,o,i){var n;o?(n=this.vocab.ldp("BasicContainer"),i="text/turtle"):(n=this.vocab.ldp("Resource"),i=i||DEFAULT_MIME_TYPE);var s={};return s.headers={},s.headers.Link=n+'; rel="type"',s.headers["Content-Type"]=i,r&&r.length>0&&(s.headers.Slug=r),this.solidRequest(e,"POST",s,t)},SolidWebClient.prototype.proxyUrl=function(e,t){return t=t||this.config.proxyUrl,t.replace("{uri}",encodeURIComponent(e))},SolidWebClient.prototype.put=function(e,t,r,o){return o=o||{},o.headers=o.headers||{},r=r||DEFAULT_MIME_TYPE,o.headers["Content-Type"]=r,this.solidRequest(e,"PUT",o,t)},SolidWebClient.prototype.solidRequest=function(e,t,r,o){r=r||{},r.headers=r.headers||{},r.proxyUrl=r.proxyUrl||this.config.proxyUrl,r.timeout=r.timeout||this.config.timeout,(this.needsProxy(e)||r.forceProxy)&&(e=this.proxyUrl(e));var i=this;return new Promise(function(n,s){var u=new XMLHttpRequest;u.open(t,e),r.noCredentials||(u.withCredentials=!0);for(var l in r.headers)u.setRequestHeader(l,r.headers[l]);r.timeout&&(u.timeout=r.timeout),u.onload=function(){this.status>=200&&this.status<300?n(i.createResponse(this,t)):s(new HttpError(this.status,this.statusText,{xhr:this}))},u.onerror=function(){s(new HttpError(this.status,this.statusText,{xhr:this}))},"undefined"!=typeof o&&o?u.send(o):u.send()})},module.exports=getClient,module.exports.SolidWebClient=SolidWebClient;
},{"../config-default":218,"./models/container":220,"./models/response":222,"./util/web-util":224,"./util/xhr":225,"solid-namespace":214,"standard-http-error":228}],220:[function(require,module,exports){
arguments[4][207][0].apply(exports,arguments)
},{"../util/graph-util":223,"./resource":221,"dup":207,"solid-namespace":214}],221:[function(require,module,exports){
arguments[4][208][0].apply(exports,arguments)
},{"dup":208}],222:[function(require,module,exports){
"use strict";function SolidResponse(e,t,s){if(!t)return this.xhr=null,this.user="",this.method=null,this.types=[],void(this.graph=null);this.rdf=e;var r=t.getResponseHeader("Link");this.linkHeaders=webUtil.parseLinkHeader(r)||{},s=s?s.toLowerCase():"",this.method=s,this.acl=this.linkHeaders.acl,this.acl&&(this.acl=this.acl[0]),this.allowedMethods=this.parseAllowedMethods(t,s),this.graph=null,this.meta=this.linkHeaders.meta||this.linkHeaders.describedBy,this.meta&&(this.meta=this.meta[0]),this.types=this.typeLinkHeaders(),this.url=t.getResponseHeader("Location")||t.responseURL,this.user=t.getResponseHeader("User")||"",this.websocket=t.getResponseHeader("Updates-Via")||"",this.xhr=t}module.exports=SolidResponse;var webUtil=require("../util/web-util"),graphUtil=require("../util/graph-util");SolidResponse.prototype.aclAbsoluteUrl=function(){return this.acl?this.resolveMetaOrAclUrl("acl"):null},SolidResponse.prototype.contentType=function(){return this.xhr?this.xhr.getResponseHeader("Content-Type"):null},SolidResponse.prototype.exists=function(){return this.xhr&&this.xhr.status>=200&&this.xhr.status<400},SolidResponse.prototype.isContainer=function(){return this.isType("http://www.w3.org/ns/ldp#Container")||this.isType("http://www.w3.org/ns/ldp#BasicContainer")},SolidResponse.prototype.isLoggedIn=function(){return this.user},SolidResponse.prototype.isType=function(e){return this.types.indexOf(e)!==-1},SolidResponse.prototype.metaAbsoluteUrl=function(){return this.meta?this.resolveMetaOrAclUrl("meta"):null},SolidResponse.prototype.parseAllowedMethods=function(e,t){return"get"===t?{}:webUtil.parseAllowedMethods(e.getResponseHeader("Allow"),e.getResponseHeader("Accept-Patch"))},SolidResponse.prototype.parsedGraph=function(){return this.graph||(this.graph=graphUtil.parseGraph(this.rdf,this.url,this.raw(),this.contentType())),this.graph},SolidResponse.prototype.raw=function(){return this.xhr?this.xhr.response:null},SolidResponse.prototype.resolveMetaOrAclUrl=function(e){if(!this.url)return null;var t=this[e],s=this.url.slice(0,this.url.lastIndexOf("/")+1);return webUtil.absoluteUrl(s,t)},SolidResponse.prototype.typeLinkHeaders=function(){if(!Array.isArray(this.linkHeaders.type))return[];var e=new Set(this.linkHeaders.type||[]);return Array.from(e)};
},{"../util/graph-util":223,"../util/web-util":224}],223:[function(require,module,exports){
arguments[4][210][0].apply(exports,arguments)
},{"dup":210}],224:[function(require,module,exports){
arguments[4][211][0].apply(exports,arguments)
},{"dup":211}],225:[function(require,module,exports){
arguments[4][212][0].apply(exports,arguments)
},{"dup":212,"xhr2":undefined}],226:[function(require,module,exports){
function StandardError(r,t){if(r&&"object"==typeof r?(t=r,r=void 0):this.message=r,t)for(var a in t)this[a]=t[a];has.call(this,"name")||(this.name=has.call(proto(this),"name")?this.name:this.constructor.name),!trace||"stack"in this||trace(this,this.constructor)}var has=Object.hasOwnProperty,proto=Object.getPrototypeOf,trace=Error.captureStackTrace;module.exports=StandardError,StandardError.prototype=Object.create(Error.prototype,{constructor:{value:StandardError,configurable:!0,writable:!0}}),StandardError.prototype.name="StandardError";
},{}],227:[function(require,module,exports){
module.exports={"100":"Continue","101":"Switching Protocols","102":"Processing","200":"OK","201":"Created","202":"Accepted","203":"Non-Authoritative Information","204":"No Content","205":"Reset Content","206":"Partial Content","207":"Multi-Status","208":"Already Reported","226":"IM Used","300":"Multiple Choices","301":"Moved Permanently","302":"Found","303":"See Other","304":"Not Modified","305":"Use Proxy","307":"Temporary Redirect","308":"Permanent Redirect","400":"Bad Request","401":"Unauthorized","402":"Payment Required","403":"Forbidden","404":"Not Found","405":"Method Not Allowed","406":"Not Acceptable","407":"Proxy Authentication Required","408":"Request Timeout","409":"Conflict","410":"Gone","411":"Length Required","412":"Precondition Failed","413":"Payload Too Large","414":"URI Too Long","415":"Unsupported Media Type","416":"Range Not Satisfiable","417":"Expectation Failed","418":"I'm a teapot","421":"Misdirected Request","422":"Unprocessable Entity","423":"Locked","424":"Failed Dependency","425":"Unordered Collection","426":"Upgrade Required","428":"Precondition Required","429":"Too Many Requests","431":"Request Header Fields Too Large","500":"Internal Server Error","501":"Not Implemented","502":"Bad Gateway","503":"Service Unavailable","504":"Gateway Timeout","505":"HTTP Version Not Supported","506":"Variant Also Negotiates","507":"Insufficient Storage","508":"Loop Detected","509":"Bandwidth Limit Exceeded","510":"Not Extended","511":"Network Authentication Required"}
},{}],228:[function(require,module,exports){
function HttpError(r,t,e){if("string"==typeof r&&(r=STATUS_NAME_TO_CODE[r]),"number"!=typeof r)throw new TypeError("Non-numeric HTTP code");"object"==typeof t&&null!=t&&(e=t,t=null),StandardError.call(this,t||STATUS_CODE_TO_NAME[r],e),this.code=r}function alias(r){return{configurable:!0,get:function(){return this[r]},set:function(t){return this[r]=t}}}exports=module.exports=HttpError;var StandardError=require("standard-error"),STATUS_CODE_TO_NAME=require("./codes"),STATUS_NAME_TO_CODE=exports;HttpError.prototype=Object.create(StandardError.prototype,{constructor:{value:HttpError,configurable:!0,writable:!0}}),HttpError.prototype.name="HttpError",Object.defineProperties(HttpError.prototype,{statusCode:alias("code"),statusMessage:alias("message"),status:{configurable:!0,get:function(){return this.code},set:function(r){Object.defineProperty(this,"status",{value:r,configurable:!0,enumerable:!0,writable:!0})}}}),HttpError.prototype.toString=function(){return this.name+": "+this.code+" "+this.message};for(var code in STATUS_CODE_TO_NAME){var name=STATUS_CODE_TO_NAME[code];exports[name.replace("'","").replace(/[- ]/g,"_").toUpperCase()]=+code}
},{"./codes":227,"standard-error":226}],229:[function(require,module,exports){
function Stream(){EE.call(this)}module.exports=Stream;var EE=require("events").EventEmitter,inherits=require("inherits");inherits(Stream,EE),Stream.Readable=require("readable-stream/readable.js"),Stream.Writable=require("readable-stream/writable.js"),Stream.Duplex=require("readable-stream/duplex.js"),Stream.Transform=require("readable-stream/transform.js"),Stream.PassThrough=require("readable-stream/passthrough.js"),Stream.Stream=Stream,Stream.prototype.pipe=function(e,r){function t(r){e.writable&&!1===e.write(r)&&m.pause&&m.pause()}function n(){m.readable&&m.resume&&m.resume()}function a(){u||(u=!0,e.end())}function o(){u||(u=!0,"function"==typeof e.destroy&&e.destroy())}function i(e){if(s(),0===EE.listenerCount(this,"error"))throw e}function s(){m.removeListener("data",t),e.removeListener("drain",n),m.removeListener("end",a),m.removeListener("close",o),m.removeListener("error",i),e.removeListener("error",i),m.removeListener("end",s),m.removeListener("close",s),e.removeListener("close",s)}var m=this;m.on("data",t),e.on("drain",n),e._isStdio||r&&r.end===!1||(m.on("end",a),m.on("close",o));var u=!1;return m.on("error",i),e.on("error",i),m.on("end",s),m.on("close",s),e.on("close",s),e.emit("pipe",m),e};
},{"events":86,"inherits":97,"readable-stream/duplex.js":167,"readable-stream/passthrough.js":174,"readable-stream/readable.js":175,"readable-stream/transform.js":176,"readable-stream/writable.js":177}],230:[function(require,module,exports){
(function (global){
var ClientRequest=require("./lib/request"),extend=require("xtend"),statusCodes=require("builtin-status-codes"),url=require("url"),http=exports;http.request=function(t,e){t="string"==typeof t?url.parse(t):extend(t);var r=global.location.protocol.search(/^https?:$/)===-1?"http:":"",s=t.protocol||r,o=t.hostname||t.host,n=t.port,u=t.path||"/";o&&o.indexOf(":")!==-1&&(o="["+o+"]"),t.url=(o?s+"//"+o:"")+(n?":"+n:"")+u,t.method=(t.method||"GET").toUpperCase(),t.headers=t.headers||{};var C=new ClientRequest(t);return e&&C.on("response",e),C},http.get=function(t,e){var r=http.request(t,e);return r.end(),r},http.Agent=function(){},http.Agent.defaultMaxSockets=4,http.STATUS_CODES=statusCodes,http.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"];
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./lib/request":232,"builtin-status-codes":48,"url":236,"xtend":247}],231:[function(require,module,exports){
(function (global){
function checkTypeSupport(e){try{return xhr.responseType=e,xhr.responseType===e}catch(e){}return!1}function isFunction(e){return"function"==typeof e}exports.fetch=isFunction(global.fetch)&&isFunction(global.ReadableStream),exports.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),exports.blobConstructor=!0}catch(e){}var xhr=new global.XMLHttpRequest;xhr.open("GET",global.XDomainRequest?"/":"https://example.com");var haveArrayBuffer="undefined"!=typeof global.ArrayBuffer,haveSlice=haveArrayBuffer&&isFunction(global.ArrayBuffer.prototype.slice);exports.arraybuffer=haveArrayBuffer&&checkTypeSupport("arraybuffer"),exports.msstream=!exports.fetch&&haveSlice&&checkTypeSupport("ms-stream"),exports.mozchunkedarraybuffer=!exports.fetch&&haveArrayBuffer&&checkTypeSupport("moz-chunked-arraybuffer"),exports.overrideMimeType=isFunction(xhr.overrideMimeType),exports.vbArray=isFunction(global.VBArray),xhr=null;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],232:[function(require,module,exports){
(function (process,global,Buffer){
function decideMode(e,t){return capability.fetch&&t?"fetch":capability.mozchunkedarraybuffer?"moz-chunked-arraybuffer":capability.msstream?"ms-stream":capability.arraybuffer&&e?"arraybuffer":capability.vbArray&&e?"text:vbarray":"text"}function statusValid(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return!1}}var capability=require("./capability"),inherits=require("inherits"),response=require("./response"),stream=require("readable-stream"),toArrayBuffer=require("to-arraybuffer"),IncomingMessage=response.IncomingMessage,rStates=response.readyStates,ClientRequest=module.exports=function(e){var t=this;stream.Writable.call(t),t._opts=e,t._body=[],t._headers={},e.auth&&t.setHeader("Authorization","Basic "+new Buffer(e.auth).toString("base64")),Object.keys(e.headers).forEach(function(r){t.setHeader(r,e.headers[r])});var r,o=!0;if("disable-fetch"===e.mode)o=!1,r=!0;else if("prefer-streaming"===e.mode)r=!1;else if("allow-wrong-content-type"===e.mode)r=!capability.overrideMimeType;else{if(e.mode&&"default"!==e.mode&&"prefer-fast"!==e.mode)throw new Error("Invalid value for opts.mode");r=!0}t._mode=decideMode(r,o),t.on("finish",function(){t._onFinish()})};inherits(ClientRequest,stream.Writable),ClientRequest.prototype.setHeader=function(e,t){var r=this,o=e.toLowerCase();unsafeHeaders.indexOf(o)===-1&&(r._headers[o]={name:e,value:t})},ClientRequest.prototype.getHeader=function(e){var t=this;return t._headers[e.toLowerCase()].value},ClientRequest.prototype.removeHeader=function(e){var t=this;delete t._headers[e.toLowerCase()]},ClientRequest.prototype._onFinish=function(){var e=this;if(!e._destroyed){var t,r=e._opts,o=e._headers;if("POST"!==r.method&&"PUT"!==r.method&&"PATCH"!==r.method&&"MERGE"!==r.method||(t=capability.blobConstructor?new global.Blob(e._body.map(function(e){return toArrayBuffer(e)}),{type:(o["content-type"]||{}).value||""}):Buffer.concat(e._body).toString()),"fetch"===e._mode){var n=Object.keys(o).map(function(e){return[o[e].name,o[e].value]});global.fetch(e._opts.url,{method:e._opts.method,headers:n,body:t,mode:"cors",credentials:r.withCredentials?"include":"same-origin"}).then(function(t){e._fetchResponse=t,e._connect()},function(t){e.emit("error",t)})}else{var s=e._xhr=new global.XMLHttpRequest;try{s.open(e._opts.method,e._opts.url,!0)}catch(t){return void process.nextTick(function(){e.emit("error",t)})}"responseType"in s&&(s.responseType=e._mode.split(":")[0]),"withCredentials"in s&&(s.withCredentials=!!r.withCredentials),"text"===e._mode&&"overrideMimeType"in s&&s.overrideMimeType("text/plain; charset=x-user-defined"),Object.keys(o).forEach(function(e){s.setRequestHeader(o[e].name,o[e].value)}),e._response=null,s.onreadystatechange=function(){switch(s.readyState){case rStates.LOADING:case rStates.DONE:e._onXHRProgress()}},"moz-chunked-arraybuffer"===e._mode&&(s.onprogress=function(){e._onXHRProgress()}),s.onerror=function(){e._destroyed||e.emit("error",new Error("XHR error"))};try{s.send(t)}catch(t){return void process.nextTick(function(){e.emit("error",t)})}}}},ClientRequest.prototype._onXHRProgress=function(){var e=this;statusValid(e._xhr)&&!e._destroyed&&(e._response||e._connect(),e._response._onXHRProgress())},ClientRequest.prototype._connect=function(){var e=this;e._destroyed||(e._response=new IncomingMessage(e._xhr,e._fetchResponse,e._mode),e.emit("response",e._response))},ClientRequest.prototype._write=function(e,t,r){var o=this;o._body.push(e),r()},ClientRequest.prototype.abort=ClientRequest.prototype.destroy=function(){var e=this;e._destroyed=!0,e._response&&(e._response._destroyed=!0),e._xhr&&e._xhr.abort()},ClientRequest.prototype.end=function(e,t,r){var o=this;"function"==typeof e&&(r=e,e=void 0),stream.Writable.prototype.end.call(o,e,t,r)},ClientRequest.prototype.flushHeaders=function(){},ClientRequest.prototype.setTimeout=function(){},ClientRequest.prototype.setNoDelay=function(){},ClientRequest.prototype.setSocketKeepAlive=function(){};var unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];
}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("buffer").Buffer)

},{"./capability":231,"./response":233,"_process":120,"buffer":47,"inherits":97,"readable-stream":175,"to-arraybuffer":235}],233:[function(require,module,exports){
(function (process,global,Buffer){
var capability=require("./capability"),inherits=require("inherits"),stream=require("readable-stream"),rStates=exports.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},IncomingMessage=exports.IncomingMessage=function(e,r,s){function a(){n.read().then(function(e){if(!t._destroyed){if(e.done)return void t.push(null);t.push(new Buffer(e.value)),a()}})}var t=this;if(stream.Readable.call(t),t._mode=s,t.headers={},t.rawHeaders=[],t.trailers={},t.rawTrailers=[],t.on("end",function(){process.nextTick(function(){t.emit("close")})}),"fetch"===s){t._fetchResponse=r,t.url=r.url,t.statusCode=r.status,t.statusMessage=r.statusText,r.headers.forEach(function(e,r){t.headers[r.toLowerCase()]=e,t.rawHeaders.push(r,e)});var n=r.body.getReader();a()}else{t._xhr=e,t._pos=0,t.url=e.responseURL,t.statusCode=e.status,t.statusMessage=e.statusText;var o=e.getAllResponseHeaders().split(/\r?\n/);if(o.forEach(function(e){var r=e.match(/^([^:]+):\s*(.*)/);if(r){var s=r[1].toLowerCase();"set-cookie"===s?(void 0===t.headers[s]&&(t.headers[s]=[]),t.headers[s].push(r[2])):void 0!==t.headers[s]?t.headers[s]+=", "+r[2]:t.headers[s]=r[2],t.rawHeaders.push(r[1],r[2])}}),t._charset="x-user-defined",!capability.overrideMimeType){var i=t.rawHeaders["mime-type"];if(i){var u=i.match(/;\s*charset=([^;])(;|$)/);u&&(t._charset=u[1].toLowerCase())}t._charset||(t._charset="utf-8")}}};inherits(IncomingMessage,stream.Readable),IncomingMessage.prototype._read=function(){},IncomingMessage.prototype._onXHRProgress=function(){var e=this,r=e._xhr,s=null;switch(e._mode){case"text:vbarray":if(r.readyState!==rStates.DONE)break;try{s=new global.VBArray(r.responseBody).toArray()}catch(e){}if(null!==s){e.push(new Buffer(s));break}case"text":try{s=r.responseText}catch(r){e._mode="text:vbarray";break}if(s.length>e._pos){var a=s.substr(e._pos);if("x-user-defined"===e._charset){for(var t=new Buffer(a.length),n=0;n<a.length;n++)t[n]=255&a.charCodeAt(n);e.push(t)}else e.push(a,e._charset);e._pos=s.length}break;case"arraybuffer":if(r.readyState!==rStates.DONE||!r.response)break;s=r.response,e.push(new Buffer(new Uint8Array(s)));break;case"moz-chunked-arraybuffer":if(s=r.response,r.readyState!==rStates.LOADING||!s)break;e.push(new Buffer(new Uint8Array(s)));break;case"ms-stream":if(s=r.response,r.readyState!==rStates.LOADING)break;var o=new global.MSStreamReader;o.onprogress=function(){o.result.byteLength>e._pos&&(e.push(new Buffer(new Uint8Array(o.result.slice(e._pos)))),e._pos=o.result.byteLength)},o.onload=function(){e.push(null)},o.readAsArrayBuffer(s)}e._xhr.readyState===rStates.DONE&&"ms-stream"!==e._mode&&e.push(null)};
}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("buffer").Buffer)

},{"./capability":231,"_process":120,"buffer":47,"inherits":97,"readable-stream":175}],234:[function(require,module,exports){
function assertEncoding(e){if(e&&!isBufferEncoding(e))throw new Error("Unknown encoding: "+e)}function passThroughWrite(e){return e.toString(this.encoding)}function utf16DetectIncompleteChar(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var Buffer=require("buffer").Buffer,isBufferEncoding=Buffer.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},StringDecoder=exports.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};StringDecoder.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";e=e.slice(r,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var h=t.charCodeAt(t.length-1);if(!(h>=55296&&h<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i);var i=t.length-1,h=t.charCodeAt(i);if(h>=55296&&h<=56319){var c=this.surrogateSize;return this.charLength+=c,this.charReceived+=c,this.charBuffer.copy(this.charBuffer,c,0,c),e.copy(this.charBuffer,0,0,c),t.substring(0,i)}return t},StringDecoder.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},StringDecoder.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,h=this.charBuffer,i=this.encoding;t+=h.slice(0,r).toString(i)}return t};
},{"buffer":47}],235:[function(require,module,exports){
var Buffer=require("buffer").Buffer;module.exports=function(e){if(e instanceof Uint8Array){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;if("function"==typeof e.buffer.slice)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(Buffer.isBuffer(e)){for(var f=new Uint8Array(e.length),r=e.length,t=0;t<r;t++)f[t]=e[t];return f.buffer}throw new Error("Argument must be a Buffer")};
},{"buffer":47}],236:[function(require,module,exports){
"use strict";function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function urlParse(t,s,e){if(t&&util.isObject(t)&&t instanceof Url)return t;var h=new Url;return h.parse(t,s,e),h}function urlFormat(t){return util.isString(t)&&(t=urlParse(t)),t instanceof Url?t.format():Url.prototype.format.call(t)}function urlResolve(t,s){return urlParse(t,!1,!0).resolve(s)}function urlResolveObject(t,s){return t?urlParse(t,!1,!0).resolveObject(s):s}var punycode=require("punycode"),util=require("./util");exports.parse=urlParse,exports.resolve=urlResolve,exports.resolveObject=urlResolveObject,exports.format=urlFormat,exports.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=require("querystring");Url.prototype.parse=function(t,s,e){if(!util.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var h=t.indexOf("?"),r=h!==-1&&h<t.indexOf("#")?"?":"#",a=t.split(r),o=/\\/g;a[0]=a[0].replace(o,"/"),t=a.join(r);var n=t;if(n=n.trim(),!e&&1===t.split("#").length){var i=simplePathPattern.exec(n);if(i)return this.path=n,this.href=n,this.pathname=i[1],i[2]?(this.search=i[2],s?this.query=querystring.parse(this.search.substr(1)):this.query=this.search.substr(1)):s&&(this.search="",this.query={}),this}var l=protocolPattern.exec(n);if(l){l=l[0];var u=l.toLowerCase();this.protocol=u,n=n.substr(l.length)}if(e||l||n.match(/^\/\/[^@\/]+@[^@\/]+/)){var p="//"===n.substr(0,2);!p||l&&hostlessProtocol[l]||(n=n.substr(2),this.slashes=!0)}if(!hostlessProtocol[l]&&(p||l&&!slashedProtocol[l])){for(var c=-1,f=0;f<hostEndingChars.length;f++){var m=n.indexOf(hostEndingChars[f]);m!==-1&&(c===-1||m<c)&&(c=m)}var v,g;g=c===-1?n.lastIndexOf("@"):n.lastIndexOf("@",c),g!==-1&&(v=n.slice(0,g),n=n.slice(g+1),this.auth=decodeURIComponent(v)),c=-1;for(var f=0;f<nonHostChars.length;f++){var m=n.indexOf(nonHostChars[f]);m!==-1&&(c===-1||m<c)&&(c=m)}c===-1&&(c=n.length),this.host=n.slice(0,c),n=n.slice(c),this.parseHost(),this.hostname=this.hostname||"";var y="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!y)for(var P=this.hostname.split(/\./),f=0,d=P.length;f<d;f++){var q=P[f];if(q&&!q.match(hostnamePartPattern)){for(var b="",O=0,j=q.length;O<j;O++)b+=q.charCodeAt(O)>127?"x":q[O];if(!b.match(hostnamePartPattern)){var x=P.slice(0,f),U=P.slice(f+1),C=q.match(hostnamePartStart);C&&(x.push(C[1]),U.unshift(C[2])),U.length&&(n="/"+U.join(".")+n),this.hostname=x.join(".");break}}}this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=punycode.toASCII(this.hostname));var A=this.port?":"+this.port:"",w=this.hostname||"";this.host=w+A,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==n[0]&&(n="/"+n))}if(!unsafeProtocol[u])for(var f=0,d=autoEscape.length;f<d;f++){var E=autoEscape[f];if(n.indexOf(E)!==-1){var I=encodeURIComponent(E);I===E&&(I=escape(E)),n=n.split(E).join(I)}}var R=n.indexOf("#");R!==-1&&(this.hash=n.substr(R),n=n.slice(0,R));var S=n.indexOf("?");if(S!==-1?(this.search=n.substr(S),this.query=n.substr(S+1),s&&(this.query=querystring.parse(this.query)),n=n.slice(0,S)):s&&(this.search="",this.query={}),n&&(this.pathname=n),slashedProtocol[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var A=this.pathname||"",k=this.search||"";this.path=A+k}return this.href=this.format(),this},Url.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var s=this.protocol||"",e=this.pathname||"",h=this.hash||"",r=!1,a="";this.host?r=t+this.host:this.hostname&&(r=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&util.isObject(this.query)&&Object.keys(this.query).length&&(a=querystring.stringify(this.query));var o=this.search||a&&"?"+a||"";return s&&":"!==s.substr(-1)&&(s+=":"),this.slashes||(!s||slashedProtocol[s])&&r!==!1?(r="//"+(r||""),e&&"/"!==e.charAt(0)&&(e="/"+e)):r||(r=""),h&&"#"!==h.charAt(0)&&(h="#"+h),o&&"?"!==o.charAt(0)&&(o="?"+o),e=e.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),o=o.replace("#","%23"),s+r+e+o+h},Url.prototype.resolve=function(t){return this.resolveObject(urlParse(t,!1,!0)).format()},Url.prototype.resolveObject=function(t){if(util.isString(t)){var s=new Url;s.parse(t,!1,!0),t=s}for(var e=new Url,h=Object.keys(this),r=0;r<h.length;r++){var a=h[r];e[a]=this[a]}if(e.hash=t.hash,""===t.href)return e.href=e.format(),e;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),n=0;n<o.length;n++){var i=o[n];"protocol"!==i&&(e[i]=t[i])}return slashedProtocol[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(t.protocol&&t.protocol!==e.protocol){if(!slashedProtocol[t.protocol]){for(var l=Object.keys(t),u=0;u<l.length;u++){var p=l[u];e[p]=t[p]}return e.href=e.format(),e}if(e.protocol=t.protocol,t.host||hostlessProtocol[t.protocol])e.pathname=t.pathname;else{for(var c=(t.pathname||"").split("/");c.length&&!(t.host=c.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==c[0]&&c.unshift(""),c.length<2&&c.unshift(""),e.pathname=c.join("/")}if(e.search=t.search,e.query=t.query,e.host=t.host||"",e.auth=t.auth,e.hostname=t.hostname||t.host,e.port=t.port,e.pathname||e.search){var f=e.pathname||"",m=e.search||"";e.path=f+m}return e.slashes=e.slashes||t.slashes,e.href=e.format(),e}var v=e.pathname&&"/"===e.pathname.charAt(0),g=t.host||t.pathname&&"/"===t.pathname.charAt(0),y=g||v||e.host&&t.pathname,P=y,d=e.pathname&&e.pathname.split("/")||[],c=t.pathname&&t.pathname.split("/")||[],q=e.protocol&&!slashedProtocol[e.protocol];if(q&&(e.hostname="",e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===c[0]?c[0]=t.host:c.unshift(t.host)),t.host=null),y=y&&(""===c[0]||""===d[0])),g)e.host=t.host||""===t.host?t.host:e.host,e.hostname=t.hostname||""===t.hostname?t.hostname:e.hostname,e.search=t.search,e.query=t.query,d=c;else if(c.length)d||(d=[]),d.pop(),d=d.concat(c),e.search=t.search,e.query=t.query;else if(!util.isNullOrUndefined(t.search)){if(q){e.hostname=e.host=d.shift();var b=!!(e.host&&e.host.indexOf("@")>0)&&e.host.split("@");b&&(e.auth=b.shift(),e.host=e.hostname=b.shift())}return e.search=t.search,e.query=t.query,util.isNull(e.pathname)&&util.isNull(e.search)||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!d.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var O=d.slice(-1)[0],j=(e.host||t.host||d.length>1)&&("."===O||".."===O)||""===O,x=0,U=d.length;U>=0;U--)O=d[U],"."===O?d.splice(U,1):".."===O?(d.splice(U,1),x++):x&&(d.splice(U,1),x--);if(!y&&!P)for(;x--;x)d.unshift("..");!y||""===d[0]||d[0]&&"/"===d[0].charAt(0)||d.unshift(""),j&&"/"!==d.join("/").substr(-1)&&d.push("");var C=""===d[0]||d[0]&&"/"===d[0].charAt(0);if(q){e.hostname=e.host=C?"":d.length?d.shift():"";var b=!!(e.host&&e.host.indexOf("@")>0)&&e.host.split("@");b&&(e.auth=b.shift(),e.host=e.hostname=b.shift())}return y=y||e.host&&d.length,y&&!C&&d.unshift(""),d.length?e.pathname=d.join("/"):(e.pathname=null,e.path=null),util.isNull(e.pathname)&&util.isNull(e.search)||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=t.auth||e.auth,e.slashes=e.slashes||t.slashes,e.href=e.format(),e},Url.prototype.parseHost=function(){var t=this.host,s=portPattern.exec(t);s&&(s=s[0],":"!==s&&(this.port=s.substr(1)),t=t.substr(0,t.length-s.length)),t&&(this.hostname=t)};
},{"./util":237,"punycode":127,"querystring":130}],237:[function(require,module,exports){
"use strict";module.exports={isString:function(n){return"string"==typeof n},isObject:function(n){return"object"==typeof n&&null!==n},isNull:function(n){return null===n},isNullOrUndefined:function(n){return null==n}};
},{}],238:[function(require,module,exports){
(function (global){
function deprecate(r,e){function o(){if(!t){if(config("throwDeprecation"))throw new Error(e);config("traceDeprecation")?console.trace(e):console.warn(e),t=!0}return r.apply(this,arguments)}if(config("noDeprecation"))return r;var t=!1;return o}function config(r){try{if(!global.localStorage)return!1}catch(r){return!1}var e=global.localStorage[r];return null!=e&&"true"===String(e).toLowerCase()}module.exports=deprecate;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],239:[function(require,module,exports){
arguments[4][97][0].apply(exports,arguments)
},{"dup":97}],240:[function(require,module,exports){
module.exports=function(o){return o&&"object"==typeof o&&"function"==typeof o.copy&&"function"==typeof o.fill&&"function"==typeof o.readUInt8};
},{}],241:[function(require,module,exports){
(function (process,global){
function inspect(e,r){var t={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),isBoolean(r)?t.showHidden=r:r&&exports._extend(t,r),isUndefined(t.showHidden)&&(t.showHidden=!1),isUndefined(t.depth)&&(t.depth=2),isUndefined(t.colors)&&(t.colors=!1),isUndefined(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=stylizeWithColor),formatValue(t,e,t.depth)}function stylizeWithColor(e,r){var t=inspect.styles[r];return t?"["+inspect.colors[t][0]+"m"+e+"["+inspect.colors[t][1]+"m":e}function stylizeNoColor(e,r){return e}function arrayToHash(e){var r={};return e.forEach(function(e,t){r[e]=!0}),r}function formatValue(e,r,t){if(e.customInspect&&r&&isFunction(r.inspect)&&r.inspect!==exports.inspect&&(!r.constructor||r.constructor.prototype!==r)){var n=r.inspect(t,e);return isString(n)||(n=formatValue(e,n,t)),n}var i=formatPrimitive(e,r);if(i)return i;var o=Object.keys(r),s=arrayToHash(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(r)),isError(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return formatError(r);if(0===o.length){if(isFunction(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(isRegExp(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(isDate(r))return e.stylize(Date.prototype.toString.call(r),"date");if(isError(r))return formatError(r)}var c="",a=!1,l=["{","}"];if(isArray(r)&&(a=!0,l=["[","]"]),isFunction(r)){var p=r.name?": "+r.name:"";c=" [Function"+p+"]"}if(isRegExp(r)&&(c=" "+RegExp.prototype.toString.call(r)),isDate(r)&&(c=" "+Date.prototype.toUTCString.call(r)),isError(r)&&(c=" "+formatError(r)),0===o.length&&(!a||0==r.length))return l[0]+c+l[1];if(t<0)return isRegExp(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special");e.seen.push(r);var f;return f=a?formatArray(e,r,t,s,o):o.map(function(n){return formatProperty(e,r,t,s,n,a)}),e.seen.pop(),reduceToSingleString(f,c,l)}function formatPrimitive(e,r){if(isUndefined(r))return e.stylize("undefined","undefined");if(isString(r)){var t="'"+JSON.stringify(r).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(t,"string")}return isNumber(r)?e.stylize(""+r,"number"):isBoolean(r)?e.stylize(""+r,"boolean"):isNull(r)?e.stylize("null","null"):void 0}function formatError(e){return"["+Error.prototype.toString.call(e)+"]"}function formatArray(e,r,t,n,i){for(var o=[],s=0,u=r.length;s<u;++s)hasOwnProperty(r,String(s))?o.push(formatProperty(e,r,t,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(formatProperty(e,r,t,n,i,!0))}),o}function formatProperty(e,r,t,n,i,o){var s,u,c;if(c=Object.getOwnPropertyDescriptor(r,i)||{value:r[i]},c.get?u=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(u=e.stylize("[Setter]","special")),hasOwnProperty(n,i)||(s="["+i+"]"),u||(e.seen.indexOf(c.value)<0?(u=isNull(t)?formatValue(e,c.value,null):formatValue(e,c.value,t-1),u.indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n"))):u=e.stylize("[Circular]","special")),isUndefined(s)){if(o&&i.match(/^\d+$/))return u;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function reduceToSingleString(e,r,t){var n=0,i=e.reduce(function(e,r){return n++,r.indexOf("\n")>=0&&n++,e+r.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?t[0]+(""===r?"":r+"\n ")+" "+e.join(",\n  ")+" "+t[1]:t[0]+r+" "+e.join(", ")+" "+t[1]}function isArray(e){return Array.isArray(e)}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNullOrUndefined(e){return null==e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isSymbol(e){return"symbol"==typeof e}function isUndefined(e){return void 0===e}function isRegExp(e){return isObject(e)&&"[object RegExp]"===objectToString(e)}function isObject(e){return"object"==typeof e&&null!==e}function isDate(e){return isObject(e)&&"[object Date]"===objectToString(e)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(e){return"function"==typeof e}function isPrimitive(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function objectToString(e){return Object.prototype.toString.call(e)}function pad(e){return e<10?"0"+e.toString(10):e.toString(10)}function timestamp(){var e=new Date,r=[pad(e.getHours()),pad(e.getMinutes()),pad(e.getSeconds())].join(":");return[e.getDate(),months[e.getMonth()],r].join(" ")}function hasOwnProperty(e,r){return Object.prototype.hasOwnProperty.call(e,r)}var formatRegExp=/%[sdj%]/g;exports.format=function(e){if(!isString(e)){for(var r=[],t=0;t<arguments.length;t++)r.push(inspect(arguments[t]));return r.join(" ")}for(var t=1,n=arguments,i=n.length,o=String(e).replace(formatRegExp,function(e){if("%%"===e)return"%";if(t>=i)return e;switch(e){case"%s":return String(n[t++]);case"%d":return Number(n[t++]);case"%j":try{return JSON.stringify(n[t++])}catch(e){return"[Circular]"}default:return e}}),s=n[t];t<i;s=n[++t])o+=isNull(s)||!isObject(s)?" "+s:" "+inspect(s);return o},exports.deprecate=function(e,r){function t(){if(!n){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),n=!0}return e.apply(this,arguments)}if(isUndefined(global.process))return function(){return exports.deprecate(e,r).apply(this,arguments)};if(process.noDeprecation===!0)return e;var n=!1;return t};var debugs={},debugEnviron;exports.debuglog=function(e){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!debugs[e])if(new RegExp("\\b"+e+"\\b","i").test(debugEnviron)){var r=process.pid;debugs[e]=function(){var t=exports.format.apply(exports,arguments);console.error("%s %d: %s",e,r,t)}}else debugs[e]=function(){};return debugs[e]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(e,r){if(!r||!isObject(r))return e;for(var t=Object.keys(r),n=t.length;n--;)e[t[n]]=r[t[n]];return e};
}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./support/isBuffer":240,"_process":120,"inherits":239}],242:[function(require,module,exports){
function Context(){}var indexOf=require("indexof"),Object_keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var r in e)t.push(r);return t},forEach=function(e,t){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;r++)t(e[r],r,e)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(e,t,r){Object.defineProperty(e,t,{writable:!0,enumerable:!1,configurable:!0,value:r})}}catch(e){return function(e,t,r){e[t]=r}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];Context.prototype={};var Script=exports.Script=function(e){return this instanceof Script?void(this.code=e):new Script(e)};Script.prototype.runInContext=function(e){if(!(e instanceof Context))throw new TypeError("needs a 'context' argument.");var t=document.createElement("iframe");t.style||(t.style={}),t.style.display="none",document.body.appendChild(t);var r=t.contentWindow,n=r.eval,o=r.execScript;!n&&o&&(o.call(r,"null"),n=r.eval),forEach(Object_keys(e),function(t){r[t]=e[t]}),forEach(globals,function(t){e[t]&&(r[t]=e[t])});var c=Object_keys(r),i=n.call(r,this.code);return forEach(Object_keys(r),function(t){(t in e||indexOf(c,t)===-1)&&(e[t]=r[t])}),forEach(globals,function(t){t in e||defineProp(e,t,r[t])}),document.body.removeChild(t),i},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(e){var t=Script.createContext(e),r=this.runInContext(t);return forEach(Object_keys(t),function(r){e[r]=t[r]}),r},forEach(Object_keys(Script.prototype),function(e){exports[e]=Script[e]=function(t){var r=Script(t);return r[e].apply(r,[].slice.call(arguments,1))}}),exports.createScript=function(e){return exports.Script(e)},exports.createContext=Script.createContext=function(e){var t=new Context;return"object"==typeof e&&forEach(Object_keys(e),function(r){t[r]=e[r]}),t};
},{"indexof":96}],243:[function(require,module,exports){
function DOMParser(t){this.options=t||{locator:{}}}function buildErrorHandler(t,e,n){function r(e){var r=t[e];!r&&i&&(r=2==t.length?function(n){t(e,n)}:t),o[e]=r&&function(t){r("[xmldom "+e+"]\t"+t+_locator(n))}||function(){}}if(!t){if(e instanceof DOMHandler)return e;t=e}var o={},i=t instanceof Function;return n=n||{},r("warning"),r("error"),r("fatalError"),o}function DOMHandler(){this.cdata=!1}function position(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}function _locator(t){if(t)return"\n@"+(t.systemId||"")+"#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}function _toString(t,e,n){return"string"==typeof t?t.substr(e,n):t.length>=e+n||e?new java.lang.String(t,e,n)+"":t}function appendElement(t,e){t.currentElement?t.currentElement.appendChild(e):t.doc.appendChild(e)}DOMParser.prototype.parseFromString=function(t,e){var n=this.options,r=new XMLReader,o=n.domBuilder||new DOMHandler,i=n.errorHandler,a=n.locator,c=n.xmlns||{},l={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return a&&o.setDocumentLocator(a),r.errorHandler=buildErrorHandler(i,o,a),r.domBuilder=n.domBuilder||o,/\/x?html?$/.test(e)&&(l.nbsp="",l.copy="",c[""]="http://www.w3.org/1999/xhtml"),c.xml=c.xml||"http://www.w3.org/XML/1998/namespace",t?r.parse(t,c,l):r.errorHandler.error("invalid doc source"),o.doc},DOMHandler.prototype={startDocument:function(){this.doc=(new DOMImplementation).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(t,e,n,r){var o=this.doc,i=o.createElementNS(t,n||e),a=r.length;appendElement(this,i),this.currentElement=i,this.locator&&position(this.locator,i);for(var c=0;c<a;c++){var t=r.getURI(c),l=r.getValue(c),n=r.getQName(c),s=o.createAttributeNS(t,n);this.locator&&position(r.getLocator(c),s),s.value=s.nodeValue=l,i.setAttributeNode(s)}},endElement:function(t,e,n){var r=this.currentElement;r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){var n=this.doc.createProcessingInstruction(t,e);this.locator&&position(this.locator,n),appendElement(this,n)},ignorableWhitespace:function(t,e,n){},characters:function(t,e,n){if(t=_toString.apply(this,arguments)){if(this.cdata)var r=this.doc.createCDATASection(t);else var r=this.doc.createTextNode(t);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(t)&&this.doc.appendChild(r),this.locator&&position(this.locator,r)}},skippedEntity:function(t){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(t){(this.locator=t)&&(t.lineNumber=0)},comment:function(t,e,n){t=_toString.apply(this,arguments);var r=this.doc.createComment(t);this.locator&&position(this.locator,r),appendElement(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var o=r.createDocumentType(t,e,n);this.locator&&position(this.locator,o),appendElement(this,o)}},warning:function(t){console.warn("[xmldom warning]\t"+t,_locator(this.locator))},error:function(t){console.error("[xmldom error]\t"+t,_locator(this.locator))},fatalError:function(t){throw console.error("[xmldom fatalError]\t"+t,_locator(this.locator)),t}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(t){DOMHandler.prototype[t]=function(){return null}});var XMLReader=require("./sax").XMLReader,DOMImplementation=exports.DOMImplementation=require("./dom").DOMImplementation;exports.XMLSerializer=require("./dom").XMLSerializer,exports.DOMParser=DOMParser;
},{"./dom":244,"./sax":245}],244:[function(require,module,exports){
function copy(e,t){for(var n in e)t[n]=e[n]}function _extends(e,t){function n(){}var o=e.prototype;if(Object.create){var i=Object.create(t.prototype);o.__proto__=i}o instanceof t||(n.prototype=t.prototype,n=new n,copy(o,n),e.prototype=o=n),o.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),o.constructor=e)}function DOMException(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,ExceptionMessage[e]),this.message=ExceptionMessage[e],Error.captureStackTrace&&Error.captureStackTrace(this,DOMException);return n.code=e,t&&(this.message=this.message+": "+t),n}function NodeList(){}function LiveNodeList(e,t){this._node=e,this._refresh=t,_updateLiveList(this)}function _updateLiveList(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var n=e._refresh(e._node);__set__(e,"length",n.length),copy(n,e),e._inc=t}}function NamedNodeMap(){}function _findNodeIndex(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function _addNamedNode(e,t,n,o){if(o?t[_findNodeIndex(t,o)]=n:t[t.length++]=n,e){n.ownerElement=e;var i=e.ownerDocument;i&&(o&&_onRemoveAttribute(i,e,o),_onAddAttribute(i,e,n))}}function _removeNamedNode(e,t,n){var o=_findNodeIndex(t,n);if(!(o>=0))throw DOMException(NOT_FOUND_ERR,new Error(e.tagName+"@"+n));for(var i=t.length-1;o<i;)t[o]=t[++o];if(t.length=i,e){var r=e.ownerDocument;r&&(_onRemoveAttribute(r,e,n),n.ownerElement=null)}}function DOMImplementation(e){if(this._features={},e)for(var t in e)this._features=e[t]}function Node(){}function _xmlEncoder(e){return"<"==e&&"&lt;"||">"==e&&"&gt;"||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function _visitNode(e,t){if(t(e))return!0;if(e=e.firstChild)do if(_visitNode(e,t))return!0;while(e=e.nextSibling)}function Document(){}function _onAddAttribute(e,t,n){e&&e._inc++;var o=n.namespaceURI;"http://www.w3.org/2000/xmlns/"==o&&(t._nsMap[n.prefix?n.localName:""]=n.value)}function _onRemoveAttribute(e,t,n,o){e&&e._inc++;var i=n.namespaceURI;"http://www.w3.org/2000/xmlns/"==i&&delete t._nsMap[n.prefix?n.localName:""]}function _onUpdateChild(e,t,n){if(e&&e._inc){e._inc++;var o=t.childNodes;if(n)o[o.length++]=n;else{for(var i=t.firstChild,r=0;i;)o[r++]=i,i=i.nextSibling;o.length=r}}}function _removeChild(e,t){var n=t.previousSibling,o=t.nextSibling;return n?n.nextSibling=o:e.firstChild=o,o?o.previousSibling=n:e.lastChild=n,_onUpdateChild(e.ownerDocument,e),t}function _insertBefore(e,t,n){var o=t.parentNode;if(o&&o.removeChild(t),t.nodeType===DOCUMENT_FRAGMENT_NODE){var i=t.firstChild;if(null==i)return t;var r=t.lastChild}else i=r=t;var a=n?n.previousSibling:e.lastChild;i.previousSibling=a,r.nextSibling=n,a?a.nextSibling=i:e.firstChild=i,null==n?e.lastChild=r:n.previousSibling=r;do i.parentNode=e;while(i!==r&&(i=i.nextSibling));return _onUpdateChild(e.ownerDocument||e,e),t.nodeType==DOCUMENT_FRAGMENT_NODE&&(t.firstChild=t.lastChild=null),t}function _appendSingleChild(e,t){var n=t.parentNode;if(n){var o=e.lastChild;n.removeChild(t);var o=e.lastChild}var o=e.lastChild;return t.parentNode=e,t.previousSibling=o,t.nextSibling=null,o?o.nextSibling=t:e.firstChild=t,e.lastChild=t,_onUpdateChild(e.ownerDocument,e,t),t}function Element(){this._nsMap={}}function Attr(){}function CharacterData(){}function Text(){}function Comment(){}function CDATASection(){}function DocumentType(){}function Notation(){}function Entity(){}function EntityReference(){}function DocumentFragment(){}function ProcessingInstruction(){}function XMLSerializer(){}function nodeSerializeToString(e,t){var n=[],o=9==this.nodeType?this.documentElement:this,i=o.prefix,r=o.namespaceURI;if(r&&null==i){var i=o.lookupPrefix(r);if(null==i)var a=[{namespace:r,prefix:null}]}return serializeToString(this,n,e,t,a),n.join("")}function needNamespaceDefine(e,t,n){var o=e.prefix||"",i=e.namespaceURI;if(!o&&!i)return!1;if("xml"===o&&"http://www.w3.org/XML/1998/namespace"===i||"http://www.w3.org/2000/xmlns/"==i)return!1;for(var r=n.length;r--;){var a=n[r];if(a.prefix==o)return a.namespace!=i}return!0}function serializeToString(e,t,n,o,i){if(o){if(e=o(e),!e)return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case ELEMENT_NODE:i||(i=[]);var r=(i.length,e.attributes),a=r.length,s=e.firstChild,u=e.tagName;n=htmlns===e.namespaceURI||n,t.push("<",u);for(var d=0;d<a;d++){var c=r.item(d);"xmlns"==c.prefix?i.push({prefix:c.localName,namespace:c.value}):"xmlns"==c.nodeName&&i.push({prefix:"",namespace:c.value})}for(var d=0;d<a;d++){var c=r.item(d);if(needNamespaceDefine(c,n,i)){var N=c.prefix||"",l=c.namespaceURI,p=N?" xmlns:"+N:" xmlns";t.push(p,'="',l,'"'),i.push({prefix:N,namespace:l})}serializeToString(c,t,n,o,i)}if(needNamespaceDefine(e,n,i)){var N=e.prefix||"",l=e.namespaceURI,p=N?" xmlns:"+N:" xmlns";t.push(p,'="',l,'"'),i.push({prefix:N,namespace:l})}if(s||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(t.push(">"),n&&/^script$/i.test(u))for(;s;)s.data?t.push(s.data):serializeToString(s,t,n,o,i),s=s.nextSibling;else for(;s;)serializeToString(s,t,n,o,i),s=s.nextSibling;t.push("</",u,">")}else t.push("/>");return;case DOCUMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(var s=e.firstChild;s;)serializeToString(s,t,n,o,i),s=s.nextSibling;return;case ATTRIBUTE_NODE:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,_xmlEncoder),'"');case TEXT_NODE:return t.push(e.data.replace(/[<&]/g,_xmlEncoder));case CDATA_SECTION_NODE:return t.push("<![CDATA[",e.data,"]]>");case COMMENT_NODE:return t.push("<!--",e.data,"-->");case DOCUMENT_TYPE_NODE:var E=e.publicId,m=e.systemId;if(t.push("<!DOCTYPE ",e.name),E)t.push(' PUBLIC "',E),m&&"."!=m&&t.push('" "',m),t.push('">');else if(m&&"."!=m)t.push(' SYSTEM "',m,'">');else{var h=e.internalSubset;h&&t.push(" [",h,"]"),t.push(">")}return;case PROCESSING_INSTRUCTION_NODE:return t.push("<?",e.target," ",e.data,"?>");case ENTITY_REFERENCE_NODE:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function importNode(e,t,n){var o;switch(t.nodeType){case ELEMENT_NODE:o=t.cloneNode(!1),o.ownerDocument=e;case DOCUMENT_FRAGMENT_NODE:break;case ATTRIBUTE_NODE:n=!0}if(o||(o=t.cloneNode(!1)),o.ownerDocument=e,o.parentNode=null,n)for(var i=t.firstChild;i;)o.appendChild(importNode(e,i,n)),i=i.nextSibling;return o}function cloneNode(e,t,n){var o=new t.constructor;for(var i in t){var r=t[i];"object"!=typeof r&&r!=o[i]&&(o[i]=r)}switch(t.childNodes&&(o.childNodes=new NodeList),o.ownerDocument=e,o.nodeType){case ELEMENT_NODE:var a=t.attributes,s=o.attributes=new NamedNodeMap,u=a.length;s._ownerElement=o;for(var d=0;d<u;d++)o.setAttributeNode(cloneNode(e,a.item(d),!0));break;case ATTRIBUTE_NODE:n=!0}if(n)for(var c=t.firstChild;c;)o.appendChild(cloneNode(e,c,n)),c=c.nextSibling;return o}function __set__(e,t,n){e[t]=n}function getTextContent(e){switch(e.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:var t=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&t.push(getTextContent(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}}var htmlns="http://www.w3.org/1999/xhtml",NodeType={},ELEMENT_NODE=NodeType.ELEMENT_NODE=1,ATTRIBUTE_NODE=NodeType.ATTRIBUTE_NODE=2,TEXT_NODE=NodeType.TEXT_NODE=3,CDATA_SECTION_NODE=NodeType.CDATA_SECTION_NODE=4,ENTITY_REFERENCE_NODE=NodeType.ENTITY_REFERENCE_NODE=5,ENTITY_NODE=NodeType.ENTITY_NODE=6,PROCESSING_INSTRUCTION_NODE=NodeType.PROCESSING_INSTRUCTION_NODE=7,COMMENT_NODE=NodeType.COMMENT_NODE=8,DOCUMENT_NODE=NodeType.DOCUMENT_NODE=9,DOCUMENT_TYPE_NODE=NodeType.DOCUMENT_TYPE_NODE=10,DOCUMENT_FRAGMENT_NODE=NodeType.DOCUMENT_FRAGMENT_NODE=11,NOTATION_NODE=NodeType.NOTATION_NODE=12,ExceptionCode={},ExceptionMessage={},INDEX_SIZE_ERR=ExceptionCode.INDEX_SIZE_ERR=(ExceptionMessage[1]="Index size error",1),DOMSTRING_SIZE_ERR=ExceptionCode.DOMSTRING_SIZE_ERR=(ExceptionMessage[2]="DOMString size error",2),HIERARCHY_REQUEST_ERR=ExceptionCode.HIERARCHY_REQUEST_ERR=(ExceptionMessage[3]="Hierarchy request error",3),WRONG_DOCUMENT_ERR=ExceptionCode.WRONG_DOCUMENT_ERR=(ExceptionMessage[4]="Wrong document",4),INVALID_CHARACTER_ERR=ExceptionCode.INVALID_CHARACTER_ERR=(ExceptionMessage[5]="Invalid character",5),NO_DATA_ALLOWED_ERR=ExceptionCode.NO_DATA_ALLOWED_ERR=(ExceptionMessage[6]="No data allowed",6),NO_MODIFICATION_ALLOWED_ERR=ExceptionCode.NO_MODIFICATION_ALLOWED_ERR=(ExceptionMessage[7]="No modification allowed",7),NOT_FOUND_ERR=ExceptionCode.NOT_FOUND_ERR=(ExceptionMessage[8]="Not found",8),NOT_SUPPORTED_ERR=ExceptionCode.NOT_SUPPORTED_ERR=(ExceptionMessage[9]="Not supported",9),INUSE_ATTRIBUTE_ERR=ExceptionCode.INUSE_ATTRIBUTE_ERR=(ExceptionMessage[10]="Attribute in use",10),INVALID_STATE_ERR=ExceptionCode.INVALID_STATE_ERR=(ExceptionMessage[11]="Invalid state",11),SYNTAX_ERR=ExceptionCode.SYNTAX_ERR=(ExceptionMessage[12]="Syntax error",12),INVALID_MODIFICATION_ERR=ExceptionCode.INVALID_MODIFICATION_ERR=(ExceptionMessage[13]="Invalid modification",13),NAMESPACE_ERR=ExceptionCode.NAMESPACE_ERR=(ExceptionMessage[14]="Invalid namespace",14),INVALID_ACCESS_ERR=ExceptionCode.INVALID_ACCESS_ERR=(ExceptionMessage[15]="Invalid access",15);DOMException.prototype=Error.prototype,copy(ExceptionCode,DOMException),NodeList.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var n=[],o=0;o<this.length;o++)serializeToString(this[o],n,e,t);return n.join("")}},LiveNodeList.prototype.item=function(e){return _updateLiveList(this),this[e]},_extends(LiveNodeList,NodeList),NamedNodeMap.prototype={length:0,item:NodeList.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);var n=this.getNamedItem(e.nodeName);return _addNamedNode(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);return t=this.getNamedItemNS(e.namespaceURI,e.localName),_addNamedNode(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return _removeNamedNode(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return _removeNamedNode(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var o=this[n];if(o.localName==t&&o.namespaceURI==e)return o}return null}},DOMImplementation.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return!(!n||t&&!(t in n))},createDocument:function(e,t,n){var o=new Document;if(o.implementation=this,o.childNodes=new NodeList,o.doctype=n,n&&o.appendChild(n),t){var i=o.createElementNS(e,t);o.appendChild(i)}return o},createDocumentType:function(e,t,n){var o=new DocumentType;return o.name=e,o.nodeName=e,o.publicId=t,o.systemId=n,o}},Node.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return _insertBefore(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return _removeChild(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return cloneNode(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==TEXT_NODE&&e.nodeType==TEXT_NODE?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var o in n)if(n[o]==e)return o;t=t.nodeType==ATTRIBUTE_NODE?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n)return n[e];t=t.nodeType==ATTRIBUTE_NODE?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){var t=this.lookupPrefix(e);return null==t}},copy(NodeType,Node),copy(NodeType,Node.prototype),Document.prototype={nodeName:"#document",nodeType:DOCUMENT_NODE,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==DOCUMENT_FRAGMENT_NODE){for(var n=e.firstChild;n;){var o=n.nextSibling;this.insertBefore(n,t),n=o}return e}return null==this.documentElement&&e.nodeType==ELEMENT_NODE&&(this.documentElement=e),_insertBefore(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),_removeChild(this,e)},importNode:function(e,t){return importNode(this,e,t)},getElementById:function(e){var t=null;return _visitNode(this.documentElement,function(n){if(n.nodeType==ELEMENT_NODE&&n.getAttribute("id")==e)return t=n,!0}),t},createElement:function(e){var t=new Element;t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new NodeList;var n=t.attributes=new NamedNodeMap;return n._ownerElement=t,t},createDocumentFragment:function(){var e=new DocumentFragment;return e.ownerDocument=this,e.childNodes=new NodeList,e},createTextNode:function(e){var t=new Text;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new Comment;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new CDATASection;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new ProcessingInstruction;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new Attr;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new EntityReference;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new Element,o=t.split(":"),i=n.attributes=new NamedNodeMap;return n.childNodes=new NodeList,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==o.length?(n.prefix=o[0],n.localName=o[1]):n.localName=t,i._ownerElement=n,n},createAttributeNS:function(e,t){var n=new Attr,o=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==o.length?(n.prefix=o[0],n.localName=o[1]):n.localName=t,n}},_extends(Document,Node),Element.prototype={nodeType:ELEMENT_NODE,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===DOCUMENT_FRAGMENT_NODE?this.insertBefore(e,null):_appendSingleChild(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var o=this.ownerDocument.createAttributeNS(e,t);o.value=o.nodeValue=""+n,this.setAttributeNode(o)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new LiveNodeList(this,function(t){var n=[];return _visitNode(t,function(o){o===t||o.nodeType!=ELEMENT_NODE||"*"!==e&&o.tagName!=e||n.push(o)}),n})},getElementsByTagNameNS:function(e,t){return new LiveNodeList(this,function(n){var o=[];return _visitNode(n,function(i){i===n||i.nodeType!==ELEMENT_NODE||"*"!==e&&i.namespaceURI!==e||"*"!==t&&i.localName!=t||o.push(i)}),o})}},Document.prototype.getElementsByTagName=Element.prototype.getElementsByTagName,Document.prototype.getElementsByTagNameNS=Element.prototype.getElementsByTagNameNS,_extends(Element,Node),Attr.prototype.nodeType=ATTRIBUTE_NODE,_extends(Attr,Node),CharacterData.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(ExceptionMessage[HIERARCHY_REQUEST_ERR])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){var o=this.data.substring(0,e),i=this.data.substring(e+t);n=o+n+i,this.nodeValue=this.data=n,this.length=n.length}},_extends(CharacterData,Node),Text.prototype={nodeName:"#text",nodeType:TEXT_NODE,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var o=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(o,this.nextSibling),o}},_extends(Text,CharacterData),Comment.prototype={nodeName:"#comment",nodeType:COMMENT_NODE},_extends(Comment,CharacterData),CDATASection.prototype={nodeName:"#cdata-section",nodeType:CDATA_SECTION_NODE},_extends(CDATASection,CharacterData),DocumentType.prototype.nodeType=DOCUMENT_TYPE_NODE,_extends(DocumentType,Node),Notation.prototype.nodeType=NOTATION_NODE,_extends(Notation,Node),Entity.prototype.nodeType=ENTITY_NODE,_extends(Entity,Node),EntityReference.prototype.nodeType=ENTITY_REFERENCE_NODE,_extends(EntityReference,Node),DocumentFragment.prototype.nodeName="#document-fragment",DocumentFragment.prototype.nodeType=DOCUMENT_FRAGMENT_NODE,_extends(DocumentFragment,Node),ProcessingInstruction.prototype.nodeType=PROCESSING_INSTRUCTION_NODE,_extends(ProcessingInstruction,Node),XMLSerializer.prototype.serializeToString=function(e,t,n){return nodeSerializeToString.call(e,t,n)},Node.prototype.toString=nodeSerializeToString;try{Object.defineProperty&&(Object.defineProperty(LiveNodeList.prototype,"length",{get:function(){return _updateLiveList(this),this.$$length}}),Object.defineProperty(Node.prototype,"textContent",{get:function(){return getTextContent(this)},set:function(e){switch(this.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),__set__=function(e,t,n){e["$$"+t]=n})}catch(e){}exports.DOMImplementation=DOMImplementation,exports.XMLSerializer=XMLSerializer;
},{}],245:[function(require,module,exports){
function XMLReader(){}function parse(e,t,r,a,n){function s(e){if(e>65535){e-=65536;var t=55296+(e>>10),r=56320+(1023&e);return String.fromCharCode(t,r)}return String.fromCharCode(e)}function c(e){var t=e.slice(1,-1);return t in r?r[t]:"#"===t.charAt(0)?s(parseInt(t.substr(1).replace("x","0x"))):(n.error("entity not found:"+e),e)}function i(t){if(t>p){var r=e.substring(p,t).replace(/&#?\w+;/g,c);m&&o(p),a.characters(r,0,t-p),p=t}}function o(t,r){for(;t>=l&&(r=_.exec(e));)u=r.index,l=u+r[0].length,m.lineNumber++;m.columnNumber=t-u+1}for(var u=0,l=0,_=/.*(?:\r\n?|\n)|.*$/g,m=a.locator,f=[{currentNSMap:t}],d={},p=0;;){try{var T=e.indexOf("<",p);if(T<0){if(!e.substr(p).match(/^\s*$/)){var S=a.doc,h=S.createTextNode(e.substr(p));S.appendChild(h),a.currentElement=h}return}switch(T>p&&i(T),e.charAt(T+1)){case"/":var A=e.indexOf(">",T+3),g=e.substring(T+2,A),w=f.pop();A<0?(g=e.substring(T+2).replace(/[\s<].*/,""),n.error("end tag name: "+g+" is not complete:"+w.tagName),A=T+1+g.length):g.match(/\s</)&&(g=g.replace(/[\s<].*/,""),n.error("end tag name: "+g+" maybe not complete"),A=T+1+g.length);var E=w.localNSMap,N=w.tagName==g,b=N||w.tagName&&w.tagName.toLowerCase()==g.toLowerCase();if(b){if(a.endElement(w.uri,w.localName,g),E)for(var v in E)a.endPrefixMapping(v);N||n.fatalError("end tag name: "+g+" is not match the current start tagName:"+w.tagName)}else f.push(w);A++;break;case"?":m&&o(T),A=parseInstruction(e,T,a);break;case"!":m&&o(T),A=parseDCC(e,T,a,n);break;default:m&&o(T);var x=new ElementAttributes,C=f[f.length-1].currentNSMap,A=parseElementStartPart(e,T,x,C,c,n),R=x.length;if(!x.closed&&fixSelfClosed(e,A,x.tagName,d)&&(x.closed=!0,r.nbsp||n.warning("unclosed xml attribute")),m&&R){for(var O=copyLocator(m,{}),D=0;D<R;D++){var L=x[D];o(L.offset),L.locator=copyLocator(m,{})}a.locator=O,appendElement(x,a,C)&&f.push(x),a.locator=m}else appendElement(x,a,C)&&f.push(x);"http://www.w3.org/1999/xhtml"!==x.uri||x.closed?A++:A=parseHtmlSpecialContent(e,A,x.tagName,c,a)}}catch(e){n.error("element parse error: "+e),A=-1}A>p?p=A:i(Math.max(T,p)+1)}}function copyLocator(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function parseElementStartPart(e,t,r,a,n,s){for(var c,i,o=++t,u=S_TAG;;){var l=e.charAt(o);switch(l){case"=":if(u===S_ATTR)c=e.slice(t,o),u=S_EQ;else{if(u!==S_ATTR_SPACE)throw new Error("attribute equal must after attrName");u=S_EQ}break;case"'":case'"':if(u===S_EQ||u===S_ATTR){if(u===S_ATTR&&(s.warning('attribute value must after "="'),c=e.slice(t,o)),t=o+1,o=e.indexOf(l,t),!(o>0))throw new Error("attribute value no end '"+l+"' match");i=e.slice(t,o).replace(/&#?\w+;/g,n),r.add(c,i,t-1),u=S_ATTR_END}else{if(u!=S_ATTR_NOQUOT_VALUE)throw new Error('attribute value must after "="');i=e.slice(t,o).replace(/&#?\w+;/g,n),r.add(c,i,t),s.warning('attribute "'+c+'" missed start quot('+l+")!!"),t=o+1,u=S_ATTR_END}break;case"/":switch(u){case S_TAG:r.setTagName(e.slice(t,o));case S_ATTR_END:case S_TAG_SPACE:case S_TAG_CLOSE:u=S_TAG_CLOSE,r.closed=!0;case S_ATTR_NOQUOT_VALUE:case S_ATTR:case S_ATTR_SPACE:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return s.error("unexpected end of input"),u==S_TAG&&r.setTagName(e.slice(t,o)),o;case">":switch(u){case S_TAG:r.setTagName(e.slice(t,o));case S_ATTR_END:case S_TAG_SPACE:case S_TAG_CLOSE:break;case S_ATTR_NOQUOT_VALUE:case S_ATTR:i=e.slice(t,o),"/"===i.slice(-1)&&(r.closed=!0,i=i.slice(0,-1));case S_ATTR_SPACE:u===S_ATTR_SPACE&&(i=c),u==S_ATTR_NOQUOT_VALUE?(s.warning('attribute "'+i+'" missed quot(")!!'),r.add(c,i.replace(/&#?\w+;/g,n),t)):("http://www.w3.org/1999/xhtml"===a[""]&&i.match(/^(?:disabled|checked|selected)$/i)||s.warning('attribute "'+i+'" missed value!! "'+i+'" instead!!'),r.add(i,i,t));break;case S_EQ:throw new Error("attribute value missed!!")}return o;case"":l=" ";default:if(l<=" ")switch(u){case S_TAG:r.setTagName(e.slice(t,o)),u=S_TAG_SPACE;break;case S_ATTR:c=e.slice(t,o),u=S_ATTR_SPACE;break;case S_ATTR_NOQUOT_VALUE:var i=e.slice(t,o).replace(/&#?\w+;/g,n);s.warning('attribute "'+i+'" missed quot(")!!'),r.add(c,i,t);case S_ATTR_END:u=S_TAG_SPACE}else switch(u){case S_ATTR_SPACE:r.tagName;"http://www.w3.org/1999/xhtml"===a[""]&&c.match(/^(?:disabled|checked|selected)$/i)||s.warning('attribute "'+c+'" missed value!! "'+c+'" instead2!!'),r.add(c,c,t),t=o,u=S_ATTR;break;case S_ATTR_END:s.warning('attribute space is required"'+c+'"!!');case S_TAG_SPACE:u=S_ATTR,t=o;break;case S_EQ:u=S_ATTR_NOQUOT_VALUE,t=o;break;case S_TAG_CLOSE:throw new Error("elements closed character '/' and '>' must be connected to")}}o++}}function appendElement(e,t,r){for(var a=e.tagName,n=null,s=e.length;s--;){var c=e[s],i=c.qName,o=c.value,u=i.indexOf(":");if(u>0)var l=c.prefix=i.slice(0,u),_=i.slice(u+1),m="xmlns"===l&&_;else _=i,l=null,m="xmlns"===i&&"";c.localName=_,m!==!1&&(null==n&&(n={},_copy(r,r={})),r[m]=n[m]=o,c.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(m,o))}for(var s=e.length;s--;){c=e[s];var l=c.prefix;l&&("xml"===l&&(c.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==l&&(c.uri=r[l||""]))}var u=a.indexOf(":");u>0?(l=e.prefix=a.slice(0,u),_=e.localName=a.slice(u+1)):(l=null,_=e.localName=a);var f=e.uri=r[l||""];if(t.startElement(f,_,a,e),!e.closed)return e.currentNSMap=r,e.localNSMap=n,!0;if(t.endElement(f,_,a),n)for(l in n)t.endPrefixMapping(l)}function parseHtmlSpecialContent(e,t,r,a,n){if(/^(?:script|textarea)$/i.test(r)){var s=e.indexOf("</"+r+">",t),c=e.substring(t+1,s);if(/[&<]/.test(c))return/^script$/i.test(r)?(n.characters(c,0,c.length),s):(c=c.replace(/&#?\w+;/g,a),n.characters(c,0,c.length),s)}return t+1}function fixSelfClosed(e,t,r,a){var n=a[r];return null==n&&(n=e.lastIndexOf("</"+r+">"),n<t&&(n=e.lastIndexOf("</"+r)),a[r]=n),n<t}function _copy(e,t){for(var r in e)t[r]=e[r]}function parseDCC(e,t,r,a){var n=e.charAt(t+2);switch(n){case"-":if("-"===e.charAt(t+3)){var s=e.indexOf("-->",t+4);return s>t?(r.comment(e,t+4,s-t-4),s+3):(a.error("Unclosed comment"),-1)}return-1;default:if("CDATA["==e.substr(t+3,6)){var s=e.indexOf("]]>",t+9);return r.startCDATA(),r.characters(e,t+9,s-t-9),r.endCDATA(),s+3}var c=split(e,t),i=c.length;if(i>1&&/!doctype/i.test(c[0][0])){var o=c[1][0],u=i>3&&/^public$/i.test(c[2][0])&&c[3][0],l=i>4&&c[4][0],_=c[i-1];return r.startDTD(o,u&&u.replace(/^(['"])(.*?)\1$/,"$2"),l&&l.replace(/^(['"])(.*?)\1$/,"$2")),r.endDTD(),_.index+_[0].length}}return-1}function parseInstruction(e,t,r){var a=e.indexOf("?>",t);if(a){var n=e.substring(t,a).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(n){n[0].length;return r.processingInstruction(n[1],n[2]),a+2}return-1}return-1}function ElementAttributes(e){}function _set_proto_(e,t){return e.__proto__=t,e}function split(e,t){var r,a=[],n=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(n.lastIndex=t,n.exec(e);r=n.exec(e);)if(a.push(r),r[1])return a}var nameStartChar=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,nameChar=new RegExp("[\\-\\.0-9"+nameStartChar.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),tagNamePattern=new RegExp("^"+nameStartChar.source+nameChar.source+"*(?::"+nameStartChar.source+nameChar.source+"*)?$"),S_TAG=0,S_ATTR=1,S_ATTR_SPACE=2,S_EQ=3,S_ATTR_NOQUOT_VALUE=4,S_ATTR_END=5,S_TAG_SPACE=6,S_TAG_CLOSE=7;XMLReader.prototype={parse:function(e,t,r){var a=this.domBuilder;a.startDocument(),_copy(t,t={}),parse(e,t,r,a,this.errorHandler),a.endDocument()}},ElementAttributes.prototype={setTagName:function(e){if(!tagNamePattern.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,r){if(!tagNamePattern.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},_set_proto_({},_set_proto_.prototype)instanceof _set_proto_||(_set_proto_=function(e,t){function r(){}r.prototype=t,r=new r;for(t in e)r[t]=e[t];return r}),exports.XMLReader=XMLReader;
},{}],246:[function(require,module,exports){
(function (process,Buffer){
var Url=require("url"),spawn=require("child_process").spawn,fs=require("fs");exports.XMLHttpRequest=function(){"use strict";var e,t,r=this,s=require("http"),n=require("https"),o={},a=!1,i={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},h={},d={},u=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],c=["TRACE","TRACK","CONNECT"],f=!1,l=!1,p={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null,this.withCredentials=!1;var E=function(e){return a||e&&u.indexOf(e.toLowerCase())===-1},y=function(e){return e&&c.indexOf(e)===-1};this.open=function(e,t,r,s,n){if(this.abort(),l=!1,!y(e))throw new Error("SecurityError: Request method not allowed");o={method:e,url:t.toString(),async:"boolean"!=typeof r||r,user:s||null,password:n||null},S(this.OPENED)},this.setDisableHeaderCheck=function(e){a=e},this.setRequestHeader=function(e,t){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!E(e))return void console.warn('Refused to set unsafe header "'+e+'"');if(f)throw new Error("INVALID_STATE_ERR: send flag is true");e=d[e.toLowerCase()]||e,d[e.toLowerCase()]=e,h[e]=h[e]?h[e]+", "+t:t},this.getResponseHeader=function(e){return"string"==typeof e&&this.readyState>this.OPENED&&t&&t.headers&&t.headers[e.toLowerCase()]&&!l?t.headers[e.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||l)return"";var e="";for(var r in t.headers)"set-cookie"!==r&&"set-cookie2"!==r&&(e+=r+": "+t.headers[r]+"\r\n");return e.substr(0,e.length-2)},this.getRequestHeader=function(e){return"string"==typeof e&&d[e.toLowerCase()]?h[d[e.toLowerCase()]]:""},this.send=function(a){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(f)throw new Error("INVALID_STATE_ERR: send has already been called");var u,c=!1,p=!1,E=Url.parse(o.url);switch(E.protocol){case"https:":c=!0;case"http:":u=E.hostname;break;case"file:":p=!0;break;case void 0:case null:case"":u="localhost";break;default:throw new Error("Protocol not supported.")}if(p){if("GET"!==o.method)throw new Error("XMLHttpRequest: Only GET method is supported");if(o.async)fs.readFile(E.pathname,"utf8",function(e,t){e?r.handleError(e):(r.status=200,r.responseText=t,S(r.DONE))});else try{this.responseText=fs.readFileSync(E.pathname,"utf8"),this.status=200,S(r.DONE)}catch(e){this.handleError(e)}}else{var y=E.port||(c?443:80),w=E.pathname+(E.search?E.search:"");for(var v in i)d[v.toLowerCase()]||(h[v]=i[v]);if(h.Host=u,c&&443===y||80===y||(h.Host+=":"+E.port),o.user){"undefined"==typeof o.password&&(o.password="");var N=new Buffer(o.user+":"+o.password);h.Authorization="Basic "+N.toString("base64")}"GET"===o.method||"HEAD"===o.method?a=null:a?(h["Content-Length"]=Buffer.isBuffer(a)?a.length:Buffer.byteLength(a),h["Content-Type"]||(h["Content-Type"]="text/plain;charset=UTF-8")):"POST"===o.method&&(h["Content-Length"]=0);var T={host:u,port:y,path:w,method:o.method,headers:h,agent:!1,withCredentials:r.withCredentials};if(l=!1,o.async){var g=c?n.request:s.request;f=!0,r.dispatchEvent("readystatechange");var C=function s(n){if(t=n,301===t.statusCode||302===t.statusCode||303===t.statusCode||307===t.statusCode){o.url=t.headers.location;var a=Url.parse(o.url);u=a.hostname;var i={hostname:a.hostname,port:a.port,path:a.path,method:303===t.statusCode?"GET":o.method,headers:h,withCredentials:r.withCredentials};return e=g(i,s).on("error",D),void e.end()}t.setEncoding("utf8"),S(r.HEADERS_RECEIVED),r.status=t.statusCode,t.on("data",function(e){e&&(r.responseText+=e),f&&S(r.LOADING)}),t.on("end",function(){f&&(S(r.DONE),f=!1)}),t.on("error",function(e){r.handleError(e)})},D=function(e){r.handleError(e)};e=g(T,C).on("error",D),a&&e.write(a),e.end(),r.dispatchEvent("loadstart")}else{var O=".node-xmlhttprequest-content-"+process.pid,R=".node-xmlhttprequest-sync-"+process.pid;fs.writeFileSync(R,"","utf8");for(var q="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(c?"s":"")+".request;var options = "+JSON.stringify(T)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+O+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('"+R+"');});response.on('error', function(error) {fs.writeFileSync('"+O+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+R+"');});}).on('error', function(error) {fs.writeFileSync('"+O+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+R+"');});"+(a?"req.write('"+JSON.stringify(a).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",L=spawn(process.argv[0],["-e",q]);fs.existsSync(R););var m=JSON.parse(fs.readFileSync(O,"utf8"));L.stdin.end(),fs.unlinkSync(O),m.err?r.handleError(m.err):(t=m.data,r.status=m.data.statusCode,r.responseText=m.data.text,S(r.DONE))}}},this.handleError=function(e){this.status=0,this.statusText=e,this.responseText=e.stack,l=!0,S(this.DONE),this.dispatchEvent("error")},this.abort=function(){e&&(e.abort(),e=null),h=i,this.status=0,this.responseText="",this.responseXML="",l=!0,this.readyState===this.UNSENT||this.readyState===this.OPENED&&!f||this.readyState===this.DONE||(f=!1,S(this.DONE)),this.readyState=this.UNSENT,this.dispatchEvent("abort")},this.addEventListener=function(e,t){e in p||(p[e]=[]),p[e].push(t)},this.removeEventListener=function(e,t){e in p&&(p[e]=p[e].filter(function(e){return e!==t}))},this.dispatchEvent=function(e){if("function"==typeof r["on"+e]&&r["on"+e](),e in p)for(var t=0,s=p[e].length;t<s;t++)p[e][t].call(r)};var S=function(e){e!=r.LOADING&&r.readyState===e||(r.readyState=e,(o.async||r.readyState<r.OPENED||r.readyState===r.DONE)&&r.dispatchEvent("readystatechange"),r.readyState!==r.DONE||l||(r.dispatchEvent("load"),r.dispatchEvent("loadend")))}};
}).call(this,require('_process'),require("buffer").Buffer)

},{"_process":120,"buffer":47,"child_process":44,"fs":44,"http":230,"https":94,"url":236}],247:[function(require,module,exports){
function extend(){for(var r={},e=0;e<arguments.length;e++){var t=arguments[e];for(var n in t)hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;
},{}],248:[function(require,module,exports){
"use strict";var UI={};UI.acl=require("./acl"),UI.ns=require("./ns"),UI.widgets=require("./widgets"),UI.utils=require("./utils"),UI.aclControl=module.exports={},UI.aclControl.preventBrowserDropEvents=function(e){function t(e){e.stopPropagation(),e.preventDefault()}function r(e){e.dataTransfer.files.length>0&&(confirm("Are you sure you want to drop this file here? (Cancel opens it in a new tab)")||(e.stopPropagation(),e.preventDefault(),console.log("@@@@ document-level DROP suppressed: "+e.dataTransfer.dropEffect)))}if(console.log("preventBrowserDropEvents called."),"undefined"!=typeof tabulator){if(tabulator.preventBrowserDropEventsDone)return;tabulator.preventBrowserDropEventsDone=!0}e.addEventListener("drop",r,!1),e.addEventListener("dragenter",t,!1),e.addEventListener("dragover",t,!1)},UI.aclControl.shortNameForFolder=function(e){var t=e.uri;"/"===t.slice(-1)&&(t=t.slice(0,-1));var r=t.lastIndexOf("/");return r>=0&&(t=t.slice(r+1)),t||"/"},UI.aclControl.ACLControlBox5=function(e,t,r,n,o){var a=n.updater||new $rdf.UpdateManager(n),i=UI.ns.acl,l=e.doc(),d=t.createElement("table");d.setAttribute("style","margin: 1em; border: 0.1em #ccc ;");var s=d.appendChild(t.createElement("tr"));s.textContent="Sharing for "+r+" "+UI.utils.label(e),s.setAttribute("style","min-width: 20em; padding: 1em; font-size: 120%; border-bottom: 0.1em solid red; margin-bottom: 2em;");var f=d.appendChild(t.createElement("tr")),c=f.appendChild(t.createElement("div"));c.setAttribute("style","padding: 2em;");var u=d.appendChild(t.createElement("tr")),p=u.appendChild(t.createElement("table")),h=d.appendChild(t.createElement("tr")),g="border-radius: 0.3em; background-color: white; border: 0.01em solid #888;",v=function(r,n,o,a,i){var l=i.doingDefault?"default":"main";i=i||{};var d,s=UI.acl.readACL(n,o,a,i.doingDefaults);r[l]=d=UI.acl.ACLbyCombination(s);var f=function(e){for(var t=["Read","Append","Write","Control"],r=[],n=0;n<4;n++)e&1<<n&&r.push("http://www.w3.org/ns/auth/acl#"+t[n]);return r.sort(),r=r.join("\n")},c={13:"Owners",9:"Owners (write locked)",5:"Editors",3:"Posters",2:"Submitters",1:"Viewers"},u={13:!0,5:!0,3:!0,2:!0,1:!0},p={13:"can read, write, and control sharing.",9:"can read and control sharing, currently write-locked.",5:"can read and change information",3:"can add new information, and read but not change existing information",2:"can add new information but not read any",1:"can read but not change information"},h={13:"purple",9:"blue",5:"red",3:"orange",2:"#cc0",1:"green"},g=function(e){for(var t="",r=["Read","Append","Write","Control"],n=0;n<4;n++)e&1<<n&&(t+=r[n])},v=function(e){for(var t=0;t<16;t++){var r=d[f(t)];if(r)for(var n=0;n<r.length;n++)for(;n<r.length&&r[n][1]===e;)r.splice(n,1)}},m=function(e){var t=UI.ns,r=$rdf.sym(e),n=a.findTypeURIs(r);for(ty in n)console.log("    drop object type includes: "+ty);if(4===e.split("/").length&&!e.split("/")[1]&&!e.split("/")[3])return{pred:"origin",obj:r};if(t.vcard("WebID").uri in n)return{pred:"agent",obj:r};if(t.vcard("Group").uri in n)return{pred:"agentGroup",obj:r};if(r.sameTerm(t.foaf("Agent"))||r.sameTerm(t.rdf("Resource"))||r.sameTerm(t.owl("Thing")))return{pred:"agentClass",obj:r};if(t.vcard("Individual").uri in n||t.foaf("Person").uri in n||t.foaf("Agent").uri in n){var o=a.any(r,t.foaf("preferredURI"));return o?{pred:"agent",obj:$rdf.sym(o)}:{pred:"agent",obj:r}}return t.solid("AppProvider").uri in n?{pred:"origin",obj:r}:t.solid("AppProviderClass").uri in n?{pred:"originClass",obj:r}:void console.log("    Triage fails for "+e)};r.saveBack=function(e){var t=$rdf.graph();r.isContainer?r.defaultsDiffer?(UI.acl.makeACLGraphbyCombo(t,n,r.mainByCombo,o,!0),UI.acl.makeACLGraphbyCombo(t,n,r.defByCombo,o,!1,!0)):UI.acl.makeACLGraphbyCombo(t,n,r.mainByCombo,o,!0,!0):UI.acl.makeACLGraphbyCombo(t,n,r.mainByCombo,o,!0);var i=t.updater||new $rdf.UpdateManager(t);i.put(o,t.statementsMatching(void 0,void 0,void 0,o),"text/turtle",function(r,n,i){n?(a.fetcher.unload(o),a.add(t.statements),a.fetcher.requested[o.uri]="done",console.log("ACL modification: success!")):console.log("ACL file save failed: "+i),e(n)})};var C,b,y=function(n,o){var l=r.appendChild(t.createElement("tr"));l.combo=o,l.setAttribute("style","color: "+(i.modify?h[C]||"black":"#888")+";");var d=l.appendChild(t.createElement("td"));d.textContent=c[C]||g[C],d.setAttribute("style","padding-bottom: 2em;");var s=l.appendChild(t.createElement("td")),f=s.appendChild(t.createElement("table"));f.style.width="100%";var u=l.appendChild(t.createElement("td"));u.textContent=p[C]||"Unusual combination",u.setAttribute("style","max-width: 30%;");var b=function(e,a){f.NoneTR&&(f.removeChild(f.NoneTR),delete f.NoneTR);var l={};i.modify&&(l.deleteFunction=function(){for(var t=n[o],i=0;i<t.length;i++)if(t[i][0]===e&&t[i][1]===a){t.splice(i,1);break}r.saveBack(function(e){e&&f.removeChild(d)})});var d=f.appendChild(UI.widgets.personTR(t,$rdf.sym(e),$rdf.sym(a),l));d.predObj=[e.uri,a.uri]},y=function(e){var r=n[e];if(r&&r.length){var o=f.children;r.sort();for(var a=0;a<o.length;a++)o[a].trashme=!0;for(var i=0;i<r.length;i++){var l=!1;for(d=0;d<o.length;d++)if(o[d].predObj&&o[d].predObj[0]===r[i][0]&&o[d].predObj[1]===r[i][1]){l=!0,delete o[d].trashme;break}l||b(r[i][0],r[i][1])}for(var d=o.length-1;d>=0;d--)o[d].trashme&&f.removeChild(o[d])}else{UI.widgets.clearElement(f);var s=f.appendChild(t.createElement("tr"));s.textContent="None",s.setAttribute("style","padding: 1em;"),f.NoneTR=s}};y(o),l.refresh=function(){y(o)},i.modify&&(l.addEventListener("dragover",function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"}),l.addEventListener("dragenter",function(e){console.log("dragenter event dropEffect: "+e.dataTransfer.dropEffect),this.style.backgroundColor="#ccc",e.dataTransfer.dropEffect="link",console.log("dragenter event dropEffect 2: "+e.dataTransfer.dropEffect)}),l.addEventListener("dragleave",function(e){console.log("dragleave event dropEffect: "+e.dataTransfer.dropEffect),this.style.backgroundColor="white"}),l.addEventListener("drop",function(t){t.preventDefault&&t.preventDefault(),console.log("Drop event. dropEffect: "+t.dataTransfer.dropEffect),console.log("Drop event. types: "+(t.dataTransfer.types?t.dataTransfer.types.join(", "):"NOPE"));var i,l=null,d=this;if(t.dataTransfer.types){for(var s=0;s<t.dataTransfer.types.length;s++){var f=t.dataTransfer.types[s];"text/uri-list"===f?(l=t.dataTransfer.getData(f).split("\n"),console.log("Dropped text/uri-list: "+l)):"text/plain"===f&&(i=t.dataTransfer.getData(f))}null===l&&i&&"http"===i.slice(0,4)&&(l=i,console.log("Waring: Poor man's drop: using text for URI"))}else l=[t.dataTransfer.getData("Text")],console.log("@@ WARNING non-standrad drop event: "+l[0]);return console.log("Dropped URI list (2): "+l),l&&l.map(function(t){var i=function(){o in n||(n[o]=[]),v(t),n[o].push([l.pred,l.obj.uri]),console.log("ACL: setting access to "+e+" by "+l.pred+": "+l.obj),r.saveBack(function(e){e&&(d.style.backgroundColor="white",E())})},l=m(t);return l?void i():(console.log("   looking up dropped thing "+t),void a.fetcher.nowOrWhenFetched(t,function(e,r){e?(l=m(t),l?i():console.log("Error: Drop fails to drop appropriate thing! "+t)):console.log("Error looking up dropped thing "+t+": "+r)}))}),!1}))},E=function(){for(var e=r.children,t=0;t<e.length;t++)e[t].refresh&&e[t].refresh()};for(C=15;C>0;C--)b=f(C),(i.modify&&u[C]||d[b])&&y(d,b);return d};return UI.acl.getACLorDefault(l,function(e,o,d,s,f,u){var m=!o;if(e)if(p.isContainer="/"===d.uri.slice(-1),m){var C=n.each(void 0,i("defaultForNew"),f,u);if(C.length){c.innerHTML="",c.textContent="The sharing for this "+r+" is the default for folder ";var b=c.appendChild(t.createElement("a"));b.setAttribute("href",f.uri),b.textContent=UI.aclControl.shortNameForFolder(f);var y=UI.acl.adoptACLDefault(l,s,f,u);v(p,l,s,y,{modify:!1}),p.style="color: #777;";var E=h.appendChild(t.createElement("button"));E.textContent="Set specific sharing\nfor this "+r,E.style=g,E.addEventListener("click",function(e){a.put(s,y.statements,"text/turtle",function(e,t,n){t?(c.textContent=" (Now editing specific access for this "+r+")",h.removeChild(E)):c.textContent+=" (Error writing back access control file: "+n+")"})})}else c.textContent+=" (No defaults given.)"}else{var w,D,I=function(e){w=h.appendChild(t.createElement("button")),w.textContent="Stop specific sharing for this "+r+" -- just use default",e&&(w.textContent+=" for "+UI.utils.label(e)),w.style=g,w.addEventListener("click",function(e){n.fetcher.webOperation("DELETE",s).then(function(e){n.fetcher.requested[s.uri]=404,n.fetcher.nonexistant[e.resource.uri]=!0,n.fetcher.unload(s),c.textContent=" The sharing for this "+r+" is now the default.",h.removeChild(w),p.style="color: #777;"}).catch(function(e){c.textContent+=" (Error deleting access control file: "+s+": "+e+")"})})},x=d.uri.split("#")[0],U=x.slice(0,-1).lastIndexOf("/"),A=x.indexOf("//"),T=A>=0&&U<A+2||U<0?null:x.slice(0,U+1);if(T?UI.acl.getACLorDefault($rdf.sym(T),function(e,t,r,n,o,a){e&&(D=t?r:o),I(D)}):I(),p.addControlForDefaults=function(){p.notice.textContent="Access to things within this folder:",p.notice.style="font-size: 120%; color: black;";var e=UI.widgets.clearElement(p.offer).appendChild(t.createElement("button"));e.innerHTML="<p>Set default for folder contents to<br />just track the sharing for the folder</p>",e.style=g,e.addEventListener("click",function(e){delete p.defaultsDiffer,delete p.defByCombo,p.saveBack(function(e){e&&p.removeControlForDefaults()})},!1),p.defaultsDiffer=!0,p.defByCombo=v(p,d,s,n,{modify:!0,doingDefaults:!0})},p.removeControlForDefaults=function(){c.textContent="This is also the default for things in this folder.",p.notice.textContent="Sharing for things within the folder currently tracks sharing for the folder.",p.notice.style="font-size: 80%; color: #888;";var e=UI.widgets.clearElement(p.offer).appendChild(t.createElement("button"));for(e.innerHTML="<p>Set the sharing of folder contets <br />separately from the sharing for the folder</p>",e.style=g,e.addEventListener("click",function(e){p.addControlForDefaults(),c.textContent=""});p.divider.nextSibling;)p.removeChild(p.divider.nextSibling);c.textContent="This is now also the default for things in this folder."},p.isContainer){var L=UI.acl.readACL(d,s,n),k=UI.acl.readACL(d,s,n,!0);p.defaultsDiffer=!UI.acl.sameACL(L,k),console.log("Defaults differ ACL: "+p.defaultsDiffer)}p.mainByCombo=v(p,d,s,n,{modify:!0}),p.divider=p.appendChild(t.createElement("tr")),p.notice=p.divider.appendChild(t.createElement("td")),p.notice.style="font-size: 80%; color: #888;",p.offer=p.divider.appendChild(t.createElement("td")),p.notice.setAttribute("colspan","2"),p.defaultsDiffer?p.addControlForDefaults():p.removeControlForDefaults()}else c.textContent+="Error reading "+(m?" default ":"")+"ACL. status "+d+": "+s}),d};
},{"./acl":249,"./ns":254,"./utils":260,"./widgets":263}],249:[function(require,module,exports){
"use strict";var acl=module.exports={},UI={acl:acl,icons:require("./iconBase"),log:require("./log"),ns:require("./ns"),store:require("./store"),utils:require("./utils"),widgets:require("./widgets")};UI.acl.adoptACLDefault=function(t,r,n,e){var a=UI.store,i=UI.ns.acl,o=(UI.ns,"/"===t.uri.slice(-1)),s=a.each(void 0,i("defaultForNew"),n,e),c=[];s.map(function(r){c=c.concat(a.statementsMatching(r,i("agent"),void 0,e)).concat(a.statementsMatching(r,i("agentClass"),void 0,e)).concat(a.statementsMatching(r,i("agentGroup"),void 0,e)).concat(a.statementsMatching(r,i("origin"),void 0,e)).concat(a.statementsMatching(r,i("originClass"),void 0,e)).concat(a.statementsMatching(r,i("mode"),void 0,e)),c.push($rdf.st(r,i("accessTo"),t,e)),o&&c.push($rdf.st(r,i("defaultForNew"),t,e))});var u=$rdf.graph();return c.map(function(t){var n=function(t){var n=e.uri.length;return $rdf.sym(t.uri.slice(0,n)==e.uri?r.uri+t.uri.slice(n):t.uri)};u.add(n(t.subject),n(t.predicate),n(t.object),$rdf.sym(r.uri))}),u},UI.acl.readACL=function(t,r,n,e){var n=n||UI.store,a=UI.ns,i=e?a.acl("defaultForNew"):a.acl("accessTo"),o=UI.ns.acl,s={agent:[],agentClass:[],agentGroup:[],origin:[],originClass:[]},c=n.each(void 0,i,t);for(var u in{agent:!0,agentClass:!0,agentGroup:!0,origin:!0,originClass:!0})c.map(function(t){n.each(t,o("mode")).map(function(r){n.each(t,o(u)).map(function(n){s[u][n.uri]||(s[u][n.uri]=[]),s[u][n.uri][r.uri]=t})})});return s},UI.acl.sameACL=function(t,r){var n=function(t,r){for(var n in{agent:!0,agentClass:!0,agentGroup:!0,origin:!0,originClass:!0})if(t[n])for(var e in t[n])for(var a in t[n][e])if(!r[n][e]||!r[n][e][a])return!1;return!0};return n(t,r)&&n(r,t)},UI.acl.ACLunion=function(t){for(var r,n,e=t[0],a=1;a<t.length;a++)["agent","agentClass","agentGroup","origin","originClass"].map(function(i){if(r=t[a],r[i])for(n in r[i])for(var o in r[i][n])e[i][n]||(e[i][n]=[]),e[i][n][o]=!0});return e},UI.acl.loadUnionACL=function(t,r){var n=[],e=function t(e){e.length?(doc=e.shift().doc(),UI.acl.getACLorDefault(doc,function(a,i,o,s,c,u){var l=!i;return a?(n.push(l?UI.widgets.readACL(c,u):UI.widgets.readACL(o,s)),void t(e.slice(1))):r(a,s)})):r(!0,UI.widgets.ACLunion(n))};e(t)},UI.acl.ACLbyCombination=function(t){var r=[];return["agent","agentClass","agentGroup","origin","originClass"].map(function(n){for(var e in t[n]){var a=[];for(var i in t[n][e])a.push(i);a.sort(),a=a.join("\n"),r[a]||(r[a]=[]),r[a].push([n,e])}}),r},UI.acl.makeACLGraph=function(t,r,n,e){var a=UI.acl.ACLbyCombination(n);return UI.acl.makeACLGraphbyCombo(t,r,a,e)},UI.acl.makeACLGraphbyCombo=function(t,r,n,e,a,i){var o=UI.ns.acl;for(combo in n){var s=combo.split("\n"),c=s.map(function(t){return t.split("#")[1]}).join("");i&&!a&&(c+="Default");var u=t.sym(e.uri+"#"+c);t.add(u,UI.ns.rdf("type"),o("Authorization"),e),a&&t.add(u,o("accessTo"),r,e),i&&t.add(u,o("defaultForNew"),r,e);for(var l=0;l<s.length;l++)t.add(u,o("mode"),t.sym(s[l]),e);var f=n[combo];for(l=0;l<f.length;l++){var d=f[l][0],g=f[l][1];t.add(u,o(d),t.sym(g),e)}}},UI.acl.ACLToString=function(t){return UI.widgets.comboToString(UI.widgets.ACLbyCombination(t))},UI.acl.comboToString=function(t){str="";for(combo in t){var r=combo.split("\n"),n=r.map(function(t){return t.split("#")[1][0]}).join("");str+=n+":";var e=t[combo];for(i=0;i<e.length;i++){var a=e[i][0],o=$rdf.sym(e[i][1]);str+="agent"===a?"@":"",str+=o.sameTerm(UI.ns.foaf("Agent"))?"*":UI.utils.label(o),i<e.length-1&&(str+=",")}str+=";"}return"{"+str.slice(0,-1)+"}"},UI.acl.makeACLString=function(t,r,n){var e=$rdf.graph();return UI.widgets.makeACLGraph(e,t,r,n),$rdf.serialize(n,e,n.uri,"text/turtle")},UI.acl.putACLObject=function(t,r,n,e,a){var i=UI.widgets.ACLbyCombination(n);return UI.widgets.putACLbyCombo(t,r,i,e,a)},UI.acl.putACLbyCombo=function(t,r,n,e,a){var i=$rdf.graph();UI.widgets.makeACLGraphbyCombo(i,r,n,e,!0),t.updater.put(e,i.statementsMatching(void 0,void 0,void 0,e),"text/turtle",function(i,o,s){o?(t.fetcher.unload(e),UI.widgets.makeACLGraphbyCombo(t,r,n,e,!0),t.fetcher.requested[e.uri]="done",a(o)):a(o,s)})},UI.acl.fixIndividualCardACL=function(t,r,n){var e=UI.store.each(void 0,UI.ns.vcard("hasMember"),t);t.doc();e?UI.widgets.fixIndividualACL(t,e,r,n):(r("This card is in no groups"),n(!0))},UI.acl.fixIndividualACL=function(t,r,n,e){n=n||console.log;var a=t.doc();UI.acl.getACLorDefault(a,function(i,o,s,c,u,l){if(!i)return e(!1,c);var f=o?UI.widgets.readACL(s,c):UI.widgets.readACL(u,l);UI.widgets.loadUnionACL(r,function(r,i){return r?void(UI.widgets.sameACL(i,f)?n("Nice - same ACL. no change "+UI.utils.label(t)+" "+a):(n("Group ACLs differ for "+UI.utils.label(t)+" "+a),UI.widgets.putACLObject(UI.store,s,i,c,e))):e(!1,i)})})},UI.acl.setACL=function(t,r,n){var e=kb.any(kb.sym(t),kb.sym("http://www.iana.org/assignments/link-relations/acl"));e?webOperation("PUT",e.uri,{data:r,contentType:"text/turtle"},n):fetcher.nowOrWhenFetched(t,void 0,function(e,a){if(!e)return n(e,"Gettting headers for ACL: "+a);var i=kb.any(kb.sym(t),kb.sym("http://www.iana.org/assignments/link-relations/acl"));i?webOperation("PUT",i.uri,{data:r,contentType:"text/turtle"},n):n(!1,"No Link rel=ACL header for "+t)})},UI.acl.getACLorDefault=function(t,r){UI.acl.getACL(t,function(n,e,a,i){var o=UI.store,s=UI.ns.acl;if(!n)return r(!1,!1,e,i);var c=function n(e){"/"===e.slice(-1)&&(e=e.slice(0,-1));var i=e.lastIndexOf("/"),c=e.indexOf("/",e.indexOf("//")+2);e=e.slice(0,i+1);var u=$rdf.sym(e);UI.acl.getACL(u,function(l,f,d){if(!l)return r(!1,!0,f,"( No ACL pointer "+e+" "+f+")"+d);if(403===f)return r(!1,!0,f,"( default ACL file FORBIDDEN. Stop."+e+")");if(404===f){if(c>=i)return r(!1,!0,499,"Nothing to hold a default");n(e)}else{if(200!==f)return r(!1,!0,f,"Error status '"+f+"' searching for default for "+u);var g=o.each(void 0,s("defaultForNew"),o.sym(e),d);if(g.length){var C=o.sym(e);r(!0,!1,t,a,C,d)}else n(e)}})};return n?404!==e?403===e?r(!1,!1,e,"(Sharing not available to you)"+i):200!==e?r(!1,!1,e,"Error "+e+" accessing Access Control information for "+t+": "+i):r(!0,!0,t,a):void c(t.uri):r(!1,!1,e,"Error accessing Access Control information for "+t+") "+i)})},UI.acl.getACL=function(t,r){UI.store.fetcher.nowOrWhenFetched(t,void 0,function(n,e){if(!n)return r(n,"Can't get headers to find ACL for "+t+": "+e);var a=UI.store,i=a.any(t,a.sym("http://www.iana.org/assignments/link-relations/acl"));if(i){if(UI.store.fetcher.nonexistant[i.uri])return r(!0,404,i,"ACL file "+i+" does not exist.");UI.store.fetcher.nowOrWhenFetched(i,void 0,function(t,n,e){t?r(!0,200,i):r(!0,e.status,i,"Can't read Access Control File "+i+": "+n)})}else r(!1,900,"No Link rel=ACL header for "+t)})};
},{"./iconBase":250,"./log":251,"./ns":254,"./store":257,"./utils":260,"./widgets":263}],250:[function(require,module,exports){
"use strict";if(module.scriptURI)module.exports.iconBase=""+module.scriptURI.slice(0,module.scriptURI.lastIndexOf("/"))+"/icons/",module.exports.originalIconBase=""+module.scriptURI.slice(0,module.scriptURI.lastIndexOf("/"))+"/originalIcons/";else{var iconsOnGithub="https://melvincarvalho.github.io/solid-ui/static";"undefined"!=typeof $SolidTestEnvironment&&$SolidTestEnvironment.iconBase?(module.exports.iconBase=$SolidTestEnvironment.iconBase,module.exports.originalIconBase=$SolidTestEnvironment.originalIconBase):(module.exports.iconBase=iconsOnGithub+"/icons/",module.exports.originalIconBase=iconsOnGithub+"/originalIcons/")}console.log("   Icon base is: "+module.exports.iconBase);
},{}],251:[function(require,module,exports){
"use strict";var wrapper=function(){var e={},n=1,t=2,r=4,o=8,l=16,s=32,u=63;return e.level=n+t+r,e.ascending=!1,e.msg=function(n,t,o){if(t||(t=r,o="mesg"),e.level&t)if("undefined"!=typeof document){var l=document.getElementById("status");if(!l)return;var s=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;")},u=document.createElement("span");u.setAttribute("class",o);var i=new Date;u.innerHTML=i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()+" ["+o+"] "+s(n)+"<br/>",e.ascending?l.insertBefore(u,l.firstChild):l.appendChild(u)}else if("undefined"!=typeof console)console.log(n);else{var a=dump?dump:print;if(!a)throw"log: No way to output message: "+n;a("Log: "+n+"\n")}},e.warn=function(n){e.msg(n,t,"warn")},e.debug=function(n){e.msg(n,s,"dbug")},e.info=function(n){e.msg(n,l,"info")},e.error=function(t){e.msg(t,n,"eror")},e.success=function(n){e.msg(n,o,"good")},"undefined"!=typeof alert?e.alert=alert:e.alert=e.warn,e.clear=function(){var e=document.getElementById("status");e&&emptyNode(e)},e.setLevel=function(n){e.level=u,e.debug("Log level is now "+n),e.level=n},e.dumpStore=function(){var n=e.level,t=Serializer();str=t.statementsToN3(kb.statements),e.level=u,e.debug("\n"+str),e.level=n},e.dumpHTML=function(){var n=e.level;e.level=u,e.debug(document.innerHTML),e.level=n},e};module.exports=wrapper();
},{}],252:[function(require,module,exports){
"use strict";var utilsModule=require("./utils");module.exports.matrixForQuery=function(e,t,r,l,n,i,a){var d=e.createElement("table"),o=UI.store,s=e.createElement("tr"),f=s.appendChild(e.createElement("td"));f.setAttribute("class","MatrixCorner"),d.appendChild(s),d.lastHeader=s;var u=[],c=[],h=function(e,t,r,l){for(;e.firstChild;)e.removeChild(e.firstChild);e.setAttribute("style",""),e.style.textAlign="center",i.cellFunction?i.cellFunction(e,t,r,l):(e.textContent=utilsModule.label(l),e.setAttribute("style","padding: 0.3em")),delete e.old},v=function(t){var r=t.toNT();if(c[r])return c[r];var l=e.createElement("tr"),n=l.appendChild(e.createElement("td"));n.setAttribute("style","padding: 0.3em;"),n.textContent=utilsModule.label(t),(t.termType="NamedNode")&&o.fetcher.nowOrWhenFetched(t.uri.split("#")[0],void 0,function(e,r,l){n.textContent=utilsModule.label(t)});for(var a=0;a<u.length;a++)h(l.appendChild(e.createElement("td")),$rdf.fromNT(u[a]),t,null);l.dataValueNT=r,c[r]=l;for(var s=d.lastHeader.nextSibling;s;s=s.nextSibling)if(r>s.dataValueNT&&i&&i.yDecreasing||r<s.dataValueNT&&(!i||!i.yDecreasing))return d.insertBefore(l,s);return d.appendChild(l)},g=function(t){for(var r=t.toNT(),l=null,n=0;n<u.length;n++){if(u[n]===r)return n;if(r>u[n]&&i.xDecreasing||r<u[n]&&!i.xDecreasing){u=u.slice(0,n).concat([r]).concat(u.slice(n)),l=n;break}}null===l&&(l=u.length,u.push(r));for(var a=d.firstChild;a;a=a.nextSibling){var o=a.dataValueNT,s=e.createElement("td");if(s.style.textAlign="center",a===d.firstChild?s.textContent=utilsModule.label(t):h(s,t,$rdf.fromNT(o),null),l===u.length-1)a.appendChild(s);else{for(var f=a.firstChild,c=0;c<l+1;c++)f=f.nextSibling;a.insertBefore(s,f)}}return l},x=function(){for(var e=1;e<d.children.length;e++)for(var t=d.children[e],r=1;r<t.children.length;r++)t.children[r].old=!0},m=function(){var e,t,r=[],l=[];if(i.set_y)for(var n=0;n<i.set_y.length;n++)l[i.set_y[n]]=!0;if(i.set_x)for(n=0;n<i.set_x.length;n++)r[g(i.set_x[n])+1]=!0;for(var a=1;a<d.children.length;a++){e=d.children[a];for(var o=1;o<e.children.length;o++)if(t=e.children[o],t.old){var s=$rdf.fromNT(e.dataValueNT),f=$rdf.fromNT(u[o-1]);h(t,f,s,null)}else l[e.dataValueNT]=!0,r[o]=!0}for(var a=0;a<d.children.length;a++)if(e=d.children[a],a>0&&!l[e.dataValueNT])delete c[e.dataValueNT],d.removeChild(e);else for(var o=e.children.length-1;o>0;o--){var t=e.children[o];r[o]||e.removeChild(t)}for(var v=[],o=0;o<u.length;o++)r[o+1]&&v.push(u[o]);u=v};d.refresh=function(){x(),o.query(t,p,void 0,m)};var p=function(e){var t=e[r],i=e[l],a=e[n],d=v(i),o=g(t),s=d.children[o+1];h(s,t,i,a)};if(i.set_y)for(var C=0;C<i.set_y.length;C++)v(i.set_y[C]);if(i.set_x)for(C=0;C<i.set_x.length;C++)g(i.set_x[C]);return o.query(t,p,void 0,a),d};
},{"./utils":260}],253:[function(require,module,exports){
"use strict";module.exports=function(e,t,r,n,a){t=t||UI.kb;var i=UI.ns,d=$rdf.Namespace("http://www.w3.org/2005/01/wf/flow#"),o=$rdf.Namespace("http://purl.org/dc/terms/");a=a||{};var l,s=!!a.newestFirst,c="width: 90%; font-size:100%; background-color: white; border: 0.07em solid #eee; padding: .2em 0.5em; margin: 0.1em 1em 0.1em 1em",u=e.createElement("div"),p=tabulator.preferences.get("me"),m=p?t.sym(p):null,f=UI.store.updater,h=function(t,r){var n=e.createElement("a");return r.uri&&(n.setAttribute("href",r.uri),n.addEventListener("click",UI.widgets.openHrefInOutlineMode,!0),n.setAttribute("style","color: #3B5998; text-decoration: none; ")),n.textContent=t,n},v=function(t,r){var n=e.createElement("pre");return n.setAttribute("style",r||"color: grey"),u.appendChild(n),n.appendChild(e.createTextNode(t)),n},C={log:function(e){v(e,"color: #111;")},warn:function(e){v(e,"color: #880;")},error:function(e){v(e,"color: #800;")}},g=function(){var a=e.createElement("tr"),d=e.createElement("td"),l=e.createElement("td"),s=e.createElement("td");a.appendChild(d),a.appendChild(l),a.appendChild(s),a.AJAR_date="9999-01-01T00:00:00Z";var u=function(){p.setAttribute("class","pendingedit"),p.disabled=!0;var d=[],l=new Date,s=""+l.getTime(),c=$rdf.term(l),u=t.sym(n.uri+"#Msg"+s);d.push(new $rdf.Statement(r,i.wf("message"),u,n)),d.push(new $rdf.Statement(u,i.sioc("content"),t.literal(p.value),n)),d.push(new $rdf.Statement(u,o("created"),c,n)),m&&d.push(new $rdf.Statement(u,i.foaf("maker"),m,n));var h=function(r,n,i){if(n){var d={"?msg":u,"?content":t.literal(p.value),"?date":c,"?creator":m};y(d),p.value="",p.setAttribute("class",""),p.disabled=!1}else a.appendChild(UI.widgets.errorMessageBlock(e,"Error writing message: "+i))};f.update([],d,h)};a.appendChild(e.createElement("br"));var p=e.createElement("textarea");l.appendChild(p),p.rows=3,p.setAttribute("style",c);var h=e.createElement("button");return h.textContent="send",h.setAttribute("style","float: right;"),h.addEventListener("click",u,!1),s.appendChild(h),a},b=function(e){var t=UI.store.any(e,UI.ns.foaf("nick"));return t?""+t.value:""+UI.utils.label(e)},A=function(e,r){var n,a,d={};for(n=r.firstChild;n;n=n.nextSibling)n.AJAR_subject&&(d[n.AJAR_subject.uri]=!0);var o=t.each(e,i.wf("message")),l={};for(o.map(function(e){l[e.uri]=!0,d[e.uri]||w(e)}),n=r.firstChild;n;)a=n.nextSibling,n.AJAR_subject&&!l[n.AJAR_subject.uri]&&r.removeChild(n),n=a},E=function(e){var n=t.statementsMatching(e).concat(t.statementsMatching(void 0,void 0,e));f.update(n,[],function(e,t,n){t?A(r,l):C.error("Cant delete messages:"+n)})},w=function(e){var r={"?msg":e,"?creator":t.any(e,i.foaf("maker")),"?date":t.any(e,o("created")),"?content":t.any(e,i.sioc("content"))};y(r)},y=function(t){var r=t["?creator"],n=t["?msg"],a=t["?date"],i=t["?content"],d=a.value,o=e.createElement("tr");o.AJAR_date=d,o.AJAR_subject=n;for(var u=!1,p=l.firstChild;p;p=p.nextSibling)if(d>p.AJAR_date&&s||d<p.AJAR_date&&!s){l.insertBefore(o,p),u=!0;break}u||l.appendChild(o);var m=e.createElement("td");o.appendChild(m);var f=m.appendChild(h(b(r),r));r.uri&&UI.store.fetcher.nowOrWhenFetched(r.doc(),void 0,function(e,t){f.textContent=b(r)}),m.appendChild(e.createElement("br")),m.appendChild(h(UI.widgets.shortDate(d),n));var v=e.createElement("td");o.appendChild(v);var C=e.createElement("p");C.setAttribute("style",c),v.appendChild(C),C.textContent=i.value;var g=e.createElement("td");o.appendChild(g);var A=e.createElement("button");g.appendChild(A),A.textContent="-",o.setAttribute("class","hoverControl"),A.setAttribute("class","hoverControlHide"),A.setAttribute("style","color: red;"),A.addEventListener("click",function(t){g.removeChild(A);var r=e.createElement("button");r.textContent="cancel",g.appendChild(r).addEventListener("click",function(e){g.removeChild(a),g.removeChild(r),g.appendChild(A)},!1);var a=e.createElement("button");a.textContent="Delete message",g.appendChild(a).addEventListener("click",function(e){g.removeChild(a),g.removeChild(r),E(n)},!1)},!1)};if(l=e.createElement("table"),u.appendChild(l),l.setAttribute("style","width: 100%;"),tabulator.preferences.get("me")){var x=g();s?l.insertBefore(x,l.firstChild):l.appendChild(x)}var k;if(a.query)k=a.query;else{k=new $rdf.Query("Messages");var I={},U=["msg","date","creator","content"];U.map(function(e){k.vars.push(I[e]=$rdf.variable(e))}),k.pat.add(r,d("message"),I.msg),k.pat.add(I.msg,i.dct("created"),I.date),k.pat.add(I.msg,i.foaf("maker"),I.creator),k.pat.add(I.msg,i.sioc("content"),I.content)}return t.query(k,y),u.refresh=function(){A(r,l)},u};
},{}],254:[function(require,module,exports){
"use strict";var thisModule={};module.exports=thisModule;var $rdf=require("rdflib");thisModule.expand=function(t){var e=t.split(":");if(0===e.length)throw new Error("Prefixed name has no colon: "+t);if(!(e[0]in thisModule))throw new Error("Unregistered namespace prefix in: "+t);return thisModule[e[0]](e[1])},thisModule.auth=$rdf.Namespace("http://www.w3.org/ns/auth/acl#"),thisModule.acl=$rdf.Namespace("http://www.w3.org/ns/auth/acl#"),thisModule.arg=$rdf.Namespace("http://www.w3.org/ns/pim/arg#"),thisModule.cal=$rdf.Namespace("http://www.w3.org/2002/12/cal/ical#"),thisModule.contact=$rdf.Namespace("http://www.w3.org/2000/10/swap/pim/contact#"),thisModule.dc=$rdf.Namespace("http://purl.org/dc/elements/1.1/"),thisModule.dct=$rdf.Namespace("http://purl.org/dc/terms/"),thisModule.doap=$rdf.Namespace("http://usefulinc.com/ns/doap#"),thisModule.foaf=$rdf.Namespace("http://xmlns.com/foaf/0.1/"),thisModule.http=$rdf.Namespace("http://www.w3.org/2007/ont/http#"),thisModule.httph=$rdf.Namespace("http://www.w3.org/2007/ont/httph#"),thisModule.ical=$rdf.Namespace("http://www.w3.org/2002/12/cal/icaltzd#"),thisModule.ldp=$rdf.Namespace("http://www.w3.org/ns/ldp#"),thisModule.link=thisModule.tab=thisModule.tabont=$rdf.Namespace("http://www.w3.org/2007/ont/link#"),thisModule.log=$rdf.Namespace("http://www.w3.org/2000/10/swap/log#"),thisModule.meeting=$rdf.Namespace("http://www.w3.org/ns/pim/meeting#"),thisModule.mo=$rdf.Namespace("http://purl.org/ontology/mo/"),thisModule.owl=$rdf.Namespace("http://www.w3.org/2002/07/owl#"),thisModule.pad=$rdf.Namespace("http://www.w3.org/ns/pim/pad#"),thisModule.patch=$rdf.Namespace("http://www.w3.org/ns/pim/patch#"),thisModule.qu=$rdf.Namespace("http://www.w3.org/2000/10/swap/pim/qif#"),thisModule.trip=$rdf.Namespace("http://www.w3.org/ns/pim/trip#"),thisModule.rdf=$rdf.Namespace("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),thisModule.rdfs=$rdf.Namespace("http://www.w3.org/2000/01/rdf-schema#"),thisModule.rss=$rdf.Namespace("http://purl.org/rss/1.0/"),thisModule.sched=$rdf.Namespace("http://www.w3.org/ns/pim/schedule#"),thisModule.schema=$rdf.Namespace("http:/schema.org/"),thisModule.sioc=$rdf.Namespace("http://rdfs.org/sioc/ns#"),thisModule.solid=$rdf.Namespace("http://www.w3.org/ns/solid/terms#"),thisModule.space=$rdf.Namespace("http://www.w3.org/ns/pim/space#"),thisModule.stat=$rdf.Namespace("http://www.w3.org/ns/posix/stat#"),thisModule.ui=$rdf.Namespace("http://www.w3.org/ns/ui#"),thisModule.vcard=$rdf.Namespace("http://www.w3.org/2006/vcard/ns#"),thisModule.wf=$rdf.Namespace("http://www.w3.org/2005/01/wf/flow#"),thisModule.xsd=$rdf.Namespace("http://www.w3.org/2001/XMLSchema#");
},{"rdflib":142}],255:[function(require,module,exports){
"use strict";var $rdf=require("rdflib"),padModule=module.exports={},UI={icons:require("./iconBase"),log:require("./log"),ns:require("./ns"),pad:padModule,rdf:$rdf,store:require("./store"),utils:require("./utils"),widgets:require("./widgets")};UI.pad.lightColorHash=function(e){var t=function(e){return e.split("").reduce(function(e,t){return e=(e<<5)-e+t.charCodeAt(0),e&e},0)};return"#"+(16777215&t(e.uri)|12632256).toString(16)},UI.pad.renderPartipants=function(e,t,n,r,o,a){var i=UI.store,s=UI.ns;t.setAttribute("style","margin: 0.8em;");var l=function(n){var r=i.any(n,s.wf("participant")),o=i.anyValue(n,s.ui("backgroundColor"))||"white",l=e.createElement("div");l.setAttribute("style","height: 1.5em; width: 1.5em; margin: 0.3em; border 0.01em solid #888; background-color: "+o);var u=UI.widgets.personTR(e,null,r,a);t.appendChild(u);var d=e.createElement("td");return d.setAttribute("style","vertical-align: middle;"),d.appendChild(l),u.insertBefore(d,u.firstChild),u},u=function(){var e=i.each(r,s.wf("participation")).map(function(e){return[i.anyValue(e,UI.ns.cal("dtstart"))||"9999-12-31",e]});e.sort();var n=e.map(function(e){return e[1]});UI.utils.syncTableToArray(t,n,l)};return t.refresh=u,u(),t},UI.pad.manageParticipation=function(e,t,n,r,o,a){if(!o)throw"Unknown user";var i=UI.store,s=UI.ns,l=e.createElement("table");t.appendChild(l);var u=i.each(r,s.wf("participation")).filter(function(e){return i.holds(e,s.wf("participant"),o)});if(u.length>1&&t.appendChild(UI.widgets.errorMessageBlock(e,"Multiple notes of my participation!")),u.length)UI.pad.renderPartipants(e,l,n,r,o,a);else{var d=UI.widgets.newThing(n),c=[UI.rdf.st(r,s.wf("participation"),d,n),UI.rdf.st(d,s.wf("participant"),o,n),UI.rdf.st(d,UI.ns.cal("dtstart"),new Date,n),UI.rdf.st(d,s.ui("backgroundColor"),UI.pad.lightColorHash(o),n)];i.updater.update([],c,function(i,s,u,d){return s?void UI.pad.renderPartipants(e,l,n,r,o,a):void console.log(t.textContent="Error recording your partipation: "+u)})}return l},UI.pad.notepad=function(e,t,n,r,o){o=o||{};var a=o.exists,i=e.createElement("table"),s=UI.store,l=(s.fetcher,UI.ns),u=UI.store.updater,d=$rdf.Namespace("http://www.w3.org/ns/pim/pad#");i.setAttribute("style","padding: 1em; overflow: auto; resize: horizontal; min-width: 40em;");var c=null,f=null;if(o.statusArea){var p=o.statusArea.appendChild(e.createElement("table")),h=p.appendChild(e.createElement("tr"));c=h.appendChild(e.createElement("td")),f=h.appendChild(e.createElement("td")),c.setAttribute("style","width:50%"),f.setAttribute("style","width:50%")}var g=function(t,n){console.log(t),o.statusArea&&(n?c:f).appendChild(UI.widgets.errorMessageBlock(e,t,"pink"))},v=function(e){o.statusArea&&(o.statusArea.innerHTML="")},m=function(e,t,n){var r=e.subject;t=t||"";var o="font-size: 100%; font-family: monospace; width: 100%; border: none; white-space: pre-wrap;",a="font-family: sans-serif; font-weight: bold;  border: none;",i=["font-size: 110%;  padding-top: 0.5em; padding-bottom: 0.5em; width: 100%;","font-size: 120%; padding-top: 1em; padding-bottom: 1em; width: 100%;","font-size: 150%; padding-top: 1em; padding-bottom: 1em; width: 100%;"],u=s.any(r,l.dc("author"));if(!t&&u){var c=UI.pad.lightColorHash(u);t="color: "+(n?"#888":"black")+"; background-color: "+c+";"}var f=s.any(r,d("indent"));f=f?f.value:0;var p=f>=0?o+"text-indent: "+3*f+"em;":a+i[-1-f];e.setAttribute("style",p+t)},b=function(e){var r=e.subject;if(!r)throw"No chunk for line to be deleted!";var o=s.any(void 0,d("next"),r),a=s.any(r,d("next"));if(o.sameTerm(n)&&a.sameTerm(n))return void console.log("You can't delete the only line.");var i=s.statementsMatching(r,void 0,void 0,t).concat(s.statementsMatching(void 0,void 0,r,t)),l=[$rdf.st(o,d("next"),a,t)],c=r.uri.slice(-4);console.log("Deleting line "+c),u.update(i,l,function(n,o,a,s){if(o){var l=e.parentNode,d=l.previousSibling;l.parentNode.removeChild(l),console.log("    deleted line "+c+" ok "+e.value),d&&d.firstChild&&d.firstChild.focus()}else 409===s.status?(m(e,"color: black;  background-color: #ffd;"),e.state=0,UI.utils.beep(.5,512),setTimeout(function(){u.requestDownstreamAction(t,E)},1e3)):(console.log("    removePart FAILED "+r+": "+a),console.log("    removePart was deleteing :'"+i),m(e,"color: black;  background-color: #fdd;"),g("Error "+s.status+" saving changes: "+a.true))})},w=function(e,n,r){var o=s.statementsMatching(n,d("indent")),a=o.length?Number(o[0].object.value):0;if(!(a+r<-3)){var i=a+r,l=$rdf.st(n,d("indent"),i,t);u.update(o,l,function(n,r,o){r?m(e):(console.log("Indent change FAILED '"+i+"' for "+t+": "+o),m(e,"color: black;  background-color: #fdd;"),u.requestDownstreamAction(t,E))})}},y=function(e,n){e.addEventListener("keydown",function(r){switch(r.keyCode){case 13:var o=r.shiftKey;if(console.log("enter"),o?(queue=s.any(void 0,d("next"),n),queueProperty="newlinesAfter"):(queue=s.any(n,d("next")),queueProperty="newlinesBefore"),queue[queueProperty]=queue[queueProperty]||0,queue[queueProperty]+=1,queue[queueProperty]>1)return void console.log("    queueing newline queue = "+queue[queueProperty]);console.log("    go ahead line before "+queue[queueProperty]),x(e,o);break;case 8:if(0===e.value.length)switch(console.log("Delete key line "+n.uri.slice(-4)+" state "+e.state),e.state){case 1:case 2:return void(e.state=4);case 3:case 4:return;case void 0:case 0:e.state=3,b(e),r.preventDefault();break;default:throw"Unexpected state "+e.state}break;case 9:var a=r.shiftKey?-1:1;w(e,n,a),r.preventDefault();break;case 27:console.log("escape"),u.requestDownstreamAction(t,E),r.preventDefault();break;case 38:e.parentNode.previousSibling&&(e.parentNode.previousSibling.firstChild.focus(),r.preventDefault());break;case 40:e.parentNode.nextSibling&&(e.parentNode.nextSibling.firstChild.focus(),r.preventDefault())}});var r=function e(n){var r=n.subject;m(n,void 0,!0);var o=s.any(r,l.sioc("content")).value;del=[$rdf.st(r,l.sioc("content"),o,t)],ins=[$rdf.st(r,l.sioc("content"),n.value,t)];var a=n.value;if(n.lastSent&&o!=n.lastSent)throw"Out of order, last sent expected '"+o+"' but found '"+n.lastSent+"'";n.lastSent=a,console.log(" Patch proposed to "+r.uri.slice(-4)+" '"+o+"' -> '"+a+"' "),u.update(del,ins,function(r,i,s,l){i?(v(!0),m(n),console.log("    Patch ok '"+o+"' -> '"+a+"' "),4===n.state?(n.state=3,b(n)):3===n.state||(2===n.state?(n.state=1,e(n)):n.state=0)):(console.log("    patch FAILED "+l.status+" for '"+o+"' -> '"+a+"': "+s),409===l.status?(m(n,"color: black;  background-color: #fdd;"),n.state=0,UI.utils.beep(.5,512),setTimeout(function(){u.requestDownstreamAction(t,E)},1e3)):(m(n,"color: black;  background-color: #fdd;"),n.state=0,g("    Error "+l.status+" sending data: "+s,!0),UI.utils.beep(1,128)))})};e.addEventListener("input",function(t){switch(m(e,void 0,!0),console.log("Input event state "+e.state+" value '"+e.value+"'"),e.state){case 3:return;case 4:return;case 2:return;case 1:return void(e.state=2);case 0:case void 0:e.state=1,r(e)}})},I=function(t,n,r){var o=s.any(n,l.sioc("content"));o=o?o.value:"";var a=e.createElement("tr");r?i.insertBefore(a,t):t&&t.nextSibling?i.insertBefore(a,t.nextSibling):i.appendChild(a);var u=a.appendChild(e.createElement("input"));return u.subject=n,u.setAttribute("type","text"),m(u,""),u.value=o,y(u,n),u},x=function e(o,a){var i,s,c,f,p,h=UI.store,g=0,v=null;o?("input"!==o.tagName.toLowerCase()&&console.log("return pressed when current document is: "+o.tagName),s=o.subject,g=h.any(s,d("indent")),g=g?Number(g.value):0,a?(c=h.any(void 0,d("next"),s),f=s,p=c,v="newlinesAfter"):(c=s,f=h.any(s,d("next")),p=f,v="newlinesBefore"),i=o.parentNode):(c=n,f=n,i=void 0);var b=UI.widgets.newThing(t),w=b.uri.slice(-4);del=[$rdf.st(c,d("next"),f,t)],ins=[$rdf.st(c,d("next"),b,t),$rdf.st(b,d("next"),f,t),$rdf.st(b,l.dc("author"),r,t),$rdf.st(b,l.sioc("content"),"",t)],g>0&&ins.push($rdf.st(b,d("indent"),g,t)),console.log("    Fresh chunk "+w+" proposed"),u.update(del,ins,function(t,n,r,o){if(n){var s=I(i,b,a);m(s),s.focus(),v&&(console.log("    Fresh chunk "+w+" updated, queue = "+p[v]),p[v]-=1,p[v]>0&&(console.log("    Implementing queued newlines = "+f.newLinesBefore),e(s,a)))}else console.log("    ERROR writing new line "+w+": "+r)})},C=function(){var e=[],t=0,r=function(e){g(e),t++};if(!s.the(n,d("next")))return r("No initial next pointer"),!1;for(var o=s.the(n,d("next"));!o.sameTerm(n);o=s.the(o,d("next"))){var a=o.uri.split("#")[1];if(e[o.uri])return r("Loop!"),!1;e[o.uri]=!0;var i=s.each(o,d("next")).length;1!==i&&r("Should be 1 not "+i+" next pointer for "+a);var i=s.each(o,d("indent")).length;i>1&&r("Should be 0 or 1 not "+i+" indent for "+a);var i=s.each(o,l.sioc("content")).length;1!==i&&r("Should be 1 not "+i+" contents for "+a);var i=s.each(o,l.dc("author")).length;1!==i&&r("Should be 1 not "+i+" author for "+a);var u=s.statementsMatching(void 0,l.sioc("contents"));u.map(function(t){e[t.subject.uri]||r("Loose chunk! "+t.subject.uri)})}return!t},k=function(){var e=s.the(n,d("next"));if(1!==s.each(n,d("next")).length){var t="Pad: Inconsistent data - NEXT pointers: "+s.each(n,d("next")).length;return console.log(t),void(o.statusAra&&(o.statusArea.textContent+=t))}for(var r,a=(s.the(void 0,d("previous"),n),e),u=[],a=s.the(n,d("next"));!a.sameTerm(n);a=s.the(a,d("next")))for(var c=0;c<i.children.length;c++){var f=i.children[c];f.firstChild.subject.sameTerm(a)&&(u[a.uri]=f.firstChild)}for(var c=i.children.length-1;c>=0;c--)r=i.children[c],u[r.firstChild.subject.uri]||i.removeChild(r);r=i.firstChild;for(var a=s.the(n,d("next"));!a.sameTerm(n);a=s.the(a,d("next"))){var p=s.any(a,l.sioc("content")).value;if(r&&u[a.uri]){var h=r.firstChild;p!==h.value&&(h.value=p),m(h),h.state=0,delete h.lastSent,r=r.nextSibling}else I(r,a,!0)}},U=function e(t){if(t.refresh)return void t.refresh();for(var n=0;n<t.children.length;n++)e(t.children[n])},q=!1,A=function(){console.log("    reloaded OK"),v(),C()?U(i):console.log("CONSITENCY CHECK FAILED")},E=function(){if(q)return void console.log("   Already reloading - stop");q=!0;var e=1e3,n=function n(){console.log("try reload - timeout = "+e),u.reload(u.store,t,function(r,o,a){q=!1,r?A():0===a.status?(g("Network error refreshing the pad. Retrying in "+e/1e3),q=!0,e*=2,setTimeout(n,e)):(g("Error "+a.status+"refreshing the pad:"+o+". Stopped"),console.log("Error "+a.status+"refreshing the pad:"+o+". Stopped"+t))})};n()};if(i.refresh=k,i.reloadAndSync=E,a)console.log("Existing pad."),C()?(k(),s.holds(n,d("next"),n)&&x()):console.log(i.textContent="Inconsistent data. Abort");else{console.log("No pad exists - making new one.");var S=[$rdf.st(n,l.rdf("type"),d("Notepad"),t),$rdf.st(n,l.dc("author"),r,t),$rdf.st(n,l.dc("created"),new Date,t),$rdf.st(n,d("next"),n,t)];u.update([],S,function(e,t,n){t?(console.log("Initial pad created"),x()):complainIfBad(t,n)})}return i};
},{"./iconBase":250,"./log":251,"./ns":254,"./store":257,"./utils":260,"./widgets":263,"rdflib":142}],256:[function(require,module,exports){
"use strict";var Solid=require("solid-client"),UI={icons:require("./iconBase"),log:require("./log"),ns:require("./ns"),store:require("./store"),utils:require("./utils"),widgets:require("./widgets")};UI.widgets.findOriginOwner=function(e,t){var n=e.uri||e,r=n.indexOf("://");if(r<0)return!1;var i=n.indexOf("/",r+3);if(i<0)return!1;n.slice(0,i+1)},UI.widgets.webOperation=function(e,t,n,r){var i=$rdf.Util.XMLHTTPFactory();i.onreadystatechange=function(){if(4==i.readyState){var e=!i.status||i.status>=200&&i.status<300;r(t,e,i.responseText,i)}},i.open(e,t,!0),n.contentType&&i.setRequestHeader("Content-type",n.contentType),i.send(n.data?n.data:void 0)},UI.widgets.webCopy=function(e,t,n,r){UI.widgets.webOperation("GET",e,{},function(e,i,o,s){i?UI.widgets.webOperation("PUT",t,{data:s.responseText,contentType:n},r):r(e,i,"(on read) "+o,s)})},UI.widgets.complain=function(e,t){var n=e.statusArea||e.div;return console.log("Complaint: "+t),n.appendChild(UI.widgets.errorMessageBlock(e.dom,t))},UI.widgets.logInLoadProfile=function(e){if(e.publicProfile)return Promise.resolve(e);var t=e.div,n=tabulator.preferences.get("me");return e.me=n?$rdf.sym(n):null,new Promise(function(n,r){var i=function(i){if(i){var o=$rdf.sym(i);e.me=o,tabulator.preferences.set("me",o.uri),UI.store.fetcher.nowOrWhenFetched(o.doc(),void 0,function(i,s){if(i)e.publicProfile=o.doc(),n(e);else{var a="Can't load profile file "+o.doc()+": "+s;t.appendChild(UI.widgets.errorMessageBlock(e.dom,a)),r(a)}})}};t=UI.widgets.loginStatusBox(e.dom,i),e.div.appendChild(t),e.me&&i(e.me.uri)})},UI.widgets.loadPreferences=function(e){if(e.preferencesFile)return Promise.resolve(e);var t=UI.store,n=t.any(e.me,UI.ns.space("preferencesFile")),r=e.statusArea||e.div||null;return new Promise(function(i,o){var s;n||(s="Can't find a preferences file for user: "+e.me,UI.widgets.errorMessageBlock(e.dom,s),o(s)),e.preferencesFile=n;var a;r&&(a=UI.widgets.errorMessageBlock(e.dom,"(loading preferences "+n+")","straw"),r.appendChild(a)),t.fetcher.load(n).then(function(t){a&&a.parentNode.removeChild(a),i(e)}).catch(function(e){o("Error loading preferences file. "+e)})})},UI.widgets.loadTypeIndexes=function(e){return new Promise(function(t,n){UI.store,UI.ns,e.me;return UI.widgets.logInLoadProfile(e).then(UI.widgets.loadPreferences).then(function(e){var r=UI.ns,i=UI.store,o=e.me;e.index=e.index||{},e.index.private=i.each(o,r.solid("privateTypeIndex"),void 0,e.preferencesFile),e.index.public=i.each(o,r.solid("publicTypeIndex"),void 0,e.publicProfile);var s=e.index.private.concat(e.index.public);0===s.length?t(e):UI.store.fetcher.load(s).then(function(n){t(e)}).catch(function(e){n(e)})}).catch(function(t){UI.widgets.complain(e,t),n("Error loading type indexes: "+t)})})},UI.widgets.ensureTypeIndexes=function(e){return new Promise(function(t,n){UI.store,UI.ns,e.me;return UI.widgets.loadTypeIndexes(e).then(function(e){var n,r=UI.ns,i=UI.store,o=e.me,s=function(e,t){return new Promise(function(s,a){var d={private:e.preferencesFile,public:e.publicProfile}[t];if(0==e.index[t].length){n=$rdf.sym(e.preferencesFile.dir().uri+t+"TypeIndex.ttl"),console.log("Linking to new fresh type index "+n);var l=[$rdf.st(o,r.solid(t+"TypeIndex"),n,d)];UI.store.updater.update([],l,function(r,o,d){o?(e.index[t].push(n),console.log("Creating new fresh type index "+n),confirm("Creating new list of things  "+n)||a("Cancelled by user: writing of "+n),i.fetcher.webOperation("PUT",n,{data:"# "+new Date+" Blank initial Type index\n"}).then(function(t){s(e)}).catch(function(e){a("Creating new index file "+e)})):a("Error saving type index link saving back "+r+": "+d)})}else s(e)})},a=[s(e,"private"),s(e,"public")];Promise.all(a).then(function(n){t(e)})})})},UI.widgets.findAppInstances=function(e,t){return new Promise(function(n,r){var i=UI.store,o=UI.ns,s=(e.me,UI.store.fetcher);UI.widgets.loadTypeIndexes(e).then(function(r){var a=(e.index.private.concat(e.index.public),i.each(t,o.solid("instance"))),d=i.each(t,o.solid("instanceContainer"));d.length&&s.load(d).then(function(e){for(var t=0;t<d.length;t++){var n=d[t];a=a.concat(i.each(n,o.ldp("contains")))}}),e.instances=a,e.containers=d,n(e)}).catch(function(e){r("Error looking for instances of "+t+": "+e)})})},UI.widgets.registrationControl=function(e,t,n){return new Promise(function(r,i){var o=UI.store,s=UI.ns,a=(e.me,UI.store.fetcher,e.dom),d=a.createElement("div");return e.div.appendChild(d),UI.widgets.ensureTypeIndexes(e).then(function(e){d.innerHTML="<table><tbody><tr></tr><tr></tr></tbody></table>",d.setAttribute("style","font-size: 120%; text-align: right; padding: 1em; border: solid gray 0.05em;");var i=d.children[0].children[0],a=o.bnode();if(e.index.public&&e.index.public.length>0){var l=e.index.public[0],c=$rdf.st(n,s.solid("instance"),t,l);i.children[0].appendChild(UI.widgets.buildCheckboxForm(e.dom,UI.store,"Public link to this "+e.noun,null,c,a,l))}if(e.index.private&&e.index.private.length>0){var l=e.index.private[0],c=$rdf.st(n,s.solid("instance"),t,l);i.children[1].appendChild(UI.widgets.buildCheckboxForm(e.dom,UI.store,"Personal note of this "+e.noun,null,c,a,l))}r(e)}).catch(function(e){i(e)})})},UI.widgets.registrationList=function(e,t){return new Promise(function(n,r){var i=UI.store,o=UI.ns,s=(e.me,UI.store.fetcher,e.dom),a=s.createElement("div");return e.div.appendChild(a),UI.widgets.ensureTypeIndexes(e).then(function(r){a.innerHTML="<table><tbody></tbody></table>",a.setAttribute("style","font-size: 120%; text-align: right; padding: 1em; border: solid #eee 0.5em;");var d=a.firstChild,l=[],c=[],u=["private","public"];u.forEach(function(n){t[n]&&(l=l.concat(e.index[n][0]),c=c.concat(i.statementsMatching(void 0,o.solid("instance"),void 0,e.index[n][0])))});for(var p=0;p<c.length;p++){var f,g=c[p],h=(g.subject,g.object),m=function(e){i.updater.update([g],[],function(e,t,n){t?console.log("Removed from index: "+g.subject):console.log("Error: Cannot delete "+g+": "+n)})},v={deleteFunction:m},f=UI.widgets.personTR(s,o.solid("instance"),h,v);d.appendChild(f)}n(e)}).catch(function(e){r(e)})})},UI.widgets.setACLUserPublic=function(e,t,n,r){var i=function(e,n,r){r=r||{};var i=r.public||[],o=$rdf.graph(),s=$rdf.Namespace("http://www.w3.org/ns/auth/acl#"),a=o.sym(n+"#a1"),d=o.sym(n),l=o.sym(e);if(o.add(a,UI.ns.rdf("type"),s("Authorization"),d),o.add(a,s("accessTo"),l,d),r.defaultForNew&&o.add(a,s("defaultForNew"),l,d),o.add(a,s("agent"),t,d),o.add(a,s("mode"),s("Read"),d),o.add(a,s("mode"),s("Write"),d),o.add(a,s("mode"),s("Control"),d),i.length){a=o.sym(n+"#a2"),o.add(a,UI.ns.rdf("type"),s("Authorization"),d),o.add(a,s("accessTo"),l,d),o.add(a,s("agentClass"),UI.ns.foaf("Agent"),d);for(var c=0;c<i.length;c++)o.add(a,s("mode"),s(i[c]),d)}return $rdf.serialize(d,o,n,"text/turtle")},o=UI.store,s=o.any(o.sym(e),o.sym("http://www.iana.org/assignments/link-relations/acl"));if(s){var a=i(e,s.uri,n);UI.widgets.webOperation("PUT",s.uri,{data:a,contentType:"text/turtle"},r)}else o.fetcher.nowOrWhenFetched(e,void 0,function(t,s){if(!t)return r(t,"Gettting headers for ACL: "+s);var a=o.any(o.sym(e),o.sym("http://www.iana.org/assignments/link-relations/acl"));if(a){var d=i(e,a.uri,n);UI.widgets.webOperation("PUT",a.uri,{data:d,contentType:"text/turtle"},r)}else r(!1,"No Link rel=ACL header for "+e)})},UI.widgets.offlineTestID=function(){if("undefined"!=typeof $SolidTestEnvironment&&$SolidTestEnvironment.username)return console.log("Assuming the user is "+$SolidTestEnvironment.username),$rdf.sym($SolidTestEnvironment.username);if("webapp"==tabulator.mode&&"undefined"!=typeof document&&document.location&&"http://localhost"===(""+document.location).slice(0,16)){var e=document.getElementById("appTarget");if(!e)return null;var t=e.getAttribute("testID");return t?(console.log("Assuming user is "+t),$rdf.sym(t)):null}return null},UI.widgets.signInOrSignUpBox=function(e,t){var n=e.createElement("div"),r=e.createElement("p");n.appendChild(r),n.className="mildNotice",r.innerHTML="You need to log in with a Web ID",console.log("UI.widgets.signInOrSignUpBox");var i=e.createElement("input");n.appendChild(i),i.setAttribute("type","button"),i.setAttribute("value","Log in"),i.setAttribute("style","padding: 1em; border-radius:0.5em; margin: 2em;"),i.addEventListener("click",function(e){var n=UI.widgets.offlineTestID();return n?t(n.uri):void Solid.auth.login().then(function(e){console.log("signInOrSignUpBox logged in up "+e),t(e)})},!1);var o=e.createElement("input");return n.appendChild(o),o.setAttribute("type","button"),o.setAttribute("value","Sign Up"),o.setAttribute("style","padding: 1em; border-radius:0.5em; margin: 2em;"),o.addEventListener("click",function(e){Solid.auth.signup().then(function(e){console.log("signInOrSignUpBox signed up "+e),t(e)})},!1),n},UI.widgets.checkUserSetMe=function(e){return UI.widgets.checkUser(e,function(e){e=e||"";var t=e.uri||e,n=tabulator.preferences.get("me");if(t==n)return null;var r;t?(tabulator.preferences.set("me",t),r="(Logged in as "+t+" by authentication.)"):r="(NOT logged in by authentication.)",console.log(r)})},UI.widgets.userCheckSite="https://databox.me/",UI.widgets.checkUser=function(e,t){var n=UI.store;if("undefined"!=typeof $SolidTestEnvironment&&$SolidTestEnvironment.username)return tabulator.preferences.set("me",$SolidTestEnvironment.username),t($SolidTestEnvironment.username);var r=tabulator.preferences.get("me");if(r)return t(r);var i=UI.store.any(e,UI.ns.link("userMirror"));i||(i=e),n.fetcher.nowOrWhenFetched(i.uri,void 0,function(e,r){if(e){var o=[],s=n.each(void 0,UI.ns.link("requestedURI"),$rdf.uri.docpart(i.uri));if(s.map(function(e){var t=n.any(e,UI.ns.link("response"));if(void 0!==t){var r=n.each(t,UI.ns.httph("user"));o=o.concat(r)}}),0===o.length)i.uri!==UI.widgets.userCheckSite?(console.log("CheckUser: non-solid server"+i+": trying "+UI.widgets.userCheckSite),UI.widgets.checkUser(n.sym(UI.widgets.userCheckSite),t),console.log("Fail to get username even from "+UI.widgets.userCheckSite)):t(null);else{var a=o[0].value.trim();"dns:"!==a.slice(0,4)?(tabulator.preferences.set("me",a),t(a)):(tabulator.preferences.set("me",""),t(null))}}else{var d="checkUser: Unable to load "+i.uri+": "+r;console.log(d),t(null)}})},UI.widgets.checkUserForTarget=function(e,t){return new Promise(function(n,r){var i=UI.store;i.fetcher.load(e.target).then(function(r){i.each(void 0,UI.ns.link("requestedURI"),e.target.uri).map(function(r){var o=i.any(r,UI.ns.link("response"));if(o){var s=i.each(o,UI.ns.httph("user"));0===s.length?(console.log("CheckUser: non-solid server: trying "+UI.widgets.userCheckSite),UI.widgets.checkUser(i.sym(UI.widgets.userCheckSite),t)):s.map(function(t){var r=t.value.trim();"dns:"!==r.slice(0,4)&&(e.me=$rdf.sym(r),tabulator.preferences.set("me",r),n(e))})}n(e)})}).catch(function(e){r(e)})})},UI.widgets.loginStatusBox=function(e,t){var n=tabulator.preferences.get("me"),r=n&&UI.store.sym(n),i=e.createElement("div"),o=function(e){var n=e.uri||e;tabulator.preferences.set("me",n),r=$rdf.sym(n);i.refresh(),t&&t(r.uri)},s=function(){tabulator.preferences.set("me","");var e="Your Web ID was "+r+". It has been forgotten.";n="",r=null;try{UI.log.alert(e)}catch(t){try{alert(e)}catch(e){}}i.refresh(),t&&t(null)},a=function(t){var n="Web ID logout";if(t){var r=UI.store.any(t,UI.ns.foaf("nick"))||UI.store.any(t,UI.ns.foaf("name"));r&&(n="Logout "+r.value)}var i=e.createElement("input");return i.className="WebIDCancelButton",i.setAttribute("type","button"),i.setAttribute("value",n),i.addEventListener("click",s,!1),i};return i.refresh=function(){var t=tabulator.preferences.get("me")||"",n=t?UI.store.sym(t):null;i.me!==t&&(UI.widgets.clearElement(i),n?i.appendChild(a(n)):i.appendChild(UI.widgets.signInOrSignUpBox(e,o))),i.me=t},i.me="99999",i.refresh(),i},UI.widgets.selectWorkspace=function(e,t,n){var r=t.noun,i=t.appPathSegment,o=tabulator.preferences.get("me"),s=o&&UI.store.sym(o),a=UI.store,d=e.createElement("div"),l={me:s,dom:e,div:d},c=function(t){d.appendChild(UI.widgets.errorMessageBlock(e,t))},u=function(e){var t=a.any(e,UI.ns.space("uriPrefix"));t=t?t.value:e.uri.split("#")[0],"/"!==t.slice(-1)&&(console.log(i+": No / at end of uriPrefix "+t),t+="/");var r=new Date;t+=i+"/id"+r.getTime()+"/",n(e,t)},p=function(t){var i=t.me,o=t.preferencesFile,s=a.statementsMatching(i,UI.ns.space("workspace"),void 0,o).map(function(e){return e.object}),l=a.each(i,UI.ns.space("storage"));if(l.map(function(e){s=s.concat(a.each(e,UI.ns.ldp("contains")))}),1==s.length){c("Workspace used: "+s[0].uri);var p=u(s[0]);n(b,p)}else if(0==s.length)c("You don't seem to have any workspaces. You have "+l.length+" storages."),c("@@ code me: create new workspace.");else{var f=e.createElement("table");f.setAttribute("style","border-collapse:separate; border-spacing: 0.5em;"),d.appendChild(f);var g=(d.appendChild(e.createElement("hr")),d.appendChild(e.createElement("p")));g.textContent="Where would you like to store the data for the "+r+"?  Give the URL of the directory where you would like the data stored.";var h=d.appendChild(e.createElement("input"));h.setAttribute("type","text"),h.size=80,h.label="base URL",h.autocomplete="on",t.baseField=h,d.appendChild(e.createElement("br"));var m=d.appendChild(e.createElement("button"));m.textContent="Start new "+r+" at this URI",m.addEventListener("click",function(e){var t=h.value;"/"!==t.slice(-1)&&(t+="/"),n(null,t)});s=s.filter(function(e){return!a.holds(e,UI.ns.rdf("type"),UI.ns.space("MasterWorkspace"))});for(var v,I,U,w,b,y,C,x="height: 3em; margin: 1em; padding: 1em white; border-radius: 0.3em;",k=x+"border: 0px;",E=0;E<s.length;E++){if(b=s[E],w=e.createElement("tr"),0==E&&(v=e.createElement("td"),v.setAttribute("rowspan",""+s.length+1),w.appendChild(v)),I=e.createElement("td"),y=a.any(b,UI.ns.ui("style")))y=y.value;else{var T=function(e){return e.split("").reduce(function(e,t){return e=(e<<5)-e+t.charCodeAt(0),e&e},0)},A="#"+(16777215&T(b.uri)|12632256).toString(16);y="color: black ; background-color: "+A+";"}I.setAttribute("style",k+y),w.target=b.uri;var P=a.any(b,UI.ns.rdfs("label"));P||(P=b.uri.split("/").slice(-1)[0]||b.uri.split("/").slice(-2)[0]),I.textContent=P||"???",w.appendChild(I),0==E&&(U=e.createElement("td"),U.setAttribute("rowspan",""+s.length+1),U.setAttribute("style","width:50%;"),w.appendChild(U)),f.appendChild(w);var S=function(e,t,n,r){e.addEventListener("click",function(e){U.textContent=t,U.setAttribute("style",n),U.appendChild(L(r))},!0)},L=function(t){var r=e.createElement("button");r.textContent="Continue";var i=u(t);return r.addEventListener("click",function(e){r.disabled=!0,n(t,i),r.textContent="---->"},!0),r},C=a.any(b,UI.ns.rdfs("comment"));C=C?C.value:"Use this workspace",S(I,C?C.value:"",k+y,b)}v.textContent="Chose a workspace for this:",v.setAttribute("style","vertical-align:middle;");var $=e.createElement("tr");I=e.createElement("td"),I.setAttribute("style",x),I.textContent="+ Make a new workspace",S(I,"Set up a new workspace",""),$.appendChild(I),f.appendChild($)}};return UI.widgets.logInLoadProfile(l).then(UI.widgets.loadPreferences).then(p),d},UI.widgets.newAppInstance=function(e,t,n){var r=function(e,t){n(e,t)},i=e.createElement("div"),o=e.createElement("button");return o.setAttribute("type","button"),i.appendChild(o),o.innerHTML="Make new "+t.noun,o.addEventListener("click",function(n){i.appendChild(UI.widgets.selectWorkspace(e,t,r))},!1),i.appendChild(o),i};
},{"./iconBase":250,"./log":251,"./ns":254,"./store":257,"./utils":260,"./widgets":263,"solid-client":192}],257:[function(require,module,exports){
"use strict";var rdf=require("rdflib"),store=module.exports=rdf.graph(),fetcher=rdf.fetcher(store),updater=new rdf.UpdateManager(store);console.log("Unique quadstore initialized.");
},{"rdflib":142}],258:[function(require,module,exports){
"use strict";var UI={icons:require("./iconBase"),log:require("./log"),ns:require("./ns"),store:require("./store"),utils:require("./utils"),widgets:require("./widgets")};module.exports=function(e,t){function n(){var t=e.createElement("table");t.setAttribute("class","toolbar");var n=e.createElement("tr");return Y=e.createElement("td"),n.appendChild(Y),Z=e.createElement("td"),n.appendChild(Z),t.appendChild(n),t}function r(e,t){for(var n=t.getColumns(),r=0;r<n.length;++r){var i=ae.variable("_col"+r);e.vars.push(i),n[r].setVariable(i)}}function i(e,t,n){var r=n.type;r||(r=ae.variable("_any")),e.pat.add(t,UI.ns.rdf("type"),r)}function a(e,t,n){for(var r=n.getColumns(),i=0;i<r.length;++i){var a=r[i],l=ae.formula();l.add(t,a.predicate,a.getVariable()),e.pat.optional.push(l)}}function l(e){var t=new tabulator.rdf.Query,n=ae.variable(de.slice(1));return r(t,e),i(t,n,e),a(t,n,e),t}function u(e){s(Z),Z.appendChild(m(e));var t=l(e);o(t,e)}function o(e,t){pe&&(pe.running=!1);var n=z(e,t);s(me),me.appendChild(n),pe=e}function s(e){for(;e.childNodes.length>0;)e.removeChild(e.childNodes[0])}function c(e){this.type=e,this.columns=null,this.allColumns=null,this.useCount=0,this.getAllColumns=function(){return this.allColumns},this.getColumns=function(){if(!this.columns){var e=this.getAllColumns();this.columns=e.slice(0,7)}return this.columns},this.getUnusedColumns=function(){for(var e=this.getAllColumns(),t=this.getColumns(),n=[],r=0;r<e.length;++r)t.indexOf(e[r])==-1&&n.push(e[r]);return n},this.addColumn=function(e){this.columns.push(e)},this.removeColumn=function(e){this.columns=this.columns.filter(function(t){return t!==e})},this.getLabel=function(){return UI.utils.label(this.type)},this.addUse=function(){this.useCount+=1}}function d(){this.useCount=0,this.checkedAnyValues=!1,this.possiblyLiteral=!0,this.possiblyNumber=!0,this.constraints=[],this.checkValue=function(e){var t=e.termType;if(this.possiblyLiteral&&"Literal"!==t&&"NamedNode"!==t)this.possiblyNumber=!1,this.possiblyLiteral=!1;else if(this.possiblyNumber)if("Literal"!=t)this.possiblyNumber=!1;else{var n=e.value;n.match(/^\-?\d+(\.\d*)?$/)||(this.possiblyNumber=!1)}this.checkedAnyValues=!0},this.getVariable=function(){return this.variable},this.setVariable=function(e){this.variable=e},this.getKey=function(){return this.variable.toString()},this.addUse=function(){this.useCount+=1},this.getLabel=function(){return this.predicate?this.predicate.sameTerm(ie.rdf("type"))&&this.superClass?UI.utils.label(this.superClass):UI.utils.label(this.predicate):this.variable?this.variable.toString():"unlabeled column?"},this.setPredicate=function(e,t,n){t?(this.inverse=e,this.constraints=this.constraints.concat(ae.each(e,UI.ns.rdfs("domain"))),e.sameTerm(ie.rdfs("subClassOf"))&&"NamedNode"===n.termType&&(this.superClass=n,this.alternatives=ae.each(void 0,ie.rdfs("subClassOf"),n))):(this.predicate=e,this.constraints=this.constraints.concat(ae.each(e,UI.ns.rdfs("range"))))},this.getConstraints=function(){return this.constraints},this.filterFunction=function(){return!0},this.sortKey=function(){return this.getLabel().toLowerCase()},this.isImageColumn=function(){for(var e=0;e<this.constraints.length;e++)if(this.constraints[e].uri in ce)return!0;return!1}}function h(e,t){var n=[];for(var r in e){var i=e[r];t&&!t(r,i)||n.push(i)}return n}function p(t,n){var r=e.createElement("option");return r.setAttribute("value",n),r.appendChild(e.createTextNode(t)),r}function v(t,n){var r=e.createElement("div");r.appendChild(e.createTextNode("Select type: "));var i=e.createElement("select");i.appendChild(p("All types","null"));for(var a in n)i.appendChild(p(n[a].getLabel(),a));return i.addEventListener("click",function(){var e;e="null"===i.value?t:n[i.value],f(e)},!1),r.appendChild(i),r}function f(e){u(e)}function m(t){var n=e.createElement("div"),r=t.getUnusedColumns();if(r.sort(function(e,t){var n=e.sortKey(),r=t.sortKey();return(n>r)-(n<r)}),r.length>0){n.appendChild(e.createTextNode("Add column: "));var i=e.createElement("select");i.appendChild(p("","-1"));for(var a=0;a<r.length;++a){var l=r[a];i.appendChild(p(l.getLabel(),""+a))}n.appendChild(i),i.addEventListener("click",function(){var e=new Number(i.value);e>=0&&(t.addColumn(r[e]),u(t))},!1)}return n}function g(e,t){var n;return t.uri in e?n=e[t.uri]:(n=new d,n.setPredicate(t),e[t.uri]=n),n}function w(e,t){var n;return t.uri in e?n=e[t.uri]:(n=new c(t),e[t.uri]=n),n}function C(){for(var e={},t=ae.statementsMatching(void 0,UI.ns.rdf("type"),te,ee),n={},r=0;r<t.length;++r){var i=t[r].object;if("NamedNode"===i.termType){var a=w(e,i);i.uri in n||(n[i.uri]=[]),n[i.uri].push(t[r].subject),a.addUse()}}return[n,e]}function b(e,t){for(var n=ae.statementsMatching(e,void 0,void 0,ee),r={},i=0;i<n.length;++i){var a=n[i].predicate;if(!(a.uri in ue)){var l=g(t,a);l.checkValue(n[i].object),r[a.uri]=l}}return r}function y(e,t){for(var n={},r=0;r<t.length;++r){var i=b(t[r],n);for(var a in i){var l=i[a];l.addUse()}}var u=h(n);L(u),e.allColumns=u}function N(){var e,t,n=C();e=n[0],t=n[1];for(var r in e){var i=e[r],a=t[r];y(a,i)}var l=new c(null);return[l,h(t)]}function L(e){function t(e,t){return(e.useCount<t.useCount)-(e.useCount>t.useCount)}e.sort(t)}function E(t,n){var r=e.createElement("a");return r.appendChild(e.createTextNode("[x]")),r.addEventListener("click",function(){t.removeColumn(n),u(t)},!1),r}function T(t,n){var r=e.createElement("tr"),i=e.createElement("th");r.appendChild(i);for(var a=0;a<t.length;++a){var l=e.createElement("th"),u=t[a];l.appendChild(e.createTextNode(u.getLabel())),n&&l.appendChild(E(n,u)),r.appendChild(l)}return r}function x(e,t,n,r){var i=t.getKey();if(e.sort(function(e,t){var a=null,l=null;i in e.values&&(a=e.values[i][0]),i in t.values&&(l=t.values[i][0]);var u=n(a,l);return r?-u:u}),e.length){for(var a=e[0]._htmlRow.parentNode,l=0;l<e.length;++l)a.removeChild(e[l]._htmlRow);for(var l=0;l<e.length;++l)a.appendChild(e[l]._htmlRow)}}function I(e,t){for(var n=!0,r=0;r<t.length;++r){var i=t[r],a=i.getKey(),l=null;if(a in e.values&&(l=e.values[a][0]),!i.filterFunction(l)){n=!1;break}}var u=e._htmlRow;n?u.style.display="":u.style.display="none"}function U(e,t){for(var n=0;n<e.length;++n){var r=e[n];I(r,t)}}function S(e,t,n){function r(e){return e?"Literal"===e.termType?e.value.toLowerCase():"NamedNode"===e.termType?UI.utils.label(e).toLowerCase():e.value.toLowerCase():""}function i(e,t){var n=r(e),i=r(t);return n<i?-1:n>i?1:0}x(e,t,i,n)}function V(t,n,r){var i=e.createElement("div"),a=e.createElement("input");a.setAttribute("type","text"),a.style.width="70%",i.appendChild(a);var l=e.createElement("span");l.appendChild(e.createTextNode("")),l.addEventListener("click",function(){S(t,r,!1)},!1),i.appendChild(l);var u=e.createElement("span");u.appendChild(e.createTextNode("")),u.addEventListener("click",function(){S(t,r,!0)},!1),i.appendChild(u);var o=null;return r.filterFunction=function(e){if(o){if(e){var t;return t="Literal"===e.termType?e.value:"NamedNode"===e.termType?UI.utils.label(e):"",t.toLowerCase().indexOf(o)>=0}return!1}return!0},a.addEventListener("keyup",function(){o=""!==a.value?a.value.toLowerCase():null,U(t,n)},!1),i}function _(t,n,r,i){for(var a=!0,l=e.createElement("div"),u=e.createElement("select"),o={},s=0;s<i.length;++s){var c=i[s];o[c.uri]=!0}var d=D(r).initialSelection;d&&(o=d),a?u.setAttribute("multiple","true"):u.appendChild(p("(All)","-1"));for(var s=0;s<i.length;++s){var c=i[s],h=p(UI.utils.label(c),s);o[c.uri]&&(h.selected=!0),u.appendChild(h)}return l.appendChild(u),r.filterFunction=function(e){return!o||e&&o[e.uri]},u.addEventListener("click",function(){if(a){o={};for(var e=u.options,r=0;r<e.length;r++){var l=e[r],s=new Number(l.value);e[r].selected&&(o[i[s].uri]=!0)}}else if(s<0)o=null;else{var s=new Number(u.value);o={},o[i[s].uri]=!0}U(t,n)},!0),l}function k(t,n,r){function i(){o=""===l.value?null:new Number(l.value),s=""===u.value?null:new Number(u.value),U(t,n)}var a=e.createElement("div"),l=e.createElement("input");l.setAttribute("type","text"),l.style.width="40px",a.appendChild(l);var u=e.createElement("input");u.setAttribute("type","text"),u.style.width="40px",a.appendChild(u);var o=null,s=null;return r.filterFunction=function(e){return e&&(e=new Number(e)),!(o&&(!e||e<o))&&!(s&&(!e||e>s))},l.addEventListener("keyup",i,!1),u.addEventListener("keyup",i,!1),a}function A(e,t,n){return n.checkedAnyValues&&n.possiblyNumber?k(e,t,n):n.possiblyLiteral?V(e,t,n):null}function M(e,t,n){if(n.superClass&&n.alternatives.length>0)return _(e,t,n,n.alternatives);for(var r,i=n.getConstraints(),a=0;a<i.length;a++){if(r=i[a],n.checkedAnyValues&&n.possiblyNumber||r.uri in oe)return k(e,t,n);if(r.uri===re)return V(e,t,n);var l=ae.each(r,UI.ns.owl("oneOf"));if(l.length>0)return _(e,t,n,l.elements)}return A(e,t,n)}function j(t,n){var r=e.createElement("tr");r.className="selectors",r.appendChild(e.createElement("td"));for(var i=0;i<n.length;++i){var a=e.createElement("td"),l=M(t,n,n[i]);l&&a.appendChild(l),r.appendChild(a)}return r}function X(t,n,r){r=r||{};var i=e.createElement("a"),a=r.linkFunction;return i.setAttribute("href",t),i.appendChild(e.createTextNode(n)),a?i.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var t=UI.utils.getTarget(e),n=t.getAttribute("href");n||console.log("No href found \n"),a(n)},!0):i.addEventListener("click",UI.widgets.openHrefInOutlineMode,!0),i}function R(e,t){var n=!1;return e.uri&&(n=e.uri.match(/^mailto:(.*)/)),n?X(e.uri,n[1],t):X(e.uri,UI.utils.label(e),t)}function q(t){var n=e.createElement("img");return n.setAttribute("src",t.uri),n.style.height="40px",n}function D(e){return t&&t.hints&&e.variable&&t.hints[e.variable.toNT()]?t.hints[e.variable.toNT()]:{}}function F(t,n){var r,i=D(n),a=i.cellFormat;if(!a){if("Literal"===t.termType){if(t.datatype){if(se[t.datatype.uri])return e.createTextNode(UI.widgets.shortDate(t.value));if(oe[t.datatype.uri]){var r=e.createElement("span");return r.textContent=t.value,r.setAttribute("style","text-align: right"),r}}return e.createTextNode(t.value)}if("NamedNode"===t.termType&&n.isImageColumn())return q(t);if("NamedNode"===t.termType||"BlankNode"===t.termType)return R(t,i);if("collection"===t.termType){var r=e.createElement("span");return r.appendChild(e.createTextNode("[")),t.elements.map(function(t){r.appendChild(F(t,n)),r.appendChild(e.createTextNode(", "))}),r.removeChild(r.lastChild),r.appendChild(e.createTextNode("]")),r}return e.createTextNode("unknown termtype '"+t.termType+"'!")}switch(a){case"shortDate":return e.createTextNode(UI.widgets.shortDate(t.value))}}function K(t,n,r,i){var a=e.createElement("td");n._subject&&"uri"in n._subject&&a.appendChild(X(n._subject.uri,"")),t.appendChild(a);for(var l=0;l<r.length;++l){var u,o=r[l],s=e.createElement("td"),c=o.getKey();if(c in n.values){var d=n.values[c],h=!1;n.originalValues&&n.originalValues[c]&&d.length!==n.originalValues[c].length&&(h=!0);for(var p=0;p<d.length;++p){var v=d[p];n.originalValues&&n.originalValues[c]&&n.originalValues[c].length>p&&(u=n.originalValues[c][p],v.toString()!==u.toString()&&(h=!0)),s.appendChild(F(v,o)),p!==d.length-1&&s.appendChild(e.createTextNode(",\n")),h&&(s.style.background="#efe")}}t.appendChild(s)}return n._htmlRow=t,t}function O(e,t){var n=null;if("Literal"===e.termType)n="value";else{if("NamedNode"!==e.termType)return t.indexOf(e)>=0;n="uri"}var r;for(r=0;r<t.length;++r)if(t[r].termType===e.termType&&t[r][n]===e[n])return!0;return!1}function P(e,t,n){var r,i=!1;for(r in n){var a=n[r];r in e.values||(e.values[r]=[]),O(a,e.values[r])||(e.values[r].push(a),i=!0)}i&&(s(e._htmlRow),K(e._htmlRow,e,t)),I(e,t)}function B(e){if("uri"in e)return e.uri;if("_subject_id"in e)return e._subject_id;var t=""+he;return e._subject_id=t,++he,t}function Q(n,r,i,a){n.running=!0;var l=Date.now(),u=e.createElement("tr");a.appendChild(u),u.textContent="Loading ...";for(var o=0;o<r.length;o++)r[o].original=!0,r[o].originalValues||(r[o].originalValues=r[o].values),r[o].values={};var s=function(t){if(n.running){u.textContent+=".";var l,o=null,s=null;if(de in t&&(s=t[de],l=B(s),l in le&&(o=le[l])),!o){var c=e.createElement("tr");a.appendChild(c),o={_htmlRow:c,_subject:s,values:{}},r.push(o),s&&(le[l]=o)}delete o.original,P(o,i,t)}},c=function(){u&&u.parentNode&&u.parentNode.removeChild&&(u.parentNode.removeChild(u),u=null);var e=Date.now()-l;console.log("Query done: "+r.length+" rows, "+e+"ms");for(var n=r.length-1;n>=0;n--)if(r[n].original){console.log("   deleting row "+r[n]._subject);var i=r[n]._htmlRow;i.parentNode.removeChild(i),delete le[B(r[n]._subject)],r.splice(n,1)}t.onDone&&t.onDone()};ae.query(n,s,void 0,c)}function H(e,t){UI.log.debug(">> processing formula");for(var n=0;n<t.statements.length;++n){var r=t.statements[n];if("NamedNode"===r.predicate.termType&&"Variable"===r.object.termType){var i=r.object.toString();if(i in e){var a=e[i];a.setPredicate(r.predicate,!1,r.subject)}}if("NamedNode"===r.predicate.termType&&"Variable"===r.subject.termType){var i=r.subject.toString();if(i in e){var a=e[i];a.setPredicate(r.predicate,!0,r.object)}}}for(var n=0;n<t.optional.length;++n)UI.log.debug("recurse to optional subformula "+n),H(e,t.optional[n]);UI.log.debug("<< finished processing formula")}function $(e){for(var t=[],n={},r=0;r<e.vars.length;++r){var i=new d,a=e.vars[r];UI.log.debug("column "+r+" : "+a),i.setVariable(a),n[a]=i,t.push(i)}return H(n,e.pat),t}function z(t,n){var r;r=ne?$(t):n.getColumns();var i=[],a=e.createElement("table");return a.appendChild(T(r,n)),a.appendChild(j(i,r)),a.logicalRows=i,a.columns=r,a.query=t,Q(t,i,r,a),a}function G(e){var t=-1,n=null;for(var r in e){var i=e[r];i.useCount>t&&(n=i,t=i.useCount)}return n}var J,W,Y,Z,ee=t.sourceDocument,te=t.tableClass,ne=t.query,re="http://www.w3.org/2000/01/rdf-schema#Literal",ie=UI.ns,ae=UI.store,le={},ue={"http://www.w3.org/2002/07/owl#sameAs":!0,"http://www.w3.org/1999/02/22-rdf-syntax-ns#type":!0},oe={"http://www.w3.org/2001/XMLSchema#decimal":!0,"http://www.w3.org/2001/XMLSchema#float":!0,"http://www.w3.org/2001/XMLSchema#double":!0,"http://www.w3.org/2001/XMLSchema#integer":!0,"http://www.w3.org/2001/XMLSchema#nonNegativeInteger":!0,"http://www.w3.org/2001/XMLSchema#positiveInteger":!0,"http://www.w3.org/2001/XMLSchema#nonPositiveInteger":!0,"http://www.w3.org/2001/XMLSchema#negativeInteger":!0,"http://www.w3.org/2001/XMLSchema#long":!0,"http://www.w3.org/2001/XMLSchema#int":!0,"http://www.w3.org/2001/XMLSchema#short":!0,"http://www.w3.org/2001/XMLSchema#byte":!0,"http://www.w3.org/2001/XMLSchema#unsignedLong":!0,"http://www.w3.org/2001/XMLSchema#unsignedInt":!0,"http://www.w3.org/2001/XMLSchema#unsignedShort":!0,"http://www.w3.org/2001/XMLSchema#unsignedByte":!0},se={"http://www.w3.org/2001/XMLSchema#dateTime":!0,"http://www.w3.org/2001/XMLSchema#date":!0},ce={"http://xmlns.com/foaf/0.1/Image":!0,"http://purl.org/dc/terms/Image":!0},de=t.keyVariable||"?_row",he=0,pe=null,ve=null,fe=e.createElement("div");fe.className="tableViewPane",fe.appendChild(n());var me=e.createElement("div");if(fe.appendChild(me),fe.refresh=function(){Q(ge.query,ge.logicalRows,ge.columns,ge)},ne){var ge=z(ne);me.appendChild(ge)}else{var we=N();J=we[0],W=we[1],te||Y.appendChild(v(J,W)),ve=G(W),u(ve?ve:J)}return fe};
},{"./iconBase":250,"./log":251,"./ns":254,"./store":257,"./utils":260,"./widgets":263}],259:[function(require,module,exports){
"use strict";var tabs={};module.exports=tabs;var UI={icons:require("./iconBase"),log:require("./log"),ns:require("./ns"),store:require("./store"),utils:require("./utils"),tabs:tabs,widgets:require("./widgets")};UI.tabs.tabWidget=function(e){var t,r,n,i=UI.store,l=e.subject,d=e.dom,a=d.createElement("div"),c=parseInt(e.orientation||"0"),s=2&c,h=1&c,o=a.appendChild(d.createElement("table")),p="resize: both; overflow: scroll; margin:0; border: 0.5em; border-style: solid; border-color: #eed; padding: 1em;  min-width: 30em; min-height: 450px; width:100%;";if(h){var m=o.appendChild(d.createElement("tr")),g=d.createElement("td");g.setAttribute("style","margin: 0;");var b=d.createElement("td");b.setAttribute("style","margin: 0;"),s?(m.appendChild(g),m.appendChild(b)):(m.appendChild(b),m.appendChild(g)),t=b.appendChild(d.createElement("table")),r="tr",n=b}else{t=d.createElement("tr");var u=o.appendChild(d.createElement("tr"));if(s)var u=o.appendChild(d.createElement("tr")),f=o.appendChild(d.createElement("tr"));else var f=o.appendChild(d.createElement("tr")),u=o.appendChild(d.createElement("tr"));t=f;var g=u.appendChild(d.createElement("td"));r="td"}var v=g.appendChild(d.createElement("table"));a.tabContainer=t,a.bodyContainer=v;var C=function(){if(e.ordered){var t=i.the(l,e.predicate);return t.elements}return i.each(l,e.predicate)},E=["2em","2em","0","0"];E=E.concat(E).slice(c,c+4),E="border-radius: "+E.join(" ")+";";var y=["0.3em","0.3em","0","0.3em"];y=y.concat(y).slice(c,c+4),y="margin: "+y.join(" ")+";";var T=E+"padding: 0.7em; max-width: 20em;",A=T+"opacity: 50%; margin: 0.3em; background-color: #ddc;",j=T+y+" background-color: #eed;",w="",q=w+"display: none;",S=function(){for(var e=0;e<t.children.length;e++)t.children[e].firstChild.setAttribute("style",A)},k=function(){for(var e=0;e<v.children.length;e++)v.children[e].setAttribute("style",q)},I=function(t){var n=d.createElement(r);n.subject=t;var i=n.appendChild(d.createElement("div"));return i.setAttribute("style",A),i.addEventListener("click",function(r){r.metaKey||(S(),k()),i.setAttribute("style",j),n.bodyTR.setAttribute("style",w);var l=n.bodyTR.firstChild;l||(l=n.bodyTR.appendChild(d.createElement("div")),l.setAttribute("style",p)),e.renderTabSettings&&r.altKey?l.asSetttings!==!0&&(l.innerHTML="loading settings ..."+t,e.renderTabSettings(l,n.subject),l.asSetttings=!0):l.asSetttings!==!1&&(l.innerHTML="loading item ..."+t,e.showMain(l,n.subject),l.asSetttings=!1)}),e.renderTab?e.renderTab(i,t):i.textContent=UI.utils.label(t),n},M=function(){var e=C();h||g.setAttribute("colspan",e.length);var r,n,i,l,a,c=!1;for(l=0;l<t.children.length;l++)if(r=t.children[l],l>=e.length||!r.subject.sameTerm(e[l])){c=!0;break}if(c||e.length!==t.children.length){for(a=t.children.length-1;a>=0&&(r=t.children[a],i=a-t.children.length+e.length,r.subject.sameTerm(e[i]));a--);for(var s=e.slice(l,a-t.children.length+e.length+1);a>=l;)t.removeChild(t.children[l]),v.removeChild(v.children[l]),a-=1;for(n=0;n<s.length;n++){var o=I(s[n]),p=d.createElement("tr");o.bodyTR=p,d.createElement("tr"),l===t.children.length?(t.appendChild(o),v.appendChild(p),console.log("   appending new "+s[n])):(console.log("   inserting at "+(l+n)+" new "+s[n]),t.insertBefore(o,t.children[l+n]),v.insertBefore(p,v.children[l+n]))}}},x=function(){var e=C();h||g.setAttribute("colspan",e.length);var r,n,i,l,d,a=[];for(n=0;n<t.children.length;n++)r=t.children[n],r.deleteMe=!0;for(i=0;i<e.length;i++){for(l=!1,n=0;n<t.children.length;n++)t.children[n].subject===e[i]&&(l=!0);l||a.push([i,e[i]])}for(i=0;i<a.length;i++)d=a[i],n=d[0],r=I(d[1]),n>=t.length?t.appendChild(r):t.insertBefore(r,t.children[n+1]);for(n=0;n<t.children.length;n++)r=t.children[n],r.deleteMe&&t.removeChild(r)},B=function(){e.ordered?M():x()};return a.refresh=B,B(),!e.startEmpty&&t.children.length&&t.children[0].firstChild.click(),a};
},{"./iconBase":250,"./log":251,"./ns":254,"./store":257,"./utils":260,"./widgets":263}],260:[function(require,module,exports){
"use strict";var utilsModule=module.exports={},UI={utils:utilsModule,log:require("./log"),ns:require("./ns"),rdf:require("rdflib"),store:require("./store")};UI.utils.hashColor=function(e){e=e.uri||e;var t=function(e){return e.split("").reduce(function(e,t){return e=(e<<5)-e+t.charCodeAt(0),e&e},0)};return"#"+(16777215&t(e)|12632256).toString(16)},UI.utils.gen_uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,r="x"==e?t:3&t|8;return r.toString(16)})},UI.utils.syncTableToArray=function(e,t,r){var n,i;for(l=0;l<e.children.length;l++)i=e.children[l],i.trashMe=!0;for(var a=0;a<t.length;a++){var o=t[a];n=!1;for(var l=0;l<e.children.length;l++){var i=e.children[l];if(i.subject&&i.subject.sameTerm(o)){i.trashMe=!1,n=!0;break}}if(!n){var s=r(o);e.appendChild(s),s.subject=o}}for(l=0;l<e.children.length;l++){var i=e.children[l];i.trashMe&&e.removeChild(i)}},UI.utils.audioContext||("undefined"!=typeof AudioContext?UI.utils.audioContext=AudioContext:"undefined"!=typeof window&&(UI.utils.audioContext=window.AudioContext||window.webkitAudioContext)),UI.utils.audioContext?UI.utils.beep=function(){var e=new UI.utils.audioContext;return function(t,r,n,i){t=+(t||.3),n=n||"sine","function"!=typeof i&&(i=function(){});var a=e.createOscillator();a.type=n,a.frequency.value=r||256,a.connect(e.destination),a.start(0),a.stop(t)}}():UI.utils.beep=function(){},"undefined"==typeof UI.utils.nextVariable&&(UI.utils.nextVariable=0),UI.utils.newVariableName=function(){return"v"+UI.utils.nextVariable++},UI.utils.clearVariableNames=function(){UI.utils.nextVariable=0},UI.utils.stackString=function(e){var t=""+e+"\n";if(!e.stack)return t+"No stack available.\n";for(var r=e.stack.toString().split("\n"),n=[],i=0;i<r.length;i++){var a=r[i];if(a.indexOf("ecmaunit.js")>-1)break;"("==a.charAt(0)&&(a="function"+a);var o=a.split("@");n.push(o)}for(var i=0;i<n.length;i++)t+="  "+n[i][1]+"\n    "+n[i][0];return t},UI.utils.getURIQueryParameters=function(e){var t=[],r=e?e.toString():new String(window.location),n=r.indexOf("?");if(n!=-1){r=r.substr(n+1);for(var i=r.split(/&/g),a=0;a<i.length;a++){var o=i[a].split(/=/);t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}}return t},UI.utils.emptyNode=function(e){var t,r=e.childNodes,n=r.length;for(t=n-1;t>=0;t--)e.removeChild(r[t]);return e},UI.utils.getTarget=function(e){var t;if(!e)var e=window.event;return e.target?t=e.target:e.srcElement&&(t=e.srcElement),3==t.nodeType&&(t=t.parentNode),t},UI.utils.ancestor=function(e,t){var r;for(r=e;r;r=r.parentNode)try{if(r.tagName==t)return r}catch(e){return}},UI.utils.getAbout=function(e,t){var r,n;for(r=t;r&&1==r.nodeType;r=r.parentNode)if(n=r.getAttribute("about"))return e.fromNT(n);UI.log.debug("getAbout: No about found")},UI.utils.getTerm=function(e){var t=e.parentNode,r=t?t.AJAR_statement:void 0,n=r?e.className:"";switch(n){case"pred":case"pred selected":return r.predicate;case"obj":case"obj selected":return t.AJAR_inverse?r.subject:r.object;case"":case"selected":return UI.utils.getAbout(UI.store,e);case"undetermined selected":return e.nextSibling?r.predicate:t.AJAR_inverse?r.subject:r.object}},UI.utils.include=function(e,t){var r=e.createElement("script");return r.setAttribute("type","text/javascript"),r.setAttribute("src",t),r},UI.utils.addLoadEvent=function(e){var t=window.onload;"function"!=typeof window.onload?window.onload=e:window.onload=function(){t(),e()}},UI.utils.findPos=function(e){var t=e.ownerDocument,r=t.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return[n.left-r.left,n.top-r.top]},UI.utils.getEyeFocus=function(e,t,r,n){function i(){n.scrollBy(0,o/10),s++,10==s&&n.clearInterval(l)}n||(n=window);var a=UI.utils.findPos(e)[1],o=a-52-n.scrollY;if(t)return r?void n.scrollBy(0,a+e.clientHeight-(n.scrollY+n.innerHeight)):void n.scrollBy(0,o);var l=n.setInterval(i,50),s=0},UI.utils.AJARImage=function(e,t,r,n){n||(n=document);var i=n.createElement("img");return i.setAttribute("src",e),"undefined"!=typeof r&&i.setAttribute("title",r),i},UI.utils.parse_headers=function(e){for(var t=e.split("\n"),e={},r=0;r<t.length;r++){var n=webdav._strip(t[r]);if(0!=n.length){var i=n.split(":"),a=webdav._strip(i.shift()).toLowerCase(),o=webdav._strip(i.join(":"));void 0!==e[a]?e[a].push(o):e[a]=[o]}}return e},UI.utils.shortName=function(e){var t=e;"#/".indexOf(t[t.length-1])>=0&&(t=t.slice(0,-1));var r=[];for(var n in this.prefixes)r[this.prefixes[n]]=n;var i,a=t.lastIndexOf("#");for(a>=0&&(t=t.slice(a-1));;){var o=t.lastIndexOf("/");o>=0&&(t=t.slice(o+1));for(var l=0;l<t.length&&this.prefixchars.indexOf(t[l]);)l++;if(t=t.slice(0,l),t.length<6&&canUse(t))return i;if(canUse(t.slice(0,3)))return i;if(canUse(t.slice(0,2)))return i;if(canUse(t.slice(0,4)))return i;if(canUse(t.slice(0,1)))return i;if(canUse(t.slice(0,5)))return i;for(var l=0;;l++)if(canUse(t.slice(0,3)+l))return i}},UI.utils.ontologyLabel=function(e){if(void 0===e.uri)return"??";var t,r=e.uri,n=[],i=r.lastIndexOf("#");if(i>=0)r=r.slice(0,i+1);else{if(i=r.lastIndexOf("/"),!(i>=0))return e.uri+"?!";r=r.slice(0,i+1)}for(var a in UI.ns)n[UI.ns[a]]=a;try{return n[r]}catch(e){}for(r=r.slice(0,-1);r;){if(i=r.lastIndexOf("/"),!(i>=0))return e.uri+"!?";if(t=r.slice(i+1),r=r.slice(0,i),"ns"!==t&&"0123456789".indexOf(t[0])<0)return t}},UI.utils.labelWithOntology=function(e,t){var r=UI.store.findTypeURIs(e);return r[UI.ns.rdf("Predicate").uri]||r[UI.ns.rdfs("Class").uri]?UI.utils.label(e,t)+" ("+UI.utils.ontologyLabel(e)+")":UI.utils.label(e,t)},UI.utils.label=function(e,t){function r(e){return t?e.slice(0,1).toUpperCase()+e.slice(1):e}function n(e){var t="";"/"===e.slice(-1)&&(e=e.slice(0,-1));for(var n=0;n<e.length;n++)"_"!=e[n]&&"-"!=e[n]?(t+=e[n],n+1<e.length&&e[n].toUpperCase()!=e[n]&&e[n+1].toLowerCase()!=e[n+1]&&(t+=" ")):t+=" ";return"has "==t.slice(0,4)&&(t=t.slice(4)),r(t)}var i;if("undefined"!=typeof tabulator&&tabulator.lb&&(i=tabulator.lb.label(e)))return r(i.value);var a=UI.store,o=a.any(e,UI.ns.link("message"))||a.any(e,UI.ns.vcard("fn"))||a.any(e,UI.ns.foaf("name"))||a.any(e,UI.ns.dct("title"))||a.any(e,UI.ns.dc("title"))||a.any(e,UI.ns.rss("title"))||a.any(e,UI.ns.contact("fullName"))||a.any(e,a.sym("http://www.w3.org/2001/04/roadmap/org#name"))||a.any(e,UI.ns.cal("summary"))||a.any(e,UI.ns.foaf("nick"))||a.any(e,UI.ns.rdfs("label"));if(o)return r(o.value);if("BlankNode"==e.termType)return"...";if("collection"==e.termType)return"("+e.elements.length+")";var l=e.uri;if("undefined"==typeof l)return e.toString();l=decodeURI(l),"#this"==l.slice(-5)?l=l.slice(0,-5):"#me"==l.slice(-3)&&(l=l.slice(0,-3));var s=l.indexOf("#");if(s>=0)return n(l.slice(s+1));"/foaf.rdf"==l.slice(-9)?l=l.slice(0,-9):"/foaf"==l.slice(-5)&&(l=l.slice(0,-5));var u=l.lastIndexOf("/",l.length-2);return u>=0&&u<e.uri.length?n(l.slice(u+1)):r(decodeURIComponent(e.uri))},UI.utils.escapeForXML=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;")},UI.utils.labelForXML=function(e){return UI.utils.escapeForXML(UI.utils.label(e))},UI.utils.predicateLabelForXML=function(e,t){var r;if(t){var n=UI.store.any(e,UI.ns.owl("inverseOf"));if(n||(n=UI.store.any(void 0,UI.ns.owl("inverseOf"),e)),n)return UI.utils.labelForXML(n)}return r=UI.utils.labelForXML(e),t?"type"==r?"...":"is "+r+" of":r},UI.utils.RDFComparePredicateObject=function(e,t){var r=e.predicate.compareTerm(t.predicate);return 0!=r?r:e.object.compareTerm(t.object)},UI.utils.RDFComparePredicateSubject=function(e,t){var r=e.predicate.compareTerm(t.predicate);return 0!=r?r:e.subject.compareTerm(t.subject)},UI.utils.predParentOf=function(e){for(var t=e;;){if(t.getAttribute("predTR"))return t;if(!t.previousSibling||"TR"!=t.previousSibling.nodeName)return UI.log.error("Could not find predParent"),e;t=t.previousSibling}};var optionalSubqueriesIndex=[];UI.utils.makeQueryRow=function(e,t,r){function n(e,t){return c?new UI.rdf.Statement(e,U.predicate,t):new UI.rdf.Statement(t,U.predicate,e)}function i(e){return this.describe=function(t){return t+" = "+e.toNT()},this.test=function(t){return e.sameTerm(t)},this}var a,o,l,s,u=UI.store,c=(t.childNodes,t.childNodes.length,t.AJAR_inverse),d=null,f=null;for(l=t.parentNode;l;l=l.parentNode)if("undefined"!=typeof l.AJAR_statement){l.setAttribute("bla",l.AJAR_statement),l.AJAR_variable||UI.utils.makeQueryRow(e,l),d=l.AJAR_variable;var p=UI.utils.predParentOf(l);p.getAttribute("optionalSubqueriesIndex")&&(f=p.getAttribute("optionalSubqueriesIndex"),s=optionalSubqueriesIndex[f]);break}if(!s)var s=e.pat;var b=UI.utils.predParentOf(t),I=b.getAttribute("optional");if(I||(f?b.setAttribute("optionalSubqueriesIndex",f):b.removeAttribute("optionalSubqueriesIndex")),I){var v=u.formula();optionalSubqueriesIndex.push(v),b.setAttribute("optionalSubqueriesIndex",optionalSubqueriesIndex.length-1),s.optional.push(v),s=v}var U=t.AJAR_statement,g=t.AJAR_inverse?U.subject:U.object,x=!0;return g.isBlank&&r&&alert("You cannot constrain a query with a blank node. No constraint will be added."),d||(x=!1,d=c?U.object:U.subject),o=t.AJAR_variable?t.AJAR_variable:u.variable(UI.utils.newVariableName()),e.vars.push(o),o.label=x?d.label:UI.utils.label(d),o.label+=" "+UI.utils.predicateLabelForXML(U.predicate,c),a=n(o,d),o.label=o.label.slice(0,1).toUpperCase()+o.label.slice(1),r&&(s.constraints[o]=new i(g)),UI.log.info("Pattern: "+a),a.tr=t,t.AJAR_pattern=a,t.AJAR_variable=o,UI.log.debug("Query pattern: "+a),s.statements.push(a),o};
},{"./log":251,"./ns":254,"./store":257,"rdflib":142}],261:[function(require,module,exports){
"use strict";function makeDropTarget(e,t,a){var r=function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"},n=function(e){console.log("dragenter event dropEffect: "+e.dataTransfer.dropEffect),this.style.backgroundColor="#ccc",e.dataTransfer.dropEffect="link",console.log("dragenter event dropEffect 2: "+e.dataTransfer.dropEffect)},o=function(e){console.log("dragleave event dropEffect: "+e.dataTransfer.dropEffect),this.style.backgroundColor="white"},s=function(e){e.preventDefault&&e.preventDefault(),console.log("Drop event. dropEffect: "+e.dataTransfer.dropEffect),console.log("Drop event. types: "+(e.dataTransfer.types?e.dataTransfer.types.join(", "):"NOPE"));var r,n=null;if(e.dataTransfer.types){for(var o=0;o<e.dataTransfer.types.length;o++){var s=e.dataTransfer.types[o];if("text/uri-list"===s)n=e.dataTransfer.getData(s).split("\n"),console.log("Dropped text/uri-list: "+n);else if("text/plain"===s)r=e.dataTransfer.getData(s);else if("Files"===s&&a){for(var d,f=e.dataTransfer.files,l=0;d=f[l];l++)console.log("Filename: "+d.name+", type: "+(d.type||"n/a")+" size: "+d.size+" bytes, last modified: "+(d.lastModifiedDate?d.lastModifiedDate.toLocaleDateString():"n/a"));a(f)}}null===n&&r&&"http"===r.slice(0,4)&&(n=r,console.log("Waring: Poor man's drop: using text for URI"))}else n=[e.dataTransfer.getData("Text")],console.log("WARNING non-standard drop event: "+n[0]);return console.log("Dropped URI list (2): "+n),n&&t(n),!1},d=function(e){e||console.log("@@@ addTargetListeners: ele "+e),e.addEventListener("dragover",r),e.addEventListener("dragenter",n),e.addEventListener("dragleave",o),e.addEventListener("drop",s)};d(e,t)}function makeDraggable(e,t){e.setAttribute("draggable","true"),e.addEventListener("dragstart",function(a){e.style.fontWeight="bold",a.dataTransfer.setData("text/uri-list",t.uri),a.dataTransfer.setData("text/plain",t.uri),a.dataTransfer.setData("text/html",e.outerHTML),console.log("Dragstart: "+e+" -> "+t+"de: "+a.dataTransfer.dropEffect)},!1),e.addEventListener("drag",function(e){e.preventDefault(),e.stopPropagation()},!1),e.addEventListener("dragend",function(a){e.style.fontWeight="normal",console.log("Dragend dropeffect: "+a.dataTransfer.dropEffect),console.log("Dragend: "+e+" -> "+t)},!1)}module.exports={makeDropTarget:makeDropTarget,makeDraggable:makeDraggable};
},{}],262:[function(require,module,exports){
"use strict";function errorMessageBlock(e,r,o){var t=e.createElement("div");return t.setAttribute("style","margin: 0.1em; padding: 0.5em; border: 0.05em solid gray; background-color: "+(o||"#fee")+"; color:black;"),t.textContent=r,t}module.exports.errorMessageBlock=errorMessageBlock;
},{}],263:[function(require,module,exports){
"use strict";var widgets=module.exports=Object.assign({},require("./peoplePicker"),require("./dragAndDrop"),require("./error")),UI={icons:require("../iconBase"),log:require("../log"),ns:require("../ns"),store:require("../store"),utils:require("../utils"),widgets:widgets};UI.widgets.field={},UI.widgets.clearElement=function(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e},UI.widgets.extractLogURI=function(e){var t=e.search(/logFile=/),i=e.search(/&rulesFile=/);return e.substring(t+8,i)},UI.widgets.shortDate=function(e){if(!e)return"???";var t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];try{var i=new Date,r=$rdf.term(i).value;return e.slice(0,10)===r.slice(0,10)?e.slice(11,16):e.slice(0,4)===r.slice(0,4)?t[parseInt(e.slice(5,7),10)-1]+" "+parseInt(e.slice(8,10),10):e.slice(0,10)}catch(e){return"shortdate:"+e}},UI.widgets.formatDateTime=function(e,t){return t.split("{").map(function(t){var i=t.split("}")[0],r={Milliseconds:3,FullYear:4},n={Month:1};return t?("000"+(e["get"+i]()+(n[i]||0))).slice(-(r[i]||2))+t.split("}")[1]:""}).join("")},UI.widgets.timestamp=function(){return UI.widgets.formatDateTime(new Date,"{FullYear}-{Month}-{Date}T{Hours}:{Minutes}:{Seconds}.{Milliseconds}")},UI.widgets.shortTime=function(){return UI.widgets.formatDateTime(new Date,"{Hours}:{Minutes}:{Seconds}.{Milliseconds}")},UI.widgets.newThing=function(e){var t=new Date;return $rdf.sym(e.uri+"#id"+t.getTime())},UI.widgets.setName=function(e,t){var i=UI.store,r=UI.ns,n=function(e){var t=i.any(e,r.vcard("fn"))||i.any(e,r.foaf("name"))||i.any(e,r.vcard("organization-name"));return t?t.value:null},s=t.sameTerm(r.foaf("Agent"))?"Everyone":n(t);e.textContent=s||UI.utils.label(t),!s&&t.uri&&i.fetcher.nowOrWhenFetched(t,void 0,function(i){e.textContent=(i?"":"? ")+(n(t)||UI.utils.label(t))})},UI.widgets.imagesOf=function(e,t){var i=UI.ns;return t.each(e,i.sioc("avatar")).concat(t.each(e,i.foaf("img"))).concat(t.each(e,i.vcard("logo"))).concat(t.each(e,i.vcard("photo"))).concat(t.each(e,i.foaf("depiction")))},UI.widgets.setImage=function(e,t){var i=UI.store,r=UI.ns,n=UI.icons.iconBase,s=function(e){if(e.sameTerm(r.foaf("Agent"))||e.sameTerm(r.rdf("Resource")))return n+"noun_98053.svg";var t=i.any(e,r.sioc("avatar"))||i.any(e,r.foaf("img"))||i.any(e,r.vcard("logo"))||i.any(e,r.vcard("hasPhoto"))||i.any(e,r.vcard("photo"))||i.any(e,r.foaf("depiction"));return t?t.uri:null},a=function(e){var t=i.findTypeURIs(e);return r.solid("AppProvider").uri in t?n+"noun_15177.svg":!e.uri||4!==e.uri.split("/").length||e.uri.split("/")[1]||e.uri.split("/")[3]?r.solid("AppProviderClass").uri in t?n+"noun_144.svg":r.vcard("Group").uri in t||r.rdfs("Class").uri in t?n+"noun_339237.svg":r.vcard("Organization").uri in t||r.rdfs("Class").uri in t?n+"noun_143899.svg":r.vcard("Individual").uri in t||r.foaf("Person").uri in t?n+"noun_15059.svg":r.vcard("AddressBook").uri in t?n+"noun_15695.svg":"http://www.w3.org/ns/pim/trip#Trip"in t?n+"noun_581629.svg":r.meeting("Meeting").uri in t?n+"noun_66617.svg":e.uri.startsWith("message:")||e.uri.startsWith("mid:")?n+"noun_480183.svg":e.uri.startsWith("mailto:")?n+"noun_567486.svg":e.uri.startsWith("http")&&e.uri.indexOf("#")<0?n+"noun_681601.svg":n+"noun_10636_grey.svg":n+"noun_15177.svg"},o=s(t);e.setAttribute("src",o||a(t)),!o&&t.uri&&i.fetcher.nowOrWhenFetched(t,void 0,function(i){e.setAttribute("src",s(t)||a(t))})},UI.widgets.deleteButtonWithCheck=function(e,t,i,r){var n=UI.icons.iconBase+"noun_2188_red.svg",s=e.createElement("img");s.setAttribute("src",n),s.setAttribute("style","margin: 0.2em; width: 1em; height:1em"),s.title="Remove this "+i;var a=s;return t.appendChild(a),t.setAttribute("class","hoverControl"),a.setAttribute("class","hoverControlHide"),a.addEventListener("click",function(n){t.removeChild(a);var s=e.createElement("button");s.textContent="cancel",t.appendChild(s).addEventListener("click",function(e){t.removeChild(o),t.removeChild(s),t.appendChild(a)},!1);var o=e.createElement("button");o.textContent="Delete "+i,t.appendChild(o).addEventListener("click",function(e){t.removeChild(o),t.removeChild(s),r()},!1)},!1),a},UI.widgets.askName=function(e,t,i,r,n){return new Promise(function(t,s){var a=e.createElement("div");r=r||UI.ns.foaf("name");var o=n?UI.utils.label(n)+"  ":"";o+=UI.utils.label(r)+": ",a.appendChild(e.createElement("p")).textContent=o;var d=e.createElement("input");d.setAttribute("type","text"),d.setAttribute("size","100"),d.setAttribute("maxLength","2048"),d.select(),a.appendChild(d),i.appendChild(a);var l=function(){a.parentNode.removeChild(a),t(d.value)};d.addEventListener("keyup",function(e){13==e.keyCode&&l()},!1);var u=(a.appendChild(e.createElement("br")),a.appendChild(e.createElement("button")));u.setAttribute("type","button"),u.innerHTML="Cancel",u.addEventListener("click",function(e){a.parentNode.removeChild(a),t(null)},!1);var c=a.appendChild(e.createElement("button"));c.setAttribute("type","button"),c.innerHTML="Continue",c.addEventListener("click",function(e){l()},!1)})},UI.widgets.linkIcon=function(e,t,i){var r=e.createElement("a");r.setAttribute("href",t.uri),t.uri.startsWith("http")&&r.setAttribute("target","_blank");var n=r.appendChild(e.createElement("img"));return n.setAttribute("src",i||UI.icons.originalIconBase+"go-to-this.png"),n.setAttribute("style","margin: 0.3em;"),r},UI.widgets.personTR=function(e,t,i,r){var n=e.createElement("tr");r=r||{};var s=n.appendChild(e.createElement("td")),a=n.appendChild(e.createElement("td")),o=n.appendChild(e.createElement("td")),d=i,l=s.appendChild(e.createElement("img"));if(s.setAttribute("style","vertical-align: middle; width:4em; padding:0.5em; height: 4em;"),a.setAttribute("style","vertical-align: middle; text-align:left;"),o.setAttribute("style","vertical-align: middle; width:2em; padding:0.5em; height: 4em;"),l.setAttribute("style","width: 3em; height: 3em; margin: 0.1em; border-radius: 1em;"),UI.widgets.setImage(l,d),UI.widgets.setName(a,d),r.deleteFunction&&UI.widgets.deleteButtonWithCheck(e,o,r.noun||"one",r.deleteFunction),r.link!==!1){var u=o.appendChild(UI.widgets.linkIcon(e,i));u.classList.add("HoverControlHide"),o.appendChild(e.createElement("br"))}return r.draggable!==!1&&(l.setAttribute("draggable","false"),UI.widgets.makeDraggable(n,i)),n},UI.widgets.attachmentList=function(e,t,i){var r=UI.store,n=UI.ns,s=i.appendChild(e.createElement("table"));s.setAttribute("style","margin-top: 1em; margin-bottom: 1em;");var a=s.appendChild(e.createElement("tr")),o=a.appendChild(e.createElement("td")),d=a.appendChild(e.createElement("td")),l=d.appendChild(e.createElement("table")),u=(l.appendChild(e.createElement("tr")),o.appendChild(e.createElement("img")));u.setAttribute("src",UI.icons.iconBase+"noun_25830.svg"),u.setAttribute("style","width; 2em; height: 2em; margin: 0.5em;"),u.setAttribute("draggable","false");var c=function(e){r.updater.update($rdf.st(t,UI.ns.wf("attachment"),e,t.doc()),[],function(e,t,i,r){t?g():complain("Error deleting attachment: "+i)})},p=function(t){var i={deleteFunction:function(){c(t)},noun:"attachment"};return UI.widgets.personTR(e,n.wf("attachment"),t,i)},g=l.refresh=function(){var e=r.each(t,UI.ns.wf("attachment"));e.sort(),UI.utils.syncTableToArray(l,e,p)};g();var f=function(e){var i=[];e.map(function(e){var r=$rdf.sym(e);console.log("Dropped on attachemnt "+e),i.push($rdf.st(t,UI.ns.wf("attachment"),r,t.doc()))}),r.updater.update([],i,function(e,t,i,r){t?g():complain("Error adding attachment: "+i)})};return UI.widgets.makeDropTarget(o,f),s},UI.widgets.field[UI.ns.ui("Form").uri]=UI.widgets.field[UI.ns.ui("Group").uri]=function(e,t,i,r,n,s,a){var o=UI.store,d=e.createElement("div");d.setAttribute("style","padding-left: 2em; border: 0.05em solid brown;");var l=UI.ns.ui;t.appendChild(d);var u=r.toNT()+"|"+n.toNT();if(i[u]){d.appendChild(e.createTextNode("Group: see above "+u));var c=[$rdf.st(r,UI.ns.owl("sameAs"),r)];return UI.outline.appendPropertyTRs(d,c),d}var p={};for(var g in i)p[g]=1;p[u]=1;var f=o.each(n,l("part"));if(!f)return d.appendChild(UI.widgets.errorMessageBlock(e,"No parts to form! ")),e;for(var m=UI.widgets.sortBySequence(f),I=[],U=[],v=0;v<m.length;v++){var h=m[v],w=UI.widgets.bottomURI(h);if(w===l("Options").uri){var b=o.any(h,l("dependingOn"));b&&o.any(r,b)&&(U[v]=o.any(r,b).toNT())}var y=UI.widgets.fieldFunction(e,h),C=function(t,n){if(t)for(var u=0;u<m.length;u++){var c=m[u],p=UI.widgets.bottomURI(c);if(p===l("Options").uri){var g=o.any(c,l("dependingOn")),f=y(e,d,i,r,c,s,a);d.removeChild(f),d.insertBefore(f,I[u]),d.removeChild(I[u]),U[u]=o.any(r,g).toNT(),I[u]=f}}a(t,n)};I.push(y(e,d,p,r,h,s,C))}return d},UI.widgets.field[UI.ns.ui("Options").uri]=function(e,t,i,r,n,s,a){var o=UI.store,d=e.createElement("div"),l=UI.ns.ui;t.appendChild(d);var u=o.any(n,l("dependingOn"));u||(u=UI.ns.rdf("type"));var c=o.each(n,l("case"));c||d.appendChild(UI.widgets.errorMessageBlock(e,"No cases to Options form. "));var p;if(u.sameTerm(UI.ns.rdf("type")))p=o.findTypeURIs(r);else{var g=o.any(r,u);void 0===g?d.appendChild(UI.widgets.errorMessageBlock(e,"Can't select subform as no value of: "+u)):(p={},p[g.uri]=!0)}for(var f=0;f<c.length;f++)for(var m=c[f],I=o.each(m,l("for")),U=0;U<I.length;U++)if(p[I[U].uri]){var v=o.the(m,l("use"));if(!v)return d.appendChild(UI.widgets.errorMessageBlock(e,"No 'use' part for case in form "+n)),d;UI.widgets.appendForm(e,d,i,r,v,s,a);break}return d},UI.widgets.field[UI.ns.ui("Multiple").uri]=function(e,t,i,r,n,s,a){var o=UI.icons.iconBase+"noun_19460_green.svg",d=UI.store;d.updater=d.updater||new $rdf.UpdateManager(d);var l=e.createElement("table"),u=UI.ns.ui;t.appendChild(l);var c=d.any(n,u("property"));if(!c)return l.appendChild(UI.widgets.errorMessageBlock(e,"No property to multiple: "+n)),l;var p=d.any(n,u("min"));p=p?p.value:0;var g=d.any(n,u("max"));g=g?g.value:99999999;var f=d.any(n,u("part"));if(!f)return l.appendChild(UI.widgets.errorMessageBlock(e,"No part to multiple: "+n)),l;var m=0,I=l.appendChild(e.createElement("tr")),U=l.appendChild(e.createElement("tr")),v=U.appendChild(e.createElement("img"));v.setAttribute("src",o),v.setAttribute("style","margin: 0.2em; width: 1em; height:1em"),v.title="Click to add one or more "+UI.utils.label(c);var h=U.appendChild(e.createElement("span")),w=function(t,n){UI.log.debug("Multiple add: "+n),++m,n||(n=UI.widgets.newThing(s));var o=l.insertBefore(e.createElement("tr"),U),u=function(t,i,l){if(i){if(!d.holds(r,c,n)){var u=[$rdf.st(r,c,n,s)];d.updater.update([],u,p)}}else o.appendChild(UI.widgets.errorMessageBlock(e,"Multiple: item failed: "+I)),a(i,l)},p=function(e,t,i){return a(t,i)},g=UI.widgets.fieldFunction(e,f),v=g(e,I,i,n,f,s,u),h=function(){if(d.holds(r,c,n)){var t=[$rdf.st(r,c,n,s)];d.updater.update(t,[],function(t,i,r){i?I.removeChild(v):I.appendChild(UI.widgets.errorMessageBlock(e,"Multiple: delete failed: "+r))})}};UI.widgets.deleteButtonWithCheck(e,v,UI.utils.label(c),h)},b=d.each(r,c);h.textContent=(0===b.length?"Add one or more ":"Add more ")+UI.utils.label(c),b.map(function(e){w(null,e)});for(var y=p-b.length,C=0;C<y;C++)console.log("Adding extra: min "+p),w();return U.addEventListener("click",w,!0),l},UI.widgets.fieldParams={},UI.widgets.fieldParams[UI.ns.ui("ColorField").uri]={size:9},UI.widgets.fieldParams[UI.ns.ui("ColorField").uri].pattern=/^\s*#[0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f]([0-9a-f][0-9a-f])?\s*$/,UI.widgets.fieldParams[UI.ns.ui("DateField").uri]={size:20,type:"date",dt:"date"},UI.widgets.fieldParams[UI.ns.ui("DateField").uri].pattern=/^\s*[0-9][0-9][0-9][0-9](-[0-1]?[0-9]-[0-3]?[0-9])?Z?\s*$/,UI.widgets.fieldParams[UI.ns.ui("DateTimeField").uri]={size:20,type:"date",dt:"dateTime"},UI.widgets.fieldParams[UI.ns.ui("DateTimeField").uri].pattern=/^\s*[0-9][0-9][0-9][0-9](-[0-1]?[0-9]-[0-3]?[0-9])?(T[0-2][0-9]:[0-5][0-9](:[0-5][0-9])?)?Z?\s*$/,UI.widgets.fieldParams[UI.ns.ui("TimeField").uri]={size:10,type:"time",dt:"time"},UI.widgets.fieldParams[UI.ns.ui("TimeField").uri].pattern=/^\s*([0-2]?[0-9]:[0-5][0-9](:[0-5][0-9])?)\s*$/,UI.widgets.fieldParams[UI.ns.ui("IntegerField").uri]={size:12,style:"text-align: right",dt:"integer"},UI.widgets.fieldParams[UI.ns.ui("IntegerField").uri].pattern=/^\s*-?[0-9]+\s*$/,UI.widgets.fieldParams[UI.ns.ui("DecimalField").uri]={size:12,style:"text-align: right",dt:"decimal"},UI.widgets.fieldParams[UI.ns.ui("DecimalField").uri].pattern=/^\s*-?[0-9]*(\.[0-9]*)?\s*$/,UI.widgets.fieldParams[UI.ns.ui("FloatField").uri]={size:12,style:"text-align: right",dt:"float"},UI.widgets.fieldParams[UI.ns.ui("FloatField").uri].pattern=/^\s*-?[0-9]*(\.[0-9]*)?((e|E)-?[0-9]*)?\s*$/,UI.widgets.fieldParams[UI.ns.ui("SingleLineTextField").uri]={},UI.widgets.fieldParams[UI.ns.ui("NamedNodeURIField").uri]={namedNode:!0},UI.widgets.fieldParams[UI.ns.ui("TextField").uri]={},UI.widgets.fieldParams[UI.ns.ui("PhoneField").uri]={size:20,uriPrefix:"tel:"},UI.widgets.fieldParams[UI.ns.ui("PhoneField").uri].pattern=/^\s*\+?[ 0-9-]+[0-9]\s*$/,UI.widgets.fieldParams[UI.ns.ui("EmailField").uri]={size:30,uriPrefix:"mailto:"},UI.widgets.fieldParams[UI.ns.ui("EmailField").uri].pattern=/^\s*.*@.*\..*\s*$/,UI.widgets.field[UI.ns.ui("PhoneField").uri]=UI.widgets.field[UI.ns.ui("EmailField").uri]=UI.widgets.field[UI.ns.ui("ColorField").uri]=UI.widgets.field[UI.ns.ui("DateField").uri]=UI.widgets.field[UI.ns.ui("DateTimeField").uri]=UI.widgets.field[UI.ns.ui("TimeField").uri]=UI.widgets.field[UI.ns.ui("NumericField").uri]=UI.widgets.field[UI.ns.ui("IntegerField").uri]=UI.widgets.field[UI.ns.ui("DecimalField").uri]=UI.widgets.field[UI.ns.ui("FloatField").uri]=UI.widgets.field[UI.ns.ui("TextField").uri]=UI.widgets.field[UI.ns.ui("SingleLineTextField").uri]=UI.widgets.field[UI.ns.ui("NamedNodeURIField").uri]=function(e,t,i,r,n,s,a){var o=UI.ns.ui,d=UI.store,l=e.createElement("tr");t.appendChild(l);var u=e.createElement("td");u.setAttribute("class","formFieldName"),u.setAttribute("style","  vertical-align: middle;"),l.appendChild(u);var c=e.createElement("td");c.setAttribute("class","formFieldValue"),l.appendChild(c);var p=d.any(n,o("property"));if(!p)return l.appendChild(e.createTextNode("Error: No property given for text field: "+n)),l;u.appendChild(UI.widgets.fieldLabel(e,p,n));var g=UI.widgets.bottomURI(n),f=UI.widgets.fieldParams[g];void 0===f&&(f={});var m=f.style||"font-size: 100%; margin: 0.1em; padding: 0.1em;",I=e.createElement("input");c.appendChild(I),I.setAttribute("type",f.type?f.type:"text");var U=d.any(n,o("size"));I.setAttribute("size",U?""+U:f.size?""+f.size:"20");var v=d.any(n,o("maxLength"));I.setAttribute("maxLength",v?""+v:"4096"),s=s||UI.widgets.fieldStore(r,p,s);var h=d.any(r,p,void 0,s);return h||(h=d.any(n,o("default")),h&&d.add(r,p,h,s)),h&&(I.value=h.value||h.uri),I.setAttribute("style",m),I.addEventListener("keyup",function(e){f.pattern&&I.setAttribute("style",m+(I.value.match(f.pattern)?"color: green;":"color: red;"))},!0),I.addEventListener("change",function(t){if(!f.pattern||I.value.match(f.pattern)){I.disabled=!0,I.setAttribute("style",m+"color: gray;");var i,n=d.statementsMatching(r,p);i=f.namedNode?d.sym(I.value):f.parse?f.parse(I.value):I.value;var o=$rdf.st(r,p,i,s);d.updater.update(n,o,function(t,i,r){i?(I.disabled=!1,I.setAttribute("style",m)):l.appendChild(UI.widgets.errorMessageBlock(e,r)),a(i,r)})}},!0),l},UI.widgets.field[UI.ns.ui("MultiLineTextField").uri]=function(e,t,i,r,n,s,a){var o=UI.ns.ui,d=UI.store,l=d.any(n,o("property"));if(!l)return UI.widgets.errorMessageBlock(e,"No property to text field: "+n);t.appendChild(UI.widgets.fieldLabel(e,l,n)),s=UI.widgets.fieldStore(r,l,s);var u=UI.widgets.makeDescription(e,d,r,l,s,a);return t.appendChild(u),u},UI.widgets.field[UI.ns.ui("BooleanField").uri]=function(e,t,i,r,n,s,a){var o=UI.ns.ui,d=UI.store,l=d.any(n,o("property"));if(!l)return t.appendChild(UI.widgets.errorMessageBlock(e,"No property to boolean field: "+n));var u=d.any(n,o("label"));u||(u=UI.utils.label(l,!0)),s=UI.widgets.fieldStore(r,l,s);var c=d.any(r,l);void 0===c&&(c=!1);var p=$rdf.st(r,l,!0,s),g=$rdf.st(r,l,!1,s),f=UI.widgets.buildCheckboxForm(e,d,u,g,p,n,s);return t.appendChild(f),f},UI.widgets.field[UI.ns.ui("Classifier").uri]=function(e,t,i,r,n,s,a){var o=UI.store,d=UI.ns.ui,l=o.any(n,d("category"));if(!l)return UI.widgets.errorMessageBlock(e,"No category for classifier: "+n);UI.log.debug("Classifier: store="+s);var u=function(e,t){return e?a(e,t):a(e,t)},c=UI.widgets.makeSelectForNestedCategory(e,o,r,l,s,u);return t.appendChild(c),c},UI.widgets.field[UI.ns.ui("Choice").uri]=function(e,t,i,r,n,s,a){function o(t,n){b=c.any(r,m),UI.widgets.fieldFunction(e,U)(e,f,i,b,U,s,a)}var d,l=UI.ns.ui,u=UI.ns,c=UI.store,p=e.createElement("tr");t.appendChild(p);var g=e.createElement("td");p.appendChild(g);var f=e.createElement("td");p.appendChild(f);var m=c.any(n,l("property"));if(!m)return UI.widgets.errorMessageBlock(e,"No property for Choice: "+n);g.appendChild(UI.widgets.fieldLabel(e,m,n));var I=c.any(n,l("from"));if(!I)return UI.widgets.errorMessageBlock(e,"No 'from' for Choice: "+n);var U=c.any(n,l("use")),v=[],h={multiple:y,nullLabel:A,disambiguate:!1};v=c.each(void 0,u.rdf("type"),I);for(var w in c.findMembersNT(I))v.push(c.fromNT(w));if(I.sameTerm(u.rdfs("Class")))for(d in UI.widgets.allClassURIs())v.push(c.sym(d));else if(I.sameTerm(u.rdf("Property"))){possibleProperties=UI.widgets.propertyTriage();for(d in possibleProperties.op)v.push(c.fromNT(d));for(d in possibleProperties.dp)v.push(c.fromNT(d));h.disambiguate=!0}else if(I.sameTerm(u.owl("ObjectProperty"))){possibleProperties=UI.widgets.propertyTriage();for(d in possibleProperties.op)v.push(c.fromNT(d));h.disambiguate=!0}else if(I.sameTerm(u.owl("DatatypeProperty"))){possibleProperties=UI.widgets.propertyTriage();for(d in possibleProperties.dp)v.push(c.fromNT(d));h.disambiguate=!0}var b=c.any(r,m),y=!1,C=UI.widgets.sortByLabel(v),A="--"+UI.utils.label(m)+"-?";c.any(n,l("canMintNew"))&&(h.mint="* New *",h.subForm=U);var E=UI.widgets.makeSelectForOptions(e,c,r,m,C,h,s,a);return f.appendChild(E),b&&U&&o(!0,""),p},UI.widgets.fieldParams[UI.ns.ui("Comment").uri]={element:"p",style:"padding: 0.1em 1.5em; color: brown; white-space: pre-wrap;"},UI.widgets.fieldParams[UI.ns.ui("Heading").uri]={element:"h3",style:"font-size: 110%; color: brown;"},UI.widgets.field[UI.ns.ui("Comment").uri]=UI.widgets.field[UI.ns.ui("Heading").uri]=function(e,t,i,r,n,s,a){var o=UI.ns.ui,d=UI.store,l=d.any(n,o("contents"));l||(l="Error: No contents in comment field.");var u=UI.widgets.bottomURI(n),c=UI.widgets.fieldParams[u];void 0===c&&(c={});var p=e.createElement("div");t.appendChild(p);var g=p.appendChild(e.createElement(c.element));g.textContent=l;var f=d.any(n,o("style"));return void 0===f&&(f=c.style?c.style:""),f&&g.setAttribute("style",f),p},UI.widgets.openHrefInOutlineMode=function(e){e.preventDefault(),e.stopPropagation();var t=UI.utils.getTarget(e),i=t.getAttribute("href");i||console.log("No href found \n"),UI.outline?UI.outline.GotoSubject(UI.store.sym(i),!0,void 0,!0,void 0):window&&window.UI&&window.UI.outline?window.UI.outline.GotoSubject(UI.store.sym(i),!0,void 0,!0,void 0):console.log("ERROR: Can't access outline manager in this config")},UI.widgets.defaultAnnotationStore=function(e){if(void 0!==e.uri){var t=e.uri;if("http://"===t.slice(0,7)){t=t.slice(7);var i=t.indexOf("#");if(i>=0)t=t.slice(0,i);else{var r=t.lastIndexOf("/");if(r<0)return;t=t.slice(0,r)}return UI.store.sym("http://tabulator.org/wiki/annnotation/"+t)}}},UI.widgets.fieldStore=function(e,t,i){var r=UI.store.statementsMatching(e,t);return 0===r.length?i:r.length>0&&r[0].why.uri&&UI.store.updater.editable(r[0].why.uri,UI.store)?UI.store.sym(r[0].why.uri):null},UI.widgets.allClassURIs=function(){var e={};return UI.store.statementsMatching(void 0,UI.ns.rdf("type"),void 0).map(function(t){t.object.uri&&(e[t.object.uri]=!0)}),UI.store.statementsMatching(void 0,UI.ns.rdfs("subClassOf"),void 0).map(function(t){t.object.uri&&(e[t.object.uri]=!0),t.subject.uri&&(e[t.subject.uri]=!0)}),UI.store.each(void 0,UI.ns.rdf("type"),UI.ns.rdfs("Class")).map(function(t){t.uri&&(e[t.uri]=!0)}),e},UI.widgets.propertyTriage=function(){var e={},t=UI.store,i={},r={},n=0,s=0,a=0,o=t.predicateIndex;for(var d in o){var l=o[d][0].object;"Literal"===l.termType?(i[d]=!0,s++):(r[d]=!0,n++)}for(var u=t.each(void 0,UI.ns.rdf("type"),UI.ns.rdf("Property")),c=0;c<u.length;c++)d=u[c].toNT(),UI.log.debug("propertyTriage: unknown: "+d),r[d]||i[d]||(i[d]=!0,r[d]=!0,a++);return e.op=r,e.dp=i,UI.log.info("propertyTriage: "+n+" non-lit, "+s+" literal. "+a+" unknown."),e},UI.widgets.fieldLabel=function(e,t,i){var r=UI.store.any(i,UI.ns.ui("label"));if(r||(r=UI.utils.label(t,!0)),void 0===t)return e.createTextNode("@@Internal error: undefined property");var n=e.createElement("a");return t.uri&&n.setAttribute("href",t.uri),n.setAttribute("style","color: #3B5998; text-decoration: none;"),n.textContent=r,n},UI.widgets.bottomURI=function(e){var t=UI.store,i=t.findTypeURIs(e),r=t.bottomTypeURIs(i),n=[];for(var s in r)n.push(s);return n[0]},UI.widgets.fieldFunction=function(e,t){var i=UI.widgets.bottomURI(t),r=UI.widgets.field[i];return UI.log.debug("paneUtils: Going to implement field "+t+" of type "+i),r?r:function(){return UI.widgets.errorMessageBlock(e,"No handler for field "+t+" of type "+i)}},UI.widgets.editFormButton=function(e,t,i,r,n){var s=e.createElement("button");return s.setAttribute("type","button"),s.innerHTML="Edit "+UI.utils.label(UI.ns.ui("Form")),s.addEventListener("click",function(a){var o=UI.widgets.appendForm(e,t,{},i,UI.ns.ui("FormForm"),r,n);o.setAttribute("style",UI.ns.ui("FormForm").sameTerm(i)?"background-color: #fee;":"background-color: #ffffe7;"),t.removeChild(s)},!0),s},UI.widgets.linkButton=function(e,t){var i=e.createElement("button");return i.setAttribute("type","button"),i.textContent="Goto "+UI.utils.label(t),i.addEventListener("click",function(e){UI.outline.GotoSubject(t,!0,void 0,!0,void 0)},!0),i},UI.widgets.removeButton=function(e,t){var i=e.createElement("button");return i.setAttribute("type","button"),i.textContent="",i.addEventListener("click",function(e){t.parentNode.removeChild(t)},!0),i},UI.widgets.appendForm=function(e,t,i,r,n,s,a){return UI.widgets.fieldFunction(e,n)(e,t,i,r,n,s,a)},UI.widgets.propertiesForClass=function(e,t){var i=UI.ns,r=e.each(void 0,i.rdf("range"),t);[i.rdfs("comment"),i.dc("title"),i.foaf("name"),i.foaf("homepage")].map(function(e){r.push(e)});var n=e.each(void 0,i.rdf("type"),t);n.length>60&&(n=n.slice(0,60));for(var s={},a=0;a<(n.length>60?60:n.length);a++)e.statementsMatching(n[a],void 0,void 0).map(function(e){s[e.predicate.uri]=!0});r.map(function(e){s[e.uri]=!0});var o=[];for(var d in s)o.push(e.sym(d));return o},UI.widgets.findClosest=function(e,t,i){for(var r=[e.sym(t)];r.length>0;){var n=r.shift(),s=e.each(n,i);if(UI.log.debug("Lists for "+n+", "+i+": "+s.length),0!==s.length)return s;for(var a=e.each(n,UI.ns.rdfs("subClassOf")),o=0;o<a.length;o++)r.push(a[o]),UI.log.debug("findClosest: add super: "+a[o])}return[]},UI.widgets.formsFor=function(e){var t=UI.ns,i=UI.store;UI.log.debug("formsFor: subject="+e);var r,n=i.findTypeURIs(e);for(r in n)UI.log.debug("   type: "+r);var s=i.bottomTypeURIs(n),a=[];for(var o in s)UI.log.debug("formsFor: trying bottom type ="+o),a=a.concat(UI.widgets.findClosest(i,o,t.ui("creationForm"))),a=a.concat(UI.widgets.findClosest(i,o,t.ui("annotationForm")));return UI.log.debug("formsFor: subject="+e+", forms="),a},UI.widgets.sortBySequence=function(e){var t=e.map(function(e){var t=UI.store.any(e,UI.ns.ui("sequence"));return[t||9999,e]});return t.sort(function(e,t){return e[0]-t[0]}),t.map(function(e){return e[1]})},UI.widgets.sortByLabel=function(e){var t=e.map(function(e){return[UI.utils.label(e).toLowerCase(),e]});return t.sort(),t.map(function(e){return e[1]})},UI.widgets.newButton=function(e,t,i,r,n,s,a,o){var d=e.createElement("button");return d.setAttribute("type","button"),d.innerHTML="New "+UI.utils.label(n),d.addEventListener("click",function(l){d.parentNode.appendChild(UI.widgets.promptForNew(e,t,i,r,n,s,a,o))},!1),d},UI.widgets.promptForNew=function(e,t,i,r,n,s,a,o){var d=UI.ns,l=e.createElement("form");if(!s){var u=UI.widgets.findClosest(t,n.uri,d.ui("creationForm"));if(0===u.length){var c=l.appendChild(e.createElement("p"));c.textContent="I am sorry, you need to provide information about a "+UI.utils.label(n)+" but I don't know enough information about those to ask you.";var p=l.appendChild(e.createElement("button"));return p.setAttribute("type","button"),p.setAttribute("style","float: right;"),p.innerHTML="Goto "+UI.utils.label(n),p.addEventListener("click",function(e){UI.outline.GotoSubject(n,!0,void 0,!0,void 0)},!1),l}UI.log.debug("lists[0] is "+u[0]),s=u[0]}UI.log.debug("form is "+s),l.setAttribute("style","border: 0.05em solid brown; color: brown"),l.innerHTML="<h3>New "+UI.utils.label(n)+"</h3>";var g=UI.widgets.fieldFunction(e,s),f=UI.widgets.newThing(a),m=!1,I=function(s,u){if(!s)return o(s,u);var c=[];i&&!t.holds(i,r,f,a)&&c.push($rdf.st(i,r,f,a)),i&&!t.holds(f,d.rdf("type"),n,a)&&c.push($rdf.st(f,d.rdf("type"),n,a)),c.length?UI.store.updater.update([],c,U):o(!0,u),m||(m=l.appendChild(UI.widgets.linkButton(e,f)))},U=function(e,t,i){return o(t,i)};UI.log.info("paneUtils Object is "+f);var v=g(e,l,{},f,s,a,I),h=UI.widgets.removeButton(e,v);return h.setAttribute("style","float: right;"),l.AJAR_subject=f,l},UI.widgets.makeDescription=function(e,t,i,r,n,s){var a=e.createElement("div"),o=t.statementsMatching(i,r,void 0);if(o.length>1)return UI.widgets.errorMessageBlock(e,"Should not be "+o.length+" i.e. >1 "+r+" of "+i);var d=o.length?o[0].object.value:void 0,l=e.createElement("textarea");a.appendChild(l),l.rows=d?d.split("\n").length+2:2,l.cols=80;var u="font-size:100%; white-space: pre-wrap; background-color: white; border: 0.07em solid gray; padding: 1em 0.5em; margin: 1em 1em;";l.setAttribute("style",u),o.length?l.value=d:l.select(),a.refresh=function(){var e=t.any(i,r);e&&e.value!==l.value&&(l.value=e.value)};var c=e.createElement("br");a.appendChild(c);var p=e.createElement("input");p.setAttribute("type","submit"),p.disabled=!0,p.setAttribute("style","visibility: hidden; float: right;"),p.value="Save "+UI.utils.label(r),a.appendChild(p);var g=function(o){p.disabled=!0,p.setAttribute("style","visibility: hidden; float: right;"),l.disabled=!0,l.setAttribute("style",u+"color: gray;");var d=t.statementsMatching(i,r),c=$rdf.st(i,r,l.value,n);UI.store.updater.update(d,c,function(t,i,r){i?(l.setAttribute("style",u+"color: black;"),l.disabled=!1):a.appendChild(UI.widgets.errorMessageBlock(e,"Error (while saving change to "+n.uri+"): "+r)),s&&s(i,r)})};return l.addEventListener("keyup",function(e){l.setAttribute("style",u+"color: green;"),p&&(p.disabled=!1,p.setAttribute("style","float: right;"))},!0),l.addEventListener("change",g,!0),p.addEventListener("click",g,!1),a},UI.widgets.makeSelectForOptions=function(e,t,i,r,n,s,a,o){UI.log.debug("Select list length now "+n.length);for(var d=0,l={},u=0;u<n.length;u++){var c=n[u];c.uri in l||(l[c.uri]=!0,d++)}if(0===d&&!s.mint)return UI.widgets.errorMessageBlock(e,"Can't do selector with no options, subject= "+i+" property = "+r+".");UI.log.debug("makeSelectForOptions: store="+a);var p=function(){return g={},r.sameTerm(UI.ns.rdf("type"))?g=t.findTypeURIs(i):t.each(i,r).map(function(e){g[e.uri]=!0}),g},g=p(),f=function(n){function d(e,t){o(e,t)}m.disabled=!0;for(var l=[],u=[],c=function(e){t.holds(i,r,e,a)&&l.push($rdf.st(i,r,e,a))},f=0;f<m.options.length;f++){var I=m.options[f];if(I.selected&&I.AJAR_mint){var U;if(s.mintClass){var v=UI.widgets.promptForNew(e,t,i,r,s.mintClass,null,a,function(e,t){e||o(e,t)});m.parentNode.appendChild(v),U=v.AJAR_subject}else U=UI.widgets.newThing(a);u.push($rdf.st(i,r,U,a)),s.mintStatementsFun&&(u=u.concat(s.mintStatementsFun(U)))}I.AJAR_uri&&(!I.selected||I.AJAR_uri in g||u.push($rdf.st(i,r,t.sym(I.AJAR_uri),a)),!I.selected&&I.AJAR_uri in g&&c(t.sym(I.AJAR_uri)),I.selected&&(m.currentURI=I.AJAR_uri))}for(var h=m.subSelect;h&&h.currentURI;)c(t.sym(h.currentURI)),h=h.subSelect;for(h=m.superSelect;h&&h.currentURI;)c(t.sym(h.currentURI)),h=h.superSelect;UI.log.info("selectForOptions: stote = "+a),UI.store.updater.update(l,u,function(t,i,r){if(g=p(),i&&(m.disabled=!1,U)){var n=UI.widgets.fieldFunction(e,s.subForm);n(e,m.parentNode,{},U,s.subForm,a,d)}o&&o(i,r)})},m=e.createElement("select");m.setAttribute("style","margin: 0.6em 1.5em;"),s.multiple&&m.setAttribute("multiple","true"),m.currentURI=null,m.refresh=function(){g=p();for(var e=0;e<m.children.length;e++){var t=m.children[e];t.AJAR_uri&&(t.selected=t.AJAR_uri in g)}m.disabled=!1};for(var I in l){var U=t.sym(I),v=e.createElement("option");s.disambiguate?v.appendChild(e.createTextNode(UI.utils.labelWithOntology(U,!0))):v.appendChild(e.createTextNode(UI.utils.label(U,!0)));var h=t.any(U,t.sym("http://www.w3.org/ns/ui#backgroundColor"));h&&v.setAttribute("style","background-color: "+h.value+"; "),v.AJAR_uri=I,I in g&&(v.setAttribute("selected","true"),m.currentURI=I),m.appendChild(v)}if(s.mint){var w=e.createElement("option");w.appendChild(e.createTextNode(s.mint)),w.AJAR_mint=!0,m.insertBefore(w,m.firstChild)}if(null==m.currentURI&&!s.multiple){var b=e.createElement("option");b.appendChild(e.createTextNode(s.nullLabel)),m.insertBefore(b,m.firstChild),b.selected=!0}return m.addEventListener("change",f,!1),m},UI.widgets.makeSelectForCategory=function(e,t,i,r,n,s){var a,o=UI.log,d=t.any(r,UI.ns.owl("disjointUnionOf")),l=!1;return d?a=d.elements:(a=t.each(void 0,UI.ns.rdfs("subClassOf"),r),l=!0),o.debug("Select list length "+a.length),0===a.length?UI.widgets.errorMessageBlock(e,"Can't do "+(l?"multiple ":"")+"selector with no subclasses of category: "+r):1===a.length?UI.widgets.errorMessageBlock(e,"Can't do "+(l?"multiple ":"")+"selector with only 1 subclass of category: "+r+":"+a[1]):UI.widgets.makeSelectForOptions(e,t,i,UI.ns.rdf("type"),a,{multiple:l,nullPrompt:"--classify--"},n,s)},UI.widgets.makeSelectForNestedCategory=function(e,t,i,r,n,s){var a,o=e.createElement("span"),d=null,l=function(e,t){e&&u(),s(e,t)};a=UI.widgets.makeSelectForCategory(e,t,i,r,n,l),o.appendChild(a);var u=function(){d&&(o.removeChild(d),d=null),a.currentURI&&t.any(t.sym(a.currentURI),UI.ns.owl("disjointUnionOf"))&&(d=UI.widgets.makeSelectForNestedCategory(e,t,i,t.sym(a.currentURI),n,s),a.subSelect=d.firstChild,a.subSelect.superSelect=a,o.appendChild(d))};return u(),o},UI.widgets.buildCheckboxForm=function(e,t,i,r,n,s,a){var o=e.createElement("div"),d=e.createTextNode(i),l=UI.store.updater.editable(a.uri);d.style="colour: black; font-size: 100%; padding-left: 0.5 em; padding-right: 0.5 em;",o.appendChild(d);var u=e.createElement("input");o.appendChild(u),u.setAttribute("type","checkbox"),u.setAttribute("style","margin: 0.7em");var c=t.holds(n.subject,n.predicate,n.object,a);if(r){var p=t.holds(r.subject,r.predicate,r.object,a);if(c&&p)return o.appendChild(UI.widgets.errorMessageBlock(e,"Inconsistent data in store!\n"+n+" and\n"+r)),o;c||p||(c=!!t.any(s,UI.ns.ui("default")))}if(u.checked=c,!l)return o;var g=function(i){d.style="color: #bbb;";var s,l;this.checked?(s=n,l=r&&p?r:[],UI.store.updater.update(r&&p?r:[],n,function(t,i,r){return i?(d.style="color: #black;",c=!0,p=!1,void 0):(d.style="color: #black; background-color: #fee;",o.appendChild(UI.widgets.errorMessageBlock(e,"Error updating store (setting boolean, checked) :\n\n"+r)),void(u.checked=!1))})):(s=r,l=t.statementsMatching(n.subject,n.predicate,n.object,a),UI.store.updater.update(l,s,function(t,i,n){return d.className="question",i?(d.style="color: #black;",c=!1,p=!!r,void 0):(d.style="color: #black; background-color: #fee;",o.appendChild(UI.widgets.errorMessageBlock(e,"Error updating store (unchecked):\n\n"+n)),void(u.checked=!1))}))};return u.addEventListener("click",g,!1),o},UI.widgets.selectorPanel=function(e,t,i,r,n,s,a,o,d){return UI.widgets.selectorPanelRefresh(e.createElement("div"),e,t,i,r,n,s,a,o,d)},UI.widgets.selectorPanelRefresh=function(e,t,i,r,n,s,a,o,d,l){
var u="border: 0.1em solid #ddd; border-bottom: none; width: 95%; height: 2em; padding: 0.5em;",c=null;e.innerHTML="";for(var p=function(e,a){var p,g,f=function(){var e=s?i.each(void 0,n,a):i.each(a,n);v.setAttribute("class",0===e.length?"hideTillHover":""),g.setAttribute("src",o.connectIcon||UI.icons.iconBase+"noun_25830.svg"),g.setAttribute("title",e.length?e.length:"attach")},m=UI.widgets.index.twoLine.widgetForClass(r);p=m(t,a),p.setAttribute("style",u);var I=t.createElement("div");I.setAttribute("class","hideTillHover"),I.setAttribute("style","float:right; width:10%");var U=t.createElement("a");U.setAttribute("href",a.uri),U.setAttribute("style","float:right"),I.appendChild(U).textContent=">",e.appendChild(I);var v=t.createElement("div");return v.setAttribute("style",(s?"float:left;":"float:right;")+" width:30px;"),g=t.createElement("img"),f(),v.appendChild(g),e.appendChild(v),p.addEventListener("click",function(e){c===p?(p.setAttribute("style",u),c=null):(c&&c.setAttribute("style",u),p.setAttribute("style",u+"background-color: #ccc; color:black;"),c=p),d(a,e,c===p),f()},!1),g.addEventListener("click",function(e){l(a,e,s,f)},!1),e.appendChild(p),e},g=0;g<a.length;g++){var f=t.createElement("div");e.appendChild(f),p(f,a[g])}return e},UI.widgets.index={},UI.widgets.index.line={},UI.widgets.index.twoLine={},UI.widgets.index.twoLine[""]=function(e,t){var i=e.createElement("div");return i.textContent=UI.utils.label(t),i},UI.widgets.index.twoLine.widgetForClass=function(e){var t=UI.widgets.index.twoLine[e.uri],i=UI.store;if(t)return t;var r=i.findSuperClassesNT(e);for(var n in r)if(t=UI.widgets.index.twoLine[i.fromNT(n).uri])return t;return UI.widgets.index.twoLine[""]},UI.widgets.index.twoLine["http://www.w3.org/2000/10/swap/pim/qif#Transaction"]=function(e,t){var i="",r=function(e){var r=UI.store.any(t,UI.ns.qu(e));return r||(i+="@@ No value for "+e+"! "),r?UI.utils.escapeForXML(r.value):"?"},n=e.createElement("table");return n.innerHTML='<tr><td colspan="2">'+r("payee")+"</td></tr>\n<tr><td><td>"+r("date").slice(0,10)+'</td><td style="text-align: right;">'+r("amount")+"</td></tr>",i&&(n.innerHTML='<tr><td><a href="'+UI.utils.escapeForXML(t.uri)+'">'+UI.utils.escapeForXML(i)+"</a></td></tr>"),n},UI.widgets.index.twoLine["http://www.w3.org/ns/pim/trip#Trip"]=function(e,t){var i=function(e){var i=UI.store.any(t,e);return i?UI.utils.escapeForXML(i.value):"?"},r=e.createElement("table");return r.innerHTML='<tr><td colspan="2">'+i(UI.ns.dc("title"))+'</td></tr>\n<tr style="color: #777"><td><td>'+i(UI.ns.cal("dtstart"))+"</td><td>"+i(UI.ns.cal("dtend"))+"</td></tr>",r},UI.widgets.addStyleSheet=function(e,t){var r=e.querySelectorAll("link");for(i=0;i<r.length;i++)if("stylesheet"===(r[i].getAttribute("rel")||"")&&(r[i].getAttribute("href")||"")===t)return;var n=e.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",t),e.getElementsByTagName("head")[0].appendChild(n)},UI.widgets.isAudio=function(e){return UI.widgets.isImage(e,"audio")},UI.widgets.isVideo=function(e){return UI.widgets.isImage(e,"video")},UI.widgets.isImage=function(e,t){var i={audio:"http://purl.org/dc/dcmitype/Sound",image:"http://purl.org/dc/dcmitype/Image",video:"http://purl.org/dc/dcmitype/MovingImage"},r=t||"image",n=UI.store.findTypeURIs(e),s=$rdf.Util.mediaTypeClass(r+"/*").uri.split("*")[0];for(var a in n)if(a.startsWith(s))return!0;return i[r]in n};
},{"../iconBase":250,"../log":251,"../ns":254,"../store":257,"../utils":260,"./dragAndDrop":261,"./error":262,"./peoplePicker":264}],264:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _taggedTemplateLiteral(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function getWithDefault(e,t,r){var n=_store2.default.any(e,t);return n?n.value:r}function patch(e,t){var r=t.toDel,n=t.toIns;return webClient.patch(e,r,n).then(function(e){var t=e.xhr.status;if(t<200||t>=400){var r=new Error("PATCH failed for resource <"+e.url+">");throw r.solidResponse=e,r}})}function bookUrls(e){return{bookIndexUrl:e+"book.ttl",groupIndexUrl:e+"groups.ttl",groupContainerUrl:e+"Group/"}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.GroupBuilder=exports.Group=exports.GroupPicker=exports.PeoplePicker=void 0;var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_templateObject=_taggedTemplateLiteral(["\n        To add someone to this group, drag and drop their WebID URL onto the box.\n      "],["\n        To add someone to this group, drag and drop their WebID URL onto the box.\n      "]),_escapeHtml=require("escape-html"),_escapeHtml2=_interopRequireDefault(_escapeHtml),_nodeUuid=require("node-uuid"),_nodeUuid2=_interopRequireDefault(_nodeUuid),_rdflib=require("rdflib"),_rdflib2=_interopRequireDefault(_rdflib),_dragAndDrop=require("./dragAndDrop"),_error=require("./error"),_iconBase=require("../iconBase"),_ns=require("../ns"),_ns2=_interopRequireDefault(_ns),_store=require("../store"),_store2=_interopRequireDefault(_store),webClient=require("solid-web-client")(_rdflib2.default),PeoplePicker=exports.PeoplePicker=function(){function e(t,r,n,o){_classCallCheck(this,e),this.element=t,this.typeIndexUrl=r,this.groupPickedCb=n,this.selectedGroupNode=o,this.onSelectGroup=this.onSelectGroup.bind(this)}return _createClass(e,[{key:"render",value:function(){var e=this,t=document.createElement("div");if(t.style.maxWidth="350px",t.style.minHeight="200px",t.style.outline="1px solid black",t.style.display="flex",this.selectedGroupNode){t.style.flexDirection="column";var r=document.createElement("div");new Group(r,this.selectedGroupNode).render();var n=document.createElement("button");n.textContent=(0,_escapeHtml2.default)("Change group"),n.addEventListener("click",function(t){e.selectedGroupNode=null,e.render()}),t.appendChild(r),t.appendChild(n)}else this.findGroupIndex(this.typeIndexUrl).then(function(r){var n=r.bookBaseUrl,o=document.createElement("button");o.textContent=(0,_escapeHtml2.default)("Pick an existing group"),o.style.margin="auto",o.addEventListener("click",function(r){new GroupPicker(t,n,e.onSelectGroup).render()});var a=document.createElement("button");a.textContent=(0,_escapeHtml2.default)("Create a new group"),a.style.margin="auto",a.addEventListener("click",function(t){e.createNewGroup(n).then(function(t){var r=t.groupNode,o=t.graphNode;new GroupBuilder(e.element,n,o,r,e.onSelectGroup).render()}).catch(function(t){e.element.appendChild((0,_error.errorMessageBlock)(document,(0,_escapeHtml2.default)("Error creating a new group. ("+t+")")))})}),t.appendChild(o),t.appendChild(a),e.element.innerHTML="",e.element.appendChild(t)}).catch(function(t){e.element.appendChild((0,_error.errorMessageBlock)(document,(0,_escapeHtml2.default)("Could find your groups. ("+t+")")))});return this.element.innerHTML="",this.element.appendChild(t),this}},{key:"findGroupIndex",value:function(e){return new Promise(function(t,r){_store2.default.fetcher.nowOrWhenFetched(e,function(e,n){if(!e)return r(n);var o=_store2.default.statementsMatching(null,_ns2.default.solid("forClass"),_ns2.default.vcard("AddressBook"));if(o.length<1)return r(new Error("no address book registered in the solid type index"));var a=o[0].subject,l=_store2.default.statementsMatching(a,_ns2.default.solid("instance"));l.length||r(new Error("incomplete address book registration"));var u=l[0].object.value,d=u.replace(/book\.ttl(#.*)?$/,"");return t({bookBaseUrl:d})})})}},{key:"createNewGroup",value:function(e){var t=bookUrls(e),r=t.groupIndexUrl,n=t.groupContainerUrl,o=t.bookIndexUrl,a=_rdflib2.default.namedNode(r),l=""+n+_nodeUuid2.default.v4().slice(0,8)+".ttl",u=_rdflib2.default.namedNode(l),d=_rdflib2.default.namedNode(l+"#this"),i=[u,a].map(function(e){var t=_rdflib2.default.st(d,_ns2.default.rdf("type"),_ns2.default.vcard("Group")),r=_rdflib2.default.st(d,_ns2.default.vcard("fn"),_rdflib2.default.literal("Untitled Group")),n=_rdflib2.default.st(_rdflib2.default.namedNode(o+"#this"),_ns2.default.vcard("includesGroup"),d),l=e.equals(a)?[t,r,n]:[t,r];return patch(e.value,{toIns:l}).then(function(){l.forEach(function(t){t.why=e,_store2.default.add(t)})})});return Promise.all(i).then(function(){return{groupNode:d,graphNode:u}}).catch(function(e){throw new Error("Couldn't create new group.  PATCH failed for ("+e.xhr.responseURL+")")})}},{key:"onSelectGroup",value:function(e){this.selectedGroupNode=e,this.groupPickedCb(e),this.render()}}]),e}(),GroupPicker=exports.GroupPicker=function(){function e(t,r,n){_classCallCheck(this,e),this.element=t,this.bookBaseUrl=r,this.onSelectGroup=n}return _createClass(e,[{key:"render",value:function(){var e=this;return this.loadGroups().then(function(t){var r=document.createElement("div");r.style.display="flex",r.style.flexDirection="column",t.forEach(function(t){var n=document.createElement("button");n.addEventListener("click",e.handleClickGroup(t)),new Group(n,t).render(),r.appendChild(n)}),e.element.innerHTML="",e.element.appendChild(r)}).catch(function(t){e.element.appendChild((0,_error.errorMessageBlock)(document,(0,_escapeHtml2.default)("There was an error loading your groups. ("+t+")")))}),this}},{key:"loadGroups",value:function(){var e=this;return new Promise(function(t,r){var n=bookUrls(e.bookBaseUrl),o=n.bookIndexUrl,a=n.groupIndexUrl;_store2.default.fetcher.nowOrWhenFetched(a,function(e,n){if(!e)return r(n);var a=_store2.default.match(_rdflib2.default.namedNode(o+"#this"),_ns2.default.vcard("includesGroup")).map(function(e){return e.object});return t(a)})})}},{key:"handleClickGroup",value:function(e){var t=this;return function(r){t.onSelectGroup(e)}}}]),e}(),Group=exports.Group=function(){function e(t,r){_classCallCheck(this,e),this.element=t,this.groupNode=r}return _createClass(e,[{key:"render",value:function(){var e=document.createElement("div");return e.textContent=(0,_escapeHtml2.default)(getWithDefault(this.groupNode,_ns2.default.vcard("fn"),"["+this.groupNode.value+"]")),this.element.innerHTML="",this.element.appendChild(e),this}}]),e}(),GroupBuilder=exports.GroupBuilder=function(){function e(t,r,n,o,a,l){_classCallCheck(this,e),this.element=t,this.bookBaseUrl=r,this.groupGraph=n,this.groupNode=o,this.onGroupChanged=function(e,t,r){l&&l(e,t,r)},this.groupChangedCb=l,this.doneBuildingCb=a}return _createClass(e,[{key:"refresh",value:function(){}},{key:"render",value:function(){var e=this,t=document.createElement("div");t.style.maxWidth="350px",t.style.minHeight="200px",t.style.outline="1px solid black",t.style.display="flex",t.style.flexDirection="column",(0,_dragAndDrop.makeDropTarget)(t,function(t){t.map(function(t){e.add(t).catch(function(t){e.element.appendChild((0,_error.errorMessageBlock)(document,(0,_escapeHtml2.default)("Could not add the given WebId. ("+t+")")))})})});var r=document.createElement("input");r.type="text",r.value=getWithDefault(this.groupNode,_ns2.default.vcard("fn"),"Untitled Group"),r.addEventListener("change",function(t){e.setGroupName(t.target.value).catch(function(t){e.element.appendChild((0,_error.errorMessageBlock)(document,"Error changing group name. ("+t+")"))})});var n=document.createElement("label");if(n.textContent=(0,_escapeHtml2.default)("Group Name:"),n.appendChild(r),t.appendChild(n),_store2.default.any(this.groupNode,_ns2.default.vcard("hasMember")))_store2.default.match(this.groupNode,_ns2.default.vcard("hasMember")).forEach(function(r){var n=r.object,o=document.createElement("div");new Person(o,n,e.handleRemove(n)).render(),t.appendChild(o)});else{var o=document.createElement("p");o.textContent=(0,_escapeHtml2.default)(_templateObject),t.appendChild(o)}var a=document.createElement("button");return a.textContent=(0,_escapeHtml2.default)("Done"),a.addEventListener("click",function(t){e.doneBuildingCb(e.groupNode)}),t.appendChild(a),this.element.innerHTML="",this.element.appendChild(t),this}},{key:"add",value:function(e){var t=this;return new Promise(function(r,n){_store2.default.fetcher.nowOrWhenFetched(e,function(o,a){if(!o)return t.onGroupChanged(a),n(a);var l=_rdflib2.default.namedNode(e),u=_store2.default.any(l,_ns2.default.rdf("type"));return u&&u.equals(_ns2.default.foaf("Person"))?r(l):n(new Error("Only people supported right now. (tried to add something of type "+u.value+")"))})}).then(function(e){var r=_rdflib2.default.st(t.groupNode,_ns2.default.vcard("hasMember"),e);return _store2.default.holdsStatement(r)?e:patch(t.groupGraph.value,{toIns:[r]}).then(function(){r.why=t.groupGraph,_store2.default.add(r),t.onGroupChanged(null,"added",e),t.render()})})}},{key:"handleRemove",value:function(e){var t=this;return function(r){var n=_rdflib2.default.st(t.groupNode,_ns2.default.vcard("hasMember"),e);return patch(t.groupGraph.value,{toDel:[n]}).then(function(){return _store2.default.remove(n),t.onGroupChanged(null,"removed",e),t.render(),!0}).catch(function(t){var r=_store2.default.any(e,_ns2.default.foaf("name")),n=r&&r.value?"Could not remove "+r.value+". ("+t+")":"Could not remove "+e.value+". ("+t+")";throw new Error(n)})}}},{key:"setGroupName",value:function(e){var t=this,r=bookUrls(this.bookBaseUrl),n=r.groupIndexUrl,o=[this.groupGraph,_rdflib2.default.namedNode(n)].map(function(r){var n=_store2.default.match(t.groupNode,_ns2.default.vcard("fn"),null,r),o=_rdflib2.default.st(t.groupNode,_ns2.default.vcard("fn"),_rdflib2.default.literal(e));return patch(r.value,{toDel:n,toIns:[o]}).then(function(e){_store2.default.removeStatements(n),o.why=r,_store2.default.add(o)})});return Promise.all(o)}}]),e}(),Person=function(){function e(t,r,n){_classCallCheck(this,e),this.webIdNode=r,this.element=t,this.handleRemove=n}return _createClass(e,[{key:"render",value:function(){var e=this,t=document.createElement("div");t.style.display="flex";var r=getWithDefault(this.webIdNode,_ns2.default.foaf("img"),_iconBase.iconBase+"noun_15059.svg"),n=document.createElement("img");n.src=(0,_escapeHtml2.default)(r),n.width="50",n.height="50",n.style.margin="5px";var o=getWithDefault(this.webIdNode,_ns2.default.foaf("name"),"["+this.webIdNode+"]"),a=document.createElement("span");a.innerHTML=(0,_escapeHtml2.default)(o),a.style.flexGrow="1",a.style.margin="auto 0";var l=document.createElement("button");return l.textContent="Remove",l.addEventListener("click",function(t){return e.handleRemove().catch(function(t){e.element.appendChild((0,_error.errorMessageBlock)(document,(0,_escapeHtml2.default)(""+t)))})}),l.style.margin="5px",t.appendChild(n),t.appendChild(a),t.appendChild(l),this.element.innerHTML="",this.element.appendChild(t),this}}]),e}();
},{"../iconBase":250,"../ns":254,"../store":257,"./dragAndDrop":261,"./error":262,"escape-html":85,"node-uuid":112,"rdflib":142,"solid-web-client":219}],"solid-ui":[function(require,module,exports){
"use strict";var rdf=require("rdflib"),ns=require("./ns"),UI={acl:require("./acl"),aclControl:require("./acl-control"),icons:require("./iconBase"),log:require("./log"),matrix:require("./matrix"),messageArea:require("./messageArea"),ns:ns,pad:require("./pad"),rdf:rdf,signin:require("./signin"),solid:require("solid-client"),store:require("./store"),table:require("./table"),tabs:require("./tabs"),utils:require("./utils"),widgets:require("./widgets")};module.exports=UI;
},{"./acl":249,"./acl-control":248,"./iconBase":250,"./log":251,"./matrix":252,"./messageArea":253,"./ns":254,"./pad":255,"./signin":256,"./store":257,"./table":258,"./tabs":259,"./utils":260,"./widgets":263,"rdflib":142,"solid-client":192}]},{},[])

